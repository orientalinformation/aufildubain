/**
generator coreV7 version 2.37.12
Y29yZSxib29rbWFya3MsY2F0YWxvZyxkaWFwb3JhbWFDYXRhbG9nLGRvd25sb2FkcyxpbmRleCxtYXBzLG1lZGlhLG5vdGVzLHByb2dyZXNzQmFyLHNlYXJjaCxzaGFyaW5nLHNsaWRlckNhdGFsb2csc3VtbWFyeSx0cmFja2luZyxzY3JvbGxzaG9w

Src-mini Version : 1636Src-mini Date : 2/10/2017, 5:14:47 PM**/

var MainFrame=MainFrame||{version:"1.0.0"};window.V7Data=window.V7Data||{},MainFrame.Abstract={},MainFrame.Action={},MainFrame.Element={},MainFrame.Global={},MainFrame.Interpretor={},MainFrame.JSONData={},MainFrame.Manager={},MainFrame.Search={},MainFrame.Trigger={},MainFrame.PreloadedData={},MainFrame.Class={include:function(e){MainFrame.Util.extend(this.prototype,e)},mergeOptions:function(e){MainFrame.Util.extend(this.prototype.options,e)},extend:function(e){var t=function(){this.uid=(new Date).getTime()+"_"+Math.random(),this.initialize&&this.initialize.apply(this,arguments)},a=function(){};a.prototype=this.prototype;var i=new a;i.constructor=t,t.prototype=i;for(var r in this)this.hasOwnProperty(r)&&"prototype"!==r&&(t[r]=this[r]);return e.statics&&(MainFrame.Util.extend(t,e.statics),delete e.statics),e.includes&&(MainFrame.Util.extend.apply(null,[i].concat(e.includes)),delete e.includes),e.options&&i.options&&(e.options=MainFrame.Util.extend({},i.options,e.options)),MainFrame.Util.extend(i,e),t}};var setAppInContainer=function(e){e=e||{};var t=e.containerId||"container",a=e.appUrl||"",i=e.version||"html5autodetect",r=e.appFolder||"html",n=e.encoded;-1!==window.location.href.indexOf("dbg=phone")?i="html5phone":-1!==window.location.href.indexOf("dbg=tablet")?i="html5tablet":-1!==window.location.href.indexOf("dbg=desktop")&&(i="html5desktop");var s=e.configFile||{phone:"_mobile",tablet:"_mobile",desktop:"_desktop"},o=e.configPath||r+"/config/",l="main"+s.phone+".xml",c="main"+s.tablet+".xml",d="main"+s.desktop+".xml",g=e.variables||{};MainFrame.Global=MainFrame.Global||{},MainFrame.Global.initializationVariables=g,MainFrame.Global.initializationVariables.appFolder=r,MainFrame.Global.settings={},n===!0&&(MainFrame.Global.settings.encoded=!0);var h=e.preventCache;if(h){var u={};if(u.requestParam=h.requestParam||"timestamp",u.affectedFiles={},h.affectedFiles){var m=h.affectedFiles.split(",");m.forEach(function(e){u.affectedFiles[e]=!0})}else u.affectedFiles.all=!0;MainFrame.Global.settings.preventCache=u}e.parseHTML&&(MainFrame.Global.settings.parseHTML=e.parseHTML),MainFrame.Global.settings.urlParams=e.urlParams?e.urlParams:{source:"self"};var p=-1!==window.location.href.indexOf("dbg=on")?!0:!1;if(p&&sessionStorage&&sessionStorage.setItem("v7-debug","true"),sessionStorage){var f=sessionStorage.getItem("v7-debug");"true"===f&&(p=!0)}p&&(window.onerror=function(e,t,a){var i=[e,"<span>"+t+", line <strong>"+a+"</strong></span>","<hr>"].join("<br/>");MainFrame.Util.logOnScreen(i)});var v=e.catalogSettings||{},M=(document.getElementById(t),function(e){var t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e));var a=document.head||document.getElementsByTagName("head")[0];a.appendChild(t)}),b=function(e,t){var i=a+"common/css/"+t,r="@font-face {	font-family: '"+e+"';	src:url('"+i+".eot');	src:url('"+i+".eot#iefix') format('embedded-opentype'),		url('"+i+".woff') format('woff'),		url('"+i+".ttf') format('truetype'),		url('"+i+".svg#"+t+"') format('svg');	font-weight: normal;	font-style: normal;}";M(r)},F=function(){b("v7-font-icon","icomoon")},A=function(e){F(),new MainFrame.Application(t,o+e,a||void 0,v)};if(i&&""!==i)switch(i){case"html5phone":A(l);break;case"html5tablet":A(c);break;case"html5desktop":A(d);break;case"html5":case"html5autodetect":default:switch(EnvDetection.deviceType){case"Phone":A(l);break;case"Tablet":A(c);break;case"Desktop":A(d)}}else switch(EnvDetection.deviceType){case"Phone":A(l);break;case"Tablet":A(c);break;case"Desktop":default:A(d)}},EnvDetection=function(){var e,t={ios:"iOS",android:"Android",webos:"webOS",blackberry:"BlackBerry",rimTablet:"RIMTablet",mac:"MacOS",win:"Windows",linux:"Linux",bada:"Bada",other:"Other"},a={ios:"i(?:Pad|Phone|Pod)(?:.*)CPU(?: iPhone)? OS ",android:"(Android |HTC_|Silk/)",windowsPhone:"IEMobile",blackberry:"(?:BlackBerry|BB)(?:.*)Version/",rimTablet:"RIM Tablet OS ",webos:"(?:webOS|hpwOS)/",bada:"Bada/"},i={},r=null,n=null,s=navigator.userAgent,o=function(e,t){"undefined"==typeof t&&(t=!0),i[e]=t,i[e.toLowerCase()]=t};for(var l in a)if(a.hasOwnProperty(l)){var c=a[l],d=s.match(new RegExp("(?:"+c+")([^\\s;]+)"));d&&(r=t[l],n=d[d.length-1])}r||(r=t[(s.toLowerCase().match(/mac|win|linux/)||["other"])[0]]),o(r);for(var l in t)if(t.hasOwnProperty(l)){var g=t[l];i.hasOwnProperty(r)||o(g,r===g)}if(i.iOS&&(e=s.toLowerCase().match(/ipad/)?"Tablet":"Phone",s.match(/iPad;.*CPU.*OS 7_\d/i))){var h=document.documentElement;h.setAttribute("class","v7__bugfix--ipad-ios7")}var u=navigator.userAgent.match("Windows")&&navigator.userAgent.match("Touch")&&navigator.userAgent.match("ARM")&&navigator.userAgent.match("WPDesktop");return(navigator.userAgent.match(/IEMobile/i)||u)&&(i.windowsMobile=!0),e||(e=i.windowsMobile||i.Android||i.iOS||!/Windows|Linux|MacOS/.test(r)?i.iPad||i.RIMTablet||i.Android&&-1==s.search(/mobile/i)?"Tablet":"Phone":"Desktop"),{os:r,deviceType:e,isAndroid:i.Android,isIOS:i.iOS,is:i}}();!function(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var e=document.createElement("style");e.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.getElementsByTagName("head")[0].appendChild(e)}}(),MainFrame.Util={extend:function(e){for(var t,a=Array.prototype.slice.call(arguments,1),i=0,r=a.length;r>i;i++){t=a[i]||{};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}return e}},MainFrame.Scoping={},MainFrame.Scoping.Global={},MainFrame.Scoping.Repeat={},!function(){var e={emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",canPlayHTML5Video:"undefined"!=typeof document.createElement("video").canPlayType,addAppSpecificPrefix:function(e){var t=MainFrame.Util.getMainFrame(),a=t.appId||"";return a+"_"+e},addBreaklines:function(e){return e+="",e?e.split("#[nlc]").join("<br/>"):e},addNewlines:function(e){return e+="",e?e.split(/\r?\n/).join("<br/>"):e},arrayIntersection:function(e,t){return e&&e.filter&&t&&t.filter?e.filter(function(e){return-1!=t.indexOf(e)}):[]},arrayMultiIntersection:function(){var e=Array.prototype.slice.apply(arguments).slice(1),t=arguments[0];for(var a in e)if(t=MainFrame.Util.arrayIntersection(e[a],t),t==[])break;return t},arrayUnique:function(e){return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])},capitalize:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)})},cartesian:function(){function e(r,n){for(var s=0,o=a[n].length;o>s;s++){var l=r.slice(0);l.push(a[n][s]),n==i?t.push(l):e(l,n+1)}}var t=[],a=arguments,i=a.length-1;return e([],0),t},clone:function(e){var t={};for(var a in e)if("object"==typeof e[a])if(e[a]instanceof Array){for(var i=[],r=e[a].length,n=0;r>n;n++)i.push(MainFrame.Util.clone(e[a][n]));t[a]=i}else t[a]=MainFrame.Util.clone(e[a]);else t[a]=e[a];return t},copyArray:function(e){for(var t=[],a=0,i=e.length;i>a;a++)t.push(e[a]);return t},decToHex:function(e){var t="";e>15&&(t=MainFrame.Util.decToHex(Math.floor(e/16)));var a=e-16*Math.floor(e/16);return a>9&&(a=String.fromCharCode(a+55)),t+=a},escapeXML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},flashColorToHtml:function(e){var t=MainFrame.Util.decToHex(e),a=t.match(/(.{1,2})/g),i=parseInt(a[0],16)/255,r="rgba("+parseInt(a[1],16)+", "+parseInt(a[2],16)+", "+parseInt(a[3],16)+", "+i+")";return r},formatText:function(e){if(e){var t="&nbsp;&nbsp;&nbsp;&nbsp;";return e=e.replace(/\t/g,t),e=e.replace(/    /g,t),e=e.replace(/\n/g,"<br/>")}return""},generateAppId:function(){var e="1",t=window.location.href,a=/:\/\/w?w?w?\.?(.*)\//,i=t.match(a);return i&&(e=window.btoa(i[1])),e},generateItemId:function(){if(this.superObject)var e=this.superObject.id,t=this.superObject.subObjects?this.superObject.subObjects.length:1;else var e="mainframe",t=1;return e+"_subObject_"+t},getActiveElement:function(){return document.activeElement&&"body"!=document.activeElement.nodeName.toLowerCase()?document.activeElement:{blur:function(){},nodeName:""}},getAnchor:function(){var e=this.doc.URL,t=e.split("#");return t.length>1?t[1]:null},getBaseUrl:function(){var e=window.location.href;if(-1!==e.indexOf("#")){var t=e.split("#");t.pop(),e=t.join("")}var t=e.split("/");t.pop();var a=t.join("/")+"/";return a},getForSource:function(e){if(e){if(e=e.slice(1,-1),0===e.indexOf("var:"))return MainFrame.Util.getValueOfVariable(e);if(0===e.indexOf("lang:"))return MainFrame.Util.getValueOfTranslation(e);if(0===e.indexOf("eps:")&&MainFrame.EprintShop.currentProduct)return MainFrame.Util.getValueOfEprintshopProduct(e);if(0===e.indexOf("manager:"))return MainFrame.Util.getValueOfManagerExpression(e)}return null},getFullPath:function(e){var t=MainFrame.Util.isAbsoluteUrl(e),a=-1!==e.indexOf("/"),i=!t&&!a;return i?MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+e:a?MainFrame.Util.getAppURL()+e:e},getItem:function(e,t,a){var i=MainFrame.Util.getMainFrame();if(i){i.usesLocalStorage===!1&&(a="standard"),t="undefined"==typeof t?!1:t,e=MainFrame.Util.addAppSpecificPrefix(e),a="undefined"==typeof a?"localStorage":a;var r=MainFrame.Util.getStorage(a);try{var n=r.getItem(e)}catch(s){if(!r.getById)return!1;var n=r.getById(e)}return t?n&&JSON.parse(n):n}},getRefferal:function(){var e=this.doc.URL.split("#");return e.length>1&&(e=e[1].split("="),"ref"===e[0])?e[1]:null},getUID:function(){var e="",t=new Date;return e=[t.getDate(),t.getHours(),t.getMinutes(),t.getMilliseconds()].join("")},hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,a,i){return t+t+a+a+i+i});var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(a){var i=parseInt(a[1],16),r=parseInt(a[2],16),n=parseInt(a[3],16);return[i,r,n].join(",")}return null},isAbsoluteUrl:function(e){return-1!==e.indexOf("http")||-1!==e.indexOf("base64")?!0:!1},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},isInteger:function(e){return e===+e&&e===(0|e)},isPercentageValue:function(e){if(e){var t=/^[+-]?\d+(\.\d+)?%$/gi;return e.match(t)}return!1},localizePath:function(e){if(-1!==e.indexOf("#{lang}")){var t=MainFrame.Util.getDefaultLanguage();e=e.replace("#{lang}",t)}return e},pointInsideRectangle:function(e,t,a,i,r,n){var s=5;return e=parseFloat(e),t=parseFloat(t),a=parseFloat(a),i=parseFloat(i),r=parseFloat(r),n=parseFloat(n),a>e+s||e>a+r?!1:i>t+s||t>i+n?!1:!0},processAttribute:function(e){var t=[];if(e&&e.replace){if(MainFrame.Scoping.Repeat)for(var a in MainFrame.Scoping.Repeat)var i=a,r=MainFrame.Scoping.Repeat[a];e=e.replace(/\{(.*?)\}/g,function(e,a){if(1===e.indexOf("var:"))return MainFrame.Util.getValueOfVariable(a);if(1===e.indexOf("id:")){var n=a.split(":")[1],s=n.split(".");if(objectId=s[0],objectProp=s[1],objectValue=MainFrame.Manager.Scoping.getById(objectId),"visible"===objectProp){var o={};o.type="visibility",o.id=objectId,t.push(o)}return MainFrame.Util.getValueOfObject(n,objectValue)}if(1===e.indexOf("lang:"))return MainFrame.Util.getValueOfTranslation(a);if(1===e.indexOf("eps:")&&MainFrame.EprintShop.currentProduct){var l=a.split(":")[1];return MainFrame.Util.getValueOfObject(l,MainFrame.EprintShop.currentProduct)}if(1===e.indexOf("manager:"))return MainFrame.Util.getValueOfManagerExpression(a);if(i&&1===e.indexOf(i)){var c=a.split(".");c.shift();var d=c.join(".");return MainFrame.Util.getValueOfObject(d,r)}return 1===e.indexOf("global:")?MainFrame.Util.getValueOfGlobalVariable(a):e})}return{interpretedString:e,dependencies:t}},interpretString:function(e){var t={},a=[];return e&&e.replace&&(e=e.replace(/\{(.*?)\}/g,function(e,t){if(1===e.indexOf("var:")){var i=t.split(":")[1],r=(MainFrame.Manager.Variables.getById(i),{});return r.type="var",r.id=i,a.push(r),MainFrame.Manager.Variables.getById(i)||""}if(1===e.indexOf("id:")){var n=t.split(":")[1],s=n.split(".")[0],o=MainFrame.Manager.Scoping.getById(s);return MainFrame.Util.getValueOfObject(n,o)}if(1===e.indexOf("lang:"))return MainFrame.Util.getValueOfTranslation(t);if(1===e.indexOf("eps:")&&MainFrame.EprintShop.currentProduct){var l=t.split(":")[1];return MainFrame.Util.getValueOfObject(l,MainFrame.EprintShop.currentProduct)}if(1===e.indexOf("manager:"))return MainFrame.Util.getValueOfManagerExpression(t);if("undefined"!=typeof repeatScopeName&&1===e.indexOf(repeatScopeName)){var c=t.split(".");c.shift();var d=c.join(".");return MainFrame.Util.getValueOfObject(d,repeatScopeItem)}if(1===e.indexOf("global:"))return MainFrame.Util.getValueOfGlobalVariable(t);if(1===e.indexOf("GET:"))return MainFrame.Util.getValueOfGETParameter(t);if(1===e.indexOf("exists:")){var n=t.split(":")[1],s=n.split(".")[0],o=MainFrame.Manager.Scoping.getById(s);return null===o?"false":"true"}if(1===e.indexOf("visible:")){var n=t.split(":")[1],s=n.split(".")[0],o=MainFrame.Manager.Scoping.getById(s);return null===o||o.visible===!1?"false":"true"}return""})),t.dependencies=a,t.interpretedString=e,t},processRepeatAction:function(e,t,a){return e&&e.replace&&(e=e.replace(/\{(.*?)\}/g,function(e,i){if(t&&1===e.indexOf(t)){var r=i.split(".");r.shift();var n=r.join("."),s=MainFrame.Util.getValueOfObject(n,a);return s}return e})),e},processSrc:function(e){if(e){e=escape(e);var t=MainFrame.Util.isAbsoluteUrl(e),a=t&&-1!==e.indexOf("%3A"),i=-1!==e.indexOf("/")&&!t,r=!t&&!i;r?e=MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+e:i&&(e=MainFrame.Util.getAppURL()+e),e=MainFrame.Util.localizePath(e),e=a?decodeURIComponent(e):e}return e},removeFromArray:function(e,t){var a=t.indexOf(e);return-1!==a?(t=t.splice(a,1),!0):!1},getValueOfObject:function(e,t){var a=MainFrame.DataParser.interpretObjectString(e,t);return"undefined"!=typeof a?a:""},getValueOfManagerExpression:function(e){var t=e.split(":")[1],a=t.split("."),i=a.shift(),r=a.join("."),n=MainFrame.Util.capitalize(i),s=MainFrame.Manager[n];if(s){var o=MainFrame.DataParser.interpretObjectString(r,s);return o||""}return""},getValueOfEprintshopProduct:function(e){var t=e.split(":")[1],a=MainFrame.EprintShop.currentProduct;if(a){var i=MainFrame.EprintShop.interpretProductString(t,a);return i||""}return""},getValueOfTranslation:function(e){var t=e.split(":")[1],a=MainFrame.Manager.Text.getById(t);return a||""},getValueOfVariable:function(e){var t=e.split(":")[1],a=MainFrame.Manager.Variables.getById(t);return a||""},getValueOfGlobalVariable:function(e){var t=e.split(":")[1],a=MainFrame.Global[t];return a||""},getValueOfHashVariable:function(e){var t=e.split(":")[1],a=MainFrame.Router.dynamicPaths[t];if("page"===t){-1!==a.indexOf("-")&&(a=a.split("-")[0]);var i=MainFrame.Manager.Scoping.getById("catalog");a=i.getPageForPageNumber(a)}return a},getValueOfGETParameter:function(e){var t=e.split(":")[1];return MainFrame.Util.urlGET(t)||""},processParameter:function(e,t){return"string"==typeof e&&-1!==e.indexOf("{")?(e=MainFrame.Util.localizePath(e),e.replace(/\{(.*?)\}/g,function(e,a){if(1===e.indexOf("params:")&&t){var i=a.split(":")[1],r=t[i];return r||""}if(1===e.indexOf("id:")){var n=a.split(":")[1],s=n.split(".")[0],o=MainFrame.Manager.Scoping.getById(s);return MainFrame.Util.getValueOfObject(n,o)}return 1===e.indexOf("var:")?MainFrame.Util.getValueOfVariable(a):1===e.indexOf("lang:")?MainFrame.Util.getValueOfTranslation(a):1===e.indexOf("eps:")&&MainFrame.EprintShop.currentProduct?MainFrame.Util.getValueOfEprintshopProduct(a,MainFrame.EprintShop.currentProduct):1===e.indexOf("manager:")?MainFrame.Util.getValueOfManagerExpression(a):1===e.indexOf("global:")?MainFrame.Util.getValueOfGlobalVariable(a):1===e.indexOf("hash:")?MainFrame.Util.getValueOfHashVariable(a):1===e.indexOf("GET:")?MainFrame.Util.getValueOfGETParameter(a):e})):e},processPosition:function(e){var t={};if(e){var a=e.split("|");1===a.length&&a.push(a[0]);var i=a[0],r=a[1],n="centerLeft"===i;n===!1&&(-1!==i.indexOf("center")&&(i=i.replace("center","50%-w/2")),-1!==i.indexOf("left")&&(i=i.replace("left","0")),-1!==i.indexOf("right")&&(i=i.replace("right","100%-w")));var s="centerTop"===r;s===!1&&(-1!==r.indexOf("center")&&(r=r.replace("center","50%-h/2")),-1!==r.indexOf("top")&&(r=r.replace("top","0")),-1!==r.indexOf("bottom")&&(r=r.replace("bottom","100%-h"))),-1!==r.indexOf("top")&&(r=r.replace("top","0")),-1!==r.indexOf("bottom")&&(r=r.replace("bottom","100%-h")),t.x=i,t.y=r}else t.x="0",t.y="0";return t},processTarget:function(e){return e.indexOf("#")>=0||this.actionParamsObj&&this.actionParamsObj[e]?this.actionParamsObj[e]:e},purgePages:function(e,t){var a=MainFrame.Util.arrayIntersection(e,t.pageIndexes);return a},defaultDiacriticsRemovalMap:[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}],removeDiacritics:function(e){if(!e)return"";for(var t=MainFrame.Util.defaultDiacriticsRemovalMap,a=0;a<t.length;a++)e=e.replace(t[a].letters,t[a].base);return e},request:function(e){e=e||{};var t=e.url,a=e.method||"GET",i=e.reload,r=e.onSuccess,n=e.onError,s=e.params,o=e.formData||null,l=e.formDataParams,c="undefined"!=typeof e.convertHTTPS?e.convertHTTPS:!0,d="undefined"!=typeof e.credentials?e.credentials:!1,g="undefined"!=typeof e.xmlResponse?e.xmlResponse:!1,h="undefined"!=typeof e.jsonResponse?e.jsonResponse:!1,u="undefined"!=typeof e.asynchronous?e.asynchronous:!0,m="undefined"!=typeof e.parsedXmlResponse?e.parsedXmlResponse:!1,p="undefined"!=typeof e.originalResponse?e.originalResponse:!1,f="undefined"!=typeof e.overrideMimeType?e.overrideMimeType:null;if(m&&(g=!0),e.onSucces&&(r=e.onSucces,MainFrame.Util.showError('Warning: the correct callback name parameter for the request method is "onSuccess"')),!MainFrame.PreloadedData[t]||i===!0){var t=MainFrame.Util.processUrlForCaching(t);if(MainFrame.Browser.isHTTPS&&c){var v=0===t.indexOf("https://");v||(t=t.replace("http://","https://"))}if("undefined"!=typeof s){var M=[];for(var b in s){var F=s[b],A=b+"="+F;M.push(A)}var P=M.join("&"),y=-1!==t.indexOf("?");t+=y?"&"+P:"?"+P}if("undefined"!=typeof l){var o=new FormData;for(var b in l)o.append(b,l[b])}if(MainFrame.Browser.isFileProtocol){var C=-1!==t.indexOf(".xml"),E=-1!==t.indexOf(".json"),S=-1!==t.indexOf(".tetml");if(C)var w=t.replace(".xml",".json"),I=MainFrame.Util.getFilenameFromUrl(w);else if(S){var w=t.replace(".tetml",".json"),I=MainFrame.Util.getFilenameFromUrl(w);I=I.replace(".json","_tetml.json")}else if(E)var w=t.split(".json")[0]+"_offline.json",I=MainFrame.Util.getFilenameFromUrl(w);if(I)if("undefined"==typeof V7Data[I]){var x=document.createElement("script");x.onerror=function(){n&&n()},x.onload=function(){var e=V7Data[I];r(e)},x.src=w,document.body.appendChild(x)}else{var D=V7Data[I];r(D)}var T=-1!==t.indexOf(".jpg"),O=-1!==t.indexOf(".jpeg"),z=-1!==t.indexOf(".png"),B=T||O||z;if(B){var k=new Image;k.onerror=function(){n&&n()},k.onload=function(){r()},k.src=t}return{abort:function(){}}}var U=!1,R=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(R.onreadystatechange=function(){if(4===R.readyState)if(200==R.status){var e=p?R:R.responseText;if(g){if(R.responseXML)var t=R.responseXML;else var a=new DOMParser,t=a.parseFromString(R.responseText,"application/xml");e=m?MainFrame.DataParser.parseXml(t.documentElement):t}else h&&(e=JSON.parse(e));r&&r(e)}else n&&(U||(n(),U=!0))},d&&(R.withCredentials=!0),t){R.open(a,t,u),f&&R.overrideMimeType(f);try{R.send(o)}catch(Y){n&&(U||(n(),U=!0))}}return R}var _=MainFrame.PreloadedData[t];if(MainFrame.Browser.isFileProtocol)r(_);else if(g)if(m)if(_.responseXML&&_.responseXML.documentElement)r(MainFrame.DataParser.parseXml(_.responseXML.documentElement));else if(_.responseText){var L=new DOMParser,N=L.parseFromString(_.responseText,"application/xml");r(MainFrame.DataParser.parseXml(N.documentElement))}else MainFrame.Util.showError("Invalid XML content! Please check the file "+t);else if(_.responseXML)r(_.responseXML);else if(_.responseText){var L=new DOMParser,N=L.parseFromString(_.responseText,"application/xml");r(N)}else MainFrame.Util.showError("Invalid XML content! Please check the file "+t);else r(h?JSON.parse(_.response):_)},getFilenameFromUrl:function(e){var t=e.split("/"),a=t.pop();return a},processUrlForCaching:function(e){var t,a=MainFrame.Global.settings.preventCache;if(a){switch(a.requestParam){case"daily":var i=(new Date).getDate();t="?preventCache="+i;break;case"timestamp":var r=Date.now();t="?preventCache="+r;break;default:t="?preventCache="+a.requestParam}var n=e.split("/"),s=n[n.length-1];if(a.affectedFiles.all)e+=t;else if(a.affectedFiles[s])e+=t;else{var o=new RegExp("^([0-9]{4}).xml"),l=new RegExp("^([0-9]{4})(hd|v|).(jpg|png|pdf)"),c=-1!==s.indexOf(".js"),d=-1!==s.indexOf(".xml"),g=-1!==s.indexOf(".txt"),h=-1!==s.indexOf(".zip"),u=h&&-1!==s.indexOf("maps")||d&&s.match(o),m=s.match(l),p=d&&-1!==s.indexOf("mapsConfig")||d&&-1!==s.indexOf("main"),f=d&&-1!==s.indexOf("translation");c&&a.affectedFiles.js?e+=t:d&&a.affectedFiles.xml?e+=t:g&&a.affectedFiles.txt?e+=t:h&&a.affectedFiles.zip?e+=t:u&&a.affectedFiles.maps?e+=t:m&&a.affectedFiles.pages?e+=t:p&&a.affectedFiles.config?e+=t:f&&a.affectedFiles.translation&&(e+=t)}}return e},requestZip:function(e){if(e=e||{},!MainFrame.Browser.hasBlobSupport||"undefined"==typeof zip)return e.onError?e.onError():MainFrame.Util.showError("Zip is not supported!"),!1;var t=e.url;if(t){var a=new zip.fs.FS;zip.useWebWorkers=!1,a.importHttpContent(t,!1,function(){for(var t=e.arrayResponse?[]:{},i=0,r=a.root.children.length;r>i;i++){var n=a.root.children[i];e.arrayResponse?t.push(n):t[n.name]=n}e.onSuccess&&e.onSuccess(t)},function(){e.onError?e.onError():MainFrame.Util.showError("Unziping error for "+t)})}else e.onError&&e.onError()},romanize:function(e){var t,a={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},i="";for(t in a)for(;e>=a[t];)i+=t,e-=a[t];return i},saveItem:function(e,t,a,i){var r=MainFrame.Util.getMainFrame();if(r){r.usesLocalStorage===!1&&(i="standard"),a="undefined"==typeof a?!1:a,t=a?JSON.stringify(t):t,e=MainFrame.Util.addAppSpecificPrefix(e),i="undefined"==typeof i?"localStorage":i;var n=MainFrame.Util.getStorage(i);try{return n.setItem(e,t),!0}catch(s){if(!n.register)return!1;n.register(e,t)}}},getStorage:function(e){return e="undefined"==typeof e?"localStorage":e,"localStorage"===e&&"undefined"!=typeof localStorage?localStorage:"sessionStorage"===e&&"undefined"!=typeof sessionStorage?sessionStorage:MainFrame.Manager.Storage},secondsToMiliseconds:function(e){var t=0;return"undefined"!=typeof e&&(e=parseFloat(e),t=1e3*e),t},setDefault:function(e,t){return"undefined"==typeof e?t:e},sortByKey:function(e,t,a){if(e&&e.length&&t){var i=a===!0?-1:1;return e.sort(function(e,a){var r=e[t],n=a[t];return i*(n>r?-1:r>n?1:0)})}return e},urlGET:function(e){var t=MainFrame.Util.getURLLocation(),a=t.href,i=-1!==a.indexOf("?");return i?MainFrame.Util.dynamicGet(e):void 0},dynamicGet:function(e){var t=MainFrame.Util.getURLLocation(),a=t.href,i=a.split("?");if(i.length>1){i=i[1].split("&");for(var r=0,n=i.length;n>r;r++)if(i[r].split("=")[0]===e)return i[r].split("=")[1].split("#")[0]}return null},getURLLocation:function(){var e=MainFrame.Global.settings.urlParams.source;switch(e){case"parent":return window.parent.location;case"self":default:return window.location}},zeroFill:function(e,t){var a="000000",i=e.toString();return t="undefined"==typeof t?4:t,a.slice(0,t-i.length)+i},clearSlashes:function(e){return e.toString().replace(/\/$/,"").replace(/^\//,"")},checkPageHash:function(){var e=window.location.hash,t=e.split("#"),a=t[1].split("/"),i=-1!==a.indexOf("page");if(i){var r=MainFrame.Util.urlGET("page");-1!==r.indexOf("-")&&(r=r.split("-")[0]),MainFrame.EventHandler.dispatch("pageHashChanged",[{page:r}])}},checkOpenHash:function(){var e=window.location.hash,t=e.split("#");if(t.length&&t.length%2!==0){var a=t[1].split("/"),i=-1!==a.indexOf("open");if(i){var r=MainFrame.Util.urlGET("open"),n="#"+r+".opened";MainFrame.EventHandler.dispatch(n)}}},serializeXmlNode:function(e){return"undefined"!=typeof window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):"undefined"!=typeof e.xml?e.xml:""},cssAnimationDict:{flip:"v7-anim-flip",flip2:"v7-anim-flip-2",flipInX:"v7-anim-flip-in-x",flipInY:"v7-anim-flip-in-y",flipOutX:"v7-anim-flip-out-x",flipOutY:"v7-anim-flip-out-y",fade:"v7-anim-fade",fadeDown:"v7-anim-fade-down",fadeDownBig:"v7-anim-fade-down-big",fadeLeft:"v7-anim-fade-left",fadeLeftBig:"v7-anim-fade-left-big",fadeRight:"v7-anim-fade-right",fadeRightBig:"v7-anim-fade-right-big",fadeUp:"v7-anim-fade-up",fadeUpBig:"v7-anim-fade-up-big",bounce:"v7-anim-bounce",bounceDown:"v7-anim-bounce-down",bounceLeft:"v7-anim-bounce-left",bounceRight:"v7-anim-bounce-right",bounceUp:"v7-anim-bounce-up",rotate:"v7-anim-rotate",rotateDownRight:"v7-anim-rotate-down-right",rotateDownLeft:"v7-anim-rotate-down-left",rotateUpLeft:"v7-anim-rotate-up-left",rotateUpRight:"v7-anim-rotate-up-right",slideDown:"v7-anim-slide-down",slideLeft:"v7-anim-slide-left",slideLeft2:"v7-anim-slide-left-2",slideRight:"v7-anim-slide-right",slideUp:"v7-anim-slide-up",scale:"v7-anim-scale",jelly:"v7-anim-jelly",genie:"v7-anim-genie",bouncy:"v7-anim-bouncy",speedInRight:"v7-anim-speed-in-right",tada:"v7-anim-tada",wobble:"v7-anim-wobble",newspaper:"v7-anim-newspaper",sign:"v7-anim-sign",superScaled:"v7-anim-super-scaled",slit:"v7-anim-slit"},applyAnimationClassShow:function(e,t){if(e&&t){var a=MainFrame.Util.cssAnimationDict[e];
return MainFrame.Util.addClass(t,a),MainFrame.Util.classExists(a)}return!1},applyAnimationClassHide:function(e,t){if(e&&t){var a=MainFrame.Util.cssAnimationDict[e],i=a+"-reverse";return MainFrame.Util.removeClass(t,a),setTimeout(function(){MainFrame.Util.addClass(t,i)},25),MainFrame.Util.classExists(i)}return!1},removeAnimationClassHide:function(e,t){if(e&&t){var a=MainFrame.Util.cssAnimationDict[e]+"-reverse";return MainFrame.Util.removeClass(t,a),MainFrame.Util.classExists(a)}return!1},isValidEmailAddress:function(e){var t=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return t.test(e)},isNumeric:function(e){var t=new RegExp(/^\d+$/);return t.test(e)},isNumber:function(e){return"number"==typeof e?!0:"string"==typeof e?e.match(/^[+-]?\d+(\.\d+)?$/gi):!1},validate:function(e){var t="";for(var a in e)e[a].isRequired&&(e[a].email?this.isValidEmailAddress(e[a].value)?e[a].element.style.borderColor="#ccc":(e[a].element.style.borderColor="#db1a39",t=!0):null===e[a].value||""===e[a].value?(e[a].element.style.borderColor="#db1a39",t=!0):e[a].element.style.borderColor="#ccc");return""!=t?!1:!0},fillTemplateWithData:function(e,t){var a=JSON.stringify(e),i=MainFrame.Util.fillStringWithData(a,t),r=JSON.parse(i);return r},fillStringWithData:function(e,t){var a=/#{(.*?)}/gi,i=e.match(a);if(i)for(var r=0,n=i.length;n>r;r++){var s=i[r],o=s.slice(2,-1),l=MainFrame.Util.interpretDataString(o,t),c=l!==t,d=c?MainFrame.Util.addNewlines(l):"";d=d.replace(/\"/g,'\\"'),d=d.replace(/\//g,"\\/"),d=d.replace(/’/g,"'"),d=d.replace(/\r/g,""),d=d.replace(/\f/g,""),d=d.replace(/\t/g,"    "),e=e.replace(s,d)}return e},interpretDataString:function(e,t){for(var a=t||MainFrame.EprintShop.currentProduct,i=e.split("."),r=0,n=i.length;n>r;r++){var s=i[r],o=!1,l=!1,c=null,d=s.match(/\[(.*)\]/);d&&(c=d[1],c=c.replace(/\'|\"/g,""),o=!0,s=s.split("[")[0]),"undefined"!=typeof a[s]?o&&a[s][c]?(a=a[s][c],l=!0):a=a[s]:a.attributes&&"undefined"!=typeof a.attributes[s]?a=a.attributes[s]:a.children&&"undefined"!=typeof a.children[s]?o&&a.children[s][c]?(a=a.children[s][c],l=!0):a=a.children[s]:o&&!l?a="":console.log('template parsing error, no value found for the property "'+e+'"')}return a.value&&(a=a.value),a},getHueRotationForColor:function(e){switch(e){case"green":return"120deg";case"blue":return"240deg";default:return"0deg"}},generateCSSStyleName:function(e){return e?e.replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()}):e},isEmbed:function(){return MainFrame.Global.initializationVariables.embeddedView===!0}};MainFrame.Util.extend(MainFrame.Util,e)}(),MainFrame.Browser={width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,isHTTPS:0===window.location.href.indexOf("https://"),isFileProtocol:"file:"===window.location.protocol,hasTouch:"ontouchstart"in window&&"Desktop"!==EnvDetection.deviceType,hasOrientation:"orientation"in window&&"onorientationchange"in window,hasTransformLevel:0,hasRetina:window.devicePixelRatio&&window.devicePixelRatio>1?!0:!1,refresh:function(){this.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,this.setOrientation()},initialize:function(){this.setVendorPrefix(),this.setTransformLevel(),this.setOrientation(),this.setPreserve3DSupport(),this.hasBlobSupport=!0;try{new Blob}catch(e){this.hasBlobSupport=!1}this.hasHover=this.hasTouch&&!window.navigator.msMaxTouchPoints?!1:!0},setOrientation:function(){var e=this.width/this.height>1?2:1;this.orientation!==e&&(this.orientation=e,MainFrame.EventHandler.dispatch("orientationChanged"),MainFrame.Publisher.publish("orientationChanged",{orientation:""}))},setVendorPrefix:function(){var e=document.documentElement.style;MainFrame.Event.transitionEnd="transitionend",MainFrame.Event.animationEnd="animationend";var t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var a in t)void 0!==e[a]&&(MainFrame.Event.transitionEnd=t[a]);"WebkitAppearance"in e?(this.vendorPrefix="Webkit",MainFrame.Event.animationEnd="webkitAnimationEnd"):"MozAppearance"in e?(this.vendorPrefix="Moz",MainFrame.Event.wheel="DOMMouseScroll"):window.opera&&"[object Opera]"===Object.prototype.toString.call(opera)?this.vendorPrefix="O":"string"==typeof navigator.cpuClass&&(this.vendorPrefix="ms")},setTransformLevel:function(){var e,t=this,a=document.createElement("div");t.hasTransformLevel=a.style[t.vendorPrefix+"Perspective"]!==e?0:a.style[t.vendorPrefix+"Transform"]!==e?1:2},setPreserve3DSupport:function(){var e=document.createElement("p"),t=(document.getElementsByTagName("HTML")[0],document.getElementsByTagName("BODY")[0]),a={webkitTransformStyle:"-webkit-transform-style",MozTransformStyle:"-moz-transform-style",msTransformStyle:"-ms-transform-style",transformStyle:"transform-style"};t.insertBefore(e,null);for(var i in a)void 0!==e.style[i]&&(e.style[i]="preserve-3d");var r=window.getComputedStyle(e,null),n=r.getPropertyValue("-webkit-transform-style")||r.getPropertyValue("-moz-transform-style")||r.getPropertyValue("-ms-transform-style")||r.getPropertyValue("transform-style");"preserve-3d"!==n&&(this.noPreserve3D=!0),document.body.removeChild(e)}},MainFrame.Event={resize:"resize",start:MainFrame.Browser.hasTouch?"touchstart":"mousedown",move:MainFrame.Browser.hasTouch?"touchmove":"mousemove",end:MainFrame.Browser.hasTouch?"touchend":"mouseup",out:"mouseout",cancel:MainFrame.Browser.hasTouch?"touchcancel":"mouseup",wheel:"mousewheel",transitionEnd:null,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches?1==e.touches.length:!0},isMultiTouch:function(e){return e.touches?e.touches.length>1:!1},isLeftClick:function(e){return e.which&&1==e.which||e.button&&1==e.button},isRightClick:function(e){return e.which&&3==e.which||e.button&&2==e.button},stop:function(e,t){t=MainFrame.Util.setDefault(t,!1),t||this.preventDefault(e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){if(e.shouldPreventDefault!==!1){var t=e.target||e.srcElement;t.tagName.match(/input|textarea|select/i)||"A"===t.tagName||(e.preventDefault?e.preventDefault():e.returnValue=!1)}},bind:function(e,t,a,i){if(e&&t){var r=t.split(" ");r.forEach(function(t){if("addEventListener"in e)try{e.addEventListener(t,a,i)}catch(r){if("object"!=typeof a||!a.handleEvent)throw r;e.addEventListener(t,function(e){a.handleEvent.call(a,e)},i)}else"attachEvent"in e&&("object"==typeof a&&a.handleEvent?e.attachEvent("on"+t,function(){a.handleEvent.call(a)}):e.attachEvent("on"+t,a))})}else MainFrame.Util.showError("Bind error! Element: "+e+", event: "+t)},unbind:function(e,t,a,i){if("removeEventListener"in e)try{e.removeEventListener(t,a,i)}catch(r){if("object"!=typeof a||!a.handleEvent)throw r;e.removeEventListener(t,function(e){a.handleEvent.call(a,e)},i)}else"detachEvent"in e&&("object"==typeof a&&a.handleEvent?e.detachEvent("on"+t,function(){a.handleEvent.call(a)}):e.detachEvent("on"+t,a))}},MainFrame.Abstract.Action=MainFrame.Class.extend({queueId:null,name:null,targetObjectId:null,confirmation:!1,hasExtraParams:!1,targetObject:null,callerObject:null,initiatorObject:null,params:null,paramsObject:null,initialize:function(e,t,a,i,r){if(this.targetObject=a,this.callerObject=e,this.confirmation=i,this.initiatorObject=t,this.paramsObject={},r){this.params=r,this.hasExtraParams=!0;for(var n=0,s=r.length;s>n;n++){var o=r[n];for(var l in o)this.paramsObject[l]=o[l]}}},initObject:function(){this.demandConfirmation()},getParam:function(e){return this.paramsObject[e]?"sourceEvent"===e?this.paramsObject.sourceEvent:MainFrame.Util.processParameter(this.paramsObject[e],this.paramsObject._actionParams):null},getTargetObject:function(){return"string"==typeof this.targetObject?"self"===this.targetObject?this.callerObject:"parent"===this.targetObject?this.initiatorObject.superObject:MainFrame.Manager.Scoping.getById(this.targetObject):this.targetObject},getTarget:function(){var e=MainFrame.Util.processParameter(this.targetObjectId,this.paramsObject._actionParams);return"self"===e?this.callerObject:"parent"===e?this.initiatorObject.superObject:MainFrame.Manager.Scoping.getById(e)},startAction:function(){},demandConfirmation:function(){var e=this.paramsObject._condition,t=this.paramsObject._conditionId,a="undefined"!=typeof e&&""!==e,i="undefined"!=typeof t&&""!==t,r=a||i;if(r){if(a&&!MainFrame.Util.evaluateCondition(e))return void this.endAndClearAction();if(i&&(e=MainFrame.Manager.Condition.getById(t),!MainFrame.Util.evaluateCondition(e)))return void this.endAndClearAction()}"false"===this.confirmation?this.startAction():this.startConfirmation()},startConfirmation:function(){var e=MainFrame.Util.getMainFrame();"true"===this.confirmation?e.requestConfirmation.call(this):e.requestConfirmation.call(this,this.confirmation)},callQueue:function(){this.queueId&&MainFrame.EventHandler.dispatch(this.queueId)},endAndClearAction:function(){MainFrame.ActionManager.removeAction(this)},killAction:function(){this.callQueue()},cancelAction:function(){this.callQueue()}}),MainFrame.Abstract.Element=MainFrame.Class.extend({positionX:"0",positionY:"0",dimensionX:"100%",dimensionY:"100%",isVisible:!0,translatedX:0,translatedY:0,hasContentElement:!0,initialize:function(e){if(e&&e.data){var t="false"===e.data.attributes.embeddedVisible?!1:!0;if(MainFrame.Util.isEmbed()&&t===!1)return}this._initialize(e)},_initialize:function(e){e=e||{},e.data&&(this.data=e.data),this._properties={},this._properties.def={},this._properties.original={},e.superObject&&this.addSuperObject(e.superObject,e.insertBeforeElement),this.id=e.id||MainFrame.Util.generateItemId.call(this),MainFrame.Manager.Scoping.register(this.id,this),"undefined"!=typeof e.containerElement&&e.containerElement?(this.containerElement=e.containerElement,this.containerElement.classList.add("v7__elem--container"),this.containerElement.setAttribute("data-type","container")):e.containerElement!==!1&&this.createContainerElement(e.insertBeforeElement),e.contentElement&&this.hasContentElement&&(this.contentElement=e.contentElement,this.contentElement.setAttribute("data-type","v7__elem--content")),e.data&&this.readData(e.data),this.resize()},updateId:function(e){var t=this.id;this.id=e,this.containerElement&&this.containerElement.setAttribute("data-item-id",e),t&&MainFrame.Manager.Scoping.unregisterById(t),MainFrame.Manager.Scoping.register(e,this)},getPositionX:function(){return this.superObject?this.parseStringExpression(this.positionX,this.superObject.getDimensionX()):0},getPositionY:function(){return this.superObject?this.parseStringExpression(this.positionY,this.superObject.getDimensionY()):0},getDimensionX:function(){return this.superObject?this.parseStringExpression(this.dimensionX,this.superObject.getDimensionX()):this.containerElement.parentNode.clientWidth},getDimensionY:function(){return this.superObject?this.parseStringExpression(this.dimensionY,this.superObject.getDimensionY()):this.containerElement.parentNode.clientHeight>MainFrame.Browser.height?MainFrame.Browser.height:this.containerElement.parentNode.clientHeight},setDimensionX:function(e){this.dimensionX=e+""},setDimensionY:function(e){this.dimensionY=e+""},setPositionX:function(e){this.positionX=e+""},setPositionY:function(e){this.positionY=e+""},resetDimension:function(){this.states&&this.states.def&&(this.setDimensionX(this.states.def.w),this.setDimensionY(this.states.def.h),this.resize())},setProperty:function(e,t,a){this._properties&&("undefined"==typeof a?(this._properties.original[e]=t,this._properties.def[e]=t):(this._properties[a]||(this._properties[a]={}),this._properties[a][e]=t))},parseStringExpression:function(exprString,parentValue){var self=this;if(MainFrame.Util.isNumber(exprString))return parseFloat(exprString,10);if(MainFrame.Util.isPercentageValue(exprString))return parentValue*parseFloat(exprString,10)/100;if("centerTop"===exprString){var currentHeight=this.getDimensionY();exprString=parentValue>=currentHeight?"50%-h/2":"0"}if("centerLeft"===exprString){var currentWidth=this.getDimensionX();exprString=parentValue>=currentWidth?"50%-w/2":"0"}try{var parsedValue=eval(exprString.replace(/\d{1,}\.\d{1,}\%|\d{1,}\%|\d{1,}\.\d{1,}|\{maxWidth:[0-9]{1,}\}|\{#[a-zA-Z0-9._]{1,}\}|[a-z]{1}/g,function(e){switch(e){case"w":return self.getDimensionX();case"h":return self.getDimensionY();default:return-1!==e.indexOf("#")?self.getObjectProperty(e):-1!==e.indexOf("%")?parseFloat(e.substr(0,e.length-1))*parentValue/100:-1!==e.indexOf("maxWidth")?self.getSizeForMaxWidth(e):e}}));return parsedValue}catch(e){MainFrame.Util.showError('Invalid size string used for element "'+this.id+'" with value "'+exprString+'" , parentValue = '+parentValue),console.log(e)}return 0},getObjectProperty:function(e){var t=e;e=e.replace("{","").replace("}","");var a=e.split("."),i=a[1],r=a[0].split("#")[1],n=MainFrame.Manager.Scoping.getById(r);if(n&&"2"===n.API_VERSION){var s=0,o=!1,l=!1;switch(i){case"x":return n.getPositionX();case"y":return n.getPositionY();case"w":return n.getDimensionX();case"h":return n.getDimensionY();case"after":return n.visible===!1?n.getPositionX():n.getPositionX()+n.getDimensionX();case"under":return n.visible===!1?n.getPositionY():n.getPositionY()+n.getDimensionY();case"centerX":return n.getPositionX()+n.getDimensionX()/2;case"centerY":return n.getPositionY()+n.getDimensionY()/2;case"pageX":var c=n.currentCatalogSize;if(o=!0,s=c.x,n.isDoublePage&&1===n.pagesOnScreen){var d=n.currentPage;n.shouldCenterPage(d)?s=c.x+Math.floor(n.currentPageSize.width/2):1===n.currentPage&&(s=c.x+n.currentPageSize.width)}break;case"pageY":var c=n.currentCatalogSize;o=!0,s=c.y;break;case"pageW":if(n.isDoublePage&&1===n.pagesOnScreen){var g=n.currentPageSize;s=g.width}else{var c=n.currentCatalogSize;s=c.width}o=!0;break;case"pageH":var c=n.currentCatalogSize;o=!0,s=c.height;break;case"pageAfter":var c=n.currentCatalogSize;if(o=!0,n.isDoublePage&&1===n.pagesOnScreen){var d=n.currentPage;if(n.shouldCenterPage(d)){var h=n.currentPageSize.width;s=c.x+Math.floor(h/2)+h}else 1===n.currentPage&&(s=c.x+c.width)}else s=c.x+c.width;break;case"pageUnder":var c=n.currentCatalogSize;o=!0,s=c.y+c.height;break;case"scale":l=!0,s=n.scale}var u=this;return o&&(MainFrame.Publisher.subscribe(n.id+":resized",u,function(){u.resize()}),MainFrame.Publisher.subscribe(n.id+":pageTypeChanged",u,function(){u.resize()})),l&&(MainFrame.Publisher.subscribe(n.id+":zoomIn",u,function(){u.resize()}),MainFrame.Publisher.subscribe(n.id+":zoomOut",u,function(){u.resize()})),s}return this.getObjectProperty_deprecated(t)},getSizeForMaxWidth:function(e){var t=this.superObject.getDimensionX();e=e.replace("{","").replace("}","");var a=e.split(":"),i=parseInt(a[1],10);return t>=i?i:t},getObjectProperty_deprecated:function(e){e=e.replace("{","").replace("}","");var t=e.split("."),a=t[1],i=t[0].split("#")[1],r=MainFrame.Manager.Scoping.getById(i),n=0,s=!1,o=!1;if(r)switch(a){case"x":return r.getPositionX();case"y":return r.getPositionY();case"w":return r.getDimensionX();case"h":return r.getDimensionY();case"after":return r.visible===!1?r.getPositionX():r.getPositionX()+r.getDimensionX();case"under":return r.visible===!1?r.getPositionY():r.getPositionY()+r.getDimensionY();case"centerX":return r.getPositionX()+r.getDimensionX()/2;case"centerY":return r.getPositionY()+r.getDimensionY()/2;case"pageX":var l=r.getContainerForCurrentPagingType(r.currentPage),c=r.pages[l],d=c.numbers.length,g=r.getPositionX(),h=r.getDimensionX(),u=r.getPageSize().pageWidth,m=u*d,p=(h-m)/2,f=r.currentPage,v=0==f||1===f,M=r.isLastPage(f);if(r.settings&&r.settings.pages){var b=h/2-u;v&&r.settings.pages.centerFirst===!1&&(p=h-u-b),M&&r.settings.pages.centerLast===!1&&(p=b)}s=!0,n=g+p;break;case"pageY":var F=r.getPositionY(),A=r.getDimensionY(),P=r.getPageSize().pageHeight,y=(A-P)/2;s=!0,n=F+y;break;case"pageW":var l=r.getContainerForCurrentPagingType(r.currentPage),c=r.pages[l],d=c.numbers.length,u=r.getPageSize().pageWidth,m=u*d;s=!0,n=m;break;case"pageH":s=!0,n=r.getPageSize().pageHeight;break;case"pageAfter":var l=r.getContainerForCurrentPagingType(r.currentPage),c=r.pages[l],d=c.numbers.length,g=r.getPositionX(),h=r.getDimensionX(),u=r.getPageSize().pageWidth,m=u*d,p=(h-m)/2,f=r.currentPage,v=0==f||1===f,M=r.isLastPage(f);if(r.settings&&r.settings.pages){var b=h/2-u;v&&r.settings.pages.centerFirst===!1&&(p=h-u-b),M&&r.settings.pages.centerLast===!1&&(p=b)}s=!0,n=g+p+m;break;case"pageUnder":var F=r.getPositionY(),A=r.getDimensionY(),P=r.getPageSize().pageHeight,y=(A-P)/2;s=!0,n=F+y+P;break;case"scale":o=!0,n=r.scale}var C=this;return s&&(MainFrame.Publisher.subscribe(r.id+":resized",C,function(){C.resize()}),MainFrame.Publisher.subscribe(r.id+":pageTypeChanged",C,function(){C.resize()})),o&&(MainFrame.Publisher.subscribe(r.id+":zoomIn",C,function(){C.resize()}),MainFrame.Publisher.subscribe(r.id+":zoomOut",C,function(){C.resize()})),n},getDistanceToTop:function(){return this.superObject?this.getPositionY()+this.superObject.getDistanceToTop():this.getPositionY()},getDistanceToLeft:function(){return this.superObject?this.getPositionX()+this.superObject.getDistanceToLeft():this.getPositionX()},customInit:function(e,t,a,i,r){e.addSubObject(this),this.addSuperObject(e),this.contentElement=MainFrame.Util.createElement("div","v7__elem--content",this.containerElement),this.positionX=t,this.positionY=a,this.dimensionX=i,this.dimensionY=r},addSubObject:function(e,t){if(e.id&&(this.children||(this.children={}),this.children[e.id]=e),this.subObjects||(this.subObjects=[]),t){var a=this.subObjects.indexOf(t);if(-1!==a)return void this.subObjects.splice(a,0,e)}this.subObjects.push(e)},removeSubObjects:function(){if(this.subObjects)for(;this.subObjects.length;){var e=this.subObjects[0];this.removeSubObject(e)}},removeSubObject:function(e){if(this.subObjects){var t=this.subObjects.indexOf(e);-1!=t&&(e.unload(),this.subObjects.splice(t,1))}},unload:function(){this._unload()},_unload:function(){this.removeSubObjects(),MainFrame.Manager.Scoping.unregisterById(this.id),this.removeEventHandlers(),MainFrame.Publisher.removeSubscriber(this),MainFrame.Util.removeElement(this.containerElement)},empty:function(){this.subObjects&&this.removeSubObjects()},removeEventHandlers:function(){if(MainFrame.EventHandlerCore.removeHandlersForTarget(this.containerElement),this.subObjects)for(var e=0,t=this.subObjects.length;t>e;e++){var a=this.subObjects[e];a.removeEventHandlers()}this.interpretors&&(this.interpretors={})},resetActions:function(){if(this.actions){var e=this;this.actions.forEach(function(t){e.setAction(t),e.subObjects&&e.subObjects.forEach(function(e){e.resetActions()})})}},reattachChildrenToContainers:function(){var e=this.containerElement;this.contentElement&&(this.contentElement=this.containerElement.childNodes[0],e=this.contentElement);for(var t=0,a=e.childNodes.length,i=[];a>t;t++){var r=e.childNodes[t];r.getAttribute&&"container"===r.getAttribute("data-type")&&i.push(r)}if(this.subObjects)for(var n=0,s=this.subObjects.length;s>n;n++){var o=this.subObjects[n];o.containerElement=i[n],o.reattachChildrenToContainers()}},getSubObjectWithId:function(e){if(this.children&&this.children[e])return this.children[e];var t=null;if(this.subObjects)for(var a=this.subObjects.length,i=0;a>i;i++){if(this.subObjects[i].id===e){t=this.subObjects[i];break}if(this.subObjects[i].subObjects&&(t=this.subObjects[i].getSubObjectWithId(e)))break}return t},getSubObjectWithRole:function(e){var t=null;if(this.subObjects)for(var a=this.subObjects.length,i=0;a>i;i++){var r=this.subObjects[i];if(r.role===e)return r;if(r.subObjects&&(t=r.getSubObjectWithRole(e)))return t}return t},getSubObjectsWithRole:function(e){var t=[];if(this.subObjects)for(var a=this.subObjects.length,i=0;a>i;i++){var r=this.subObjects[i];if(r.role===e)t.push(r);else if(r.subObjects){var n=r.getSubObjectsWithRole(e);t=t.concat(n)}}return t},addSuperObject:function(e,t){this.superObject=e,e.addSubObject(this,t)},createContainerElement:function(e){var t,a=!1;e?(t=e.containerElement,a=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body,this.containerElement=MainFrame.Util.createElement("div","v7__elem--container",t,a),this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container")},createContentElement:function(){this.containerElement||this.createContainerElement(),this.contentElement=MainFrame.Util.createElement("div","v7__elem--content",this.containerElement),this.contentElement.setAttribute("data-type","content")},readData:function(e){MainFrame.DataParser.parseElement.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this]),this.data=e},resize:function(e){this.containerElement&&this._resize(e)},_resize:function(){if("fit"===this.fillType?this._resizeToFit():"fill"===this.fillType?this._resizeToFill():this._resizeStandard(),this.hasSlider){var e=this;setTimeout(function(){Ps.update(e.contentElement)},500)}},_resizeToFit:function(){this.containerElement.style.maxWidth="100%",this.containerElement.style.maxHeight="100%",this.containerElement.style.top="0px",this.containerElement.style.left="0px",this.containerElement.style.right="0px",this.containerElement.style.bottom="0px",this.containerElement.style.margin="auto";var e=this.superObject.getDimensionX()/this.superObject.getDimensionY();if(this.ratio>=e){this.containerElement.style.width="100%";var t=this.superObject.getDimensionX();a=t/this.ratio,this.containerElement.style.height=a+"px"}else{this.containerElement.style.height="100%";var a=this.superObject.getDimensionY(),t=a*this.ratio;this.containerElement.style.width=t+"px"}this._resizeContent(),this._resizeSkins(),this.needsResize=!1},_resizeToFill:function(){var e=this.superObject.getDimensionX()/this.superObject.getDimensionY();this.ratio>=e?(this.containerElement.style.width="auto",this.containerElement.style.height="100%"):(this.containerElement.style.width="100%",this.containerElement.style.height="auto");var t=MainFrame.Util.isPercentageValue(this.positionX)?this.positionX:this.getPositionX()+"px",a=MainFrame.Util.isPercentageValue(this.positionY)?this.positionY:this.getPositionY()+"px";this.containerElement.style.left=t,this.containerElement.style.top=a,this._resizeContent(),this._resizeSkins(),this.needsResize=!1},_resizeStandard:function(e){if(e=e||{},this.layout&&("grid"===this.layout?this.gridResize():"vertical"===this.layout?this.verticalResize():"horizontal"===this.layout&&this.horizontalResize()),"undefined"==typeof e.width)var t=MainFrame.Util.isPercentageValue(this.dimensionX)?this.dimensionX:this.getDimensionX()+"px";else var t=MainFrame.Util.isPercentageValue(e.width)?e.width:e.width+"px";if("undefined"==typeof e.height)var a=MainFrame.Util.isPercentageValue(this.dimensionY)?this.dimensionY:this.getDimensionY()+"px";else var a=MainFrame.Util.isPercentageValue(e.height)?e.height:e.height+"px";if(this.containerElement.style.width=t,this.containerElement.style.height=a,"undefined"==typeof e.x)var i=MainFrame.Util.isPercentageValue(this.positionX)?this.positionX:this.getPositionX()+"px";else var i=MainFrame.Util.isPercentageValue(e.x)?e.x:e.x+"px";if("undefined"==typeof e.y)var r=MainFrame.Util.isPercentageValue(this.positionY)?this.positionY:this.getPositionY()+"px";else var r=MainFrame.Util.isPercentageValue(e.y)?e.y:e.y+"px";this.containerElement.style.left=i,this.containerElement.style.top=r,this._resizeContent(),this._resizeSkins(),this.needsResize=!1},_resizeContent:function(){if(this.subObjects)for(var e=0,t=this.subObjects.length;t>e;e++)this.subObjects[e].resize()},_resizeSkins:function(){if(this.skins)for(var e=0,t=this.skins.length;t>e;e++){var a=this.skins[e];a.resize()}},gridResize:function(){if(this.subObjects&&this.subObjects.length){for(var e=this.getDimensionX(),t=(this.subObjects.length,this.subObjects[0]),a=t.getDimensionX(),i=t.getDimensionY(),r=Math.floor(e/(a+this.spacing.x)),n=r*a+(r-1)*this.spacing.x,s=0,o=0,l=e-n,c=Math.floor(l/2),d=!1,g=0,h=0,u=0,m=this.subObjects.length;m>g;g++){var p=this.subObjects[g],f=c+s,v=o;p.visible!==!1&&(s+=a,h++,this.spacing.x&&(s+=this.spacing.x)),h===r&&(h=0,s=0,u++,o+=i,this.spacing.y&&(o+=this.spacing.y),g===m-1&&(d=!0)),p.setPositionX(f),p.setPositionY(v)}d&&(u-=1);var M=i*(u+1);this.setDimensionY(M)}},verticalResize:function(){if(this.subObjects&&this.subObjects.length){for(var e,t=0,a=this.subObjects.length,i=0;a>t;t++){var r=this.subObjects[t];e=r.getDimensionY();var n=i;r.setPositionY(n),r.visible!==!1&&(i+=e,this.spacing.y&&(i+=this.spacing.y))}this.setDimensionY(i)}},horizontalResize:function(){if(this.subObjects&&this.subObjects.length){for(var e,t=0,a=this.subObjects.length,i=0;a>t;t++){var r=this.subObjects[t];e=r.getDimensionX();var n=i;r.setPositionX(n),r.visible!==!1&&(i+=e,this.spacing.x&&(i+=this.spacing.x))}this.setDimensionX(i)}},checkResponsiveConditions:function(){return"undefined"!=typeof this.maxWidth&&MainFrame.Browser.width>this.maxWidth?(this.hide(),void(this.disabled=!0)):"undefined"!=typeof this.minWidth&&MainFrame.Browser.width<this.minWidth?(this.hide(),void(this.disabled=!0)):"undefined"!=typeof this.maxHeight&&MainFrame.Browser.height>this.maxHeight?(this.hide(),void(this.disabled=!0)):"undefined"!=typeof this.minHeight&&MainFrame.Browser.height<this.minHeight?(this.hide(),void(this.disabled=!0)):(this.show(),void(this.disabled=!1))},setAction:function(e,t){this.actions||(this.actions=[]),MainFrame.ActionManager.resolveAction.call(this,e,t),-1===this.actions.indexOf(e)&&this.actions.push(e)},setTriggers:function(e){this.triggers||(this.triggers=[]);for(var t=0,a=e.length;a>t;t++){var i=e[t];i&&i.options&&i.options.triggerName&&i.options.triggerName.match(/press|singlePress|doublePress/)&&this.addHandCursor(),this.triggers.push(i)}},addHandCursor:function(e){this.containerElement.style.cursor=e||"pointer"},addAltId:function(e,t,a,i,r){var n=r||this.containerElement;MainFrame.AltPopOver.add(n,e,t,a,i),this.containerElement.style.cursor="pointer"},setVisible:function(e){e?(this.containerElement.style.display="block",this.visible=!0,this.isVisible=!0,MainFrame.Publisher.publish(this.id+":shown",{})):(this.containerElement.style.display="none",this.visible=!1,this.isVisible=!1,MainFrame.Publisher.publish(this.id+":hidden",{})),this.superObject&&this.superObject.layout&&this.superObject.resize(),MainFrame.Publisher.publish(this.id+":visibilityChanged",{visibile:this.visible})},show:function(){this.setVisible(!0);var e="#"+this.id+".show";MainFrame.EventHandler.dispatch(e)},hide:function(){this.setVisible(!1);var e="#"+this.id+".hide";MainFrame.EventHandler.dispatch(e)},setState:function(e){MainFrame.ActionManager.doAction(this,this,this.id,"applyStateChanges","false",[{state:e}])},reloadText:function(){if(this.originalText){var e=MainFrame.Util.processAttribute(this.originalText);text=e.interpretedString,this.setText(text)}if(this.subObjects)for(var t=0,a=this.subObjects.length;a>t;t++){var i=this.subObjects[t];i.reloadText()}},refresh:function(){this.empty(),this.readData(this.data)},applyProperty:function(e,t){var a=this.skinElement?this.skinElement.style:{},i=this.containerElement.style,r=this.skinElement?a:i,n="undefined"!=typeof this.contentElement&&"p"===this.contentElement.nodeName.toLowerCase(),s="input"===this.containerElement.nodeName.toLowerCase(),o="textarea"===this.containerElement.nodeName.toLowerCase();switch(n?r=this.contentElement.style:(s||o)&&(r=i),e){case"alpha":i.opacity=t||"";break;case"tint":this.containerElement.style.color=t||"";break;case"skin.fontIconColor":var l=this.skins[0];l&&l.fontIconTxt&&(l.fontIconTxt.style.color=t||"");break;case"skin.alpha":a.opacity=t||"";break;case"skin.border":r.border=t||"";break;case"skin.borderColor":r.borderTopColor=t,r.borderBottomColor=t,r.borderLeftColor=t,r.borderRightColor=t,r.borderWidth||(r.borderWidth="1px"),r.borderStyle||(r.borderStyle="solid");break;case"skin.borderTopColor":r.borderTopColor=t,r.borderTopWidth||(r.borderTopWidth="1px"),r.borderTopStyle||(r.borderTopStyle="solid");break;case"skin.borderBottomColor":r.borderBottomColor=t,r.borderBottomWidth||(r.borderBottomWidth="1px"),r.borderBottomStyle||(r.borderBottomStyle="solid");break;case"skin.borderLeftColor":r.borderLeftColor=t,r.borderLeftWidth||(r.borderLeftWidth="1px"),r.borderLeftStyle||(r.borderLeftStyle="solid");break;case"skin.borderRightColor":r.borderRightColor=t,r.borderRightWidth||(r.borderRightWidth="1px"),r.borderRightStyle||(r.borderRightStyle="solid");break;case"skin.borderSize":r.borderTopWidth=t+"px",r.borderBottomWidth=t+"px",r.borderLeftWidth=t+"px",r.borderRightWidth=t+"px",r.borderStyle||(r.borderStyle="solid");break;case"skin.borderTopSize":r.borderTopWidth=t+"px",r.borderStyle||(r.borderStyle="solid");break;case"skin.borderBottomSize":r.borderBottomWidth=t+"px",r.borderStyle||(r.borderStyle="solid");break;case"skin.borderLeftSize":r.borderLeftWidth=t+"px",r.borderStyle||(r.borderStyle="solid");break;case"skin.borderRightSize":r.borderRightWidth=t+"px",r.borderStyle||(r.borderStyle="solid");break;case"skin.borderStyle":r.borderStyle=t,r.borderWidth||(r.borderWidth="1px");break;case"borderT":r.borderTop=t||"";break;case"borderR":r.borderRight=t||"";break;case"borderB":r.borderBottom=t||"";break;case"borderL":r.borderLeft=t||"";break;case"skin.color":r.backgroundColor=t||"";break;case"skin.file":case"skin.img":var c=t===this.states.def["skin.img"]?"def":"other";this.skinElement||(this.skinElement=MainFrame.Util.createElement("div","v7__elem--skin",this.containerElement)),this.backgroundImage||(this.backgroundImage=MainFrame.Util.createElement("img","",this.skinElement)),src=MainFrame.Util.localizePath(t);var d=!MainFrame.Util.isAbsoluteUrl(src);d&&(src=-1===src.indexOf("/")?MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+src:MainFrame.Util.getAppURL()+src),this.duration&&"0"!==this.duration?(this.secondBackgroundImage||(this.secondBackgroundImage=MainFrame.Util.createElement("img","",this.skinElement),this.secondBackgroundImage.style.position="absolute",this.secondBackgroundImage.style.left="0px",this.secondBackgroundImage.style.top="0px;",this.secondBackgroundImage.style.opacity="0",this.secondBackgroundImage.style.transition="opacity "+this.duration+"s",window.getComputedStyle(this.secondBackgroundImage,null).getPropertyValue("opacity")),"def"===c?(this.backgroundImage.src=src,this.secondBackgroundImage.style.opacity="0"):(this.secondBackgroundImage.src=src,this.secondBackgroundImage.style.opacity="1")):this.backgroundImage.src=src;break;case"h":this.setDimensionY(t),this.needsResize=!0;break;case"skin.radius":t=t||"0",r.borderRadius=t+"px";break;case"radiusTL":t=t||"0",r.borderTopLeftRadius=t+"px";break;case"radiusTR":t=t||"0",r.borderTopRightRadius=t+"px";break;case"radiusBL":t=t||"0",r.borderBottomLeftRadius=t+"px";break;case"radiusBR":t=t||"0",r.borderBottomRightRadius=t+"px";break;case"skin.shadow":this.setShadow(t);break;case"skin.shape":this.setShape(t);break;case"scale":t=t||"1",this.containerElement.style[MainFrame.Browser.vendorPrefix+"Transform"]="scale("+t+")";break;case"textColor":t=t||"",this.containerElement.style.color=t,r.color=t;break;case"bold":t="1"===t?"bold":"normal",r.fontWeight=t;break;case"bold":t="1"===t?"bold":"normal",r.fontWeight=t;break;case"italic":t="1"===t?"italic":"",r.fontStyle=t;break;case"underline":t="1"===t?"underline":"",r.textDecoration=t;break;case"striketrough":t="1"===t?"striketrough":"",r.textDecoration=t;
break;case"upperCase":t="1"===t?"uppercase":"",r.textTransform=t;break;case"lowerCase":t="1"===t?"lowercase":"",r.textTransform=t;break;case"w":this.setDimensionX(t),this.needsResize=!0;break;case"x":this.setPositionX(t),this.needsResize=!0;break;case"y":this.setPositionY(t),this.needsResize=!0;break;case"visible":t&&"false"!==t&&"0"!==t?this.show():this.hide()}},setShadow:function(e){for(var t=this.skinElement?this.skinElement.style:this.containerElement.style,a=e.split(";"),i=0,r=0,n=3,s=3,o=3,l="#000000",c=0,d=a.length;d>c;c++){var g=a[c].split(":"),h=g[0],u=g[1];switch(h){case"side":for(var m=u.split("|"),p=0,f=m.length;f>p;p++){var v=m[p];switch(v){case"top":i=-1;break;case"right":r=1;break;case"bottom":i=1;break;case"left":r=-1}}break;case"color":l=u;break;case"distance":n=u,s=u}}t.boxShadow=r*n+"px "+i*s+"px "+o+"px "+l},setShape:function(e){var t=this.skinElement?this.skinElement.style:this.containerElement.style;switch(e){case"circle":t.borderRadius="50%";break;case"roundRect":t.borderRadius="10px";break;case"semiCircleTop":var a=this.getDimensionY();t.borderRadius=a+"px "+a+"px 0px 0px";break;case"semiCircleRight":var a=this.getDimensionY();t.borderRadius="0px "+a+"px "+a+"px 0px";break;case"semiCircleBottom":var a=this.getDimensionY();t.borderRadius="0px 0px "+a+"px "+a+"px";break;case"semiCircleLeft":var a=this.getDimensionY();t.borderRadius=a+"px 0px 0px "+a+"px";break;case"triangleTop":this.skinElement||(this.skinElement=MainFrame.Util.createElement("div","v7__elem--skin",this.containerElement)),this.skinElement.style.width="0px",this.skinElement.style.height="0px";var i=this.getDimensionX(),r=parseInt(i/2,10),n=this.states.def.color||"#FFFFFF";this.skinElement.style.borderBottom=i+"px solid "+n,this.skinElement.style.borderLeft=r+"px solid transparent",this.skinElement.style.borderRight=r+"px solid transparent",this.containerElement.style.backgroundColor="";break;case"triangleRight":this.skinElement||(this.skinElement=MainFrame.Util.createElement("div","v7__elem--skin",this.containerElement)),this.skinElement.style.width="0px",this.skinElement.style.height="0px";var a=this.getDimensionY(),s=parseInt(a/2,10),n=this.states.def.color||"#FFFFFF";this.skinElement.style.borderLeft=a+"px solid "+n,this.skinElement.style.borderTop=s+"px solid transparent",this.skinElement.style.borderBottom=s+"px solid transparent",this.containerElement.style.backgroundColor="";break;case"triangleBottom":this.skinElement||(this.skinElement=MainFrame.Util.createElement("div","v7__elem--skin",this.containerElement)),this.skinElement.style.width="0px",this.skinElement.style.height="0px";var i=this.getDimensionX(),r=parseInt(i/2,10),n=this.states.def.color||"#FF0000";this.skinElement.style.borderTop=i+"px solid "+n,this.skinElement.style.borderLeft=r+"px solid transparent",this.skinElement.style.borderRight=r+"px solid transparent",this.containerElement.style.backgroundColor="";break;case"triangleLeft":this.skinElement||(this.skinElement=MainFrame.Util.createElement("div","v7__elem--skin",this.containerElement)),this.skinElement.style.width="0px",this.skinElement.style.height="0px";var a=this.getDimensionY(),s=parseInt(a/2,10),n=this.states.def.color||"#FF0000";this.skinElement.style.borderRight=a+"px solid "+n,this.skinElement.style.borderTop=s+"px solid transparent",this.skinElement.style.borderBottom=s+"px solid transparent",this.containerElement.style.backgroundColor=""}},resizeIfNeeded:function(){if(this.needsResize)this.resize();else if(this.subObjects&&this.subObjects.length)for(var e=0,t=this.subObjects.length;t>e;e++){var a=this.subObjects[e];a.resizeIfNeeded()}}}),MainFrame.Abstract.Interpretor=MainFrame.Class.extend({initialize:function(e,t,a,i){switch(t){case"self":this.target=e;break;case"parent":this.target=e.superObject;break;case null:this.target=e;break;default:t=MainFrame.Util.processParameter(t,a),this.target=MainFrame.Manager.Scoping.getById(t)||e}this.shouldPreventDefault="undefined"==typeof i?!0:!1,this.initiator=e,this.addListeners()},addListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.bind(e,MainFrame.Event.start,this),MainFrame.Event.bind(e,MainFrame.Event.move,this),MainFrame.Event.bind(e,MainFrame.Event.end,this),MainFrame.Event.bind(e,MainFrame.Event.cancel,this)},removeListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.unbind(e,Event.start,this),MainFrame.Event.unbind(e,Event.move,this),MainFrame.Event.unbind(e,Event.end,this),MainFrame.Event.unbind(e,Event.cancel,this)},handleEvent:function(e){e.type===MainFrame.Event.start?this.onTouchStart(e):e.type===MainFrame.Event.move?this.onTouchMove(e):(e.type===MainFrame.Event.end||e.type===MainFrame.Event.cancel||e.type===MainFrame.Event.out)&&this.onTouchEnd(e)},onTouchStart:function(){},onTouchMove:function(){},onTouchEnd:function(){},showTapEffect:function(){var e=this,t=MainFrame.Util.getMainFrame(),a=t.tapEffect;if(a&&a.enabled){var i=a.differenceX,r=a.differenceY,n=e.initialX+i,s=e.initialY+r;a.animationAreaContainer.style.left=n+"px",a.animationAreaContainer.style.top=s+"px",MainFrame.Util.addClass(a.animationCenterContainer,"v7__tap-point--tapped");var o=function(){MainFrame.Util.removeClass(a.animationCenterContainer,"v7__tap-point--tapped"),MainFrame.Event.unbind(a.animationCenterContainer,MainFrame.Event.animationEnd,o)};MainFrame.Event.bind(a.animationCenterContainer,MainFrame.Event.animationEnd,o)}},initiatedByTheCatalog:function(){return this.initiator&&this.initiator instanceof MainFrame.Element.Catalog?!0:!1},validCatalogTarget:function(e){var t=this.initiator,a=e.srcElement||e.target;return-1!==a.className.indexOf(t.cssClasses["single-zoom-overlay"])?!0:-1!==a.className.indexOf("v7__maps__zones")?!0:-1!==a.className.indexOf("v7__maps__map")?!0:-1!==a.className.indexOf("v7__maps__custom-content")?!0:-1!==a.className.indexOf(t.cssClasses["zoom-canvas"])?!0:-1!==a.className.indexOf("v7__maps__prices")?!0:-1!==a.className.indexOf("v7__elem__catalog__zoom-prices")?!0:-1!==a.className.indexOf(t.cssClasses["page-inner-shadow"])?!0:-1!==a.className.indexOf(t.cssClasses["text-highlight"])?!0:-1!==a.className.indexOf(t.cssClasses["slide-page-image"])?!0:-1!==a.className.indexOf(t.cssClasses["flip-page-image"])?!0:-1!==a.className.indexOf("v7-anim-falltrough")?!0:!1}}),MainFrame.Abstract.Library=function(){this.isLoaded=!1,this.onReadyCallbacks=null},MainFrame.Abstract.Library.prototype.triggerWhenReady=function(e,t){if(this.isLoaded)e.call(t);else{this.onReadyCallbacks||(this.onReadyCallbacks=[]);var a={};a.callback=e,a.context=t,this.onReadyCallbacks.push(a)}},MainFrame.Abstract.Library.prototype.onReady=function(){if(this.onReadyCallbacks)for(var e=0,t=this.onReadyCallbacks.length;t>e;e++){var a=this.onReadyCallbacks[e];a.callback.call(a.context)}},MainFrame.Abstract.Library.prototype.load=function(e){e=e||{};var t=e.isXML||!1,a=e.isJSON||!1,i=e.isZip||!1,r=e.isCSV||!1,n=e.csvConfig,s=e.url,o=e.arrayResponse||!1,l=this,c={};c.url=s,c.onSuccess=function(e){if(r){var t=e.responseText,a=MainFrame.DataParser.parseCSV(t,n);e=a}l.data=e,l.isLoaded=!0,l.onReady()},i?(c.arrayResponse=o,MainFrame.Util.requestZip(c)):(c.xmlResponse=t,c.jsonResponse=a,MainFrame.Util.request(c))},!function(){var e=function(e){if("undefined"!=typeof e&&"undefined"!=typeof e.id){if(this.id=e.id,"undefined"!=typeof e.hasLocalStorage){if("undefined"==typeof e.localStorageKeySufix)var t="";else var t=e.localStorageKeySufix;this.hasLocalStorage=e.hasLocalStorage,this.localStorageKey="manager:"+this.id+t}"undefined"!=typeof e.hasEventPublishing&&(this.hasEventPublishing=e.hasEventPublishing,this.eventKey="manager."+this.id+":")}this.initList(),e&&e.customInitList&&e.customInitList.apply(this)},t=e.prototype;t.initList=function(){var e=!1;for(var t in this.list)e=!0;if(!e){var a={};this.hasLocalStorage&&(a=MainFrame.Util.getItem(this.localStorageKey,!0)||a),this.list=a}},t.customInitList=function(){},t.saveList=function(e){if(this.save(),this.hasEventPublishing){var t=this.eventKey+"change";"undefined"!=typeof e?MainFrame.Publisher.publish(t,{triggerType:e.triggerType,id:e.id}):MainFrame.Publisher.publish(t)}},t.save=function(){this.hasLocalStorage&&MainFrame.Util.saveItem(this.localStorageKey,this.list,!0)},t.register=function(e,t,a){if(t){if("undefined"!=typeof a){if(a.clone){var i=MainFrame.Util.clone(t);this.list[e]=i}}else this.list[e]=t;this.saveList({triggerType:"register",id:e})}else MainFrame.Util.showError("Therere is no value to be stored in the manager for the id "+e)},t.getById=function(e){return this.list[e]?this.list[e]:null},t.unregister=function(){for(var e in this.list)delete this.list[e];this.saveList({triggerType:"unregister"})},t.unregisterById=function(e){this.list[e]&&(delete this.list[e],this.saveList({triggerType:"unregisterById",id:e}))},t.getTotalItems=function(){var e=0;if(this.list)for(var t in this.list)e++;return e},MainFrame.Abstract.Manager=e}(),MainFrame.Abstract.Module=MainFrame.Abstract.Element.extend({setLoadingScreen:function(){if(this.loadingTemplateData)var e=this.loadingTemplateData;else if(this.loadingTemplateId)var e=MainFrame.Manager.Resource.getById(this.loadingTemplateId);if(e){var t=new MainFrame.Element.Resource({superObject:this,data:e});this.loadingTemplate=t}},removeLoadingScreen:function(){this.loadingTemplate&&this.removeSubObject(this.loadingTemplate)}}),MainFrame.Abstract.Trie=MainFrame.Abstract.Trie||MainFrame.Class.extend({mainTrie:null,isInitialized:!1,init:function(){},range:function(e,t){var a=[];"undefined"==typeof t&&(t=e,e=0);for(var i=e;t>i;i++)a.push(i);return a},insertWord:function(e,t){for(var a=0,i=t.length;i>a;a++){var r=t[a];e.children[r]||(e.children[r]=new MainFrame.Abstract.Trie.Node),e=e.children[r]}e.word=t},searchSimilarWords:function(e,t){var a=this.range(e.length+1),i=[];for(var r in this.mainTrie.children)this.searchSimilarWordsRecursive(this.mainTrie.children[r],r,e,a,i,t);return i},searchSimilarWordsRecursive:function(e,t,a,i,r,n){for(var s=a.length+1,o=[i[0]+1],l=this.range(1,s),c=0,d=l.length;d>c;c++){var g=l[c],h=o[g-1]+1,u=i[g]+1,m=a[g-1]!==t?i[g-1]+1:i[g-1];o.push(Math.min(h,u,m))}if(o[o.length-1]<=n&&e.word&&r.push(e.word),Math.min.apply(Math,o)<=n)for(var t in e.children)this.searchSimilarWordsRecursive(e.children[t],t,a,o,r,n)},searchWordsBeginningWith:function(e){if(!e)return[];for(var t=e.split(""),a=this.mainTrie,i=[],r=0,n=t.length;n>r;r++){var s=t[r];if(!a.children||!a.children[s]){a=null;break}a=a.children[s]}return a&&this.searchWordsBeginningWithRecursive(a,i),i},searchWordsBeginningWithRecursive:function(e,t){if(e.word&&t.push(e.word),e.children)for(var a in e.children)this.searchWordsBeginningWithRecursive(e.children[a],t)}}),MainFrame.Abstract.Trie.Node=function(){this.word=null,this.children={}},MainFrame.Abstract.Trigger=MainFrame.Class.extend({initiatorObject:null,callerObject:null,callerId:null,targetId:null,actionString:null,actionId:null,actionParamsObj:null,queueId:null,params:null,confirmation:"false",repeat:0,delay:0,cooldown:0,interpretors:null,initialize:function(e,t,a,i){this.initiatorObject=e,this.actionDescription=t,this.actionParams=a,this.options=i,this.actionParamsObj=this.createParamsObject(a),this.interpretors={},this.actions||(this.actions=[]),this.initTrigger(),this.startAction()},setActionType:function(e){this.actionType=e},createParamsObject:function(e){var t={};if(e)for(var a,i,r,n=e.split(","),s=0,o=n.length;o>s;s++)a=n[s].split("="),a.length>2?(i=a.shift(),r=a.join("=")):(i=a[0],r=a[1]),t[i]=r;return t},initTrigger:function(){switch(this.actionDescription.nodeName){case"action":var e=MainFrame.DataParser.parseActionDescription.call(this,this.actionDescription);this.actions.push(e);break;case"actionQueue":var t=MainFrame.DataParser.parseActionQueue.call(this,this.actionDescription);this.actions=this.actions.concat(t);break;default:MainFrame.Util.showError('ActionDescription parsing error! The node with the node name "'+this.actionDescription.nodeName+'" is not suported inside an actionDesc!')}},startAction:function(){},_doAction:function(e){var t=this,a={},i=!this.initiatorObject.disabled;if(i){a.sourceEvent=e;for(var r=0,n=this.actions.length;n>r;r++){var s=this.actions[r],o="undefined"!=typeof s.condition;if(o)for(var l=0,c=s.actions.length;c>l;l++){var d=s.actions[l];d.addParam(a)}else s.addParam(a)}t.callerObject=t.callerId?"parent"===t.callerId?t.initiatorObject.getSuperObject():MainFrame.Manager.Scoping.getById(t.callerId):t.initiatorObject,this.executeAction()}},executeAction:function(){for(var e=[],t=0,a=this.actions.length;a>t;t++){var i=this.actions[t],r="undefined"!=typeof i.condition;if(r){i.queueActions=[];for(var n=0,s=i.actions.length;s>n;n++){var o=i.actions[n],l=this.getActionsToQueue(o);i.queueActions=i.queueActions.concat(l)}e.push(i)}else{var l=this.getActionsToQueue(i);e=e.concat(l)}}"actionQueue"===this.actionType&&MainFrame.Queue.addQueue(e,!0)},getActionsToQueue:function(e){for(var t=[],a=0,i=e.getActionNames(),r=i.length;r>a;a++){var n=i[a],s=MainFrame.DataParser.getTrigger(this.actionDescription),o=e.getParams();o.push({trigger:s});var l=e.getCode();if(l&&o.push({code:l}),"action"===this.actionType&&MainFrame.ActionManager.doAction(this.callerObject,this.initiatorObject,e.getTargetId(),n,this.confirmation,o),"actionQueue"===this.actionType)for(var c=MainFrame.ActionManager.getAction(n,this.callerObject,this.initiatorObject,e.getTargetId(),this.confirmation,o),d=0,g=c.length;g>d;d++)t.push(c[d])}return t}}),MainFrame.ActionDescription=MainFrame.Class.extend({actionParams:null,actionNames:null,actionTargetId:"",initialize:function(){this.actionParams=[],this.actionNames=[]},setTargetId:function(e){this.actionTargetId=e},getTargetId:function(){return this.actionTargetId},addParam:function(e){this.actionParams.push(e)},addDynamicCode:function(e){this.code=e},getCode:function(){return this.code},addParams:function(e){this.actionParams.push.apply(this.actionParams,e)},getParams:function(){return this.actionParams},addActionName:function(e){this.actionNames.push(e)},getActionNames:function(){return this.actionNames}}),MainFrame.ActionManager={actions:[],byTarget:{},byName:{},resolveAction:function(e,t){e.indexOf(":")<0&&MainFrame.Util.showError("Se incearca setare de actiune cu un string gresit. String: "+e);var a=e.split(";");if(a.length)for(var i=0,r=a.length;r>i;i++){var n=a[i];if(0===n.indexOf("id:"))var s=n.split(":")[1],o=s.split(",");if(0===n.indexOf("params:")){var l=n.split(":");l.shift(),l=l.join(":")}}for(var c=0,d=o.length;d>c;c++){var g=o[c],h=MainFrame.Manager.ActionDesc.getById(g);if(null!==h){if(h.attributes&&h.attributes.templateId){var u=h.attributes.templateId,m=MainFrame.DataParser.getTemplateParams(h);h=MainFrame.DataParser.applyTemplate(h,u,m)}var p=MainFrame.ActionManager.getTriggers.call(this,h,l,t);this.setTriggers.call(this,p)}else MainFrame.Util.warn('No actionDesc found for the id "'+g+'". Please make sure the actionDesc exists or remove the attribute action="id:'+g+'"')}},doAction:function(e,t,a,i,r,n){var s=this.getActions(i,e,t,a,r,n);MainFrame.Queue.addQueue(s,!0)},doActionLib:function(e,t,a,i,r,n){var s=[],o=MainFrame.Manager.ActionLib.getById(i);if(o)for(var l=0,c=o.childNodes.length;c>l;l++){var d=o.childNodes[l],g=d.attributes.name;if("action"===d.nodeName){var a=d.attributes.target,h=(MainFrame.Code.api.scoping+"('"+a+"')",d.attributes.params),u=MainFrame.DataParser.parseParamsString(h,",","=",n);s=s.concat(this.getActions(g,e,t,a,"false",u))}"actionLib"===d.nodeName&&MainFrame.ActionManager.doActionLib(e,t,a,g,r,n)}MainFrame.Queue.addQueue(s,!0)},registerAction:function(e){this.byTarget[e.targetObjectId]||(this.byTarget[e.targetObjectId]=[]),this.byTarget[e.targetObjectId].push(e),this.byName[e.name]||(this.byName[e.name]=[]),this.byName[e.name].push(e),this.actions.push(e)},getActiveAction:function(e,t,a){var i=[];return null!=e?i.push(e):i=this.filterActions(t,a),i},removeAction:function(e,t,a){var i=[];e?i.push(e):i=filterActions(t,a);for(var r=0,n=i.length;n>r;r++)this.deleteAction(i[r])},deleteAction:function(e){e.killAction();for(var t=e.name,a=e.targetObjectId,i=0,r=this.actions.length;r>i;i++)this.actions[i]==e&&(this.actions.splice(i,1),i--);if(null!=this.byName[t])for(i=0,r=this.byName[t].length;r>i;i++)this.byName[t][i]==e&&(this.byName[t].splice(i,1),i--);if(null!=this.byTarget[a])for(i=0,r=this.byTarget[a].length;r>i;i++)this.byTarget[a][i]==e&&(this.byTarget[a].splice(i,1),i--)},getActions:function(e,t,a,i,r,n){for(var s=[],o=this.getAction(e,t,a,i,r,n),l=0,c=o.length;c>l;l++)s.push(o[l]);return s},filterActions:function(e,t){var a,i,r=[];if(null!=e){if(null!=byName[e])for(a=0,i=byName[e].length;i>a;a++)this.byName[e][a].name===e&&r.push(this.byName[e][a]);if(t){var n=[];for(a=0,i=r.length;i>a;a++)r[a].targetObjectId===t&&n.push(r[a]);r=n}return r}if(null!=t){if(null!=this.byTarget[t])for(a=0,i=this.byTarget[t].length;i>a;a++)this.byTarget[t][a].targetObjectId==t&&r.push(this.byTarget[t][a]);return r}return[]}},MainFrame.ActionManager.getAction=function(e,t,a,i,r,n){var s=[],o=[],l=[],c=i&&-1!==i.indexOf(",");if(c)for(var l=i.split(","),d=0,g=l.length;g>d;d++){var h=l[d],u=MainFrame.ActionManager.getTargetWithId(h,t,a);o.push(u),l.push(h)}else{var u=MainFrame.ActionManager.getTargetWithId(i,t,a);o.push(u),l.push(i)}var m=MainFrame.Util.capitalize(e);if(MainFrame.Action[m])for(var p=0,f=o.length;f>p;p++){var u=o[p],v=new MainFrame.Action[m](t,a,u.object,r,n);v.targetObjectId=l[p],v.name=e,f>1&&(v.paramsObject||(v.paramsObject={}),v.paramsObject._wait=!1),MainFrame.ActionManager.registerAction(v),s.push(v)}return s},MainFrame.ActionManager.getTargetWithId=function(e,t,a){var i={};switch(e){case"self":i.object=t,i.id=t.id;break;case"parent":i.object=a.superObject,i.id=a.superObject.id;break;default:i.object=MainFrame.Manager.Scoping.getById(e),i.id=e}return i},MainFrame.ActionManager.getTriggers=function(e,t,a){for(var i=[],r=e.childNodes,n=[],s=0,o=r.length;o>s;s++){var l=r[s];if(l.attributes)if(l.attributes.trigger){n=l.attributes.trigger.split(",");for(var c=0,d=n.length;d>c;c++){var g=MainFrame.ActionManager.getTrigger.call(this,n[c],l,t,a);g?(g.setActionType(l.nodeName),i.push(g)):MainFrame.Util.showError("The trigger does not exist. Trigger name: "+n[c])}}else MainFrame.Util.showError("The trigger is not defined."),console.log(l)}return i},MainFrame.ActionManager.getTrigger=function(e,t,a,i){var r;switch(e){case"press":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:MainFrame.Event.start,preventDefault:i});break;case"click":case"firstClick":case"secondClick":case"clickOnContainer":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.Press,preventDefault:i});break;case"release":r=new MainFrame.Trigger.Release(this,t,a);break;case"move":r=new MainFrame.Trigger.Move(this,t,a);break;case"wheelUp":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.MouseWheelUp});break;case"wheelDown":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.MouseWheelDown});break;case"wheelLeft":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.MouseWheelLeft});break;case"wheelRight":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.MouseWheelRight});break;case"wheelScroll":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.MouseWheel});break;case"keyArrowUp":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:38});break;case"keyArrowDown":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:40});break;case"keyArrowLeft":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:37});break;case"keyArrowRight":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:39});break;case"keyP":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:80});break;case"keyEnter":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:13});break;case"keySpace":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:32});break;case"keyEscape":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:27});break;case"keyDelete":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:46});break;case"keyPlus":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:107});break;case"keyMinus":r=new MainFrame.Trigger.Keyboard(this,t,a,{keyCode:109});break;case"singleClick":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SinglePress});break;case"doubleClick":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DoublePress});break;case"longPress":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.LongPress});break;case"pinch":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.Pinch});break;case"pinchEnd":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.PinchEnd});break;case"pinchStart":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.PinchStart});break;case"drag":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.Drag});break;case"dragStart":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragStart});break;case"dragEnd":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragEnd});break;case"swipe":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.Swipe});break;case"swipeUp":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeUp});break;case"swipeDown":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeDown});break;case"swipeLeft":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeLeft});break;case"swipeRight":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeRight});break;case"pressOnParent":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.PressOnParent});break;case"initialization":r=new MainFrame.Trigger.Initialization(this,t,a);break;case"validDragRightScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.ValidDragRightScroller});break;case"validDragLeftScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.ValidDragLeftScroller});break;case"dragNormal":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragNormal});break;case"dragHorizontal":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragHorizontal});break;case"dragZoom":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragZoom});break;case"dragEndScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragEndScroller});break;case"dragEndNormalScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragEndNormalScroller});break;case"dragEndZoomScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragEndZoomScroller});break;case"dragStartZoomScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragStartZoomScroller});break;case"swipeLeftNormal":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeLeftNormal});break;case"swipeRightNormal":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeRightNormal});break;case"tapLeftMarginScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.TapLeftMarginScroller});break;case"tapRightMarginScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.TapRightMarginScroller});break;case"singlePressOnScroller":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SinglePressOnScroller});break;case"dragStartZoomCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragStartZoomCatalog});break;case"dragNormalCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragNormalCatalog});break;case"dragEndNormalCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragEndNormalCatalog});break;case"validDragBackCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.ValidDragBackCatalog});break;case"validDragNextCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.ValidDragNextCatalog});break;case"swipeBackNormalCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeBackNormalCatalog});break;case"swipeNextNormalCatalog":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.SwipeNextNormalCatalog});break;case"keyArrowBack":r=new MainFrame.Trigger.Keyboard(this,t,a,{type:"back",keyCodeUp:38,keyCodeLeft:37});break;case"keyArrowNext":r=new MainFrame.Trigger.Keyboard(this,t,a,{type:"next",keyCodeDown:40,keyCodeRight:39});break;case"dragEndNormalMediaContainer":r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e,interpretor:MainFrame.Interpretor.DragEndNormalMediaContainer});break;case"mouseOver":case"mouseOut":var n=e.toLowerCase();r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:n});break;default:r=new MainFrame.Trigger.Anonymous(this,t,a,{triggerName:e})}return r},MainFrame.EventHandlerIncrement=0,MainFrame.EventHandler=MainFrame.Class.extend({triggerName:"",listener:null,target:null,context:null,repeat:0,delay:0,cooldown:0,isNative:!1,internalId:0,initialize:function(e,t,a,i,r,n,s,o){this.triggerName=e,this.listener=t,this.context=a,this.target=i,this.isNative=r,this.repeat=n,this.delay=s,this.cooldown=o,this.internalId=MainFrame.EventHandlerIncrement++,MainFrame.EventHandlerCore.registerHandler(this)},doAction:function(e){this.callListenerFunction(e)},dispatchNative:function(e){e=e||window.event;var t=e.which||e.button;t||MainFrame.Event.stop(e),this.doAction([e])},callListenerFunction:function(e){if(this.context&&this.context.actionDescription){var t=this.context.actionDescription.attributes,a=t.condition,i=t.conditionId,r="undefined"!=typeof a&&""!==a,n="undefined"!=typeof i&&""!==i,s=r||n;if(s){if(r&&!MainFrame.Util.evaluateCondition(a))return;if(n&&(a=MainFrame.Manager.Condition.getById(i),!MainFrame.Util.evaluateCondition(a)))return}}this.listener.apply(this.context,e)},handleEvent:function(e){this.dispatchNative(e)}}),MainFrame.EventHandler.addHandler=function(e,t,a,i,r,n,s,o){return new MainFrame.EventHandler(e,t,a,i,r,n,s,o)},MainFrame.EventHandler.removeHandler=function(e,t,a,i){MainFrame.EventHandlerCore.removeHandler(e,t,a,i)},MainFrame.EventHandler.dispatch=function(e,t,a){MainFrame.EventHandlerCore.dispatch(e,t,a)},MainFrame.EventHandlerCore={handlers:null,handlersByTarget:{},handlersByTrigger:{},handlersByListener:{},registerHandler:function(e){e.isNative&&(e.target||MainFrame.Util.showError("Native events must have a target. Event: "+e.triggerName+" Listener: "+e.listener),e.triggerName.indexOf("key")>=0?MainFrame.Event.bind(document.body,e.triggerName,e):MainFrame.Event.bind(e.target.containerElement,e.triggerName,e)),this.initAndPush(this.handlersByTarget,e.context.targetId,e),this.initAndPush(this.handlersByListener,e.context.actionId,e),this.initAndPush(this.handlersByTrigger,e.triggerName,e),this.handlers.push(e)},initialize:function(){this.handlers=[]},initAndPush:function(e,t,a){e[t]||(e[t]=[]),e[t].push(a)},dispatch:function(e,t,a){for(var i=0,r=this.handlers.length;r>i;i++){var n=this.handlers[i];n&&e===n.triggerName&&(a?a===n.target&&(a.disabledTriggers&&-1!==a.disabledTriggers.indexOf(e)||n.doAction(t)):n.doAction(t))}},dispatchNative:function(e){MainFrame.Event.stop(e),this.dispatch(e.type,[e],e.currentTarget)},unbindNativeHandler:function(e){e.triggerName.indexOf("key")>=0?MainFrame.Event.unbind(document.body,e.triggerName,e):MainFrame.Event.unbind(e.target.containerElement,e.triggerName,e)},removeHandler:function(e,t,a,i){var r=[];i?r.push(i):r=this.filterHandlers(e,t,a);for(var n=0,s=r.length;s>n;n++)this.deleteHandler(r[n])},removeHandlersForTarget:function(e){for(var t=[],a=0,i=this.handlers.length;i>a;a++)this.handlers[a].target&&(this.handlers[a].target.containerElement===e||this.handlers[a].target===e)&&t.push(this.handlers[a]);this.removeHandlers(t)},removeTriggerForTarget:function(e,t){t.triggers=[];for(var a=0,i=this.handlers.length,r=[];i>a;a++){var n=this.handlers[a];n&&n.target===t&&n.triggerName===e&&r.push(n)}this.removeHandlers(r)},removeHandlers:function(e){for(var t=0,a=e.length;a>t;t++)this.deleteHandler(e[t])},deleteHandler:function(e){if(e.target.interpretors&&e.target.interpretors[e.triggerName]){var t=e.target.interpretors[e.triggerName];t.removeListeners()}e.isNative&&this.unbindNativeHandler(e);for(var a=0,i=this.handlers.length;i>a;a++)this.handlers[a]===e&&this.handlers.splice(a,1);for(var a=0,i=this.handlersByTrigger[e.triggerName].length;i>a;a++)this.handlers[a]===e&&this.handlersByTrigger[e.triggerName].splice(a,1)},getHandlers:function(e,t,a){return this.filterHandlers(e,t,a)},filterHandlers:function(e,t,a){var i,r,n=[],s=[],o=[];if(e){for(i=0,r=this.handlersByTrigger[e].length;r>i;i++)n.push(this.handlersByTrigger[e][i]);if(t){for(i=0,r=n.length;r>i;i++)n[i].listener===t&&o.push(n[i]);n=n.concat(o)}if(a){for(i=0,r=n.length;r>i;i++)n[i].target===a&&s.push(n[i]);n=n.concat(s)}return n}if(t){for(i=0,r=this.handlersByListener[t].length;r>i;i++)n.push(this.handlersByListener[t][i]);if(a){for(i=0,r=n.length;r>i;i++)n[i].target===a&&s.push(n[i]);n=s}return n}if(a){for(i=0,r=this.handlersByTarget[a].length;r>i;i++)n.push(this.handlersByTarget[a][i]);return n}return[]}},MainFrame.Publisher={subscribers:{},subscribedTo:{},publish:function(e,t){var a=MainFrame.Publisher.subscribedTo[e];if(a)for(var i=0,r=a.length;r>i;i++){var n=a[i];n.callback.call(n.subscriber,e,t)}},subscribe:function(e,t,a){return this.validate(e,t,a)?(MainFrame.Publisher.subscribedTo[e]||(MainFrame.Publisher.subscribedTo[e]=[]),MainFrame.Publisher.subscribers[t.uid]||(MainFrame.Publisher.subscribers[t.uid]={}),MainFrame.Publisher.subscribers[t.uid][e]||(MainFrame.Publisher.subscribedTo[e].push({subscriber:t,callback:a}),MainFrame.Publisher.subscribers[t.uid][e]=!0),!0):!1},unsubscribe:function(e,t){var a=MainFrame.Publisher.subscribedTo[e];if(a)for(var i=0,r=a.length;r>i;i++){var n=a[i];if(n.subscriber.uid===t.uid){a.splice(i,1),0===a.length&&delete MainFrame.Publisher.subscribedTo[e],delete MainFrame.Publisher.subscribers[t.uid][e];var s=!1;for(var o in MainFrame.Publisher.subscribers[t.uid]){s=!0;break}return s||delete MainFrame.Publisher.subscribers[t.uid],!0}}return!1},removeSubscriber:function(e){if(MainFrame.Publisher.subscribers[e.uid])for(var t in MainFrame.Publisher.subscribers[e.uid])MainFrame.Publisher.unsubscribe(t,e)},validate:function(){for(var e=0,t=arguments.length;t>e;e++){var a=arguments[e];if("undefined"==typeof a||null===a)return!1}return!0}},MainFrame.Queue=MainFrame.Class.extend({items:null,internalId:null,queueId:null,isAutostarting:!1,isInitialized:!1,isPaused:!0,hasObjectRunning:!1,callbackFn:null,callbackContext:null,addItemToQueue:function(e){e.queueId=this.internalId,this.items||(this.items=[]),this.items.push(e)},startQueue:function(){if(this.isInitialized||(this.isInitialized=!0,MainFrame.EventHandler.addHandler(this.internalId,this.queueListener,this),this.isPaused=!1),!this.isPaused){var e=this.items[0];
if(e){var t="undefined"!=typeof e.condition;if(t){var a=MainFrame.Util.evaluateCondition(e.condition),i=!0;if(a){var r=e.queueActions[0];if(r){var i=!1;e.queueActions.shift(),this.initAction(r)}}i&&(this.items.shift(),this.startQueue())}else this.items.shift(),this.initAction(e)}else this.endQueue(),this.callQueue()}},initAction:function(e){e.queueId=this.internalId,e.initObject(),this.hasObjectRunning=!0},pauseQueue:function(){this.isPaused||(this.isPaused=!0)},resumeQueue:function(){this.isPaused&&(this.isPaused=!1,this.hasObjectRunning||this.startQueue())},endQueue:function(){var e=this.callbackContext,t=this.callbackFn;t&&t.call(e,t)},killQueue:function(){MainFrame.EventHandler.removeHandler(this.internalId,this.queueListener,this)},queueListener:function(){this.hasObjectRunning=!1,this.isPaused||this.startQueue()},callQueue:function(){this.queueId&&MainFrame.EventHandler.dispatch(this.queueId)},setQueueId:function(e){this.queueId=e}}),MainFrame.QueueIncrement=0,MainFrame.Queue.addQueue=function(e,t,a,i){var r=new MainFrame.Queue;return r.items=e,r.isAutostarting=t,a&&(r.callbackFn=a,r.callbackContext=i),r.internalId="queue"+MainFrame.QueueIncrement++,r.isAutostarting&&r.items.length>0&&(MainFrame.EventHandler.addHandler(r.internalId,r.queueListener,r),r.isInitialized=!0,r.isPaused=!1,r.startQueue()),r},MainFrame.Code={init:function(){var e,t={};try{MainFrame.Util.isInteger(1),e=!1}catch(a){e=!0}e?(t.actionLib="G.bG.doActionLib",t.action="G.bG.tA",t.global="G.Global",t.scoping="G.bP.getById"):(t.action="MainFrame.ActionManager.doAction",t.actionLib="MainFrame.ActionManager.doActionLib",t.global="MainFrame.Global",t.scoping="MainFrame.Manager.Scoping.getById"),this.api=t},interpretCode:function(e){var t=e;return t=MainFrame.Code.removeTypeDeclarations(t),t=MainFrame.Code.setGlobals(t),t=MainFrame.Code.setGlobalFunctions(t),t=MainFrame.Code.replaceAPI.call(this,t),t=MainFrame.Code.replaceGlobals(t)},removeTypeDeclarations:function(e){var t=/:int/g;return e.replace(t,"")},setGlobals:function(e){var t=/var ([\w-]+)/g;return e.replace(t,function(e,t){var a=MainFrame.Code.api.global+"['"+t+"']";return MainFrame.Global[t]=!0,a})},setGlobalFunctions:function(e){var t=/function ([\w-]+)/g;return e.replace(t,function(e,t){var a=MainFrame.Code.api.global+"['"+t+"'] = function";return MainFrame.Global[t]=!0,a})},replaceGlobals:function(e){var t=/([\w'"]+)/g;return e.replace(t,function(e,t){if("undefined"!=typeof MainFrame.Global[t]){var a=MainFrame.Code.api.global+"['"+t+"']";return a}return e})},replaceAPI:function(e){var t,a=this,i=e;return t=/action\.target/g,i=i.replace(t,function(){var e="#"+a.targetObject.id;return e}),t=/action\.params\.([\w-]+)/g,i=i.replace(t,function(e,t){var i=a.getParam(t);return i}),t=/do\((.*)\);/g,i=i.replace(t,function(e){var t=MainFrame.Code.replaceAction.call(a,e);return t}),t=/doXmlActionLib\((.*)\)/g,i=i.replace(t,function(e){var t=MainFrame.Code.replaceActionLib.call(a,e);return t}),t=/\#([\w-]+)/g,i=i.replace(t,function(e,t){var a=MainFrame.Code.api.scoping+"('"+t+"')";return a})},replaceAction:function(e){var t,a,i="{";t=/do\(([\w-]+)\s?\,/g,a=t.exec(e);var r=a[1];if(t=/([\w-]+)\=([\w-'"']+)/g,a=e.match(t))for(var n=0,s=a.length;s>n;n++){var o=a[n].split("="),l=o[0],c=o[1];if("target"===l)var d=c,g=MainFrame.Code.api.scoping+"('"+d+"')";else i+=MainFrame.Global[c]?"'"+l+"': "+MainFrame.Code.api.global+"['"+c+"'],":"'"+l+"': '"+c+"',"}i+="}";var h=MainFrame.Code.api.action+"("+g+", "+g+", '"+d+"', '"+r+"', 'false', ["+i+"])";return h},replaceActionLib:function(e){var t,a;t=/doXmlActionLib\(['"](.*?)[,\s'"](.*?)['"\s]\)/g,a=t.exec(e);var i=a[1];t=/doXmlActionLib\(['"\s](?:.*?)['",\sw+](.*?)['"\s]\)/g,a=t.exec(e);var r=a[1];r=r.replace(/,/g,""),r=r.replace(/'/g,""),r=r.replace(/"/g,"");var n=MainFrame.Manager.ActionLib.getById(r);if(n){var s=i,o=MainFrame.Code.api.scoping+"('"+s+"')",l=MainFrame.Code.api.actionLib+"("+o+", "+o+", '"+s+"', '"+r+"', 'false', [])";return l}return MainFrame.Util.showError('Code error: The actionLib with the id: "'+r+'" does not exist.'),""}},MainFrame.Router={paths:[],reachedPaths:{},dynamicPaths:{},currentHash:"",init:function(){MainFrame.Router.initForGET(),MainFrame.Router.initForHash()},initForGET:function(){var e=window.location.search;if(e){var t=e.replace("?",""),a=t.split("&");a.forEach(function(e){var t=e.split("="),a=t[0],i=t[1],r="#get."+a+(i?"="+i:"");MainFrame.EventHandler.dispatch(r)})}},initForHash:function(){MainFrame.Event.bind(window,"hashchange",MainFrame.Router.onHashChange)},get:function(){return window.location.hash.slice(1)},set:function(e){e&&(e=MainFrame.Util.clearSlashes(e),MainFrame.Router.currentHash=e,window.location.hash=e)},add:function(e){var t=MainFrame.Router.get();if(t=MainFrame.Util.clearSlashes(t),-1===t.indexOf(e)){var a=t+"/"+e;MainFrame.Router.set(a)}},remove:function(e){var t=-1!==e.indexOf("/:");t?MainFrame.Router.removeDynamicRoute(e):MainFrame.Router.removeStaticRoute(e)},removeDynamicRoute:function(e){var t=MainFrame.Router.get(),a=t.split("/"),i=e.split("/:"),r=i[0],n=0,s=a.length,o=[];do{var l=a[n];l===r?n+=2:(o.push(l),n++)}while(s>n);var c=o.join("/");MainFrame.Router.set(c)},removeStaticRoute:function(e){var t=MainFrame.Router.get(),a=t.replace(e,"");a=clearSlashes(a),MainFrame.Router.set(a)},onHashChange:function(){var e=MainFrame.Router.get();e!==MainFrame.Router.currentHash&&(MainFrame.Router.currentHash=e,MainFrame.Router.checkForPaths(e))},registerPath:function(e){MainFrame.Router.paths.push(e)},getHashForId:function(e){for(var t=0,a=MainFrame.Router.paths.length;a>t;t++){var i=MainFrame.Router.paths[t];if(i.id===e)return MainFrame.Util.clearSlashes(i.hash)}return""},getHashValue:function(e){var t=MainFrame.Router.get();if(-1!==t.indexOf(e+"/"))for(var a=t.split("/"),i=a.length,r=0;i>r;r++){var n=a[r];if(n===e&&a[r+1])return a[r+1]}},checkForPaths:function(e){e=MainFrame.Util.clearSlashes(e),MainFrame.Router.paths.length&&MainFrame.Router.paths.forEach(function(t){var a=-1!==t.hash.indexOf("/:");a?MainFrame.Router.interpretDynamicRoute(e,t):MainFrame.Router.interpretStaticRoute(e,t)})},interpretDynamicRoute:function(e,t){for(var a=MainFrame.Util.clearSlashes(t.hash),i=a.split("/:"),r=i[0],n=e.split("/"),s=i.length,o=0,l=!1;s>o;o++){var c=n[o];if(c===r){var d=n[o+1],g="undefined"==typeof MainFrame.Router.dynamicPaths[t.id],h=d!==MainFrame.Router.dynamicPaths[t.id];if((g||h)&&(MainFrame.Router.dynamicPaths[t.id]=d,l=!0),l){var u="#route."+t.id+".changed";return void MainFrame.EventHandler.dispatch(u)}}}},interpretStaticRoute:function(e,t){var a=MainFrame.Util.clearSlashes(t.hash),i=-1!==e.indexOf(a);if(i){if(!MainFrame.Router.reachedPaths[t.id]){var r="#route."+t.id;MainFrame.EventHandler.dispatch(r),MainFrame.Router.reachedPaths[t.id]=!0}}else if(MainFrame.Router.reachedPaths[t.id]){var n="#route."+t.id+".closed";MainFrame.EventHandler.dispatch(n),MainFrame.Router.reachedPaths[t.id]=!1}}},MainFrame.AltPopOver={isInitialized:{},isVisible:!1,popovers:{},container:null,createPopover:function(e){var t={},a=MainFrame.Manager.AltText.getById(e),i=MainFrame.Util.getMainFrame();t.element=new MainFrame.Element.Resource({id:"altPopover_"+e,superObject:i,data:a}),t.autoresize="false"===a.attributes.autoresize?!1:!0,t.element.containerElement.className="v7__alt-popover",t.cachedEstimatedTextSizeWithText={},t.altTextObject=t.element.getSubObjectWithId("altText"),this.hide(t),this.popovers[e]=t,this.isInitialized[e]=!0},estimatedTextSizeWithText:function(e,t,a){var i=JSON.stringify(Array.prototype.slice.call([t,a]));if(e.cachedEstimatedTextSizeWithText[i])var r=e.cachedEstimatedTextSizeWithText[i];else{var n=MainFrame.Util.createElement("div","",e.element.containerElement),s=e.altTextObject.containerElement;n.style.cssText=s.style.cssText,n.innerHTML=t,n.style.position="absolute",n.style.top="-1000px",n.style.left="-1000px",n.style.height="auto",n.style.width="auto";var o=n.clientWidth+1,l=n.clientHeight+1;o>a&&(n.style.width=a+"px",o=n.clientWidth+1,l=n.clientHeight+1),MainFrame.Util.removeElement(n);var r={width:o,height:l};1!==r.width&&1!==r.height&&(e.cachedEstimatedTextSizeWithText[i]=r)}return r},add:function(e,t,a,i,r){this.isInitialized[a]||this.createPopover(a);var n=new MainFrame.AltPopOver.Observer(t,a,i,r);e.altObserver=n,MainFrame.Event.bind(e,"mousedown",n),MainFrame.Event.bind(e,"mousemove",n),MainFrame.Event.bind(e,"mouseout",n),MainFrame.Event.bind(e,"mouseup",n),MainFrame.Event.bind(e,"click",n)},remove:function(e){if(e.altObserver){var t=e.altObserver;MainFrame.Event.unbind(e,"mousedown",t),MainFrame.Event.unbind(e,"mousemove",t),MainFrame.Event.unbind(e,"mouseout",t),MainFrame.Event.unbind(e,"mouseup",t),MainFrame.Event.unbind(e,"click",t),delete e.altObserver}},resizePopover:function(){var e=MainFrame.AltPopOver.popovers[this.altId],t=e.altTextObject,a=this.customText||MainFrame.Manager.Text.getById(this.textId),i=this.variablesDictionary;if(i){var r=i.catalogId||"catalog";for(var n in i){var s=i[n];if("##urlValue"===n&&i.refType&&-1===i.refType.indexOf("url")){var o=MainFrame.Manager.Scoping.getById(r),l=o.getContainerForCustomPage(s);s=l}if(i.initiator&&i.initiator.altTextPage){var c=i.initiator.altTextPage;a=a.replace("##pageValue",c)}"object"!=typeof s&&(a=a.replace(n,s))}}a=MainFrame.Util.interpretString(a).interpretedString;var d=e.element,g=d.getDimensionX(),h=d.getDimensionY(),u=t.getDimensionX(),m=t.getDimensionY(),p=g-u,f=h-m,v=MainFrame.AltPopOver.estimatedTextSizeWithText(e,a,u),M=u;v.width<u&&(M=v.width);var b=m;if(v.height>m&&(b=v.height),e.autoresize){t.containerElement.style.width=M+"px",t.containerElement.style.height=b+"px";var F=M+p,A=b+f;d.setDimensionX(F),d.setDimensionY(A),d.resize()}t.containerElement.innerHTML=a,e.loadedAltText=1===v.width||1===v.height?null:a,e.loadedTextId=this.textId},placePopover:function(e){var t=MainFrame.AltPopOver.popovers[this.altId],a=t.element,i=MainFrame.AltPopOver.calculatePopoverOrigins(t,e);a.containerElement.style.left=i.x+"px",a.containerElement.style.top=i.y+"px",MainFrame.AltPopOver.moveElement(a,i.posX,i.posY),MainFrame.AltPopOver.show(t)},movePopover:function(e){var t=MainFrame.AltPopOver.popovers[this.altId],a=t.element,i=MainFrame.AltPopOver.calculatePopoverOrigins(t,e);a.containerElement.style.left=i.x+"px",a.containerElement.style.top=i.y+"px",MainFrame.AltPopOver.show(t),a.containerElement.translatedX=0,a.containerElement.translatedY=0,MainFrame.Util.setTransformDuration(a.containerElement,0),MainFrame.Util.setPosition(a.containerElement,a.containerElement.translatedX,a.containerElement.translatedY)},calculatePopoverOrigins:function(e,t){var a=e.element,i=t.clientX+25,r=t.clientY-20,n="right",s="top",o=a.getDimensionX(),l=a.getDimensionY();return l>r&&(r+=l,s="bottom"),i+o>MainFrame.Browser.width&&(i-=o+30,n="left"),{x:i,y:r,posX:n,posY:s}},moveElement:function(e,t,a){var i=30,r=30;"left"===t&&(i=-30),"top"===a&&(r=-30),e.containerElement.translatedX=i,e.containerElement.translatedY=r,MainFrame.Util.setTransformDuration(e.containerElement,0),MainFrame.Util.setPosition(e.containerElement,e.containerElement.translatedX,e.containerElement.translatedY)},disappear:function(){var e=MainFrame.AltPopOver.popovers[this.altId];MainFrame.AltPopOver.hide(e)},show:function(e){e.element.containerElement.style.visibility="visible",MainFrame.AltPopOver.visible=!0},hide:function(e){e.element.containerElement.style.visibility="hidden",MainFrame.AltPopOver.visible=!1,MainFrame.AltPopOver.moveElement(e.element)}},MainFrame.AltPopOver.Observer=MainFrame.Class.extend({initialize:function(e,t,a,i){this.textId=e,this.altId=t,this.customText=a,this.variablesDictionary=i},getAltText:function(){return"undefined"!=typeof this.customText?this.customText:MainFrame.Manager.Text.getById(this.textId)},handleEvent:function(e){return"mousemove"!==e.type||this.dragStarted?("mousedown"===e.type||"click"===e.type?this.dragStarted=!0:("mouseup"===e.type||"mouseout"===e.type)&&(this.dragStarted=!1),void this.disappear(e)):void this.appear(e)},appear:function(e){var t=MainFrame.AltPopOver.popovers[this.altId],a=t.loadedTextId!==this.textId;altDescription=this.customText||MainFrame.Manager.Text.getById(this.textId),textIsDynamic=-1!==altDescription.indexOf("##"),a||textIsDynamic?(t.element.resetDimension(),MainFrame.AltPopOver.resizePopover.call(this,e),MainFrame.AltPopOver.placePopover.call(this,e)):MainFrame.AltPopOver.movePopover.call(this,e)},disappear:function(e){MainFrame.AltPopOver.disappear.call(this,e)}}),MainFrame.Element.Check=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseCheck.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},addSuperObject:function(e){this.superObject=e,e.addSubObject(this)},createContainerElement:function(e){var t,a=this.data,i=!1;e?(t=e.containerElement,i=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body;var r="undefined"!=typeof a.attributes.templateId;if(r)var n=MainFrame.Manager.Template.getById(a.attributes.templateId),s=n&&n.childNodes.length;var o=a.childNodes.length>1||s;if(o){this.isCustomButton=!0,this.containerElement=MainFrame.Util.createElement("div","v7__elem--container",t,i),this.createContentElement(),this.checked=this.defaultValue;var l=this;MainFrame.Event.bind(this.containerElement,MainFrame.Event.start,function(){l.toggleCheckForCustomButton()})}else{this.isCustomButton=!1,this.containerElement=MainFrame.Util.createElement("input","v7__elem--container-input",t,i),this.containerElement.setAttribute("type","checkbox"),"true"===this.defaultValue&&this.containerElement.setAttribute("checked","checked");var l=this;MainFrame.Event.bind(l.containerElement,"click",function(){l.checked=l.containerElement.checked?!0:!1})}this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container")},toggleCheckForCustomButton:function(){this.checked?this.uncheck():this.check()},check:function(){this.isCustomButton?(this.checked=!0,this.onElement.setVisible(!0),this.offElement.setVisible(!1)):(this.containerElement.checked=!0,this.containerElement.setAttribute("checked","checked"))},uncheck:function(){this.isCustomButton?(this.checked=!1,this.onElement.setVisible(!1),this.offElement.setVisible(!0)):(this.containerElement.checked=!1,this.containerElement.removeAttribute("checked"))},isChecked:function(){return this.isCustomButton?this.checked:this.containerElement.checked}}),MainFrame.Element.Confirmation=MainFrame.Abstract.Element.extend({addSuperObject:function(e){var t=this;this.superObject=e,t.overlay=MainFrame.Util.createElement("div","v7__confirmation__overlay",e.contentElement),t.overlay.style.width=MainFrame.Browser.width+"px",t.overlay.style.height=MainFrame.Browser.height+"px",t.containerElement=MainFrame.Util.createElement("div","v7__confirmation",e.contentElement),MainFrame.Util.addClass(t.containerElement,"v7--shadow"),setTimeout(function(){MainFrame.Util.addClass(t.overlay,"v7--fade-out")},50)},readData:function(e){MainFrame.DataParser.parseConfirmation.call(this,e)},resize:function(){if(this.containerElement.style.width=this.getDimensionX()+"px",this.containerElement.style.height=this.getDimensionY()+"px",this.containerElement.style.top=this.getPositionY()+"px",this.containerElement.style.left=this.getPositionX()+"px",this.overlay.style.width=MainFrame.Browser.width+"px",this.overlay.style.height=MainFrame.Browser.height+"px",this.subObjects)for(var e=0,t=this.subObjects.length;t>e;e++)this.subObjects[e].resize();this.skinObject&&this.skinObject.resize()}}),MainFrame.Element.Embedded=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseEmbedded.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},createContainerElement:function(e){var t,a=!1;e?(t=e.containerElement,a=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body,this.containerElement=MainFrame.Util.createElement("div","",t,a),this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container"),this.containerElement.setAttribute("class","v7__elem__embedded"),this.containerElement.style.overflow="auto",this.containerElement.style.webkitOverflowScrolling="touch"}}),MainFrame.Element.Html=MainFrame.Element.Embedded.extend({readData:function(e){this.createContentElement(),MainFrame.DataParser.parseHtml.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])}}),MainFrame.Element.HtmlItem=MainFrame.Abstract.Element.extend({hasContentElement:!1,_initialize:function(e){e=e||{},e.superObject&&this.addSuperObject(e.superObject),this.id=e.id||MainFrame.Util.generateItemId.call(this),MainFrame.Manager.Scoping.register(this.id,this),"undefined"!=typeof e.containerElement&&(this.containerElement=e.containerElement,this.containerElement.setAttribute("data-type","container"))},resize:function(){}}),MainFrame.Element.Img=MainFrame.Abstract.Element.extend({hasContentElement:!1,createContainerElement:function(e){var t,a=!1;e?(t=e.containerElement,a=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body,this.containerElement=MainFrame.Util.createElement("img","v7__elem__img",t,a),this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container")},readData:function(e){MainFrame.DataParser.parseImage.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},getDimensionX:function(){if(this.fill&&this.superObject&&this.ratio){var e=this.superObject.getDimensionX()/this.superObject.getDimensionY();if(this.ratio>=e)var t="100%";else{var t="h*"+this.ratio;this.dimensionX=t}return this.parseStringExpression(this.dimensionX,this.superObject.getDimensionX())}return"auto"===this.dimensionX?this.containerElement.clientWidth:this.superObject?this.parseStringExpression(this.dimensionX,this.superObject.getDimensionX()):parseFloat(this.dimensionX)},getDimensionY:function(){if(this.fill&&this.superObject&&this.ratio){var e=this.superObject.getDimensionX()/this.superObject.getDimensionY();if(this.ratio<=e)var t="100%";else{var t="w/"+this.ratio;this.dimensionY=t}return this.parseStringExpression(this.dimensionY,this.superObject.getDimensionY())}return"auto"===this.dimensionY?this.containerElement.clientHeight:this.superObject?this.parseStringExpression(this.dimensionY,this.superObject.getDimensionY()):parseFloat(this.dimensionY)},setSource:function(e){e=MainFrame.Util.processSrc(e);var t=this;if(this.containerElement.onload=function(){this.naturalWidth&&this.naturalHeight&&(t.ratio=this.naturalWidth/this.naturalHeight),t.resize()},this.fallbackSrc){var t=this,a=MainFrame.Util.processSrc(this.fallbackSrc);this.containerElement.onerror=function(){t.containerElement.src=a,t.containerElement.onerror=null}}this.containerElement.src=e},_resize:function(){"fit"===this.fillType?this._resizeToFit():"fill"===this.fillType?this._resizeToFill():this._resizeStandard()},_resizeToFit:function(){this.containerElement.style.maxWidth="100%",this.containerElement.style.maxHeight="100%",this.containerElement.style.top="0px",this.containerElement.style.left="0px",this.containerElement.style.right="0px",this.containerElement.style.bottom="0px",this.containerElement.style.margin="auto";var e=this.superObject.getDimensionX()/this.superObject.getDimensionY();this.ratio>=e?(this.containerElement.style.width="100%",this.containerElement.style.height="auto"):(this.containerElement.style.width="auto",this.containerElement.style.height="100%")},_resizeToFill:function(){var e=this.superObject.getDimensionX()/this.superObject.getDimensionY();this.ratio>=e?(this.containerElement.style.width="auto",this.containerElement.style.height="100%"):(this.containerElement.style.width="100%",this.containerElement.style.height="auto");var t=MainFrame.Util.isPercentageValue(this.positionX)?this.positionX:this.getPositionX()+"px",a=MainFrame.Util.isPercentageValue(this.positionY)?this.positionY:this.getPositionY()+"px";this.containerElement.style.left=t,this.containerElement.style.top=a},_resizeStandard:function(){if("auto"!==this.dimensionX)this.containerElement.style.width=this.getDimensionX()+"px";else{var e="auto";this.containerElement.style.width=e}if("auto"!==this.dimensionY)this.containerElement.style.height=this.getDimensionY()+"px";else{var t="auto";this.containerElement.style.height=t}var a=MainFrame.Util.isPercentageValue(this.positionX)?this.positionX:this.getPositionX()+"px",i=MainFrame.Util.isPercentageValue(this.positionY)?this.positionY:this.getPositionY()+"px";this.containerElement.style.left=a,this.containerElement.style.top=i}}),MainFrame.Element.Item=MainFrame.Abstract.Element.extend({}),MainFrame.Element.Object=MainFrame.Abstract.Element.extend({addSuperObject:function(e){this.superObject=e},createContainerElement:function(){MainFrame.Abstract.Element.prototype.createContainerElement.call(this),this.containerElement.setAttribute("class","v7__elem__object"),this.createContentElement(),this.containerElement.setAttribute("data-type","container")},createContentElement:function(){this.containerElement||this.createContainerElement(),this.contentElement=MainFrame.Util.createElement("object","v7__elem__object--content",this.containerElement),this.contentElement.setAttribute("data-type","content")},readData:function(e){MainFrame.DataParser.parseObject.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},setData:function(e){this.contentElement.setAttribute("data",e)},setType:function(e){this.contentElement.setAttribute("type",e)}}),MainFrame.Element.Preloader=MainFrame.Abstract.Element.extend({totalItemsToLoad:0,totalItemsLoaded:0,initialize:function(e){e=e||{},this.superObject=e.superObject||null,this.superObject&&(this.superObject.addSubObject(this),this.containerElement=MainFrame.Util.createElement("div","v7__preloader",this.superObject.containerElement),this.containerElement.setAttribute("data-item-id","preloader"),this.containerElement.setAttribute("data-type","container")),e.data&&this.parseData(e.data),this.resize()},parseData:function(e){MainFrame.DataParser.parseElement.call(this,e)},preloadItems:function(e){for(var t=0,a=e.length;a>t;t++){var i=e[t];switch(i.nodeName){case"script":this.preloadScript(i);break;case"image":this.preloadImage(i);break;case"file":default:this.preloadFile(i)}}},preloadScript:function(e){var t=this;if(e.attributes.src){var a=MainFrame.Util.createElement("script","",document.head),i=e.attributes.src,r=MainFrame.Util.isAbsoluteUrl(i),n=-1!==i.indexOf("/"),s=!r&&!n,o=!r&&n;s?i=MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/res/"+i:o&&(i=MainFrame.Util.getAppURL()+i),a.onload=function(){t.update()},"true"===e.attributes.optional&&(a.onerror=function(){MainFrame.Util.showError("Preloading failed for the script at the path: "+i),t.update()}),a.src=i}else MainFrame.Util.showError("The preloaded script has no src attribute: "+e),t.update()},preloadImage:function(e){var t=this;if(e.attributes.src){var a=new Image,i=e.attributes.src,r=MainFrame.Util.isAbsoluteUrl(i),n=-1!==i.indexOf("/"),s=!r&&!n,o=!r&&n;s?i=MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/res/"+i:o&&(i=MainFrame.Util.getAppURL()+i),a.onload=function(){t.update()},"true"===e.attributes.optional&&(a.onerror=function(){MainFrame.Util.showError("Preloading failed for the image at the path: "+i),t.update()}),a.src=i}else MainFrame.Util.showError("The preloaded image has no src attribute: "+e),t.update()},preloadFile:function(e){var t=this;if(e.attributes.src){var a=e.attributes.src,i=MainFrame.Util.isAbsoluteUrl(a),r=-1!==a.indexOf("/"),n=!i&&!r,s=!i&&r;n?a=MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/res/"+a:s&&(a=MainFrame.Util.getAppURL()+a);var o=!1;(-1!==a.indexOf(".xml")||"xml"===e.attributes.type)&&(o=!0);var l=!1;(-1!==a.indexOf(".js")||"json"===e.attributes.type)&&(l=!0),MainFrame.Util.request({url:a,originalResponse:!0,onSuccess:function(e){MainFrame.PreloadedData[a]=e,t.update()},onError:function(){"true"===e.attributes.optional&&(MainFrame.Util.showError("Preloading failed for the script at the path: "+a),t.update())}})}else MainFrame.Util.showError("The preloaded file has no src attribute: "+e),t.update()},increment:function(){this.totalItemsToLoad++},update:function(){if(this.totalItemsLoaded++,this.totalItemsLoaded===this.totalItemsToLoad){var e=300;this.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+e+"ms ease-in",this.containerElement.style.opacity="0";var t=this;setTimeout(function(){t.superObject.removeSubObject(t),delete t.superObject.preloadScreen},e)}else this.totalItemsLoaded===this.totalItemsToLoad-1&&this.superObject.loadApp()}}),MainFrame.Element.Radio=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseRadio.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},addSuperObject:function(e){this.superObject=e,e.addSubObject(this)},createContainerElement:function(e){var t,a=(this.data,!1);e?(t=e.containerElement,a=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body,this.containerElement=MainFrame.Util.createElement("input","v7__elem--container-input",t),this.containerElement.setAttribute("type","radio"),this.selected&&this.containerElement.setAttribute("checked",this.selected),this.name&&this.containerElement.setAttribute("name",this.name);var i=this;MainFrame.Event.bind(this.containerElement,MainFrame.Event.start+" click",function(){MainFrame.Manager.RadioList.register(i.name,i.value)}),this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container")},check:function(){this.containerElement.setAttribute("checked","true"),this.containerElement.checked=!0},uncheck:function(){this.containerElement.removeAttribute("checked"),this.containerElement.checked=!1},checked:function(){return this.containerElement.checked}}),MainFrame.Element.Repeat=MainFrame.Abstract.Module.extend({parseFor:function(e){var t=e.split(" in "),a=t[0],i=t[1];this.forSourceName=i,this.forLocalScoping=a},readData:function(e){MainFrame.DataParser.parseRepeat.call(this,e),this.refresh(),this.setScrollingActions()},setScrollingActions:function(){"vertical"===this.layout?this.setAction("id:applyVerticalEasing"):"horizontal"===this.layout&&this.setAction("id:applyHorizontalEasing")},refresh:function(){var e=this;this.empty(),this.setLoadingScreen(),setTimeout(function(){e.render()},10)},getTemplate:function(){var e=this.templates.length;this.templateIndex||(this.templateIndex=0);var t=1===e?!0:!1;if(t)return this.templates[0];var a=this.templates[this.templateIndex];return this.templateIndex++,this.templateIndex>=e&&(this.templateIndex=0),a},render:function(){this.totalHeight=0,this.totalWidth=0;var e=MainFrame.Util.getForSource(this.forSourceName);if(e){var t="object"==typeof e,a=t&&"undefined"!=typeof e.length;if(a)for(var i=e.length,r=0;i>r;r++){var n=e[r];MainFrame.Scoping.Repeat[this.forLocalScoping]=n,this.drawItem(n)}else if(t)for(var s in e){var n=e[s];MainFrame.Scoping.Repeat[this.forLocalScoping]=n,this.drawItem(n)}else MainFrame.Util.showError("Repeat source error! for = "+forString);this.totalHeight&&this.setDimensionY(this.totalHeight),this.totalWidth&&this.setDimensionX(this.totalWidth),this.resize()}delete MainFrame.Scoping.Repeat[this.forLocalScoping],this.removeLoadingScreen()},drawItem:function(e){var t=this.getTemplate();t=this.processItemActions(t,e);var a=new MainFrame.Element.Item({data:t,superObject:this});this.positionItem(a)},processItemActions:function(e,t){var a=MainFrame.Util.clone(e);if(a.attributes&&a.attributes.action){var i=a.attributes.action;i=MainFrame.Util.processRepeatAction(i,this.forLocalScoping,t),a.attributes.action=i}if(a.childNodes&&a.childNodes.length)for(var r=a.childNodes.length,n=0;r>n;n++){var s=a.childNodes[n];a.childNodes[n]=this.processItemActions(s,t)}return a},positionItem:function(e){if("vertical"===this.layout){e.setPositionY(this.totalHeight);var t=e.getDimensionY();this.totalHeight+=t}if("horizontal"===this.layout){e.setPositionX(this.totalWidth);var a=e.getDimensionX();this.totalWidth+=a}}}),MainFrame.Element.Resource=MainFrame.Abstract.Element.extend({readData:function(e){var t=e.childNodes[0];MainFrame.DataParser.parseResource.call(this,t)}}),MainFrame.Element.Select=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseSelect.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},createContainerElement:function(e){var t,a=(this.data,!1);e?(t=e.containerElement,a=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body,this.containerElement=MainFrame.Util.createElement("select","v7__elem--container-select",t,a),this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container")},addOptions:function(e){this.options=e,this.buildOptions()},buildOptions:function(){if(this.options){MainFrame.Util.emptyElement(this.containerElement);for(var e=0,t=this.options.length;t>e;e++){var a=this.options[e];if(a.value)var i=a.value;else if("string"==typeof a)var i=a;if(a.label)var r=a.label;else var r=i;var n=document.createElement("option");n.text=r,n.value=i,this.containerElement.appendChild(n)}}},getValue:function(){var e=this.containerElement,t=this.containerElement.selectedIndex;return e[t].value}}),MainFrame.Element.Skin=MainFrame.Abstract.Element.extend({initialize:function(){"undefined"==typeof this.states&&(this.states={},this.states.def={})},resize:function(){if(this._resize(),this.fontIconTxt){var e=this.getDimensionY();this.fontIconTxt.style.lineHeight=e+"px",this.fontIconTxt.style.fontSize=e+"px"}}}),MainFrame.Element.Tabs=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseTabs.call(this,e),this.getButtons(),this.getPanels(),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},getPanels:function(){var e=this;if(e.panels=e.getTabSubObjects(e,"tab-panel"),e.panels.length){var t=e.getDefaultPanel();t&&this.showPanel(t)}else MainFrame.Util.showError('Warning! The tabs with the id "'+e.id+'" do not have any panels defined!')},getButtons:function(){var e=this;e.buttons=e.getTabSubObjects(e,"tab-button")},getTabSubObjects:function(e,t){var a=[];if(e.subObjects)for(var i=e.subObjects.length,r=0;i>r;r++){var n=e.subObjects[r],s="undefined"==typeof n.getPanels;if(s)if(n.role===t)a.push(n);else if(n.subObjects){var o=this.getTabSubObjects(n,t);a=a.concat(o)}}return a},getDefaultPanel:function(){if(this.defaultPanelId){var e=this.getPanelWithId(this.defaultPanelId);if(e)return e}else if(this.defaultPanelIndex){var e=this.panels[this.defaultPanelIndex];if(e)return e}return this.panels[0]||null},getPanelWithId:function(e){for(var t=0,a=this.panels.length;a>t;t++){var i=this.panels[t];if(i.id===e)return i}return null},showPanel:function(e){for(var t=200,a=e.id,i=0,r=this.panels.length;r>i;i++){var n=this.panels[i],s=this.buttons[i];n.id===a?("undefined"!=typeof n.hideTimeout&&clearTimeout(n.hideTimeout),n.show(),n.containerElement.style.opacity="0",window.getComputedStyle(n.containerElement,null).getPropertyValue("opacity"),n.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+t+"ms ease-in",n.containerElement.style.opacity="1",s&&s.setState("select")):(s&&s.setState("deselect"),(n.visible||"undefined"==typeof n.visible)&&(n.containerElement.style.opacity="1",window.getComputedStyle(n.containerElement,null).getPropertyValue("opacity"),n.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+t+"ms ease-in",n.containerElement.style.opacity="0",function(e){e.hideTimeout=setTimeout(function(){e.hide()
},t)}(n)))}},showPanelWithId:function(e){var t=this.getPanelWithId(e);t?this.showPanel(t):MainFrame.Util.showError('Tabs error! No panel found with the id "'+e+'"')},showPanelAtIndex:function(e){var t=this.panels[e];t?this.showPanel(t):MainFrame.Util.showError('Tabs error! No panel found with the id "'+panelId+'"')}}),MainFrame.Element.Txt=MainFrame.Abstract.Element.extend({defaultText:null,initialize:function(e){if(e=e||{},this.text="",e.superObject&&this.addSuperObject(e.superObject),this.id=e.id||MainFrame.Util.generateItemId.call(this),MainFrame.Manager.Scoping.register(this.id,this),e.type?this.txtType=e.type:e.data&&e.data.attributes&&e.data.attributes.type&&(this.txtType=e.data.attributes.type),this.scrollable=!1,e.scrollable?this.scrollable=e.scrollable:e.data&&e.data.attributes&&e.data.attributes.scrollable&&(this.scrollable="true"===e.data.attributes.scrollable||e.data.attributes.sliderId?!0:!1),"undefined"!=typeof e.containerElement?(this.containerElement=e.containerElement,this.containerElement.setAttribute("data-type","container")):this.createContainerElement(e.insertBeforeElement),e.contentElement&&this.hasContentElement&&(this.contentElement=e.contentElement,this.contentElement.setAttribute("data-type","content")),e.data&&(this.readData(e.data),this.resize()),"undefined"!=typeof this.autosaveType){if("session"===this.autosaveType)var t="sessionStorage";else if("persistent"===this.autosaveType)var t="localStorage";else var t="standard";var a=this.id+"_txt",i=MainFrame.Util.getItem(a,!1,t);i&&this.setText(i)}},createContainerElement:function(e){var t,a=!1;switch(e?(t=e.containerElement,a=!0):t=this.superObject&&this.superObject.contentElement?this.superObject.contentElement:this.superObject&&this.superObject.containerElement?this.superObject.containerElement:window.document.body,this.txtType){case"input":this.containerElement=MainFrame.Util.createElement("input","v7__elem--container-input",t);var i=this;MainFrame.Event.bind(this.containerElement,"input change blur",function(){i.text=i.containerElement.value,i.autosave()});break;case"textarea":this.containerElement=MainFrame.Util.createElement("textarea","v7__elem--container-textarea",t);var i=this;MainFrame.Event.bind(this.containerElement,"input change blur",function(){i.text=i.containerElement.value,i.autosave()});break;default:this.containerElement=MainFrame.Util.createElement("div","v7__elem--container",t),this.contentElement=MainFrame.Util.createElement("p","v7__elem--content-p",this.containerElement),"Desktop"===EnvDetection.deviceType?this.scrollable&&(this.containerElement.style["overflow-x"]="hidden",this.containerElement.style["overflow-y"]="auto"):(this.scrollable&&this.setAction("id:textAutoscroll"),this.containerElement.style.overflow="hidden")}this.containerElement.setAttribute("data-item-id",this.id),this.containerElement.setAttribute("data-type","container")},readData:function(e){this.data=e,MainFrame.DataParser.parseTxt.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},registerDependencies:function(e){if(e.length){var t=this;e.forEach(function(e){if("var"===e.type)if(MainFrame.Manager.VariablesDependencies.getById(e.id)){var a=MainFrame.Manager.VariablesDependencies.getById(e.id);-1===a.indexOf(t)&&a.push(t)}else{var a=[t];MainFrame.Manager.VariablesDependencies.register(e.id,a)}})}},setText:function(e){"string"!=typeof e&&(e+="");var t=MainFrame.Util.interpretString(e),a=t.interpretedString;switch(this.defaultText!==e&&(this.registerDependencies(t.dependencies),this.defaultText=e),this.text=a,this.txtType){case"input":this.containerElement.value=a;break;case"textarea":this.containerElement.value=a;break;default:e=MainFrame.Util.formatText(a),e=MainFrame.Util.addBreaklines(e),this.contentElement.innerHTML=e,this.hasAutoshrink&&!this.hasAutoresize&&this.autoshrinkText(),this.hasAutoresize&&(this.autoresizeText(),this.resize())}this.autosave()},setPlaceholderText:function(e){switch(this.txtType){case"input":case"textarea":this.containerElement.setAttribute("placeholder",e)}},getText:function(){return this.txtType?this.containerElement.value:this.contentElement.innerHTML},getPlaceholderText:function(){var e=this.containerElement.getAttribute("placeholder");return e||""},_resize:function(){this.hasAutoresize&&this.autoresizeText();var e=this.getDimensionX(),t=this.getDimensionY();if(this.containerElement.style.width=e+"px",this.containerElement.style.height=t+"px",this.containerElement.style.top=this.getPositionY()+"px",this.containerElement.style.left=this.getPositionX()+"px",this.contentElement&&(this.contentElement.style.width=e+"px",this.hasTextOverflow!==!0&&(this.contentElement.style.height="auto")),this.hasAutoshrink&&!this.hasAutoresize&&this.autoshrinkText(),this.subObjects)for(var a=0,i=this.subObjects.length;i>a;a++)this.subObjects[a].resize();this.skinObject&&this.skinObject.resize(),this.hasSlider&&Ps.update(this.contentElement)},estimatedTextSizeWithText:function(e,t,a){var i=MainFrame.Util.createElement("div","",document.body);i.innerHTML=e,i.style=this.containerElement.style,i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.style.fontFamily=this.containerElement.style.fontFamily,i.style.width=a?this.getDimensionX()+"px":"auto",i.style.height="auto",i.style.fontSize=t+"px";var r=i.clientWidth+1,n=i.clientHeight+1;MainFrame.Util.removeElement(i);var s={width:r,height:n};return s},autoshrinkText:function(){var e=this.getText(),t=this.fontSize,a=this.getDimensionY();if(t)for(var i=this.estimatedTextSizeWithText(e,t,!0).height;i>a+1&&t>this.minimumFontSize;)t--,i=this.estimatedTextSizeWithText(e,t,!0).height;this.containerElement.style.fontSize=t+"px"},autoresizeText:function(){var e=this.getText(),t=this.fontSize;if(t)if("width"===this.autoresizeType){var a=!1,i=this.estimatedTextSizeWithText(e,t,a).width;this.dimensionX=i,this.setDimensionX(i)}else if("height"===this.autoresizeType){var a=!0,r=this.estimatedTextSizeWithText(e,t,a).height;this.dimensionY=r,this.setDimensionY(r)}else if("none"!==this.autoresizeType){var a=!1,n=this.estimatedTextSizeWithText(e,t,a);this.setDimensionX(n.width),this.setDimensionY(n.height)}},unload:function(){this.autosave(),this._unload()},autosave:function(){if("undefined"!=typeof this.autosaveType){var e=this.text,t=this.id+"_txt";if("session"===this.autosaveType)var a="sessionStorage";else if("persistent"===this.autosaveType)var a="localStorage";else var a="standard";e&&MainFrame.Util.saveItem(t,e,!1,a)}}}),MainFrame.Element.Video=MainFrame.Abstract.Element.extend({addSuperObject:function(e){this.superObject=e},createContainerElement:function(){MainFrame.Abstract.Element.prototype.createContainerElement.call(this),this.containerElement.setAttribute("class","v7__elem__video"),this.createContentElement(),this.containerElement.setAttribute("data-type","container")},createContentElement:function(){this.containerElement||this.createContainerElement(),this.contentElement=MainFrame.Util.createElement("video","v7__elem__video--content",this.containerElement),this.contentElement.setAttribute("data-type","content")},readData:function(e){MainFrame.DataParser.parseVideo.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},setControls:function(){this.hasControls&&this.contentElement.setAttribute("controls","true")},setAutoplay:function(){this.autoplay&&this.contentElement.setAttribute("autoplay","true")},setPoster:function(e){e&&this.contentElement.setAttribute("poster",e)},setFormats:function(e){this.formats=e.split("|")},setSource:function(e){if(this.formats){var t=e.split(".");t.pop();for(var a=t.join("."),i=0,r=this.formats.length;r>i;i++){var n=this.formats[i],s=MainFrame.Util.createElement("source","",this.contentElement);s.setAttribute("src",a+"."+n)}}else this.contentElement.src=e}}),MainFrame.Element.Webview=MainFrame.Abstract.Element.extend({addSuperObject:function(e){this.superObject=e},createContainerElement:function(){MainFrame.Abstract.Element.prototype.createContainerElement.call(this),this.containerElement.setAttribute("class","v7__elem__webview"),this.createContentElement(),this.containerElement.setAttribute("data-type","container")},createContentElement:function(){this.containerElement||this.createContainerElement(),this.contentElement=MainFrame.Util.createElement("iframe","v7__elem__webview--content",this.containerElement),this.contentElement.setAttribute("data-type","content")},readData:function(e){MainFrame.DataParser.parseWebview.call(this,e),MainFrame.EventHandler.dispatch(this.id+"Ready",[this])},setSource:function(e){this.contentElement.src=e}}),MainFrame.Manager.Condition=new MainFrame.Abstract.Manager({id:"condition"}),MainFrame.Manager.Condition.getById=function(e){return this.list[e]?this.list[e].value:""},MainFrame.Manager.ActionDesc=new MainFrame.Abstract.Manager({id:"actionDesc"}),MainFrame.Manager.ActionLib=new MainFrame.Abstract.Manager({id:"actionLib"}),MainFrame.Manager.AltText=new MainFrame.Abstract.Manager({id:"altText"}),MainFrame.Manager.Confirmation=new MainFrame.Abstract.Manager({id:"confirmation"}),MainFrame.Manager.CustomCondition=new MainFrame.Abstract.Manager({id:"customCondition"}),MainFrame.Manager.Language=new MainFrame.Abstract.Manager({id:"language"}),MainFrame.Manager.Library=new MainFrame.Abstract.Manager({id:"library"}),MainFrame.Manager.LibraryNode=new MainFrame.Abstract.Manager({id:"libraryNode"}),MainFrame.Manager.RadioList=new MainFrame.Abstract.Manager({id:"radioList"}),MainFrame.Manager.Resource=new MainFrame.Abstract.Manager({id:"resource"}),MainFrame.Manager.Scoping=new MainFrame.Abstract.Manager({id:"scoping"}),MainFrame.Manager.Settings=new MainFrame.Abstract.Manager({id:"settings"}),MainFrame.Manager.Skin=new MainFrame.Abstract.Manager({id:"skin"}),MainFrame.Manager.Slider=new MainFrame.Abstract.Manager({id:"slider"}),MainFrame.Manager.Storage=new MainFrame.Abstract.Manager({id:"storage"}),MainFrame.Manager.Template=new MainFrame.Abstract.Manager({id:"template"}),MainFrame.Manager.TxtStyle=new MainFrame.Abstract.Manager({id:"txtStyle"}),MainFrame.Manager.VariablesDependencies=new MainFrame.Abstract.Manager({id:"variablesDependencies"}),MainFrame.Manager.Text=new MainFrame.Abstract.Manager({id:"text"}),MainFrame.Manager.Text.getById=function(e){return"undefined"==typeof this.list[e]&&MainFrame.Util.warn('No text in translation.xml for the id "'+e+'"'),this.list[e]?this.list[e].value:""},MainFrame.Manager.Variables=new MainFrame.Abstract.Manager({id:"variables"}),MainFrame.Manager.Variables.register=function(e,t){if(t){var a=t.value||t;a=a.trim(),this.list[e]=a,this.saveList(),this.notifyListeners(e)}else MainFrame.Util.showError("Therere is no value to be stored in the manager for the id "+e)},MainFrame.Manager.Variables.set=function(e,t){this.register(e,t)},MainFrame.Manager.Variables.notifyListeners=function(e){if(MainFrame.Manager.VariablesDependencies.getById(e)){var t=MainFrame.Manager.VariablesDependencies.getById(e);t.forEach(function(e){e.setText(e.defaultText)})}},MainFrame.DataParser={defaultSize:{check:{width:"15",height:"15"},radio:{width:"15",height:"15"},select:{width:"100",height:"15"},skin:{width:"100%",height:"100%"}},elements:{check:MainFrame.Element.Check,embedded:MainFrame.Element.Embedded,html:MainFrame.Element.Html,fontIcon:MainFrame.Element.Txt,img:MainFrame.Element.Img,item:MainFrame.Element.Item,object:MainFrame.Element.Object,radio:MainFrame.Element.Radio,repeat:MainFrame.Element.Repeat,select:MainFrame.Element.Select,tabs:MainFrame.Element.Tabs,txt:MainFrame.Element.Txt,video:MainFrame.Element.Video,webview:MainFrame.Element.Webview}},!function(){var e={applySkin:function(e,t){if(e){if(e.attributes&&e.attributes.skinStyle){var a=MainFrame.Util.processAttribute(e.attributes.skinStyle).interpretedString,i=MainFrame.DataParser.getJSONFromAttribute(a,";",":");for(var r in i)e[r]=i[r]}this.skins||(this.skins=[]);var n=this.skins.length>0;if(t===!0&&n)var s=this.skins[0];else{var s=new MainFrame.Element.Skin;s.superObject=this,s.containerElement=MainFrame.Util.createElement("div","v7__elem--skin",this.containerElement),this.skins.push(s)}1===this.skins.length&&(this.skinElement=s.containerElement);var o=s.containerElement;for(var l in e.attributes)switch(l){case"img":var c=e.attributes.img;c=MainFrame.Util.processAttribute(c).interpretedString,MainFrame.DataParser.applySkinImg.call(this,c,o);break;case"file":var c=e.attributes.file;c=MainFrame.Util.processAttribute(c).interpretedString,MainFrame.DataParser.applySkinFile.call(this,c,o);break;case"appli":var c=e.attributes.appli;c=MainFrame.Util.processAttribute(c).interpretedString,MainFrame.DataParser.applySkinAppli.call(this,c,o);break;case"data":var c=e.attributes.data;c=MainFrame.Util.processAttribute(c).interpretedString,MainFrame.DataParser.applySkinData.call(this,c,o);break;case"common":var c=e.attributes.common;c=MainFrame.Util.processAttribute(c).interpretedString,MainFrame.DataParser.applySkinCommon.call(this,c,o);break;case"src":var c=e.attributes.src;c=MainFrame.Util.localizePath(c),c=MainFrame.Util.processAttribute(c).interpretedString,0===c.indexOf("#")?MainFrame.DataParser.applySkinColor.call(this,c,o):MainFrame.DataParser.applySkinImg.call(this,c,o);break;case"backgroundSize":var d=e.attributes.backgroundSize;MainFrame.DataParser.applySkinBackgroundSize.call(this,d,o);break;case"backgroundPosition":var g=e.attributes.backgroundPosition;MainFrame.DataParser.applySkinBackgroundPosition.call(this,g,o);break;case"backgroundPositionX":var h=e.attributes.backgroundPositionX;MainFrame.DataParser.applySkinBackgroundPositionX.call(this,h,o);break;case"backgroundPositionY":var u=e.attributes.backgroundPositionY;MainFrame.DataParser.applySkinBackgroundPositionY.call(this,u,o);break;case"backgroundRepeat":var m=e.attributes.backgroundRepeat;MainFrame.DataParser.applySkinBackgroundRepeat.call(this,m,o);break;case"color":var p=MainFrame.Util.processAttribute(e.attributes.color).interpretedString;MainFrame.DataParser.applySkinColor.call(this,p,o);break;case"alpha":var f=e.attributes.alpha;MainFrame.DataParser.applySkinOpacity.call(this,f,o);break;case"shape":var v=e.attributes.shape;MainFrame.DataParser.applySkinShape.call(this,v);break;case"shadow":var M=e.attributes.shadow;MainFrame.DataParser.applySkinShadow.call(this,M);break;case"border":var b=MainFrame.Util.processAttribute(e.attributes.border).interpretedString;MainFrame.DataParser.applySkinBorder.call(this,b,o);break;case"borderColor":var F=e.attributes.borderColor;MainFrame.DataParser.applySkinBorderColor.call(this,F,o);break;case"borderTopColor":var A=e.attributes.borderTopColor;MainFrame.DataParser.applySkinBorderTopColor.call(this,A,o);break;case"borderBottomColor":var P=e.attributes.borderBottomColor;MainFrame.DataParser.applySkinBorderBottomColor.call(this,P,o);break;case"borderLeftColor":var y=e.attributes.borderLeftColor;MainFrame.DataParser.applySkinBorderLeftColor.call(this,y,o);break;case"borderRightColor":var C=e.attributes.borderRightColor;MainFrame.DataParser.applySkinBorderRightColor.call(this,C,o);break;case"borderSize":var E=e.attributes.borderSize;MainFrame.DataParser.applySkinBorderSize.call(this,E,o);break;case"borderStyle":var S=e.attributes.borderStyle;MainFrame.DataParser.applySkinBorderStyle.call(this,S,o);break;case"borderRight":var w=e.attributes.borderRight;MainFrame.DataParser.applySkinBorderRight.call(this,w,o);break;case"borderLeft":var I=e.attributes.borderLeft;MainFrame.DataParser.applySkinBorderLeft.call(this,I,o);break;case"borderTop":var x=e.attributes.borderTop;MainFrame.DataParser.applySkinBorderTop.call(this,x,o);break;case"borderBottom":var D=e.attributes.borderBottom;MainFrame.DataParser.applySkinBorderBottom.call(this,D,o);break;case"radius":var T=e.attributes.radius;MainFrame.DataParser.applySkinBorderRadius.call(this,T,o);break;case"radiusBR":var T=e.attributes.radiusBR;MainFrame.DataParser.applySkinBorderRadiusBR.call(this,T,o);break;case"radiusBL":var T=e.attributes.radiusBL;MainFrame.DataParser.applySkinBorderRadiusBL.call(this,T,o);break;case"radiusTR":var T=e.attributes.radiusTR;MainFrame.DataParser.applySkinBorderRadiusTR.call(this,T,o);break;case"radiusTL":var T=e.attributes.radiusTL;MainFrame.DataParser.applySkinBorderRadiusTL.call(this,T,o);break;case"pos":var O=MainFrame.Util.processAttribute(e.attributes.pos).interpretedString;MainFrame.DataParser.setPos.call(s,O);break;case"size":var z=MainFrame.Util.processAttribute(e.attributes.size).interpretedString;MainFrame.DataParser.setSize.call(s,z,"skin");break;case"fontIcon":var B=e.attributes.fontIcon,k=MainFrame.Util.createElement("txt","v7-font-icon "+B,o),U=s.getDimensionY();k.style.width="100%",k.style.height="100%",k.style.lineHeight=U+"px",k.style.fontSize=U+"px",k.style.textAlign="center",k.style.display="block",s.fontIconTxt=k;break;case"fontIconColor":var R=e.attributes.fontIconColor;s.fontIconTxt&&(s.fontIconTxt.style.color=R),this.setProperty("fontIconColor",R),this.states.def["skin.fontIconColor"]=R;break;case"id":break;default:var Y=MainFrame.Util.generateCSSStyleName(l),_=e.attributes[l];o.style[Y]=_}if(e.childNodes)for(var L=e.childNodes,N=0,j=L.length;j>N;N++){var X=L[N];MainFrame.DataParser.applySkin.call(s,X)}}},applySkinImg:function(e,t){var a=e;this.setProperty("backgroundImage",a),this.states.def["skin.img"]=a,a=MainFrame.Util.processSrc(a),t.style.backgroundImage="url('"+a+"')",t.style.backgroundSize||(t.style.backgroundSize="100% 100%"),t.style.backgroundRepeat||(t.style.backgroundRepeat="no-repeat")},applySkinFile:function(e,t){var a=e;this.setProperty("backgroundImage",a),this.states.def["skin.file"]=a,a=MainFrame.Util.localizePath(a),a=escape(a);var i=MainFrame.Util.isAbsoluteUrl(a);i||(a=MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+a),t.style.backgroundImage="url('"+a+"')",t.style.backgroundSize||(t.style.backgroundSize="100% 100%"),t.style.backgroundRepeat||(t.style.backgroundRepeat="no-repeat")},applySkinAppli:function(e,t){var a=e;this.setProperty("backgroundImage",a),this.states.def["skin.appli"]=a,a=MainFrame.Util.localizePath(a),a=escape(a);var i=MainFrame.Util.isAbsoluteUrl(a);i||(a=MainFrame.Util.getAppURL()+a),t.style.backgroundImage="url('"+a+"')",t.style.backgroundSize||(t.style.backgroundSize="100% 100%"),t.style.backgroundRepeat||(t.style.backgroundRepeat="no-repeat")},applySkinData:function(e,t){var a=e;this.setProperty("backgroundImage",a),this.states.def["skin.data"]=a,a=MainFrame.Util.localizePath(a),a=escape(a);var i=MainFrame.Util.isAbsoluteUrl(a);i||(a=MainFrame.Util.getAppURL()+MainFrame.Util.getDataURL()+a),t.style.backgroundImage="url('"+a+"')",t.style.backgroundSize||(t.style.backgroundSize="100% 100%"),t.style.backgroundRepeat||(t.style.backgroundRepeat="no-repeat")},applySkinCommon:function(e,t){var a=e;this.setProperty("backgroundImage",a),this.states.def["skin.common"]=a,a=MainFrame.Util.localizePath(a),a=escape(a);var i=MainFrame.Util.isAbsoluteUrl(a);i||(a=MainFrame.Util.getAppURL()+"common/"+a),t.style.backgroundImage="url('"+a+"')",t.style.backgroundSize||(t.style.backgroundSize="100% 100%"),t.style.backgroundRepeat||(t.style.backgroundRepeat="no-repeat")},applySkinBackgroundSize:function(e,t){this.setProperty("backgroundSize",e),t.style.backgroundSize=e},applySkinBackgroundPosition:function(e,t){this.setProperty("backgroundPosition",e),t.style.backgroundPosition=e,t.style.backgroundRepeat="repeat"},applySkinBackgroundPositionX:function(e,t){this.setProperty("backgroundPositionX",e),t.style.backgroundPositionX=e,t.style.backgroundRepeat="repeat"},applySkinBackgroundPositionY:function(e,t){this.setProperty("backgroundPositionY",e),t.style.backgroundPositionX=e,t.style.backgroundRepeat="repeat"},applySkinBackgroundRepeat:function(e,t){this.setProperty("backgroundRepeat",e),t.style.backgroundRepeat=e,t.style.backgroundSize="auto"},applySkinColor:function(e,t){this.setProperty("color",e),t.style.backgroundColor=e,this.states.def["skin.color"]=e},applySkinOpacity:function(e,t){this.setProperty("opacity",e),t.style.opacity=e,this.states.def["skin.alpha"]=e},applySkinShape:function(e){this.setProperty("skin.shape",e),this.applyProperty("skin.shape",e)},applySkinShadow:function(e){this.setProperty("skin.shadow",e),this.applyProperty("skin.shadow",e)},applySkinBorder:function(e,t){this.setProperty("border",e),t.style.border=e,this.states.def["skin.border"]=e},applySkinBorderColor:function(e,t){this.setProperty("borderTopColor",e),this.setProperty("borderBottomColor",e),this.setProperty("borderLeftColor",e),this.setProperty("borderRightColor",e),t.style.borderTopColor=e,t.style.borderBottomColor=e,t.style.borderLeftColor=e,t.style.borderRightColor=e,this.states.def["skin.borderTopColor"]=e,this.states.def["skin.borderBottomColor"]=e,this.states.def["skin.borderLeftColor"]=e,this.states.def["skin.borderRightColor"]=e,t.style.borderWidth||(t.style.borderWidth="1px",this.states.def["skin.borderSize"]="1"),t.style.borderStyle||(t.style.borderStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderTopColor:function(e,t){this.setProperty("borderTopColor",e),t.style.borderTopColor=e,this.states.def["skin.borderTopColor"]=e,t.style.borderTopWidth||t.style.borderWidth||(t.style.borderTopWidth="1px",this.states.def["skin.borderTopSize"]="1"),t.style.borderTopStyle||(t.style.borderTopStyle="solid",this.states.def["skin.borderTopStyle"]="solid")},applySkinBorderBottomColor:function(e,t){this.setProperty("borderBottomColor",e),t.style.borderBottomColor=e,this.states.def["skin.borderBottomColor"]=e,t.style.borderBottomWidth||t.style.borderWidth||(t.style.borderBottomWidth="1px",this.states.def["skin.borderBottomSize"]="1"),t.style.borderBottomStyle||(t.style.borderBottomStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderLeftColor:function(e,t){this.setProperty("borderLeftColor",e),t.style.borderLeftColor=e,this.states.def["skin.borderLeftColor"]=e,t.style.borderLeftWidth||t.style.borderWidth||(t.style.borderLeftWidth="1px",this.states.def["skin.borderLeftSize"]="1"),t.style.borderLeftStyle||(t.style.borderLeftStyle="solid",this.states.def["skin.borderLeftStyle"]="solid")},applySkinBorderRightColor:function(e,t){this.setProperty("borderRightColor",e),t.style.borderRightColor=e,this.states.def["skin.borderRightColor"]=e,t.style.borderRightWidth||t.style.borderWidth||(t.style.borderRightWidth="1px",this.states.def["skin.borderRightSize"]="1"),t.style.borderRightStyle||(t.style.borderRightStyle="solid",this.states.def["skin.borderRightStyle"]="solid")},applySkinBorderSize:function(e,t){this.setProperty("borderTopSize",e),this.setProperty("borderBottomSize",e),this.setProperty("borderLeftSize",e),this.setProperty("borderRightSize",e),t.style.borderTopWidth=e+"px",t.style.borderBottomWidth=e+"px",t.style.borderLeftWidth=e+"px",t.style.borderRightWidth=e+"px",this.states.def["skin.borderTopSize"]=e,this.states.def["skin.borderBottomSize"]=e,this.states.def["skin.borderLeftSize"]=e,this.states.def["skin.borderRightSize"]=e,t.style.borderStyle||(t.style.borderStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderTopSize:function(e,t){this.setProperty("borderTopSize",e),t.style.borderTopWidth=e+"px",this.states.def["skin.borderTopSize"]=e,t.style.borderStyle||(t.style.borderStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderBottomSize:function(e,t){this.setProperty("borderBottomSize",e),t.style.borderBottomWidth=e+"px",this.states.def["skin.borderBottomSize"]=e,t.style.borderStyle||(t.style.borderStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderLeftSize:function(e,t){this.setProperty("borderLeftSize",e),t.style.borderLeftWidth=e+"px",this.states.def["skin.borderLeftSize"]=e,t.style.borderStyle||(t.style.borderStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderRightSize:function(e,t){this.setProperty("borderRightSize",e),t.style.borderRightWidth=e+"px",this.states.def["skin.borderRightSize"]=e,t.style.borderStyle||(t.style.borderStyle="solid",this.states.def["skin.borderStyle"]="solid")},applySkinBorderStyle:function(e,t){this.setProperty("borderStyle",e),t.style.borderStyle=e,this.states.def["skin.borderStyle"]=e,t.style.borderSize||(t.style.borderWidth="1px",this.states.def["skin.borderSize"]="1")},applySkinBorderLeft:function(e,t){this.setProperty("borderLeft",e),t.style.borderLeft=e,this.states.def.borderLeft=e},applySkinBorderRight:function(e,t){this.setProperty("borderRight",e),t.style.borderRight=e,this.states.def.borderRight=e},applySkinBorderTop:function(e,t){this.setProperty("borderTop",e),t.style.borderTop=e,this.states.def.borderTop=e},applySkinBorderBottom:function(e,t){this.setProperty("borderBottom",e),t.style.borderBottom=e,this.states.def.borderBottom=e},applySkinBorderRadius:function(e,t){this.setProperty("radius",e),t.style.borderRadius=e+"px",this.states.def["skin.radius"]=e},applySkinBorderRadiusBR:function(e,t){this.setProperty("radiusBR",e),t.style.borderBottomRightRadius=e+"px",this.states.def.radiusBR=e},applySkinBorderRadiusBL:function(e,t){this.setProperty("radiusBL",e),t.style.borderBottomLeftRadius=e+"px",this.states.def.radiusBL=e},applySkinBorderRadiusTR:function(e,t){this.setProperty("radiusTR",e),t.style.borderTopRightRadius=e+"px",this.states.def.radiusTR=e},applySkinBorderRadiusTL:function(e,t){this.setProperty("radiusTL",e),t.style.borderTopLeftRadius=e+"px",this.states.def.radiusTL=e},applyTemplate:function(e,t,a){var i=MainFrame.Manager.Template.getById(t);if(i){if(a){var r=JSON.stringify(i);for(var n in a){var s=a[n],o=new RegExp(n,"g");r=r.replace(o,s)}i=JSON.parse(r)}for(var l in i)if("childNodes"===l)e[l]=i[l];else if("attributes"===l)for(var c in i[l])"undefined"==typeof e[l][c]&&(e[l][c]=i[l][c])}return e},basicParse:function(e,t){if("undefined"==typeof t&&(t=!0),this.id||MainFrame.DataParser.getId.call(this,e),e.attributes.template)e=MainFrame.DataParser.interpretTemplateString(e);else if(e.attributes&&e.attributes.templateId){var a=e.attributes.templateId,i=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,a,i)}if(e.attributes&&e.attributes.role&&(this.role=e.attributes.role),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getHandCursor.call(this,e),MainFrame.DataParser.getAltId.call(this,e)),MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getScaleWithCatalog.call(this,e),MainFrame.DataParser.getAlpha.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getSkin.call(this,e),MainFrame.DataParser.getTint.call(this,e),MainFrame.DataParser.getAction.call(this,e),MainFrame.DataParser.getVisible.call(this,e),MainFrame.DataParser.getVisibleOffline.call(this,e),MainFrame.DataParser.getResponsiveConditions.call(this,e),MainFrame.DataParser.getLayout.call(this,e),MainFrame.DataParser.getSpacing.call(this,e),e.attributes&&e.attributes.resourceId){var r=e.attributes.resourceId,n=MainFrame.Manager.Resource.getById(r);n?MainFrame.DataParser.parseChildren.call(this,n):MainFrame.Util.showError("No resource can be loaded for the id: "+r)}else t&&MainFrame.DataParser.parseChildren.call(this,e);if(MainFrame.DataParser.getSliderId.call(this,e),MainFrame.DataParser.getDuration.call(this,e),MainFrame.DataParser.getStates.call(this,e),MainFrame.DataParser.getDisabled.call(this,e),MainFrame.DataParser.getClass.call(this,e),MainFrame.DataParser.getOverflow.call(this,e),MainFrame.DataParser.getStyles.call(this,e),"undefined"!=typeof e.attributes.ratio){var s=e.attributes.ratio;this.ratio=parseFloat(s,10)}var o=e.attributes.proportions;("proportionalInside"===o||"fit"===o)&&(this.fillType="fit"),("proportionalOutside"===o||"fill"===o)&&(this.fillType="fill")},createElement:function(e){var t=e.nodeName;if(MainFrame.DataParser.elements[t]){var a=MainFrame.DataParser.elements[t];return new a({id:e.attributes.id,superObject:this,data:e})}},getAction:function(e){e.attributes&&e.attributes.action&&this.setAction.call(this,e.attributes.action)},getAlpha:function(e){var t=1;e.attributes.alpha&&(t=e.attributes.alpha,this.containerElement.style.opacity=t),this.setProperty("alpha",t),this.states.def.alpha=t},getAltId:function(e){if(e.attributes.altId){var t=e.attributes.altType||"default",a=e.attributes.altId,i=null;this.addAltId(a,t,i,{initiator:this})}},getBorders:function(e){if(e.attributes.borderWidth){this.hasBorders=!0;var t=parseFloat(e.attributes.borderWidth)}else t=0;if(this.borderTopWidth=t,this.borderRightWidth=t,this.borderBottomWidth=t,this.borderLeftWidth=t,e.attributes.borderTopWidth&&(this.borderTopWidth=parseFloat(e.attributes.borderTopWidth)),e.attributes.borderRightWidth&&(this.borderRightWidth=parseFloat(e.attributes.borderRightWidth)),e.attributes.borderBottomWidth&&(this.borderBottomWidth=parseFloat(e.attributes.borderBottomWidth)),e.attributes.borderLeftWidth&&(this.borderLeftWidth=parseFloat(e.attributes.borderLeftWidth)),e.attributes.borderColor){var a=e.attributes.borderColor;this.borderTopColor=a,this.borderRightColor=a,this.borderBottomColor=a,this.borderLeftColor=a}e.attributes.borderTopColor&&(this.borderTopColor=e.attributes.borderTopColor),e.attributes.borderRightColor&&(this.borderRightColor=e.attributes.borderRightColor),e.attributes.borderBottomColor&&(this.borderBottomColor=e.attributes.borderBottomColor),e.attributes.borderLeftColor&&(this.borderLeftColor=e.attributes.borderLeftColor);var i;i=e.attributes.borderStyle?e.attributes.borderStyle:"solid",this.borderTopStyle=i,this.borderRightStyle=i,this.borderBottomStyle=i,this.borderLeftStyle=i,e.attributes.borderTopStyle&&(this.borderTopStyle=e.attributes.borderTopStyle),e.attributes.borderRightStyle&&(this.borderRightStyle=e.attributes.borderRightStyle),e.attributes.borderBottomStyle&&(this.borderBottomStyle=e.attributes.borderBottomStyle),e.attributes.borderLeftStyle&&(this.borderLeftStyle=e.attributes.borderLeftStyle)},getChildrenWithNodeName:function(e,t){for(var a=[],i=0,r=e.childNodes.length;r>i;i++){var n=e.childNodes[i];n.nodeName===t&&a.push(n)}return a},getNodeNamed:function(e,t){if(e){var a=MainFrame.DataParser.getChildrenWithNodeName(e,t);if(a.length)return a[0]}return null},getClass:function(e){if(e.attributes["class"]){var t,a=e.attributes["class"],i=a.split(" ");if(this.skinElement){var r=this.skinElement.getElementsByTagName("div");if(r.length){var n=r[0];t=n}else t=this.skinElement}else t=this.containerElement;i.forEach(function(e){t.classList.add(e)})}if(e.attributes.containerClass){var a=e.attributes.containerClass,i=a.split(" "),t=this.containerElement;i.forEach(function(e){t.classList.add(e)})}},getResponsiveConditions:function(e){var t=!1;e.attributes.maxWidth&&(this.maxWidth=parseInt(e.attributes.maxWidth,10),t=!0),e.attributes.minWidth&&(this.minWidth=parseInt(e.attributes.minWidth,10),t=!0),e.attributes.maxHeight&&(this.maxHeight=parseInt(e.attributes.maxHeight,10),t=!0),e.attributes.minHeight&&(this.minHeight=parseInt(e.attributes.minHeight,10),t=!0),t&&(this.checkResponsiveConditions(),MainFrame.Publisher.subscribe("browser:resize",this,this.checkResponsiveConditions))},getPath:function(e,t){var a=e.attributes[t];if(a){a=MainFrame.Util.processAttribute(a).interpretedString;var i=MainFrame.Util.isAbsoluteUrl(a),r=-1!==a.indexOf("/"),n=!i&&!r,s=!i&&r;n?a=MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/res/"+a:s&&(a=MainFrame.Util.getAppURL()+a)}return a},getOverflow:function(e){var t=e.attributes.overflow;t&&(this.containerElement.style.overflow=t,this.contentElement&&(this.contentElement.style.overflow=t))},getSliderId:function(e){var t=e.attributes.sliderId,a="undefined"!=typeof t,i="undefined"!=typeof Ps,r="undefined"!=typeof this.contentElement,n=r&&this.contentElement.nodeName&&"p"===this.contentElement.nodeName.toLowerCase(),s=r&&"html"===e.nodeName;if(a&&i){var o=MainFrame.Manager.Slider.getById(t);if(o){var l=MainFrame.DataParser.getSliderConfig(o);n||s?("Desktop"===EnvDetection.deviceType&&(Ps.initialize(this.containerElement,l),this.hasSlider=!0),s&&(this.contentElement.style.overflow="visible")):r&&(Ps.initialize(this.contentElement,l),this.hasSlider=!0)
}else MainFrame.Util.showError('Error! No slider found for the id "'+t+'"!')}},getSliderConfig:function(e){var t={};t.scrollbar={},t.scrollbarRail={};var a=e.attributes.width,i=e.attributes.railColor,r=e.attributes.scrollbarColor,n=e.attributes.position;if("undefined"!=typeof a&&(t.scrollbar.width=a,t.scrollbarRail.width=a),"undefined"!=typeof i){var s=MainFrame.Util.processAttribute(i).interpretedString;t.scrollbarRail.color=s}if("undefined"!=typeof r){var s=MainFrame.Util.processAttribute(r).interpretedString;t.scrollbar.color=s}return t.scrollbarRail.position="left"===n?"left":"right",t},getStyles:function(e){var t=MainFrame.Util.processAttribute(e.attributes.h5_style).interpretedString,a=MainFrame.Util.processAttribute(e.attributes.h5_skinStyle).interpretedString,i=MainFrame.Util.processAttribute(e.attributes.h5_contentStyle).interpretedString;if(t&&this.containerElement){var r=this.containerElement.getAttribute("style");this.containerElement.setAttribute("style",r+";"+t)}if(a&&this.skinElement){var r=this.skinElement.getAttribute("style");this.skinElement.setAttribute("style",r+";"+a)}if(i&&this.contentElement){var r=this.contentElement.getAttribute("style");this.contentElement.setAttribute("style",r+";"+i)}},getDefaultLanguage:function(e){if(!e)return null;var t=MainFrame.DataParser.getChildrenWithNodeName(e,"languages");if(t.length){var a=t[0];if(a.attributes.currentLanguage)return a.attributes.currentLanguage;var i=MainFrame.DataParser.getChildrenWithNodeName(a,"language");if(i.length){var r=i[0];return r.attributes.language?r.attributes.language:null}return null}return null},getDisabled:function(e){if(e.attributes.disabled){var t="true"===e.attributes.disabled||"1"===e.attributes.disabled;t&&(this.setState("disable"),this.disabled=!0)}if(e.attributes.disabledOffline){var t="true"===e.attributes.disabledOffline||"1"===e.attributes.disabledOffline;t&&MainFrame.Browser.isFileProtocol&&(this.setState("disable"),this.disabled=!0)}},getDuration:function(e){if(e.attributes.duration){var t=e.attributes.duration;this.duration=t,this.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="all "+t+"s ease",this.skinElement&&(this.skinElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="all "+t+"s ease")}},getHandCursor:function(e){var t=e.attributes.handCursor||e.attributes.useHandCursor;if(t){switch(t){case"false":var a="auto";break;case"true":var a="pointer";break;default:var a=t}this.addHandCursor(a)}},getId:function(e){e.attributes&&e.attributes.id&&(this.id=MainFrame.Util.processAttribute(e.attributes.id).interpretedString)},getJSONFromAttribute:function(e,t,a){var i={};i.attributes={};var r=t||";";a="undefined"==typeof a?"=":a;for(var n=e.split(r),s=0,o=n.length;o>s;s++){var l=n[s];if(""!==l){var c=l.split(a),d=c[0];c.shift();var g=c.join(a);if("undefined"!=typeof i.attributes[d]){if(!Array.isArray(i.attributes[d])){var h=i.attributes[d];i.attributes[d]=[],i.attributes[d].push(h)}i.attributes[d].push(g)}else i.attributes[d]=g}}return i},getLayout:function(e){e.attributes&&e.attributes.layout&&(this.layout=e.attributes.layout,"grid"===this.layout||"vertical"===this.layout?"Desktop"!==EnvDetection.deviceType&&this.setAction("id:applyVerticalEasing"):"horizontal"===this.layout&&this.setAction("id:applyHorizontalEasing"))},getSpacing:function(e){if(this.spacing={x:0,y:0},e.attributes&&e.attributes.spacing){var t=e.attributes.spacing;if("vertical"===this.layout)this.spacing={x:0,y:parseInt(t,10)};else if("horizontal"===this.layout)this.spacing={x:parseInt(t,10),y:0};else if("grid"===this.layout)if(-1===t.indexOf("|"))this.spacing={x:parseInt(t,10),y:parseInt(t,10)};else{var a=t.split("|"),i=a[0],r=a[1];this.spacing={x:parseInt(i,10),y:parseInt(r,10)}}}},getLoadingTemplateId:function(e){e.attributes.loadingTemplateId&&(this.loadingTemplateId=e.attributes.loadingTemplateId)},getNodesWithNodeName:function(e,t){var a=[];if(!e.childNodes)return a;for(var i=0,r=e.childNodes.length;r>i;i++){var n=e.childNodes[i];n.nodeName===t&&a.push(n),n.childNodes&&(a=a.concat(MainFrame.DataParser.getNodesWithNodeName(n,t)))}return a},getPos:function(e){this.states||(this.states={},this.states.def={});var t=e.attributes.pos,a=MainFrame.Util.processPosition(t);this.positionX=a.x,this.positionY=a.y,this.states.def.x=this.positionX,this.states.def.y=this.positionY,this.setProperty("x",this.positionX),this.setProperty("y",this.positionY)},getSkin:function(e){if(e.attributes&&e.attributes.skin){var t=MainFrame.DataParser.getJSONFromAttribute(e.attributes.skin,",","="),a=!0;MainFrame.DataParser.applySkin.call(this,t,a)}MainFrame.DataParser.getSkinStyle.call(this,e)},getSkinStyle:function(e){if(e.attributes&&e.attributes.skinStyle){var t=MainFrame.Util.processAttribute(e.attributes.skinStyle).interpretedString,a=!0;if(skin=MainFrame.DataParser.getJSONFromAttribute(t,";",":"),skin.attributes&&skin.attributes.id){if(Array.isArray(skin.attributes.id))var i=skin.attributes.id;else var i=[skin.attributes.id];var r=this;i.forEach(function(e){var t=MainFrame.Manager.Skin.getById(e);MainFrame.DataParser.applySkin.call(r,t,a)})}MainFrame.DataParser.applySkin.call(this,skin,a)}},getSkinId:function(e){if(e.attributes&&e.attributes.skinId){var t=e.attributes.skinId,a=-1===t.indexOf(":");if(a){var i=MainFrame.Manager.Skin.getById(t);MainFrame.DataParser.applySkin.call(this,i)}else{var r=t.split(":"),n=r[0],s=r[1],i={};i.attributes={},i.attributes[n]=s,MainFrame.DataParser.applySkin.call(this,i)}}},getSize:function(e){if(this.states||(this.states={},this.states.def={}),e.attributes&&e.attributes.size){var t=e.attributes.size.split("|");1===t.length&&(t[1]=t[0]),this.dimensionX=t[0],this.dimensionY=t[1]}else{var a=e.nodeName;if(MainFrame.DataParser.defaultSize[a]){var t=MainFrame.DataParser.defaultSize[a];this.dimensionX=t.width,this.dimensionY=t.height}else"mainframe"!==this.id&&(this.dimensionX="100%",this.dimensionY="100%")}this.states.def.w=this.dimensionX,this.states.def.h=this.dimensionY,this.setProperty("width",this.dimensionX),this.setProperty("height",this.dimensionY)},getSizeFromAttribute:function(e,t){var a=t.attributes[e].split("|"),i={};return i.width=a[0],i.height=a[1],i},getScaleWithCatalog:function(e){if(e.attributes&&"true"===e.attributes.scaleWithCatalog){var t=e.attributes.catalogId||"catalog";this.scaleWithCatalog=!0;var a=this;MainFrame.Publisher.subscribe(t+":resized",a,function(){var e=MainFrame.Manager.Scoping.getById(t),i=e.pageScale;MainFrame.Util.setPosition(a.containerElement,0,0,i,!0)})}},getSourceModule:function(e){e.attributes.source&&(this.sourceModuleId=e.attributes.source,this.sourceModule=MainFrame.Manager.Scoping.getById(this.sourceModuleId))},getSrc:function(e){var t=MainFrame.Util.processAttribute(e.attributes.src).interpretedString;if(t)if(t.indexOf("#")>-1&&-1===t.indexOf("{"))this.containerElement.style.backgroundColor=t;else{var a=MainFrame.Util.createElement("img","",this.containerElement);t=MainFrame.Util.localizePath(t),t=escape(t);var i=!MainFrame.Util.isAbsoluteUrl(t);a.src=i?-1===t.indexOf("/")?MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+t:MainFrame.Util.getAppURL()+t:t,a.style.width="100%",a.style.height="100%"}},getState:function(e,t){var a=MainFrame.Util.processAttribute(e.attributes[t]).interpretedString;this.states||(this.states={},this.states.def={}),this.states[t]={};for(var t=this.states[t],i={},r=a.split(","),n=0,s=r.length;s>n;n++){var o=r[n].split("="),l=o[0],c=o[1],d=-1!==l.indexOf(".")&&0!==l.indexOf("skin.");if(d){var g=l.split("."),h=g[0],u=g.splice(1).join(".");i[h]||(i[h]={}),i[h][u]=c}else t[l]=c}t.childrenAffected=i},getStateStyle:function(e,t){var a={},i={},r=MainFrame.Util.processAttribute(t).interpretedString,n=MainFrame.DataParser.getJSONFromAttribute(r,";",":");if(n.attributes){if(n.attributes.state){var s=n.attributes.state,o=this.states[s];if(o)for(var l in o){var c=o[l];a[l]=c}}for(var l in n.attributes){var c=n.attributes[l],d=-1!==l.indexOf(".")&&0!==l.indexOf("skin.");if(d){var g=l.split("."),h=g[0],u=g.splice(1).join(".");i[h]||(i[h]={}),i[h][u]=c}else a[l]=c}}a.childrenAffected=i,this.states[e]=a},getStates:function(e){this.states||(this.states={},this.states.def={});var t=!1;if(e.attributes.over&&(MainFrame.DataParser.getState.call(this,e,"over"),t=!0),e.attributes.overStyle){var a=e.attributes.overStyle;MainFrame.DataParser.getStateStyle.call(this,"over",a),t=!0}if(e.attributes.select&&(MainFrame.DataParser.getState.call(this,e,"select"),t=!0),e.attributes.selectStyle){var a=e.attributes.selectStyle;MainFrame.DataParser.getStateStyle.call(this,"select",a),t=!0}if(e.attributes.disable&&(MainFrame.DataParser.getState.call(this,e,"disable"),t=!0),e.attributes.disableStyle){var a=e.attributes.disableStyle;MainFrame.DataParser.getStateStyle.call(this,"disable",a),t=!0}this.hasStates=t,t&&this.setAction("id:setState")},getTemplateParams:function(e){if(e.attributes.templateParams){var t=e.attributes.templateParams;return MainFrame.DataParser.parseTemplatesParamsString(t,",","=")}return{}},getTint:function(e){var t=null;if(e.attributes.tint)t=e.attributes.tint,t=MainFrame.Util.processAttribute(t).interpretedString;else{var a=this.superObject;a&&a._properties&&null!==a._properties.original.tint&&"undefined"!=typeof a._properties.original.tint&&(t="")}null!==t&&"undefined"!=typeof t&&(this.containerElement.style.color=t,this.setProperty("tint",t),this.states.def.tint=t)},getTopRightBottomLeftValues:function(e,t){t||(t="|");var a=e.split(t),i={};return 2===a.length?(i.top=a[0],i.bottom=a[0],i.left=a[1],i.right=a[1]):4===a.length&&(i.top=a[0],i.right=a[1],i.bottom=a[2],i.left=a[3]),i},getTrigger:function(e){return e.attributes.trigger?e.attributes.trigger:null},getType:function(e){e.attributes.type&&(this.type=e.attributes.type)},getVisible:function(e){var t=e.attributes.visible,a=MainFrame.Util.processAttribute.call(this,t);if(a.dependencies.length){var i=this;a.dependencies.forEach(function(e){if("visibility"===e.type){var a=e.id;MainFrame.Publisher.subscribe(a+":visibilityChanged",i,function(){MainFrame.DataParser.parseVisibleString.call(i,t)})}})}MainFrame.DataParser.parseVisibleString.call(this,t)},parseVisibleString:function(e){var t=MainFrame.Util.processAttribute.call(this,e).interpretedString,a="false"===t,i="0"===t,r=""===t,n="null"===t,s="undefined"===t;this.setVisible(a||i||r||n||s?!1:!0)},getVisibleOffline:function(e){var t=e.attributes.visibleOffline;"false"!==t&&"0"!==t||!MainFrame.Browser.isFileProtocol||this.setVisible(!1)},interpretObjectString:function(e,t){var a=t;e=e.replace(/\[\'/,"."),e=e.replace(/\[\"/,"."),e=e.replace(/\'\]\./,"."),e=e.replace(/\"\]\./,"."),e=e.replace(/\'\]/,""),e=e.replace(/\"\]/,"");for(var i=e.split("."),r=0,n=i.length;n>r;r++){var s=i[r],o=!1,l=!1,c=null,d=s.match(/\[(.*)\]/);d&&(c=d[1],c=c.replace(/\'|\"/g,""),o=!0,s=s.split("[")[0]),"undefined"!=typeof a[s]?o&&a[s][c]?(a=a[s][c],l=!0):a=a[s]:a.attributes&&a.attributes[s]?a=a.attributes[s]:a.children&&a.children[s]?o&&a.children[s][c]?(a=a.children[s][c],l=!0):a=a.children[s]:a.list?a=a.list:o&&!l&&(a="")}return a.value&&(a=a.value),"undefined"!=typeof a&&"object"!=typeof a?a:""},interpretTemplateString:function(e){var t=e.attributes.template,a=MainFrame.DataParser.parseTemplatesParamsString(t,";",":"),i=a&&a.id;if(i){var r=a.id;delete a.id,e=MainFrame.DataParser.applyTemplate(e,r,a)}return e},parseChildren:function(e){this.contentElement||this.createContentElement();var t=MainFrame.DataParser.getChildren.call(this,e);if(t&&t.length>0)for(var a=0,i=t.length;i>a;a++){var r=t[a],n=MainFrame.DataParser.createElement.call(this,r);if(n&&this.layout){var s=0,o=0;if(this.subObjects&&this.subObjects.length>1){var l=this.subObjects.length-2,c=this.subObjects[l];"horizontal"===this.layout?(s="{#"+c.id+".after}",this.spacing.x&&(s+="+"+this.spacing.x)):"vertical"===this.layout&&(o="{#"+c.id+".under}",this.spacing.y&&(o+="+"+this.spacing.y))}0!=s&&n.setPositionX(s),0!=o&&n.setPositionY(o);var d=a===i-1;if(d)if("horizontal"===this.layout){var g=n.getDimensionX(),h=n.getPositionX(),u=h+g;this.setDimensionX(u)}else if("vertical"===this.layout){var m=n.getDimensionY(),p=n.getPositionY(),f=p+m;this.setDimensionY(f)}}}},getChildren:function(e){var t=[];if(e.childNodes&&e.childNodes.length>0)for(var a=0,i=e.childNodes.length;i>a;a++){var r=e.childNodes[a],n="conditions"===r.nodeName;if(n){var s=MainFrame.DataParser.parseCondition.call(this,r);t=t.concat(s)}else t.push(r)}return t},parseCondition:function(e){for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t];if("condition"===i.nodeName){var r=i.attributes,n=!0;for(var s in r){var o=r[s];if("orientation"===s&&(MainFrame.Publisher.subscribe("orientationChanged",this,this.refresh),!MainFrame.Util.validateConditionOrientation(o))){n=!1;break}if("device"===s&&!MainFrame.Util.validateConditionDevice(o)){n=!1;break}var l=-1!==s.toLowerCase().indexOf("width")||-1!==s.toLowerCase().indexOf("height");if(l){switch(MainFrame.Util.bindConditionResize(this),s){case"minWidth":n=MainFrame.Util.validateConditionMinWidth(o);break;case"maxWidth":n=MainFrame.Util.validateConditionMaxWidth(o);break;case"minHeight":n=MainFrame.Util.validateConditionMinHeight(o);break;case"maxHeight":n=MainFrame.Util.validateConditionMaxHeight(o)}if(n===!1)break}}if(n)return i.childNodes}else if("def"===i.nodeName)return i.childNodes}return[]},parseAttributes:function(e){var t={};if(e.attributes)for(var a=e.attributes,i=0,r=a.length;r>i;i++){var n=a[i],s=n.nodeName;attributeValue="undefined"!=typeof n.value?n.value:"undefined"!=typeof n.textContent?n.textContent:"",t[s]=attributeValue}return t},parseNodeToObject:function(e){for(var t={},a=e,i=a.childNodes.length,r=0;i>r;r++){var n=a.childNodes[r];t[n.nodeName]=n.value}return t},parseTemplatesParamsString:function(e,t,a){var i=e.split(t),r={};return i.forEach(function(e){var t=e.split(a),i=t[0],n=t[1];r[i]=n}),r},parseCSV:function(e,t){var a=e.split("\n"),i={},r=t.separator||",";if(a.length){if("true"===t.firstRowFields||t.firstRowFields===!0)var n=a.splice(0,1)[0],s=n.split(r);else var s=t.fieldNames;for(var o=0,l=a.length,c=s.length;l>o;o++){var d={},g=a[o],h=g.split(r);if(""!==g){for(var u=0;c>u;u++){var m=s[u];d[m]=h[u]}if(t.idField&&d[t.idField])var p=d[t.idField];else var p=o;i[p]=d}}}else MainFrame.Util.showError("CSV parsing error!");return i},parseXml:function(e){var t={};if(t.nodeName=e.nodeName,t.childNodes=[],t.attributes=MainFrame.DataParser.parseAttributes(e),"html"!==t.nodeName){if(e.childNodes&&e.childNodes.length){var a=4===e.childNodes[0].nodeType||e.childNodes[1]&&4===e.childNodes[1].nodeType,i=1===e.childNodes.length&&3===e.childNodes[0].nodeType?!0:!1;if(a){var r=4===e.childNodes[0].nodeType?e.childNodes[0]:e.childNodes[1],n=r.textContent||r.text;t.value=n}else if(i)t.value=e.textContent||e.text;else for(var s=0,o=e.childNodes.length;o>s;s++){var l=e.childNodes[s];if(1===l.nodeType){var c=MainFrame.DataParser.parseXml(l);t.childNodes.push(c)}}}}else if(e.childNodes.length){if(XMLSerializer){var d=MainFrame.Util.serializeXmlNode(e.children[0]);d=d.replace("<code>",""),d=d.replace("</code>","")}t.html=d}return t},registerInManager:function(e,t,a,i,r){if(r){var n=MainFrame.DataParser.getChildrenWithNodeName(r,t);if(n.length){var s=n[0];MainFrame.DataParser.registerDataInManager(e,a,i,s)}}},registerDataInManager:function(e,t,a,i,r){var n=t?MainFrame.DataParser.getChildrenWithNodeName(i,t):i.childNodes;n.forEach(function(i){var n=i.attributes[a],s=0!==i.childNodes.length;(r&&s||!r)&&("undefined"!=typeof n&&"undefined"!=typeof e.list[n]&&MainFrame.Util.warn("Warning: the <"+t+'> element with the id "'+n+'" was already registered and will be overwritten.'),e.register(n,i))})},setPos:function(e){if(this.states||(this.states={},this.states.def={}),e){var t=e.split("|"),a=t[0],i=t[1];-1!==a.indexOf("center")&&(a=a.replace("center","50%-w/2")),-1!==a.indexOf("left")&&(a=a.replace("left","0")),-1!==a.indexOf("right")&&(a=a.replace("right","100%-w")),-1!==i.indexOf("center")&&(i=i.replace("center","50%-h/2")),-1!==i.indexOf("top")&&(i=i.replace("top","0")),-1!==i.indexOf("bottom")&&(i=i.replace("bottom","100%-h")),this.positionX=a,this.positionY=i}else this.positionX="0",this.positionY="0";this.states.def.x=this.positionX,this.states.def.y=this.positionY},setSize:function(e,t){if(this.states||(this.states={},this.states.def={}),e){var a=e.split("|");this.dimensionX=a[0],this.dimensionY=a[1]}else if(MainFrame.DataParser.defaultSize[t]){var e=MainFrame.DataParser.defaultSize[t];this.dimensionX=e.width,this.dimensionY=e.height}else this.dimensionX="100%",this.dimensionY="100%";this.states.def.w=this.dimensionX,this.states.def.h=this.dimensionY},parseDetails:function(e){MainFrame.DataParser.parseSystem.call(this,e);for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t],r=i.attributes.id,n=i.nodeName;"template"===n&&MainFrame.Manager.Template.register(r,i),"actionDesc"===n&&MainFrame.Manager.ActionDesc.register(r,i),"actionLib"===n&&MainFrame.Manager.ActionLib.register(r,i),"skin"===n&&(r=i.attributes.skinId,MainFrame.Manager.Skin.register(r,i)),"txtStyle"===n&&MainFrame.Manager.TxtStyle.register(r,i),"resource"===n&&MainFrame.Manager.Resource.register(r,i),"slider"===n&&MainFrame.Manager.Slider.register(r,i)}},getDataAsObject:function(e){var t={};return e.childNodes.forEach(function(e){var a={};for(var i in e.attributes)a[i]=e.attributes[i];if(e.childNodes.length){var r=MainFrame.DataParser.getDataAsObject(e);for(var i in r)a[i]=r[i]}var n=e.nodeName;if(t[n]){if(!t[n].length){var s=t[n];t[n]=[],t[n].push(s)}t[n].push(a)}else t[n]=a}),t},parseXmlFlux:function(e){var t={};if(e.attributes&&e.attributes.length&&(t.attributes=MainFrame.DataParser.parseAttributes(e)),t.nodeName=e.nodeName,e.childNodes&&e.childNodes.length){var a=MainFrame.DataParser.getCDATA(e);null!==a?t.value=a:MainFrame.DataParser.addChildren(e,t)}return t},getCDATA:function(e){var t=4===e.childNodes[0].nodeType||e.childNodes[1]&&4===e.childNodes[1].nodeType,a=1===e.childNodes.length&&3===e.childNodes[0].nodeType?!0:!1;if(t){var i=4===e.childNodes[0].nodeType?e.childNodes[0]:e.childNodes[1];return"undefined"!=typeof i.textContent?i.textContent:i.text}return a?"undefined"!=typeof e.textContent?e.textContent:e.text:null},addChildren:function(e,t){var a=0,i=e.childNodes.length;if(i)for(t.nodeName=e.nodeName,t.children={},t.childNodes=[];i>a;a++){var r=e.childNodes[a],n=r.nodeName;if(r.attributes){var s=MainFrame.DataParser.parseXmlFlux(r);t.childNodes.push(s),MainFrame.DataParser.isChildWithUniqueTagName(e,n)?t.children[n]=s:(t.children[n]||(t.children[n]=[]),t.children[n].push(s))}}},isChildWithUniqueTagName:function(e,t){var a=e.getElementsByTagName(t).length;if(0===a||1===a)return!0;for(var i=0,r=e.childNodes.length,n={};r>i;i++){var s=e.childNodes[i],o=s.nodeName;if(o===t&&n[t])return!1;n[o]=!0}return!0}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),!function(){var Parsers={parseAppConfig:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"resUrl");this.resURL=t?t.value:MainFrame.Global.initializationVariables.appFolder+"/res/";var a=MainFrame.DataParser.getNodeNamed(e,"dataUrl");this.dataURL=a?a.value:MainFrame.Global.initializationVariables.appFolder+"/data/";var i=MainFrame.DataParser.getNodeNamed(e,"commonUrl");this.commonURL=i?i.value:"common/";var r=MainFrame.DataParser.getNodeNamed(e,"dataCaching");this.usesLocalStorage=r&&"false"===r.value?!1:!0;var n=MainFrame.DataParser.getNodeNamed(e,"deepLinking");n?MainFrame.DataParser.parseDeepLinking.call(this,n):MainFrame.Router.active=!1;var s=MainFrame.DataParser.getNodeNamed(e,"tracking");this.hasTracking=s&&"false"!==s.attributes.enabled?!0:!1,this.hasTracking&&MainFrame.DataParser.parseTrackingSettings(s);var o=MainFrame.DataParser.getNodeNamed(e,"tapEffect"),l=o&&"true"===o.attributes.enabled;this.tapEffect={},l?(this.tapEffect.enabled=!0,MainFrame.DataParser.parseTapEffect.call(this,o)):this.tapEffect.enabled=!1;var c=MainFrame.DataParser.getNodeNamed(e,"appId");this.appId=c?c.value:MainFrame.Util.generateAppId(),MainFrame.DataParser.parseSharing.call(this,e)},parseDeepLinking:function(e){MainFrame.Router.active="true"===e.attributes.active?!0:!1;var t=!1,a=!1,i=MainFrame.DataParser.getChildrenWithNodeName(e,"path");if(i&&i.forEach(function(e){var i={};i.id=e.attributes.id,"page"===i.id?t=!0:"product"===i.id&&(a=!0);var r=MainFrame.DataParser.getNodeNamed(e,"hash");i.hash=r?r.value:i.id,MainFrame.Router.registerPath(i)}),!t){var r={};r.id="page",r.hash="page/:value",MainFrame.Router.registerPath(r)}if(!a){var r={};r.id="product",r.hash="product/:value",MainFrame.Router.registerPath(r)}},parseTapEffect:function(e){var t=e.attributes.type||"boris",a=0,i=-4;"undefined"!=typeof e.attributes.differenceX&&(a=parseInt(e.attributes.differenceX,10)),"undefined"!=typeof e.attributes.differenceY&&(i=parseInt(e.attributes.differenceY,10)),this.tapEffect.type=t,this.tapEffect.differenceX=a,this.tapEffect.differenceY=i},parseSharing:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"sharing");if(t){this.sharingSettings={};var a={};a["default"]="index.html";var i=MainFrame.DataParser.getChildrenWithNodeName(t,"shareUrl");i.forEach(function(e){var t=e.attributes.type,i=e.value;a[t]=i}),this.sharingSettings.types=a}},parseCheck:function(e){var t=!1;if(MainFrame.DataParser.basicParse.call(this,e,t),e.attributes.value&&(this.value=e.attributes.value),e.attributes.selected){var a="true"===e.attributes.selected?!0:!1;this.containerElement&&a&&this.containerElement.setAttribute("checked",a)}else var a=!1;if(this.checked=a,e.childNodes.length>1)for(var i=0,r=e.childNodes.length;r>i;i++){var n=e.childNodes[i];if("on"===n.nodeName){var s=new MainFrame.Element.Item({superObject:this,data:n});a===!1&&s.setVisible(!1),this.onElement=s}if("off"===n.nodeName){var o=new MainFrame.Element.Item({superObject:this,data:n});a===!0&&o.setVisible(!1),this.offElement=o}}MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e))},parseCode:function(data){MainFrame.Code.init();var code=data.value,interpretedCode=MainFrame.Code.interpretCode(code);try{eval(interpretedCode)}catch(e){MainFrame.Util.showError("There was an error inside the global code! Error details: "+e)}},parseSelectOptions:function(e){if(this.options||(this.options=[]),e.childNodes.length>0){for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t];if(i.attributes){var r={};i.attributes.value&&(r.value=i.attributes.value),i.attributes.label&&(r.label=i.attributes.label),this.options.push(r)}}this.buildOptions()}},parseSelect:function(e){if(MainFrame.DataParser.basicParse.call(this,e),e.attributes.defaultLabel){var t={};t.label=e.attributes.defaultLabel,t.value=e.attributes.defaultValue,this.options||(this.options=[]),this.options.push(t)}if(e.attributes.autofocus&&"true"===e.attributes.autofocus&&(this.autofocus=!0,this.contentElement.setAttribute("autofocus",this.autofocus)),e.attributes.disabled&&(this.disabled="true"===e.attributes.disabled?!0:!1,this.disabled&&this.contentElement.setAttribute("disabled","true")),e.attributes.multiple&&"true"===e.attributes.multiple&&(this.multiple=!0,this.contentElement.setAttribute("multiple","multiple")),e.attributes.selectedIndex&&(this.selectedIndex=e.attributes.selectedIndex,this.contentElement.selectedIndex=this.selectedIndex),e.attributes.selectSize&&(this.selectSize=e.attributes.selectSize,this.contentElement.setAttribute("size",this.selectSize)),e.attributes.source){var a=MainFrame.Util.getForSource(e.attributes.source);""!==a&&this.addOptions(a)}if(e.attributes.range){for(var i=e.attributes.range,r=i.split("-"),n=parseInt(r[0],10),s=parseInt(r[1],10),o=n,l=[];s>=o;o++)l.push({value:o,label:o+""});this.addOptions(l)}MainFrame.DataParser.parseSelectOptions.call(this,e)},parseConfirmation:function(e){MainFrame.DataParser.basicParse.call(this,e)},parseElement:function(e){MainFrame.DataParser.basicParse.call(this,e),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e)),MainFrame.EventHandler.dispatch(this.id+"_ready"),MainFrame.EventHandler.dispatch("#"+this.id+".ready")},parseEmbedded:function(e){MainFrame.DataParser.basicParse.call(this,e),this.containerElement.innerHTML=e.value},parseHtml:function(e){if(MainFrame.DataParser.basicParse.call(this,e,!1),e.html){var t=!0;this.contentElement.innerHTML=e.html,MainFrame.DataParser.bindHtmlActions(this.contentElement,this,t)}else if(e.attributes.src){var a=this,t=!1;MainFrame.Util.request({url:e.attributes.src,xmlResponse:!1,onSuccess:function(e){a.contentElement.innerHTML=e,MainFrame.DataParser.bindHtmlActions(a.contentElement,a,t)}})}},bindHtmlActions:function(e,t,a){if("style"===e.nodeName.toLowerCase()&&a){var i=e.innerHTML;i=i.replace("<![CDATA[",""),i=i.replace("]]>",""),e.innerHTML=i}else if("script"===e.nodeName.toLowerCase()&&a){var i=e.innerHTML;i=i.replace("<![CDATA[",""),i=i.replace("]]>","");var r=document.createElement("script");r.text=i,e.parentNode.appendChild(r)}else{var n=e.getAttribute("action"),s=e.getAttribute("data-item-id"),o=new MainFrame.Element.HtmlItem({id:s,containerElement:e,superObject:t});if(n){var l=!1;o.setAction(n,l)}if(e.children)for(var c=0,d=e.children.length;d>c;c++){var g=e.children[c];MainFrame.DataParser.bindHtmlActions(g,o)}}},parseHelp:function(e){MainFrame.DataParser.basicParse.call(this,e),this.templateName=e.attributes.templateName||"helpTemplate_",this.fitType=e.attributes.fitType||"none"},parseImage:function(e){MainFrame.DataParser.basicParse.call(this,e,!1),e.attributes.fill&&"true"===e.attributes.fill&&(this.fill=!0,this.dimensionX="100%",this.dimensionY="100%",this.positionX="50%-w/2",this.positionY="50%-h/2");var t=e.attributes.proportions;("proportionalInside"===t||"fit"===t)&&(this.fillType="fit"),("proportionalOutside"===t||"fill"===t)&&(this.fillType="fill"),e.attributes.fallbackSrc&&(this.fallbackSrc=e.attributes.fallbackSrc),e.attributes.src&&this.setSource(e.attributes.src)},parseLanguage:function(e,t){if(e.attributes.src){var a=MainFrame.Util.getAppURL()+e.attributes.src;MainFrame.Util.request({url:a,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(e){MainFrame.DataParser.parseTranslation(e),t&&t()}})}},parseLibraries:function(){for(var e in MainFrame.Manager.LibraryNode.list){var t=MainFrame.Manager.LibraryNode.getById(e);MainFrame.DataParser.parseLibrary(t)}},parseLibrary:function(e){var t=e.attributes.id,a=MainFrame.Manager.Library.getById(t);if(!a){var i=MainFrame.Util.getAppURL()+e.attributes.src,r=i&&-1!==i.indexOf(".xml"),n=i&&-1!==i.indexOf(".zip"),s=i&&-1!==i.indexOf(".js"),o=i&&-1!==i.indexOf(".csv"),l=new MainFrame.Abstract.Library;l.load({url:i,isXML:r,isJSON:s,isZip:n,isCSV:o,csvConfig:{firstRowFields:e.attributes.firstRowFields,separator:e.attributes.separator,idField:e.attributes.idField}}),MainFrame.Manager.Library.register(t,l)}},parseObject:function(e){MainFrame.DataParser.basicParse.call(this,e,!1),e.attributes.type&&this.setType(e.attributes.type),e.attributes.data&&this.setData(e.attributes.data)},parsePreload:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"load");if(t){for(var a=[],i=0,r=t.childNodes.length;r>i;i++){var n=t.childNodes[i];a.push(n),this.totalItemsToLoad++}this.preloadItems(a)}},parseRadio:function(e){MainFrame.DataParser.basicParse.call(this,e),e.attributes.name&&(this.name=e.attributes.name,this.containerElement&&this.containerElement.setAttribute("name",this.name)),e.attributes.value&&(this.value=e.attributes.value),e.attributes.selected&&(this.selected="true"===e.attributes.selected?!0:!1,this.containerElement&&this.selected&&(this.containerElement.setAttribute("checked",this.selected),MainFrame.Manager.RadioList.register(this.name,this.value))),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e))},parseRepeat:function(e){var t=!1;MainFrame.DataParser.basicParse.call(this,e,t),MainFrame.DataParser.getLoadingTemplateId.call(this,e);var a=(e.attributes.layout||"vertical",e.attributes["for"]);if(e.childNodes&&e.childNodes.length){this.templates=[];for(var i=0,r=e.childNodes.length;r>i;i++){var n=e.childNodes[i];n.attributes&&this.templates.push(n)}}this.parseFor(a)},parseResource:function(e){MainFrame.DataParser.basicParse.call(this,e),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e))},parseSystem:function(e){if(e){MainFrame.DataParser.registerInManager(MainFrame.Manager.Variables,"variables","var","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Template,"templates","template","id",e),MainFrame.DataParser.parseLibraries(),MainFrame.DataParser.registerInManager(MainFrame.Manager.Skin,"skins","skin","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Skin,"skins","skin","skinId",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Language,"languages","language","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.TxtStyle,"txtStyles","txtStyle","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.ActionLib,"actions","actionLib","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.ActionDesc,"actions","actionDesc","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Condition,"conditions","condition","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Resource,"resources","resource","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Settings,"modules","","id",e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Slider,"sliders","slider","id",e);var t=MainFrame.DataParser.getChildrenWithNodeName(e,"systemResources");t.length&&MainFrame.DataParser.registerInManager(MainFrame.Manager.AltText,"altTexts","altText","id",t[0])}},parseTabs:function(e){MainFrame.DataParser.basicParse.call(this,e),this.defaultPanelId=e.attributes.defaultPanelId,this.defaultPanelIndex=e.attributes.defaultPanelIndex},parseTranslation:function(e){MainFrame.DataParser.registerDataInManager(MainFrame.Manager.Text,"txt","id",e)},parseVideo:function(e){MainFrame.DataParser.basicParse.call(this,e,!1),this.hasControls="false"===e.attributes.controls?!1:!0,this.setControls(),this.autoplay="true"===e.attributes.autoplay?!0:!1,this.setAutoplay(),this.setPoster(e.attributes.poster),e.attributes.formats&&this.setFormats(e.attributes.formats),e.attributes.src&&this.setSource(e.attributes.src)},parseWebview:function(e){MainFrame.DataParser.basicParse.call(this,e,!1),e.attributes.src&&this.setSource(e.attributes.src)}};MainFrame.Util.extend(MainFrame.DataParser,Parsers)}(),!function(){var e={parseHTMLData:function(e){if(!e.getAttribute||"container"!==e.getAttribute("id")){MainFrame.DataParser.parseHTMLElement(e);for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t];i.getAttribute&&MainFrame.DataParser.parseHTMLData(i)}}},parseHTMLElement:function(e){var t=e.getAttribute("data-v7-action");if(t){var a=MainFrame.Util.getMainFrame(),i=e.getAttribute("data-v7-id");if(i)var r=i;var n=new MainFrame.Element.HtmlItem({id:r,superObject:a,containerElement:e});n.setAction(t)}}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),!function(){var e={parseParamsString:function(e,t,a){var i=[];if(e)for(var r=e.split(t),n=0,s=r.length;s>n;n++){var o=r[n].split(a);if(2===o.length){var l=o[0],c=o[1],d={};d[l]=c,i.push(d)}else if(1===o.length&&i.length){var c=o[0];d[l]=d[l]+","+c}else if(o.length){var l=o.shift(),c=o.join(a),d={};d[l]=c,i.push(d)}}return i},parseActionDescription:function(e){var t=new MainFrame.ActionDescription,a=e.attributes.name,i=[];a&&(i=a.split("|"));for(var r=0,n=i.length;n>r;r++)t.addActionName(i[r]);if(e.attributes.target){var s=e.attributes.target;this.targetId=MainFrame.Util.processTarget.call(this,s)}if(t.setTargetId(this.targetId),e.attributes.params){var o=MainFrame.DataParser.parseParamsString(e.attributes.params,",","=",this.actionParamsObj);t.addParams(o)
}else t.addParam({});if(t.actionParams[0]&&(t.actionParams[0]._wait=!0),e.attributes.wait){var l=e.attributes.wait;"false"===l&&(t.actionParams[0]._wait=!1)}if(e.attributes.condition){var c=e.attributes.condition;t.actionParams[0]._condition=c}if(e.attributes.conditionId){var d=e.attributes.conditionId;t.actionParams[0]._conditionId=d}if(e.value){var g=e.value;t.addDynamicCode(g)}return t.actionParams[0]._actionParams=this.actionParamsObj,t},parseActionLib:function(e,t){var a=[],i=e.attributes.id||e.attributes.name,r=MainFrame.Manager.ActionLib.getById(i);if(r){var n=e.attributes.condition||r.attributes.condition,s=e.attributes.conditionId||r.attributes.conditionId;if(e.attributes.params)for(var o=MainFrame.DataParser.parseParamsString(e.attributes.params,",","="),l=0,c=o.length;c>l;l++){var d=o[l];for(var g in d)this.actionParamsObj[g]=d[g]}if(e.attributes.condition)var h=e.attributes.condition;for(var u=0,m=r.childNodes.length;m>u;u++){var p=r.childNodes[u];if("action"===p.nodeName){for(var f=MainFrame.DataParser.parseActionDescription.call(this,p),v=0,M=f.actionParams.length;M>v;v++){var b=f.actionParams[v];for(var g in b)this.actionParamsObj[g]&&(b[g]=this.actionParamsObj[g])}var F=f.actionParams[0];n&&(F._condition=n),h&&(F._condition?F._condition+="&&"+h:F._condition=h),t&&(F._condition?F._condition+="&&"+t:F._condition=t),s&&(F._conditionId=s),a.push(f)}else if("actionLib"===p.nodeName){var A=p.attributes.name||p.attributes.id,P=MainFrame.Manager.ActionLib.getById(A);if(P){var y=MainFrame.DataParser.parseActionLib.call(this,P),C=p.attributes.condition;if("undefined"!=typeof C)for(var l=0,c=y.length;c>l;l++){var E=y[l];if(E&&E.actionParams&&E.actionParams[0]){var F=E.actionParams[0];F._condition=C}}a=a.concat(y)}}else MainFrame.Util.showError('ActionLib parsing error! The node with the node name "'+p.nodeName+'" is not suported inside an actionLib!')}}else MainFrame.Util.showError('ActionLib parsing error! The actionLib "'+e.attributes.name+'" is used without being defined. Please create the actionLib first');return a},parseActionQueue:function(e,t){for(var a=[],i=e.childNodes,r=0,n=i.length;n>r;r++){var s=i[r];if(s.attributes)if("action"===s.nodeName){var o=MainFrame.DataParser.parseActionDescription.call(this,s);t&&o&&o.actionParams&&o.actionParams[0]&&(o.actionParams[0]._condition=t),a.push(o)}else if("actionLib"===s.nodeName){var l=MainFrame.DataParser.parseActionLib.call(this,s,t);a=a.concat(l)}else"condition"===s.nodeName?a.push(MainFrame.DataParser.parseActionCondition.call(this,s)):MainFrame.Util.showError('ActionQueue parsing error! The node with the node name "'+s.nodeName+'" is not suported inside an actionQueue!')}return a},parseActionCondition:function(e){var t=e.attributes.description,a=MainFrame.DataParser.parseActionQueue.call(this,e),i={};return i.condition=t,i.actions=a,i}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),!function(){var e={parseTxt:function(e){var t="fontIcon"===e.nodeName;if(t){e.attributes.font="v7-font-icon",e.attributes.align="center";var a=e.attributes.name;a&&(e.attributes.class=a)}if(MainFrame.DataParser.getId.call(this,e),e.attributes.templateId){var i=e.attributes.templateId,r=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,i,r)}if(e.attributes&&e.attributes.role&&(this.role=e.attributes.role),MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getSkin.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getAlpha.call(this,e),MainFrame.DataParser.getVisible.call(this,e),MainFrame.DataParser.getClass.call(this,e),MainFrame.DataParser.getStyles.call(this,e),MainFrame.DataParser.getSliderId.call(this,e),e.attributes.defaultTextId){this.defaultTextId=e.attributes.defaultTextId;var n=MainFrame.Manager.Text.getById(this.defaultTextId);this.setText(n)}if(e.attributes.autosaveType&&(this.autosaveType=e.attributes.autosaveType),e.attributes.placeholderTextId){this.placeholderTextId=e.attributes.placeholderTextId;var s=MainFrame.Manager.Text.getById(this.placeholderTextId);this.setPlaceholderText(s)}var o=e.attributes.txtStyle||"default";if(-1===o.indexOf(":")){var l=MainFrame.Manager.TxtStyle.getById(o);MainFrame.DataParser.applyTxtStyle.call(this,l)}else{var l=MainFrame.Util.processAttribute(e.attributes.txtStyle).interpretedString,c=MainFrame.DataParser.getJSONFromAttribute(l,";",":");if(c.attributes&&c.attributes.id){if(Array.isArray(c.attributes.id))var d=c.attributes.id;else var d=[c.attributes.id];var g=this;d.forEach(function(e){var t=MainFrame.Manager.TxtStyle.getById(e);MainFrame.DataParser.applyTxtStyle.call(g,t)})}MainFrame.DataParser.applyTxtStyle.call(this,c)}if(MainFrame.DataParser.applyTxtStyle.call(this,e),MainFrame.DataParser.getTint.call(this,e),e.attributes.autoshrink&&(this.hasAutoshrink="true"===e.attributes.autoshrink?!0:!1,this.minimumFontSize=9),e.attributes.autoresize&&(this.autoresizeType=e.attributes.autoresize,this.hasAutoresize=!0),e.attributes.minimumFontSize&&(this.minimumFontSize=parseInt(e.attributes.minimumFontSize,10)),e.attributes.defaultText){this.originalText=e.attributes.defaultText;var n=MainFrame.Util.processAttribute(e.attributes.defaultText).interpretedString;this.setText(n)}if(e.attributes.placeholderText){this.placeholderText=e.attributes.placeholderText;var s=MainFrame.Util.processAttribute(e.attributes.placeholderText).interpretedString;this.setPlaceholderText(s)}e.attributes.required&&(this.isRequired="true"===e.attributes.required?!0:!1),e.attributes.restrict&&(this.characterRestriction=e.attributes.restrict,"0-9"===this.characterRestriction&&this.containerElement.setAttribute("type","number")),this.isRequired&&"email"===e.attributes.inputType&&(this.emailValidation=!0),e.value&&this.setText(e.value),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e)),MainFrame.DataParser.getAction.call(this,e)},applyTxtStyle:function(e){if(e){this.states||(this.states={},this.states.def={});for(var t in e.attributes)switch(t){case"templateId":var a=e.attributes.templateId,i=MainFrame.DataParser.getTemplateParams(e);MainFrame.DataParser.applyTemplate(e,a,i);break;case"selectable":"0"===e.attributes.selectable&&(this.containerElement.style[MainFrame.Browser.vendorPrefix+"UserSelect"]="none",("O"===MainFrame.Browser.vendorPrefix||"ms"===MainFrame.Browser.vendorPrefix)&&this.containerElement.setAttribute("unselectable","on"),this.containerElement.setAttribute("readonly","true"));break;case"autoSize":var r=e.attributes.autoSize;this.autoresizeType=r,this.hasAutoresize=!0;break;case"wordWrap":"0"!==e.attributes.wordWrap&&(this.containerElement.style.wordWrap="break-word");break;case"maxChars":"0"!==e.attributes.maxChars&&this.containerElement.setAttribute("maxlength",e.attributes.maxChars);break;case"displayAsPassword":"0"!==e.attributes.displayAsPassword&&this.txtType&&"input"===this.txtType&&this.containerElement.setAttribute("type","password");break;case"font":var n=MainFrame.Util.processAttribute(e.attributes.font).interpretedString;this.containerElement.style.fontFamily=n;break;case"size":var s=e.attributes.size;-1===s.indexOf("|")&&(s=MainFrame.Util.processAttribute(s).interpretedString,this.containerElement.style.fontSize=s+"px",this.fontSize=s);break;case"textSize":var s=e.attributes.textSize;s=MainFrame.Util.processAttribute(s).interpretedString,this.containerElement.style.fontSize=s+"px",this.fontSize=s;break;case"color":var o=MainFrame.Util.processAttribute(e.attributes.color).interpretedString;0===o.indexOf("0x")&&(o=o.replace("0x","#")),this.containerElement.style.color=o,this.states.def.textColor=o;break;case"bold":"0"!==e.attributes.bold&&(this.containerElement.style.fontWeight="bold");break;case"italic":"0"!==e.attributes.italic&&(this.containerElement.style.fontStyle="italic");break;case"underline":"0"!==e.attributes.underline&&(this.contentElement.style.textDecoration="underline");break;case"striketrough":"0"!==e.attributes.striketrough&&(this.contentElement.style.textDecoration="line-through");break;case"align":this.containerElement.style.textAlign=e.attributes.align;break;case"leading":"0"!==e.attributes.leading&&(this.containerElement.style.lineHeight=e.attributes.leading);break;case"leftMargin":"0"!==e.attributes.leftMargin&&(this.containerElement.style.paddingLeft=e.attributes.leftMargin+"px");break;case"rightMargin":"0"!==e.attributes.rightMargin&&(this.containerElement.style.paddingRight=e.attributes.rightMargin+"px");break;case"indent":"0"!==e.attributes.indent&&(this.containerElement.style.textIndent=e.attributes.indent+"px");break;case"letterSpacing":"0"!==e.attributes.letterSpacing&&(this.containerElement.style.letterSpacing=e.attributes.letterSpacing+"px");break;case"transform":this.containerElement.style.textTransform=e.attributes.transform;break;case"upper":"1"===e.attributes.upper&&(this.containerElement.style.textTransform="uppercase");break;case"upperCase":"1"===e.attributes.upperCase&&(this.containerElement.style.textTransform="uppercase");break;case"lowerCase":"1"===e.attributes.lowerCase&&(this.containerElement.style.textTransform="lowercase");break;case"border":case"borderColor":if("0"!==e.attributes.border&&e.attributes.borderColor){var l=e.attributes.border,c=MainFrame.Util.processAttribute(e.attributes.borderColor).interpretedString;0===c.indexOf("0x")&&(c=c.replace("0x","#")),this.containerElement.style.border=l+"px solid "+c}else"0"===e.attributes.border&&(this.containerElement.style.border="0");break;case"background":case"backgroundColor":if("0"!==e.attributes.background&&e.attributes.backgroundColor){var d=MainFrame.Util.processAttribute(e.attributes.backgroundColor).interpretedString;0===d.indexOf("0x")&&(d=d.replace("0x","#")),this.containerElement.style.backgroundColor=d}break;case"padding":var g=e.attributes.padding+"px";this.containerElement.style.padding=g;break;case"paddingLeft":var h=e.attributes.paddingLeft+"px";this.containerElement.style.paddingLeft=h;break;case"paddingRight":var u=e.attributes.paddingRight+"px";this.containerElement.style.paddingRight=u;break;case"paddingTop":var m=e.attributes.paddingTop+"px";this.containerElement.style.paddingTop=m;break;case"paddingBottom":var p=e.attributes.paddingBottom+"px";this.containerElement.style.paddingBottom=p;break;case"autoReduce":("1"===e.attributes.autoReduce||"true"===e.attributes.autoReduce)&&(this.hasTextOverflow=!0,this.contentElement.style.height="100%",this.contentElement.style.overflow="hidden",this.contentElement.style.whiteSpace="nowrap",this.contentElement.style.textOverflow="ellipsis");break;case"lineHeight":var f=e.attributes.lineHeight+"px";this.containerElement.style.lineHeight=f}}}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.ApplyStateChanges=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("state"),t=this.getTarget(),a=t.states.over,i=t.states.select,r=(t.states.def,!t.disabled);switch(e){case"over":a&&r&&this.setState("over");break;case"toggleSelect":i&&r&&(t.selected?(this.setDefaultState("select"),t.selected=!1):(this.setState("select"),t.selected=!0));break;case"select":r&&(this.setState("select"),t.selected=!0);break;case"deselect":r&&(this.setDefaultState("select"),t.selected=!1);break;case"disable":r&&(this.setState("disable"),t.disabled=!0);break;case"def":r?a&&(t.selected?(this.setDefaultState("over"),this.setState("select")):this.setDefaultState("over")):(this.setDefaultState("disable"),t.disabled=!1)}t.resizeIfNeeded(),this.endAndClearAction()},setDefaultState:function(e){e=e||"def";var t=this.getTarget(),a=t.states.def,i=t.states[e];if(i){for(var r in i){var n=a[r];t.applyProperty(r,n)}var s=i.childrenAffected;s&&this.setChildProperties(s,"def")}},setState:function(e){var t=this.getTarget(),a=t.states[e];for(var i in a){var r=a[i];if("childrenAffected"===i){var n=r;this.setChildProperties(n,e)}else t.applyProperty(i,r)}},setChildProperties:function(e,t){var a=this.getTarget();for(var i in e){var r=a.getSubObjectWithId(i),n=e[i],s=r.states[t]||n;if(r)for(var o in n){var l=s[o];r.applyProperty(o,l),a.duration&&(r.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="all 0.30s ease",r.skinElement&&(r.skinElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="all 0.30s ease"))}}}}),MainFrame.Action.DoCodeFunction=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("name");e&&MainFrame.Global[e]&&"function"==typeof MainFrame.Global[e]&&MainFrame.Global[e](),this.endAndClearAction()}}),MainFrame.Action.ClearTrigger=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("trigger"),t=this.getTarget();MainFrame.EventHandlerCore.removeTriggerForTarget(e,t),this.endAndClearAction()}}),MainFrame.Action.ClearTriggers=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){for(var t=(e.triggers,0),a=e.triggers.length,i=[];a>t;t++){var r=e.triggers[t],n=r.options.triggerName;i.push(n)}for(var t=0,a=i.length;a>t;t++){var s=i[t];MainFrame.EventHandlerCore.removeTriggerForTarget(s,e)}}this.endAndClearAction()}}),MainFrame.Action.Code=MainFrame.Abstract.Action.extend({startAction:function(){var code=this.getParam("code");if(code){code=MainFrame.Code.interpretCode.call(this,code);try{eval(code)}catch(e){MainFrame.Util.showError("There was an error inside a code action! Initiator object: "+this.initiatorObject.id+", trigger: "+this.getParam("trigger")+". Error details: "+e)}}this.endAndClearAction()}}),MainFrame.Action.ConfirmNotification=MainFrame.Abstract.Action.extend({startAction:function(){MainFrame.AltPopOver.hide();var e=MainFrame.Util.getMainFrame();e.actionConfirmed(),this.endAndClearAction()}}),MainFrame.Action.DeclineNotification=MainFrame.Abstract.Action.extend({startAction:function(){MainFrame.AltPopOver.hide();var e=MainFrame.Util.getMainFrame();e.actionCanceled(),this.endAndClearAction()}}),MainFrame.Action.Deselect=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e?e.setState("deselect"):MainFrame.Util.showError('Deselect error! The target with the id "'+this.targetObjectId+'" does not exist'),this.endAndClearAction()}}),MainFrame.Action.Disable=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e?(e.setState("disable"),e.disabled=!0):MainFrame.Util.showError('Disable error! The target with the id "'+this.targetObjectId+'" does not exist'),this.endAndClearAction()}}),MainFrame.Action.DisableTrigger=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("trigger"),t=this.getTarget();t.disabledTriggers||(t.disabledTriggers=[]),t.disabledTriggers.push(e),this.endAndClearAction()}}),MainFrame.Action.Enable=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e?(e.setState("def"),delete e.disabled):MainFrame.Util.showError('Enable error! The target with the id "'+this.targetObjectId+'" does not exist'),this.endAndClearAction()}}),MainFrame.Action.EnableTrigger=MainFrame.Abstract.Action.extend({startAction:function(){var e=(this.getParam("trigger"),this.getTarget());e.disabledTriggers&&(e.disabledTriggers=[],delete e.disabledTriggers),this.endAndClearAction()}}),MainFrame.Action.Eval=MainFrame.Abstract.Action.extend({startAction:function(){var code=this.getParam("code");code&&eval(code),this.endAndClearAction()}}),MainFrame.Action.Select=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e?e.setState("select"):MainFrame.Util.showError('Select error! The target with the id "'+this.targetObjectId+'" does not exist'),this.endAndClearAction()}}),MainFrame.Action.SetAction=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("id");if(e&&t){var a="id:"+t+";",i=[];for(var r in this.paramsObject)if("id"!==r&&"sourceEvent"!==r&&"_wait"!==r&&"trigger"!==r){var n=r+"="+this.getParam(r);i.push(n)}a+="params:"+i.join(","),e.setAction(a)}this.endAndClearAction()}}),MainFrame.Action.SetActionDesc=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("id");if(e&&t){var a="id:"+t;e.setAction(a)}this.endAndClearAction()}}),MainFrame.Action.SetSizePos=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&(this.setSize(e),this.setPos(e),e.resize()),this.endAndClearAction()},setSize:function(e){var t=this.getParam("size");if(t){var a=t.split("|");1===a.length&&(a[1]=a[0]);var i=a[0],r=a[1]}var n=this.getParam("sizeX");if(n)var i=n;var s=this.getParam("sizeY");if(s)var r=s;i&&(e.dimensionX=i,e.states.def.w=e.dimensionX,e.setProperty("width",e.dimensionX)),r&&(e.dimensionY=r,e.states.def.h=e.dimensionY,e.setProperty("height",e.dimensionY))},setPos:function(e){var t=this.getParam("pos");if(t)var a=MainFrame.Util.processPosition(t),i=a.x,r=a.y;var n=this.getParam("posX");if(n)var i=n;var s=this.getParam("posY");if(s)var r=s;i&&(e.positionX=i,e.states.def.x=e.positionX,e.setProperty("x",e.positionX)),r&&(e.positionY=r,e.states.def.y=e.positionY,e.setProperty("y",e.positionY))}}),MainFrame.Action.SetVariable=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("value"),t=this.getParam("name");MainFrame.Manager.Variables.register(t,e),this.endAndClearAction()}}),MainFrame.Action.SetVariables=MainFrame.Abstract.Action.extend({startAction:function(){for(var e in this.paramsObject){var t=-1==="_actionParams,_wait,sourceEvent,trigger".indexOf(e);if(t){var a=this.paramsObject[e],i=e;MainFrame.Manager.Variables.register(i,a)}}this.endAndClearAction()}}),MainFrame.Action.Add=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=this.getTarget(),a=this.getParam("id"),i=a,r="true"===this.getParam("orientationBased")?!0:!1,n="false"===this.getParam("wait")?!1:!0,s="true"!==this.getParam("cumulative"),o=MainFrame.Manager.Scoping.getById(a);if(o&&s){var l=MainFrame.Manager.Scoping.getById(a),c=l.superObject;c.removeSubObject(l)}r&&(1===MainFrame.Browser.orientation?i+="_portrait":2===MainFrame.Browser.orientation&&(i+="_landscape"));var d=MainFrame.Manager.Resource.getById(i);if(t&&d){var g=this.getParam("insertBefore"),h=MainFrame.Manager.Scoping.getById(g),u="undefined"!=typeof MainFrame.EprintShop,m=u&&"undefined"!=typeof MainFrame.EprintShop.currentProduct,p="eps"===d.attributes.bind||"eps"===this.getParam("bind");if(p&&m)var f=JSON.stringify(d),v=MainFrame.EprintShop.fillTemplateWithProductData(f,MainFrame.EprintShop.currentProduct),d=JSON.parse(v);var M=new MainFrame.Element.Resource({id:a,superObject:t,data:d,insertBeforeElement:h}),b=this.getParam("x"),F=this.getParam("y"),A=this.getParam("width"),P=this.getParam("height"),y=!1;b&&(M.setPositionX(b),y=!0),F&&(M.setPositionY(F),y=!0),A&&(M.setDimensionX(A),y=!0),P&&(M.setDimensionY(P),y=!0),y&&M.resize();var C=this.getParam("animation"),E=this.getParam("duration");if(C){M._addAnimation=C,M._addDuration=E,E&&(M.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationDuration"]=E+"s");var S=function(){MainFrame.Event.unbind(M.containerElement,MainFrame.Event.animationEnd,S),n&&(t.layout&&"true"!==e.getParam("blockResize")&&t.resize(),e.endAndClearAction())};n||(t.layout&&"true"!==this.getParam("blockResize")&&t.resize(),this.endAndClearAction()),MainFrame.Event.bind(M.containerElement,MainFrame.Event.animationEnd,S);var w=MainFrame.Util.applyAnimationClassShow(C,M.containerElement);return void(w||(MainFrame.Util.showError('CSS Animation error! The animation class ".'+MainFrame.Util.cssAnimationDict[C]+'" is not declared'),this.endAndClearAction()))}}this.endAndClearAction()}}),MainFrame.Action.Animate=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("duration"),t=this.getParam("delay"),a=this.getParam("wait")||!0,i=this.getParam("easing")||"Power1.easeOut",r=this.getParam("x"),n=this.getParam("y"),s=this.getParam("w"),o=this.getParam("h"),l=this.getParam("rotation"),c=this.getParam("rotationX"),d=this.getParam("rotationY"),g=this.getParam("rotationZ"),h=this.getParam("scaleX"),u=this.getParam("scaleY"),m=this.getParam("scale"),p=this.getParam("alpha"),f=this.getParam("color"),v=this.getTarget(),M=[];if(params={},fromParams={},hasParams=!1,hasFromParams=!1,!v)return console.log(this),MainFrame.Util.showError('Animate error! You are trying to animate the item with the id "'+this.targetObjectId+'" but it does not exist'),void this.endAndClearAction();this.newSize={},this.newSizeValues={},M.push(v.containerElement);var b=this.processEasing(i);b&&(params.ease=b);var F=null!==s||null!==o||null!==r||null!==n;this.sizeChanges=F,F&&(params.width=this.processWidthValue(s),params.height=this.processHeightValue(o),params.left=this.processXValue(r),params.top=this.processYValue(n)),null!==t&&(params.delay=t),null!==l&&(params.rotation=this.processValue(l,"rotation")),null!==c&&(params.rotationX=this.processValue(c,"rotationX")),null!==d&&(params.rotationY=this.processValue(d,"rotationY")),null!==g&&(params.rotationZ=this.processValue(g,"rotationZ")),null!==m&&(hasParams=!0,params.scale=this.processValue(m,"scale")),null!==h&&(hasParams=!0,params.scaleX=this.processValue(h,"scaleX")),null!==u&&(hasParams=!0,params.scaleY=this.processValue(u,"scaleY")),null!==p&&(params.opacity=this.processValue(p,"alpha")),null!==f&&(params.backgroundColor=f),params.onComplete=this.onComplete,params.onCompleteScope=this,params.onStart=this.onStart,params.onStartScope=this,params.onUpdate=this.onUpdate,params.onUpdateScope=this,TweenMax.to(M,e,params),1!=a&&this.endAndClearAction()},processEasing:function(e){if(e&&-1!==e.indexOf(".")){var t=e.split("."),a=t[0],i=t[1],r=window[a];if(r&&r[i])return r[i]}return null},processWidthValue:function(e){var t=this.getTarget();null===e&&(e=t.dimensionX),0>i&&(i=0);var a=t.superObject?t.superObject.getDimensionX():MainFrame.Browser.width,i=t.parseStringExpression(e,a);this.newSizeValues.width=i;var r=(MainFrame.Util.isPercentageValue(e),MainFrame.Util.isPercentageValue(e)),n=-1!==e.indexOf("-")&&0!==e.indexOf("-")||-1!==e.indexOf("+")&&0!==e.indexOf("+")||-1!==e.indexOf("#"),s=r||n;return this.newSize.width=s?e:i,i},processHeightValue:function(e){var t=this.getTarget();null===e&&(e=t.dimensionY);var a=t.superObject?t.superObject.getDimensionY():MainFrame.Browser.height,i=t.parseStringExpression(e,a);0>i&&(i=0),this.newSizeValues.height=i;var r=MainFrame.Util.isPercentageValue(e),n=-1!==e.indexOf("-")&&0!==e.indexOf("-")||-1!==e.indexOf("+")&&0!==e.indexOf("+")||-1!==e.indexOf("#"),s=r||n;return this.newSize.height=s?e:i,i},processValue:function(e,t){return 0===e.indexOf(t+"+")&&(e=e.replace(t+"+","+=")),0===e.indexOf(t+"-")&&(e=e.replace(t+"-","-=")),e},processXValue:function(e){var t=this.getTarget();null===e&&(e=t.positionX),e=e.replace("left","0"),e=e.replace("right","100%-w"),e=e.replace("center","50%-w/2"),-1===e.indexOf(".x")&&(e=e.replace("x",t.positionX));var a=MainFrame.Util.isPercentageValue(e),i=-1!==e.indexOf("w"),r=-1!==e.indexOf("-")&&0!==e.indexOf("-")||-1!==e.indexOf("+")&&0!==e.indexOf("+")||-1!==e.indexOf("#"),n=a||i||r,s=this.newSizeValues.width,o=e;-1===o.indexOf(".x")&&(o=o.replace("x",t.getPositionX())),-1===o.indexOf(".w")&&(o=o.replace("w",s));var l=t.superObject?t.superObject.getDimensionX():MainFrame.Browser.width,c=t.parseStringExpression(o,l);return this.newSizeValues.x=c,this.newSize.x=n?e:c,c},processYValue:function(e){var t=this.getTarget();null===e&&(e=t.positionY),e=e.replace("top","0"),e=e.replace("bottom","100%-h"),e=e.replace("center","50%-h/2"),-1===e.indexOf(".y")&&(e=e.replace("y",t.positionY));var a=MainFrame.Util.isPercentageValue(e),i=-1!==e.indexOf("h"),r=-1!==e.indexOf("-")&&0!==e.indexOf("-")||-1!==e.indexOf("+")&&0!==e.indexOf("+")||-1!==e.indexOf("#"),n=a||i||r,s=this.newSizeValues.height,o=e;-1===o.indexOf(".h")&&(o=o.replace("h",s)),-1===o.indexOf(".y")&&(o=o.replace("y",t.getPositionY()));var l=t.superObject?t.superObject.getDimensionY():MainFrame.Browser.height,c=t.parseStringExpression(o,l);return this.newSizeValues.y=c,this.newSize.y=n?e:c,c},onComplete:function(){var e=this.getTarget(),t=this.paramsObject.onComplete,a="false"===this.getParam("triggerResize")?!1:!0;MainFrame.EventHandler.dispatch(t),a&&this.sizeChanges&&(e.setPositionX(this.newSize.x),e.setPositionY(this.newSize.y),e.setDimensionX(this.newSize.width),e.setDimensionY(this.newSize.height),e.resize());var i=this.getParam("wait")||!0;1==i&&this.endAndClearAction()},onStart:function(){var e=this.paramsObject.onInit;MainFrame.EventHandler.dispatch(e)},onUpdate:function(){var e="false"===this.getParam("triggerResize")?!1:!0;if(e&&this.sizeChanges){var t=this.getTarget();if(t&&t.subObjects){"catalog"===t.id&&MainFrame.Publisher.publish("catalog:resized",{});var a={};if(a.x=t.setPositionX(t.containerElement.offsetLeft),"undefined"==typeof a.x)return;if(a.y=t.setPositionY(t.containerElement.offsetTop),"undefined"==typeof a.y)return;if(a.width=t.setDimensionX(t.containerElement.clientWidth),"undefined"==typeof a.width)return;if(a.height=t.setDimensionY(t.containerElement.clientHeight),"undefined"==typeof a.height)return;t.resize(a)}}}}),MainFrame.Action.AnimateCount=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("duration"),t=e?parseFloat(e,10):1,a=this.getParam("initialValue"),i=this.getParam("finalValue"),r=this.getTarget();if(!r)return MainFrame.Util.showError('Animate error! You are trying to animate the item with the id "'+this.targetObjectId+'" but it does not exist'),void this.endAndClearAction();var n=this.getParam("elemId");if(n)var s=document.getElementById(n);var o=this.getParam("precision"),l="true"===this.getParam("useComma")?!0:!1,c=this.getParam("type");if(o)var d=parseInt(o,10);else var d=2;var g=function(){var e=u.tweenValue;"float"===c&&-1!==d&&(e=e.toFixed(d),l&&(e=e.replace(".",","))),s?s.innerHTML=e:r.setText(e)},h=this,u={tweenValue:a},m={tweenValue:i,onUpdate:function(){g()},onComplete:function(){g(),p&&h.endAndClearAction()}};switch(c){case"float":break;case"integer":default:m.roundProps="tweenValue"}TweenMax.to(u,t,m);var p="false"===this.getParam("wait")?!1:!0;1!=p&&this.endAndClearAction()}}),MainFrame.Action.AnimateElement=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("animation"),t=this.getParam("duration"),a="true"===this.getParam("reverse")?!0:!1,i=this.getParam("repeat"),r=this.getParam("chain"),n=this.getTarget();if(n.containerElement.setAttribute("class",e),t&&(n.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationDuration"]=t+"ms"),i&&(n.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationIterationCount"]=i),a&&(n.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationDirection"]="alternate"),r)this.endAndClearAction();else{var s=this;setTimeout(function(){s.endAndClearAction()},t+50)}}}),MainFrame.Action.ApplyEasing=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getTarget(),a="false"===this.getParam("allowHorizontalScrolling")?!1:!0,i="false"===this.getParam("allowVerticalScrolling")?!1:!0,r="true"===this.getParam("allowHorizontalBouncing")?!0:!1,n="true"===this.getParam("allowVerticalBouncing")?!0:!1,s=this.getParam("translationEvent");t.easing?e=t.easing:(e=new MainFrame.Easing,t.easing=e,s&&e.onTranslationDispatch(s));var o=t.superObject.getDimensionX(),l=t.superObject.getDimensionY(),c=t.getDimensionX(),d=t.getDimensionY(),g=t.getPositionX(),h=t.getPositionY();o>=c&&(a=!1),l>=d&&(i=!1),0>g?(t.leftLimit=g,t.rightLimit=0):(t.rightLimit<=0&&!r&&(a=!1),t.leftLimit=0,t.rightLimit=a?g+c-o:0),0>h?(t.topLimit=h,t.bottomLimit=0):(t.topLimit=0,t.bottomLimit=i?h+d-l:0,t.bottomLimit<=0&&!n&&(i=!1)),e.setOptions({scrollingX:a,scrollingY:i}),e.setScrollLeftLimits(t.leftLimit,t.rightLimit),e.setScrollTopLimits(t.topLimit,t.bottomLimit),e.setTarget(t),e.addListeners(),e.setScrollPosition(-t.translatedX,-t.translatedY);var u=this.getParam("sourceEvent").currentEvent;e.startWithEvent(u),this.endAndClearAction()}}),MainFrame.Action.ClearItemContent=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e?e.empty():MainFrame.Util.showError("ClearItemContent attempted with an invalid target!"),this.endAndClearAction()}}),MainFrame.Action.ClearPreviousAnimations=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.containerElement;t.style[MainFrame.Browser.vendorPrefix+"Transform"]="",t.style[MainFrame.Browser.vendorPrefix+"TransitionDuration"]="0ms",t.removeAttribute("class"),this.endAndClearAction()}}),MainFrame.Action.CloseHoverChild=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("resourceId"),t="true"===this.getParam("orientationBased")?!0:!1;t&&(1===MainFrame.Browser.orientation?e+="_portrait":2===MainFrame.Browser.orientation&&(e+="_landscape"));var a=MainFrame.Manager.Scoping.getById(e),i=this.getTarget();i.removeSubObject(a),this.endAndClearAction()}}),MainFrame.Action.CloseOverlay=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=e.getParam("duration"),a=e.getTarget(),i=e.getParam("overlayId");if("#overlayId"===i&&(i=null),null==t&&(t=0),a.overlays)if(i)a.overlays[i]?e.removeOverlayWithId(a,i,t):MainFrame.Util.showError("Action.CloseOverlay error! No overlay found for the id: "+i);else for(var i in a.overlays)e.removeOverlayWithId(a,i,t);e.endAndClearAction()},removeOverlayWithId:function(e,t,a){var i=e.overlays[t];i.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+a+"ms ease-in",i.containerElement.style.opacity="0",setTimeout(function(){i&&(e.removeSubObject(i),delete e.overlays[t])},a)}}),MainFrame.Action.CloseResource=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("resourceId"),t="true"===this.getParam("orientationBased")?!0:!1;t&&(1===MainFrame.Browser.orientation?e+="_portrait":2===MainFrame.Browser.orientation&&(e+="_landscape"));var a=MainFrame.Manager.Scoping.getById(e);a||-1===e.indexOf("media")||(a=MainFrame.Manager.Scoping.getById("media"));var i=this.getTarget();i.removeSubObject(a),this.endAndClearAction()}}),MainFrame.Action.CloseVideo=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("duration")||300,a=this.getParam("overlayId")||"showVideoOverlay";if("#overlayId"===a&&(a=null),e.overlays)if(a)e.overlays[a]?this.removeOverlayWithId(e,a,t):MainFrame.Util.showError("CloseVideo error! No overlay found for the id: "+a);else for(var a in e.overlays)this.removeOverlayWithId(e,a,t);this.endAndClearAction()},removeOverlayWithId:function(e,t,a){MainFrame.Util.removeElement(e.video),delete e.video;var i=e.overlays[t];i.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+a+"ms ease-in",i.containerElement.style.opacity="0",setTimeout(function(){i&&(e.removeSubObject(i),delete e.overlays[t])},a)}}),MainFrame.Action.Hide=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=this.getTarget(),a=this.getParam("wait")||!0;if(!t)return void this.endAndClearAction();if(!t.visible)return void this.endAndClearAction();var i=this.getParam("duration"),r=this.getParam("animation");if(r){i&&(t.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationDuration"]=i+"s");var n=function(){MainFrame.Event.unbind(t.containerElement,MainFrame.Event.animationEnd,n),MainFrame.Util.removeAnimationClassHide(r,t.containerElement),t.hide(),e.endAndClearAction()};return MainFrame.Event.bind(t.containerElement,MainFrame.Event.animationEnd,n),void MainFrame.Util.applyAnimationClassHide(r,t.containerElement)}if(i){t.containerElement.style.opacity="1",window.getComputedStyle(t.containerElement,null).getPropertyValue("opacity"),t.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+i+"s ease-in",t.containerElement.style.opacity="0";var s=MainFrame.Util.secondsToMiliseconds(i);return setTimeout(function(){t.hide(),a&&e.endAndClearAction()},s),void("false"===a&&(t.hide(),this.endAndClearAction()))
}t.hide(),this.endAndClearAction()}}),MainFrame.Action.HideItemContent=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e&&e.contentElement){var t=this.getParam("duration"),a=1e3*t;t?(e.contentElement.style.opacity="1",window.getComputedStyle(e.contentElement,null).getPropertyValue("opacity"),e.contentElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+t+"s ease-in",e.contentElement.style.opacity="0",setTimeout(function(){e.contentElement.style.display="none"},a)):e.contentElement.style.display="none"}else MainFrame.Util.showError("HideItemContent attempted with an invalid target!");this.endAndClearAction()}}),MainFrame.Action.HideHoverChild=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.hoverChild;e.hoverTimeout=setTimeout(function(){t.visible&&(t.containerElement.style.visibility="hidden",t.visible=!1)},300),this.endAndClearAction()}}),MainFrame.Action.InsertResourceBefore=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("beforeItemId"),a=MainFrame.Manager.Scoping.getById(t),i=a.containerElement,r=this.getParam("resourceId"),n=new MainFrame.Element.Resource;e.addSubObject(n),n.superObject=e,n.containerElement=document.createElement("div"),e.contentElement.insertBefore(n.containerElement,i),n.readData(MainFrame.Manager.Resource.getById(r)),n.resize(),MainFrame.Manager.Scoping.register(r,n),this.endAndClearAction()}}),MainFrame.Action.KeepHoverChildVisible=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();clearTimeout(e.hoverTimeout),this.endAndClearAction()}}),MainFrame.Action.MoveElement=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("moveX")||"0",t=this.getParam("moveY")||"0",a=parseInt(this.getParam("duration"),10)||0,i="true"===this.getParam("chain")?!0:!1,r=this.getTarget(),n=r.parseStringExpression(e,r.getDimensionX()),s=r.parseStringExpression(t,r.getDimensionY());if(setTimeout(function(){MainFrame.Util.setPosition(r.containerElement,n,s),MainFrame.Util.setTransformDuration(r.containerElement,a)},50),i)this.endAndClearAction();else{var o=this;setTimeout(function(){o.endAndClearAction()},a+50)}}}),MainFrame.Action.PushInResource=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("resourceId"),t=MainFrame.Manager.Resource.getById(e);if(!t)return MainFrame.Util.showError('PushInResource action error! The resource with the id "'+e+'" does not exist!'),void this.endAndClearAction();var a=new MainFrame.Element.Resource,i=this.getParam("direction"),r=this.getParam("duration")||0,n=this.getTarget(),s=n.superObject;s.addSubObject(a),a.superObject=s,a.containerElement=document.createElement("div"),s.contentElement.insertBefore(a.containerElement,n.containerElement),a.readData(t),MainFrame.Manager.Scoping.register(e,a),a.resize();var o=0,l=0;switch(i){case"top":l=-a.getDimensionY();break;case"right":o=-a.getDimensionX();break;case"bottom":l=a.getDimensionY();break;case"left":o=a.getDimensionX()}return MainFrame.Util.setPosition(n.containerElement,o,l),MainFrame.Util.setTransformDuration(n.containerElement,r),void this.endAndClearAction()}}),MainFrame.Action.PushOutResource=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("resourceId"),t=MainFrame.Manager.Scoping.getById(e);if(!t)return MainFrame.Util.showError('PushOutResource action error! The resource with the id "'+e+'" does not exist!'),void this.endAndClearAction();var a=(this.getParam("direction"),this.getParam("duration")||0),i=this.getTarget(),r=i.superObject,n=0,s=0;MainFrame.Util.setPosition(i.containerElement,n,s),MainFrame.Util.setTransformDuration(i.containerElement,a);var o=this;setTimeout(function(){MainFrame.Util.clearTransformations(i.containerElement),r.removeSubObject(t),r.resize(),o.endAndClearAction()},a)}}),MainFrame.Action.Remove=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=this.getTarget(),a=this.getParam("id"),i=MainFrame.Manager.Scoping.getById(a);if(i){var r=this.getParam("animation"),n=this.getParam("duration");if(r||"none"===r||(r=i._addAnimation),n||"0"===n||(n=i._addDuration),r&&"none"!==r){n&&(i.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationDuration"]=n+"s");var s=function(){MainFrame.Event.unbind(i.containerElement,MainFrame.Event.animationEnd,s),t.removeSubObject(i),e.endAndClearAction()};MainFrame.Event.bind(i.containerElement,MainFrame.Event.animationEnd,s);var o=MainFrame.Util.applyAnimationClassHide(r,i.containerElement);return o||(MainFrame.Util.showError('CSS Animation error! The animation class ".'+MainFrame.Util.cssAnimationDict[r]+'" is not declared'),t.removeSubObject(i),t.layout&&"true"!==e.getParam("blockResize")&&t.resize(),this.endAndClearAction()),delete i._addAnimation,void delete i._addDuration}delete i._addAnimation,delete i._addDuration,t.removeSubObject(i),t.layout&&"true"!==e.getParam("blockResize")&&t.resize()}this.endAndClearAction()}}),MainFrame.Action.ScrollElement=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("sourceEvent"),a=e.superObject.getDimensionY(),i=e.getDimensionY(),r=e.getPositionY();e.topLimit=0,e.bottomLimit=r+i-a,e.bottomLimit=e.bottomLimit<0?0:-e.bottomLimit,e.translatedX=e.translatedX||0,e.translatedY=t.scrolledDistance,e.translatedY<e.bottomLimit?(e.translatedY=e.bottomLimit,t.scrolledDistance=e.bottomLimit):e.translatedY>e.topLimit&&(e.translatedY=e.topLimit,t.scrolledDistance=e.topLimit),MainFrame.Util.setPosition(e.containerElement,e.translatedX,e.translatedY),MainFrame.Util.setTransformDuration(e.containerElement,0),this.endAndClearAction()}}),MainFrame.Action.Show=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=this.getTarget(),a=this.getParam("wait")||!0;if(!t)return void this.endAndClearAction();if(t.visible)return void this.endAndClearAction();var i=this.getParam("duration"),r=this.getParam("animation");if(t.show(),r){i&&(t.containerElement.style[MainFrame.Browser.vendorPrefix+"AnimationDuration"]=i+"s");var n=function(){MainFrame.Event.unbind(t.containerElement,MainFrame.Event.animationEnd,n),e.endAndClearAction()};return MainFrame.Event.bind(t.containerElement,MainFrame.Event.animationEnd,n),void MainFrame.Util.applyAnimationClassShow(r,t.containerElement)}if(i){t.containerElement.style.opacity="0",window.getComputedStyle(t.containerElement,null).getPropertyValue("opacity"),t.containerElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+i+"s ease-in",t.containerElement.style.opacity="1";var s=MainFrame.Util.secondsToMiliseconds(i);return setTimeout(function(){t.show(),a&&e.endAndClearAction()},s),void("false"===a&&(t.show(),this.endAndClearAction()))}this.endAndClearAction()}}),MainFrame.Action.ShowErrorMessage=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("resourceId"),a=MainFrame.Manager.Resource.getById(t),i=this.getParam("messageContainerId")||"errorMessage",r=this.getParam("triggerOnClose")||"closeCustomError";if(a){var n=(new MainFrame.Element.Resource({id:t,superObject:e,data:a}),MainFrame.Manager.Scoping.getById(i));if(n&&this.paramsObject.sourceEvent&&this.paramsObject.sourceEvent.errorMessageId){var s=this.paramsObject.sourceEvent.errorMessageId,o=MainFrame.Manager.Text.getById(s);n.setText(o)}var l=this.getParam("closeAfter");if(l){var c=parseFloat(l);c>0&&setTimeout(function(){MainFrame.EventHandler.dispatch(r)},c)}}this.endAndClearAction()}}),MainFrame.Action.ShowHoverChild=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getParam("resourceId"),a=this.getTarget();if(a.hoverChild)a.hoverChild.containerElement.style.visibility="visible",a.hoverChild.visible=!0;else{var i=MainFrame.Util.getMainFrame();e=new MainFrame.Element.Resource,i.addSubObject(e),e.addSuperObject(i),e.readData(MainFrame.Manager.Resource.getById(t)),e.resize(),MainFrame.Manager.Scoping.register(t,e),e.visible=!0,a.hoverChild=e}this.endAndClearAction()}}),MainFrame.Action.ShowItemContent=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e&&e.contentElement){var t=this.getParam("duration"),a="none"===e.contentElement.style.display;e.contentElement.style.display="block",t&&a&&(e.contentElement.style.opacity="0",window.getComputedStyle(e.contentElement,null).getPropertyValue("opacity"),e.contentElement.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+t+"s ease-in",e.contentElement.style.opacity="1")}else MainFrame.Util.showError("ShowItemContent attempted with an invalid target!");this.endAndClearAction()}}),MainFrame.Action.ShowOverlay=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=e.getParam("color")||"#000",a=e.getParam("duration"),i=e.getParam("opacity"),r=e.getParam("zIndex"),n=e.getTarget(),s=e.getParam("onPressActionId"),o=e.getParam("overlayId"),l=e.getParam("insertBefore"),c=MainFrame.Manager.Scoping.getById(l),d=e.getParam("catalogTarget");if(null==a&&(a=0),n.overlays||(n.overlays={}),o||(o="default"),n.overlays[o])return MainFrame.Util.showError("Action.ShowOverlay error! An overlay with the id "+o+" already exists!"),void this.endAndClearAction();if(c)var g=!0,h=MainFrame.Util.createElement("div","v7__overlay",c.containerElement,g);else{if("centeredDiv"===d)var u=n.getCurrentContainer(),m=u.centeredDiv;else var m=n.contentElement;var h=MainFrame.Util.createElement("div","v7__overlay",m)}var p=new MainFrame.Element.Item({superObject:n,containerElement:h});h.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+a+"ms ease-in",h.style.backgroundColor=t,null!==r&&""!==r&&(h.style.zIndex=r),n.overlays[o]=p,setTimeout(function(){h.style.opacity=i,e.endAndClearAction(),s&&p.setAction("id:"+s)},parseInt(a,10)+50)}}),MainFrame.Action.ShowResource=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getParam("resourceId"),a=this.getTarget();if(a){var i="true"===this.getParam("orientationBased")?!0:!1;i&&(1===MainFrame.Browser.orientation?t+="_portrait":2===MainFrame.Browser.orientation&&(t+="_landscape")),e=new MainFrame.Element.Resource,a.addSubObject(e),e.superObject=a;var r=this.getParam("insertBefore"),n=MainFrame.Manager.Scoping.getById(r);if(n){var s=!0;e.containerElement=MainFrame.Util.createElement("div","v7__elem--container",n.containerElement,s)}else e.containerElement=MainFrame.Util.createElement("div","v7__elem--container",a.contentElement);e.readData(MainFrame.Manager.Resource.getById(t)),e.resize(),MainFrame.Manager.Scoping.register(t,e)}this.endAndClearAction()}}),MainFrame.Action.ShowTabPanel=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("panelId"),a=this.getParam("panelIndex");t?e.showPanelWithId(t):a?e.showPanelAtIndex(a):MainFrame.Util.showError("ShowTabPanel error! You must define a panel id or a panel index!")}else MainFrame.Util.showError("ShowTabPanel error! The target tabs do not exist!");this.endAndClearAction()}}),MainFrame.Action.ShowVideo=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("color")||"#000000",a=this.getParam("duration")||300,i=this.getParam("opacity")||.8,r=this.getParam("onPressActionId")||"closeVideo",n=this.getParam("overlayId")||"showVideoOverlay",s=this.getParam("insertBefore"),o=MainFrame.Manager.Scoping.getById(s);if(e.overlays||(e.overlays={}),n||(n="default"),e.overlays[n])return MainFrame.Util.showError('ShowVideo error! An overlay with the id "'+n+'" already exists!'),void this.endAndClearAction();var l=e.contentElement,c=!1;o&&(c=!0,l=o.containerElement);var d=MainFrame.Util.createElement("div","v7__overlay",l,c),g=new MainFrame.Element.Item({superObject:e,containerElement:d});d.style[MainFrame.Browser.vendorPrefix+"Transition"]="opacity "+a+"ms ease-in",d.style.backgroundColor=t,e.overlays[n]=g;var h=this,u=parseInt(a,10)+50;setTimeout(function(){d.style.opacity=i,g.setAction("id:"+r),h.showVideo(),h.endAndClearAction()},u)},showVideo:function(){var e=this.getTarget(),t=this.getParam("video");if(t){var a=MainFrame.Util.createElement("iframe","",e.contentElement);a.style.width="80%",a.style.height="80%",a.style.border="none",a.style.margin="0 auto",a.style.left="0",a.style.right="0",a.style.top="10%",a.style.position="absolute";var i="";i+='<script>function closeIframe() { var clickedElement = window.event.target || window.event.srcElement; if (clickedElement.nodeName.toLowerCase() === "div") { window.top.MainFrame.EventHandler.dispatch("iframeDivPressed"); } };</script>',i+='<div onclick="closeIframe();" style="width: 100%; height: 100%;"><video autoplay autobuffer controls preload="metadata" style="margin: auto; position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px; width: 100%; height: 100%; max-width: 100%; max-height: 100%;">',i+='<source src="'+t+'"/>',i+="</video></div>",a.contentDocument.write(i),e.video=a,e.addSubObject(a)}}}),MainFrame.Action.SlideInResource=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("resourceId"),t="true"===this.getParam("orientationBased")?!0:!1;t&&(1===MainFrame.Browser.orientation?e+="_portrait":2===MainFrame.Browser.orientation&&(e+="_landscape"));var a=MainFrame.Manager.Resource.getById(e);if(!a)return MainFrame.Util.showError('SlideInResource action error! The resource with the id "'+e+'" does not exist!'),void this.endAndClearAction();var i=this.getParam("direction"),r=this.getParam("duration");"undefined"==typeof r&&(r="0");var n=this.getTarget(),s=this.getParam("insertBefore"),o=MainFrame.Manager.Scoping.getById(s);if(o)var l=!0,c=MainFrame.Util.createElement("div","v7__elem--container",o.containerElement,l);else var c=MainFrame.Util.createElement("div","v7__elem--container",n.contentElement);var d=new MainFrame.Element.Resource({superObject:n,data:a,id:e,containerElement:c}),g=0,h=0;switch(i){case"top":var u=d.getDimensionY();d.containerElement.style.top="-"+u+"px",h=parseInt(d.getPositionY(),10)+parseInt(u,10);break;case"right":var m=parseInt(window.innerWidth,10)+parseInt(d.getPositionX(),10);d.containerElement.style.left=m+"px",g="-"+window.innerWidth;break;case"bottom":var u=parseInt(window.innerHeight,10)+parseInt(d.getPositionY(),10);d.containerElement.style.top=u+"px",h="-"+window.innerHeight;break;case"left":var m=d.getDimensionX();d.containerElement.style.left="-"+m+"px",g=parseInt(m,10)+parseInt(d.getPositionX(),10)}setTimeout(function(){MainFrame.Util.setPosition(d.containerElement,g,h),MainFrame.Util.setTransformDuration(d.containerElement,r)},50);var p=this;setTimeout(function(){MainFrame.Util.setPosition(d.containerElement,0,0),MainFrame.Util.setTransformDuration(d.containerElement,0),MainFrame.Util.clearTransformations(d.containerElement),d.resize(),p.endAndClearAction()},parseInt(r,10)+100)}}),MainFrame.Action.SlideOutResource=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=e.getParam("resourceId"),a="true"===this.getParam("orientationBased")?!0:!1;a&&(1===MainFrame.Browser.orientation?t+="_portrait":2===MainFrame.Browser.orientation&&(t+="_landscape"));var i=MainFrame.Manager.Scoping.getById(t),r=e.getParam("direction"),n=e.getParam("duration");if(!i)return MainFrame.Util.showError("Action.SlideOutResource error! No resource found for the id: "+t),void this.endAndClearAction();"undefined"==typeof n&&(n="0");var s=0,o=0;switch(r){case"top":o=-(parseInt(i.getPositionY(),10)+parseInt(i.getDimensionY(),10));break;case"right":s=parseInt(window.innerWidth,10)+parseInt(i.getDimensionX(),10);break;case"bottom":o=parseInt(window.innerHeight,10)-parseInt(i.getPositionY(),10);break;case"left":s=-(parseInt(i.getPositionX(),10)+parseInt(i.getDimensionX(),10))}setTimeout(function(){MainFrame.Util.setPosition(i.containerElement,s,o),MainFrame.Util.setTransformDuration(i.containerElement,n)},50),setTimeout(function(){var t=e.getTarget();t&&t.removeSubObject(i),e.endAndClearAction()},parseInt(n,10)+100)}}),MainFrame.Action.ToggleVisibilityAnimated=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("hide"),a=this.getParam("duration"),i=this.getParam("force");"undefined"==typeof a&&(a="0"),"undefined"==typeof i&&(i=null);var r,n,s=0,o=0,l=!1,c=e.visible&&"show"!==i||!e.visible&&"hide"===i,d=t.toLowerCase(),g=-1!==d.indexOf("top"),h=-1!==d.indexOf("bottom"),u=-1!==d.indexOf("left"),m=-1!==d.indexOf("right"),p=-1!==d.indexOf("fade");g&&(r=c?-1:0,o=r*(parseInt(e.getDimensionY(),10)+parseInt(e.getPositionY(),10))),h&&(r=c?1:0,o=r*(parseInt(MainFrame.Browser.height,10)-parseInt(e.getPositionY(),10))),u&&(r=c?-1:0,s=r*(e.getPositionX()+e.getDimensionX())),m&&(r=c?1:0,s=r*(MainFrame.Browser.width-e.getPositionX()+e.getDimensionX())),p&&(l=!0,n=c?0:1),MainFrame.Util.setTransformDuration(e.containerElement,a),l?(e.containerElement.style.opacity=n,setTimeout(function(){e.containerElement.style.display=n?"block":"none"},a+100)):MainFrame.Util.setPosition(e.containerElement,s,o),e.visible=!e.visible,this.endAndClearAction()}}),MainFrame.Action.TranslateElement=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("direction"),t=this.getParam("distance"),a=parseInt(this.getParam("duration"),10)||.3,i=this.getTarget(),r=(i.subObjects.length,i.subObjects[0]),n=r.getDimensionX(),s=i.superObject,o=s.getDimensionX(),l=i.getDimensionX();if(o>=l)return void this.endAndClearAction();null!==t&&""!==t&&(n=parseInt(t,10));var c=i.translatedX||0,d=i.translatedY||0,g=o-l,h=0;"front"===e?c+=n:c-=n,c>h?c=h:g>c&&(c=g),MainFrame.Util.setPosition(i.containerElement,c,d),MainFrame.Util.setTransformDuration(i.containerElement,a,"s"),i.translatedX=c,i.translatedY=d,this.endAndClearAction()}}),MainFrame.Action.AddHash=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("hash"),t=this.getParam("hashId");t&&(e=MainFrame.Router.getHashForId(t)),e&&MainFrame.Router.add(e),this.endAndClearAction()}}),MainFrame.Action.AddAltText=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("altType")||"default",a=this.getParam("altId");e.addAltId(a,t)}this.endAndClearAction()}}),MainFrame.Action.AddCSSClass=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("class"),a=this.getParam("element")||"container";if(t){if("container"===a)var i=e.containerElement;else if("content"===a)var i=e.contentElement;else if("skin"===a)var i=e.skinElement;MainFrame.Util.addClass(i,t)}}this.endAndClearAction()}}),MainFrame.Action.RemoveAltText=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&e.containerElement.altObserver&&(MainFrame.AltPopOver.remove(e.containerElement),e.containerElement.style.cursor="pointer"),this.endAndClearAction()}}),MainFrame.Action.Alert=MainFrame.Abstract.Action.extend({startAction:function(){var e="";if(this.getParam("msg"))e=this.getParam("msg");else if(this.getParam("msgId")){var t=this.getParam("msgId");e=MainFrame.Manager.Text.getById(t)}alert(e),this.endAndClearAction()}}),MainFrame.Action.ApplySkin=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.skins;t.forEach(function(e){MainFrame.Util.removeElement(e.containerElement)}),delete e.skins,delete e.skinElement;var a=this.getParam("id"),i=MainFrame.Manager.Skin.getById(a);MainFrame.DataParser.applySkin.call(e,i);var r=e.skins;r.forEach(function(e){e.resize()}),this.endAndClearAction()}}),MainFrame.Action.ApplyTextScrollEasing=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.getDimensionY(),a=e.contentElement.clientHeight,i=(e.getPositionY(),0),r=0,n=0,s=a-t;if(s>0){var o;e.easing?o=e.easing:(o=new MainFrame.Easing,e.easing=o,o.setOptions({scrollingX:!1,scrollingY:!0}),o.__targetContainer=e.contentElement);var l=1>=s?!1:!0;o.setOptions({scrollingX:!1,scrollingY:l}),o.setScrollLeftLimits(i,r),o.setScrollTopLimits(n,s);var e=e;o.setTarget(e),o.addListeners(),o.setScrollPosition(-e.translatedX,-e.translatedY);var c=this.getParam("sourceEvent").currentEvent;o.startWithEvent(c)}this.endAndClearAction()}}),MainFrame.Action.BlockActions=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=new MainFrame.Element.Item;t.customInit(e,"0","0","100%","100%"),t.resize(),e.actionBlocker=t,this.endAndClearAction()}}),MainFrame.Action.BringToFront=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=e.containerElement.parentNode;t.insertBefore(e.containerElement)}this.endAndClearAction()}}),MainFrame.Action.ChangeBackgroundImage=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("duration"),a=this.getParam("fadeDuration")||"0.5",i=this.getParam("images"),r=i.split(",");if(e&&r.length){var n=!1,s=1,o=r.length,l=e.skinElement,c=!0,d=MainFrame.Util.createElement("div","v7__elem--skin",l,c);l.style.transition="opacity "+a+"s",d.style.transition="opacity "+a+"s",d.style.backgroundSize="cover",d.style.backgroundRepeat="no-repeat";var g=MainFrame.Util.secondsToMiliseconds(t);setInterval(function(){var e=r[s],t=MainFrame.Util.processSrc(e);n?(l.style.backgroundImage="url('"+t+"')",l.style.opacity="1",d.style.opacity="0",n=!1):(d.style.backgroundImage="url('"+t+"')",d.style.opacity="1",l.style.opacity="0",n=!0),s++,s===o&&(s=0)},g)}this.endAndClearAction()}}),MainFrame.Action.Check=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();"undefined"!=typeof e.isChecked,e&&e.check(),this.endAndClearAction()}}),MainFrame.Action.CheckAll=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.extractCheckboxItemsFromTarget(e);t.forEach(function(e){e.check()})}this.endAndClearAction()},extractCheckboxItemsFromTarget:function(e){for(var t=[],a=0,i=e.subObjects.length;i>a;a++){var r=e.subObjects[a],n="undefined"!=typeof r.isChecked;if(n)t.push(r);else if(r.subObjects){var s=this.extractCheckboxItemsFromTarget(r);s.forEach(function(e){t.push(e)})}}return t}}),MainFrame.Action.ClearItemContent=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e.empty(),this.endAndClearAction()}}),MainFrame.Action.ClearText=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e.setText(""),this.endAndClearAction()}}),MainFrame.Action.DoFunction=MainFrame.Abstract.Action.extend({startAction:function(){var functionName=this.getParam("function"),target=this.getTarget(),type=this.getParam("type")||"v7";"js"===type?-1===functionName.indexOf("()")&&(functionName+="()",eval(functionName)):target[functionName]&&target[functionName](),this.endAndClearAction()}}),MainFrame.Action.DisplayImageInItem=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("align")||"center",a=this.getParam("border")||"none",i=this.getParam("productProperty"),r=decodeURIComponent(this.getParam("imageUrl"));if(i)r=MainFrame.EprintShop.interpretProductString(i,MainFrame.EprintShop.currentProduct);else{var n=MainFrame.Util.isAbsoluteUrl(r),s=-1!==r.indexOf("/"),o=!n&&!s;o&&(r=MainFrame.Util.getAppURL()+r)}var l=MainFrame.Util.createElement("img","",e.contentElement);switch(l.style.margin="auto",l.style.position="absolute",l.style.maxWidth="99%",l.style.maxHeight="99%",l.style.top="0px",l.style.bottom="0px",t){case"left":l.style.left="0px";break;case"right":l.style.right="0px";break;case"center":default:l.style.left="0px",l.style.right="0px"}l.style.border=a,l.src=r,this.endAndClearAction()}}),MainFrame.Action.Dispatch=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("event"),t=this.getTarget(),a=this.getParam("delay");if(a){var i=this;setTimeout(function(){MainFrame.EventHandler.dispatch(e,[],t),i.endAndClearAction()},a)}else MainFrame.EventHandler.dispatch(e,[],t),this.endAndClearAction()}}),MainFrame.Action.DragObject=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t="false"===this.getParam("limits")?!1:!0,a=this.getParam("sourceEvent"),i=this.getParam("dragTarget")||"self",r="false"===this.getParam("allowHorizontalDragging")?!1:!0,n="false"===this.getParam("allowVerticalDragging")?!1:!0;switch(i){case"self":var s=e;break;case"parent":var s=e.superObject;break;default:var s=MainFrame.Manager.Scoping.getById(i)}if(s){s.translatedX||(s.translatedX=0),s.translatedY||(s.translatedY=0);var o=s.getPositionX(),l=s.getPositionY();r&&(!t||t&&this.isWithinHorizontalLimits(s,a))&&(s.translatedX+=a.distanceX,o+=a.distanceX),n&&(!t||t&&this.isWithinVerticalLimits(s,a))&&(s.translatedY+=a.distanceY,l+=a.distanceY),MainFrame.Util.setPosition(s.containerElement,s.translatedX,s.translatedY),s.setPositionX(o),s.setPositionY(l)}this.endAndClearAction()},isWithinHorizontalLimits:function(e,t){var a=e.superObject,i=e.getPositionX(),r=e.getDimensionX(),n=a.getDimensionX();return i+t.distanceX<0?!1:i+r+t.distanceX>n?!1:!0},isWithinVerticalLimits:function(e,t){var a=e.superObject,i=e.getPositionY(),r=e.getDimensionY(),n=a.getDimensionY();return i+t.distanceY<0?!1:i+r+t.distanceY>n?!1:!0}}),MainFrame.Action.EnterFullscreen=MainFrame.Abstract.Action.extend({startAction:function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||(document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen()),this.endAndClearAction()}}),MainFrame.Action.ExitFullscreen=MainFrame.Abstract.Action.extend({startAction:function(){(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)&&(document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msCancelFullScreen&&document.msCancelFullScreen()),this.endAndClearAction()}}),MainFrame.Action.Log=MainFrame.Abstract.Action.extend({startAction:function(){var e=new Date;console.log(this.getParam("msg")+" date: "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+":"+e.getMilliseconds()),this.endAndClearAction()}}),MainFrame.Action.OpenAppURL=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getParam("iosURL"),a=this.getParam("androidURL");if(e=EnvDetection.isIOS?t:a){e=decodeURIComponent(e),e=e.replace("#{url}",MainFrame.Util.doc.URL).replace("#{q}",MainFrame.Util.doc.location.search);var i=this.paramsObject.winName;i?window.open(e,i):window.open(e)}this.endAndClearAction()}}),MainFrame.Action.OpenColorbox=MainFrame.Abstract.Action.extend({startAction:function(){var e=decodeURIComponent(this.getParam("url"));"function"==typeof doIt&&e&&doIt(e),this.endAndClearAction()}}),MainFrame.Action.OpenURL=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("url"),t=this.getParam("urlTarget"),a=this.getParam("winName"),i="false"===this.getParam("decode")?!1:!0;i&&(e=decodeURIComponent(e)),e=e.replace("#{url}",MainFrame.Util.doc.URL),e=e.replace("#{q}",MainFrame.Util.doc.location.search),e.indexOf("mailto:")>=0?window.location.href=e:t?window.open(e,t):a?window.open(e,a):window.open(e),this.endAndClearAction()}}),MainFrame.Action.PauseVideo=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("videoId");if(e)var t=document.getElementById(e);else var a=this.getTarget(),t=a.contentElement;t&&t.pause?t.pause():MainFrame.Util.showError("PauseVideo error!"),this.endAndClearAction()}}),MainFrame.Action.PlaySound=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("file");e=MainFrame.Util.getFullPath(e);var t=new Audio(e);t.play(),this.endAndClearAction()}}),MainFrame.Action.PlayVideo=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("videoId");if(e)var t=document.getElementById(e);else var a=this.getTarget(),t=a.contentElement;t&&t.play?t.play():MainFrame.Util.showError("PlayVideo error!"),this.endAndClearAction()}}),MainFrame.Action.Print=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("source"));if(e){var t=MainFrame.Util.getAppURL();if(null!==this.getParam("printPath")){var a=this.getParam("printPath");-1===a.indexOf("http")?a=t+a+"/print.html":a+="/print.html"}else var a=t+"common/print.html";var i="310",r=this.getFilesPath(t,e),n=this.getFilesList(e,i);if(-1!==t.indexOf("?"))var s="&";else var s="?";var o=a+s+"path="+r+"&files="+n;"true"===this.getParam("printAnnotations")&&(o+="&annotations=true"),window.open(o,"_blank")}else MainFrame.Util.showError("Print page source module is invalid. No object found with the id "+this.getParam("source"));this.endAndClearAction()},getFilesPath:function(e,t){if(-1!==e.indexOf("?"))if("Desktop"===EnvDetection.deviceType)var a=e+"desktop/data/";else var a=e+"html/data/";else{var i="undefined"!=typeof t.settings.pages.sizes;if(i)var a="../";else var a="Desktop"===EnvDetection.deviceType?"../desktop/data/":"../html/data/"}return this.getParam("filePath")||encodeURIComponent(a)},getFilesList:function(e,t){var a=e;if("2"===a.API_VERSION){var i=a.currentPage,r="single"===a.settings.pages.coverType;r&&a.isDoublePage&&1===i&&(i=0);var n=a.pageReferences[i],s=a.pageReferences[i+1];if(n)if(a.settings.pages.useXJpgForZoom)var o=n.hdx;else var o=n.hd;if(s)if(a.settings.pages.useXJpgForZoom)var l=s.hdx;else var l=s.hd}else var c=e.pages[e.currentContainer].pageType.zoom,o=c[0],l=c[1];var d,g=this.getPage(),h=!0,u=[];switch(g){case"left":u.push(o),d=e.leftPageNumber;break;case"right":l&&(u.push(l),d=e.rightPageNumber);break;case"double":l&&(u.push(o),u.push(l),d=e.leftPageNumber+"_"+e.rightPageNumber);break;case"localURL":u.push(this.getParam("path")),d="catalog.pdf";break;case"current":default:a.isDoublePage?(o&&u.push(o),l&&u.push(l)):u.push(o),d=e.leftPageNumber,1==e.currentPage&&(d=e.rightPageNumber)}var m=MainFrame.Util.getMainFrame();h&&"undefined"!=typeof d&&m.hasTracking&&MainFrame.Tracker.sendTrackedEvent(t,"press",this.initiatorObject,[d]);var p=u.join(",");return MainFrame.Util.localizePath(p)},getPage:function(){return this.getParam("page")}}),MainFrame.Action.RedirectURL=MainFrame.Abstract.Action.extend({startAction:function(){var e=decodeURIComponent(this.getParam("url")),t=this.getParam("delay")||0;t?setTimeout(function(){window.location.href=e},t):window.location.href=e,this.endAndClearAction()}}),MainFrame.Action.RefreshRepeat=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("repeatId"),t=MainFrame.Manager.Scoping.getById(e);t&&(console.log(t),t.refresh()),this.endAndClearAction()}}),MainFrame.Action.RemoveCSSClass=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("class"),a=this.getParam("element")||"container";if(t){if("container"===a)var i=e.containerElement;else if("content"===a)var i=e.contentElement;else if("skin"===a)var i=e.skinElement;var r=this.getParam("delay");if(r)var n=parseFloat(r,10);else var n=0;var s=MainFrame.Util.secondsToMiliseconds(n),o=this;setTimeout(function(){MainFrame.Util.removeClass(i,t),o.endAndClearAction()},s),0===s&&MainFrame.Util.removeClass(i,t)}}else this.endAndClearAction()}}),MainFrame.Action.RemoveFocus=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e?e.containerElement&&(e=e.containerElement):e=MainFrame.Util.getActiveElement(),e.blur(),this.endAndClearAction()}}),MainFrame.Action.RemoveHash=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("hash"),t=this.getParam("hashId");t&&(e=MainFrame.Router.getHashForId(t)),e&&MainFrame.Router.remove(e),this.endAndClearAction()
}}),MainFrame.Action.RemoveManagerItem=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("manager"),t=MainFrame.Util.capitalize(e),a=MainFrame.Manager[t];if(a){var i=this.getParam("itemId");a.unregisterById(i)}this.endAndClearAction()}}),MainFrame.Action.ResetClickCount=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&(e.clicked=!1),this.endAndClearAction()}}),MainFrame.Action.SendToBack=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=e.containerElement.parentNode,a=t.childNodes.length>1;if(a){var i=t.childNodes[0];t.insertBefore(e.containerElement,i)}}this.endAndClearAction()}}),MainFrame.Action.SetCondition=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("condition"),t=this.getParam("value");MainFrame.Manager.CustomCondition.register(e,t),this.endAndClearAction()}}),MainFrame.Action.SetCursor=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("cursor");e&&t&&(e.containerElement.style.cursor=t),this.endAndClearAction()}}),MainFrame.Action.SetDepth=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("depth"),a=e.containerElement.parentNode,i=a.childNodes.length>1;if("undefined"!=typeof t&&i){var r=a.childNodes.length;if(t>r-1)a.insertBefore(e.containerElement);else{var n=a.childNodes[t];a.insertBefore(e.containerElement,n)}}}this.endAndClearAction()}}),MainFrame.Action.SetLanguage=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("language");if(e){MainFrame.Util.setLanguage(e);var t=MainFrame.Util.getMainFrame();t.reloadText();var a=this.getParam("catalogId")||"catalog",i=MainFrame.Manager.Scoping.getById(a);if(i){i.reload(),i.resize();var r=MainFrame.ModuleManager.getById(i.catalogId);MainFrame.DataParser.parseSearch.call(i,r)}}else MainFrame.Util.showError("SetLanguage error! The language parameter was not given!");this.endAndClearAction()}}),MainFrame.Action.SetFocus=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.containerElement;t&&t.focus&&t.focus(),this.endAndClearAction()}}),MainFrame.Action.SetText=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("textId");if(null!==t)var a=MainFrame.Manager.Text.getById(t);else var a=this.getParam("text");e?e.setText(a):MainFrame.Util.showError('SetText error! The target with the id "'+this.targetObjectId+'" does not exist'),this.endAndClearAction()}}),MainFrame.Action.SetSource=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("source")||"";e.setSource&&e.setSource(t),this.endAndClearAction()}}),MainFrame.Action.SetZIndex=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("zIndex");"undefined"!=typeof t&&(e.containerElement.style.zIndex=t)}this.endAndClearAction()}}),MainFrame.Action.StopVideo=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.contentElement;t.load(),this.endAndClearAction()}}),MainFrame.Action.ToggleFullscreen=MainFrame.Abstract.Action.extend({startAction:function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen(),this.endAndClearAction()}}),MainFrame.Action.Uncheck=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();"undefined"!=typeof e.isChecked,e&&e.uncheck(),this.endAndClearAction()}}),MainFrame.Action.UncheckAll=MainFrame.Action.CheckAll.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.extractCheckboxItemsFromTarget(e);t.forEach(function(e){e.uncheck()})}this.endAndClearAction()}}),MainFrame.Action.UnblockActions=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.actionBlocker;t&&(e.removeSubObject(t),delete e.actionBlocker),this.endAndClearAction()}}),MainFrame.Action.UpdateSkin=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("img"),a=this.getParam("file"),i=this.getParam("src"),r=this.getParam("backgroundSize"),n=this.getParam("backgroundRepeat"),s=this.getParam("backgroundPosition"),o=this.getParam("backgroundPositionX"),l=this.getParam("backgroundPositionY"),c=this.getParam("color"),d=this.getParam("alpha"),g=this.getParam("shape"),h=this.getParam("border"),u=this.getParam("borderTop"),m=this.getParam("borderLeft"),p=this.getParam("borderRight"),f=this.getParam("borderBottom"),v=this.getParam("size"),M=this.getParam("sizeW"),b=this.getParam("sizeH"),F=this.getParam("pos"),A=this.getParam("posX"),P=this.getParam("posY");if(!e.skins){e.skins=[];var y=new MainFrame.Element.Skin;y.superObject=e;var C=!0;y.containerElement=MainFrame.Util.createElement("div","v7__elem--skin",e.contentElement,C),e.skins.push(y)}var E=e.skins[0],y=E.containerElement;t&&MainFrame.DataParser.applySkinImg.call(e,t,y),a&&MainFrame.DataParser.applySkinImg.call(e,a,y),i&&(0===i.indexOf("#")?MainFrame.DataParser.applySkinColor.call(e,i,y):MainFrame.DataParser.applySkinImg.call(e,i,y)),r&&MainFrame.DataParser.applyBackgroundSize.call(e,r,y),n&&MainFrame.DataParser.applyBackgroundRepeat.call(e,n,y),s&&MainFrame.DataParser.applyBackgroundPosition.call(e,s,y),o&&MainFrame.DataParser.applyBackgroundPositionX.call(e,o,y),l&&MainFrame.DataParser.applyBackgroundPositionY.call(e,l,y),c&&MainFrame.DataParser.applySkinColor.call(e,c,y),d&&MainFrame.DataParser.applySkinOpacity.call(e,d,y),g&&MainFrame.DataParser.applySkinShape.call(e,g),h&&MainFrame.DataParser.applySkinBorder.call(e,h,y),m&&MainFrame.DataParser.applySkinBorderLeft.call(e,m,y),p&&MainFrame.DataParser.applySkinBorderRight.call(e,p,y),u&&MainFrame.DataParser.applySkinBorderTop.call(e,u,y),f&&MainFrame.DataParser.applySkinBorderBottom.call(e,f,y),v&&MainFrame.DataParser.setSize.call(E,v,"skin"),F&&MainFrame.DataParser.setPos.call(E,F),M&&(E.dimensionX=M,E.states.def.w=M),b&&(E.dimensionY=b,E.states.def.h=b),A&&(-1!==A.indexOf("center")&&(A=A.replace("center","50%-w/2")),-1!==A.indexOf("left")&&(A=A.replace("left","0")),-1!==A.indexOf("right")&&(A=A.replace("right","100%-w")),E.positionX=A,E.states.def.x=A),P&&(-1!==P.indexOf("center")&&(P=P.replace("center","50%-h/2")),-1!==P.indexOf("top")&&(P=P.replace("top","0")),-1!==P.indexOf("bottom")&&(P=P.replace("bottom","100%-h")),E.positionY=P,E.states.def.y=P),E.resize(),this.endAndClearAction()}}),MainFrame.Trigger.Initialization=MainFrame.Abstract.Trigger.extend({startAction:function(){this.interpretors.initialization||(this.interpretors.initialization=!0,MainFrame.EventHandler.addHandler("initialization",this.doAction,this,this.initiatorObject,!0,0,0,0))},doAction:function(e){this._doAction(e)}}),MainFrame.Trigger.Keyboard=MainFrame.Abstract.Trigger.extend({startAction:function(){MainFrame.EventHandler.addHandler("keydown",this.doAction,this,this.initiatorObject,!0,0,0,0)},doAction:function(e){var t=e.srcElement||e.target,a=t.tagName.match(/input|textarea|select/i),i=this.options&&this.options.keyCode;if(i)var r=this.options.keyCode;else{var n=this.initiatorObject;if("back"===this.options.type){if("flip"===n.settings.navigationType||"horizontalSlide"===n.settings.navigationType)var r=this.options.keyCodeLeft;if("verticalSlide"===n.settings.navigationType)var r=this.options.keyCodeUp}else if("next"===this.options.type){if("flip"===n.settings.navigationType||"horizontalSlide"===n.settings.navigationType)var r=this.options.keyCodeRight;if("verticalSlide"===n.settings.navigationType)var r=this.options.keyCodeDown}"undefined"!=typeof r&&(i=!0)}var s=13===e.keyCode&&13===r,o=t.tagName.match(/input/i),l=this.initiatorObject.txtType&&("input"===this.initiatorObject.txtType||"textarea"===this.initiatorObject.txtType),c=document.activeElement===this.initiatorObject.containerElement;l?c&&(i&&e.keyCode===r&&!a?this._doAction(e):i&&s&&o&&this._doAction(e)):i&&e.keyCode===r&&!a?this._doAction(e):i&&s&&o&&this._doAction(e)}}),MainFrame.Trigger.Move=MainFrame.Abstract.Trigger.extend({startAction:function(){var e=MainFrame.Browser.hasTouch?"touchmove":"mousemove";MainFrame.EventHandler.addHandler(e,this.doAction,this,this.initiatorObject,!0,0,0,0)},doAction:function(e){this._doAction(e)}}),MainFrame.Trigger.Release=MainFrame.Abstract.Trigger.extend({startAction:function(){var e=MainFrame.Browser.hasTouch?"touchend":"mouseup";MainFrame.EventHandler.addHandler(e,this.doAction,this,this.initiatorObject,!0,0,0,0)},doAction:function(e){this._doAction(e)}}),MainFrame.Trigger.Anonymous=MainFrame.Abstract.Trigger.extend({startAction:function(){if(this.options&&this.options.triggerName){var e=this.options.triggerName,t=!0;if(this.options.interpretor){t=!1,this.initiatorObject.interpretors||(this.initiatorObject.interpretors={});var a=e;("firstClick"===a||"secondClick"===a)&&(a="click"),this.initiatorObject.interpretors[a]||(this.initiatorObject.interpretors[a]=new this.options.interpretor(this.initiatorObject,this.targetId,this.actionParamsObj,this.options.preventDefault))}var i=0===e.indexOf("#");i&&(e=e.replace("#target",this.targetId)),MainFrame.EventHandler.addHandler(e,this.doAction,this,this.initiatorObject,t,0,0,0)}},doAction:function(e){this._doAction(e)}}),MainFrame.Interpretor.Drag=MainFrame.Abstract.Interpretor.extend({addListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.bind(e,MainFrame.Event.start,this)},addDragListeners:function(){var e=document.body;MainFrame.Event.bind(e,MainFrame.Event.move,this),MainFrame.Event.bind(e,MainFrame.Event.end,this),MainFrame.Event.bind(e,MainFrame.Event.cancel,this),MainFrame.Event.bind(e,MainFrame.Event.out,this)},removeListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.unbind(e,Event.start,this)},removeDragListeners:function(){var e=document.body;MainFrame.Event.unbind(e,Event.move,this),MainFrame.Event.unbind(e,Event.end,this),MainFrame.Event.unbind(e,Event.cancel,this),MainFrame.Event.unbind(e,Event.out,this)},handleEvent:function(e){if(e.type===MainFrame.Event.start)this.onTouchStart(e),this.addDragListeners();else if(e.type===MainFrame.Event.move)this.onTouchMove(e);else if(e.type===MainFrame.Event.end||e.type===MainFrame.Event.cancel||e.type===MainFrame.Event.out){var t=!0;if(e.type===MainFrame.Event.out){var a=e.pageX<=0||e.pageX>=MainFrame.Browser.width,i=e.pageY<=0||e.pageY>=MainFrame.Browser.height;t=a||i?!0:!1}t&&(this.onTouchEnd(e),this.removeDragListeners())}},onTouchStart:function(e){var t=this,a=MainFrame.Util.getActiveElement();a.blur(),MainFrame.Event.isMultiTouch(e)||(t.dragStarted=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.initialX=this.currentEvent.pageX,t.initialY=this.currentEvent.pageY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=0,t.totalDistanceY=0,t.dragStartedTime=(new Date).getTime()),MainFrame.Event.preventDefault(e),MainFrame.Event.stop(e)},onTouchMove:function(e){var t=this;t.dragStarted&&(t.target.isDragged=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=this.currentEvent.pageX,t.currentY=this.currentEvent.pageY,t.distanceX=this.currentEvent.pageX-t.previousX,t.distanceY=this.currentEvent.pageY-t.previousY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY,MainFrame.EventHandler.dispatch("drag",[this],this.initiator))},onTouchEnd:function(){this.dragStarted&&(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.target.isDragged=!1)}}),MainFrame.Interpretor.Pinch=MainFrame.Interpretor.Drag.extend({onTouchStart:function(e){var t=this;if(MainFrame.Event.isMultiTouch(e)){t.pinchStarted=!0;var a=e.touches[0],i=e.touches[1];t.initialCenterX=(a.pageX+i.pageX)/2,t.initialCenterY=(a.pageY+i.pageY)/2,t.initialDistance=t.getDistance(e.touches)}MainFrame.Event.preventDefault(e)},onTouchMove:function(e){var t=this;if(t.pinchStarted&&MainFrame.Event.isMultiTouch(e)){var a=e.touches[0],i=e.touches[1];if(t.centerX=(a.pageX+i.pageX)/2,t.centerY=(a.pageY+i.pageY)/2,t.distance=t.getDistance(e.touches),"undefined"==typeof e.scale){var r=t.distance/t.initialDistance;t.scale=r}else t.scale=e.scale;MainFrame.EventHandler.dispatch("pinch",[this],this.initiator)}},onTouchEnd:function(e){this.pinchStarted&&(this.pinchStarted&&MainFrame.Event.isMultiTouch(e)&&(this.initialDistance=this.getDistance(e.touches)),this.pinchStarted=!1)},getDistance:function(e){var t=e[0],a=e[1];return Math.sqrt(Math.pow(t.clientX-a.clientX,2)+Math.pow(t.clientY-a.clientY,2))}}),MainFrame.Interpretor.Press=MainFrame.Abstract.Interpretor.extend({addListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.bind(e,MainFrame.Event.start,this)},addPressListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.bind(e,MainFrame.Event.end,this),MainFrame.Event.bind(e,MainFrame.Event.move,this),MainFrame.Event.bind(e,MainFrame.Event.cancel,this)},removeListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.unbind(e,Event.start,this)},removePressListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.unbind(e,Event.end,this),MainFrame.Event.unbind(e,Event.move,this),MainFrame.Event.unbind(e,Event.cancel,this)},handleEvent:function(e){e.shouldPreventDefault=this.shouldPreventDefault,e.type===MainFrame.Event.start?(this.onTouchStart(e),this.addPressListeners()):e.type===MainFrame.Event.move?this.onTouchMove(e):(e.type===MainFrame.Event.end||e.type===MainFrame.Event.cancel||e.type===MainFrame.Event.out)&&(this.onTouchEnd(e),this.removePressListeners())},onTouchStart:function(e){var t=this;e.changedTouches&&e.changedTouches[0]?(t.initialX=e.changedTouches[0].pageX,t.initialY=e.changedTouches[0].pageY):(t.initialX=e.pageX,t.initialY=e.pageY),MainFrame.Event.isMultiTouch(e)||(t.hasMoved=!1,t.eventData=e.changedTouches?e.changedTouches[0]:e),MainFrame.Event.preventDefault(e)},minClickDistance:10,onTouchMove:function(e){var t,a;e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].pageX,a=e.changedTouches[0].pageY):(t=e.pageX,a=e.pageY),(t>=this.initialX+this.minClickDistance||t<=this.initialX-this.minClickDistance||a>=this.initialY+this.minClickDistance||a<=this.initialY-this.minClickDistance)&&(this.hasMoved=!0)},onTouchEnd:function(e){var t=this;if(!t.hasMoved){if(this.initiatedByTheCatalog()&&!this.validCatalogTarget(e))return;var a=MainFrame.Util.getActiveElement();a.blur(),t.showTapEffect(),MainFrame.EventHandler.dispatch("click",[t],t.initiator),t.initiator.clicked?(MainFrame.EventHandler.dispatch("secondClick",[t],t.initiator),t.initiator.clicked=!1):(MainFrame.EventHandler.dispatch("firstClick",[t],t.initiator),t.initiator.clicked=!0);var i=e.target||e.srcElement;(i===t.initiator.containerElement||i===t.initiator.contentElement)&&MainFrame.EventHandler.dispatch("clickOnContainer",[t],t.initiator)}t.hasMoved=!1}}),MainFrame.Interpretor.Swipe=MainFrame.Interpretor.Drag.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){this.dragStarted&&(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.isDragged&&this.dragDuration<400&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipe",[this],this.initiator)),this.isDragged=!1)}}),MainFrame.Interpretor.DoublePress=MainFrame.Abstract.Interpretor.extend({dblClickDelay:300,dblclickTolerance:30,lastEvent:null,isSwipe:!1,addListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.bind(e,MainFrame.Event.start,this),MainFrame.Event.bind(e,MainFrame.Event.move,this)},removeListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.unbind(e,Event.start,this),MainFrame.Event.unbind(e,Event.move,this)},handleEvent:function(e){e.shouldPreventDefault=this.shouldPreventDefault,e.type===MainFrame.Event.start?this.onTouchStart(e):e.type===MainFrame.Event.move&&this.onTouchMove(e)},onTouchStart:function(e){var t=this;if(e.changedTouches&&e.changedTouches[0]?(t.initialX=e.changedTouches[0].pageX,t.initialY=e.changedTouches[0].pageY):(t.initialX=e.pageX,t.initialY=e.pageY),t.isSwipe===!1&&t.lastEvent&&t.isDoubleClick(e,t.lastEvent)&&(e.touches&&1===e.touches.length||"undefined"==typeof e.touches)){if(this.initiatedByTheCatalog()&&!this.validCatalogTarget(e))return;return t.showTapEffect(),void MainFrame.EventHandler.dispatch("doubleClick",[t],t.initiator)}t.isSwipe=!1,t.lastEvent=t.getEventInfo(e)},onTouchMove:function(e){var t,a;e.changedTouches&&e.changedTouches[0]?(t=e.changedTouches[0].pageX,a=e.changedTouches[0].pageY):(t=e.pageX,a=e.pageY),(t!==this.initialX||a!==this.initialY)&&(Math.abs(t-this.initialX)>this.dblclickTolerance||Math.abs(a-this.initialY)>this.dblclickTolerance)&&(this.isSwipe=!0)},onTouchEnd:function(){},isDoubleClick:function(e,t){return this.passesDblclickTime(e,t)&&this.passesDblclickTolerance(e,t)},passesDblclickTime:function(e,t){return t.startTime?(e.timeStamp||Date.now())-t.startTime<this.dblClickDelay:!1},passesDblclickTolerance:function(e,t){return t.clientX&&t.clientY?this.getTouchDistance(e,t)<=this.dblclickTolerance:!0},getEventInfo:function(e){var t=e.touches?e.touches[0]:e;return{clientX:t.clientX,clientY:t.clientY,startTime:e.timeStamp||Date.now()}},getTouchDistance:function(e,t){var e=e.touches?e.touches[0]:e;return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))}}),MainFrame.Interpretor.DragEnd=MainFrame.Interpretor.Drag.extend({onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.dragStarted=!0),MainFrame.Event.preventDefault(e)},onTouchMove:function(){var e=this;e.dragStarted&&(e.isDragged=!0)},onTouchEnd:function(){this.dragStarted&&(this.dragStarted=!1,this.isDragged&&MainFrame.EventHandler.dispatch("dragEnd",[this],this.initiator),this.isDragged=!1)}}),MainFrame.Interpretor.DragHorizontal=MainFrame.Interpretor.Drag.extend({onTouchMove:function(e){var t=this;if(t.dragStarted){t.target.isDragged=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=this.currentEvent.pageX,t.currentY=this.currentEvent.pageY,t.distanceX=this.currentEvent.pageX-t.previousX,t.distanceY=this.currentEvent.pageY-t.previousY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY;var a=Math.abs(t.currentY),i=Math.abs(t.initialY);Math.abs(a-i)<10&&MainFrame.EventHandler.dispatch("dragHorizontal",[this],this.target)}}}),MainFrame.Interpretor.DragStart=MainFrame.Interpretor.Drag.extend({onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.dragStarted=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e),t.dragStartDispatched=!1,MainFrame.Event.preventDefault(e)},onTouchMove:function(e){var t=this;!t.dragStarted||t.dragStartDispatched||MainFrame.Event.isMultiTouch(e)||(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("dragStart",[t],t.initiator),t.dragStartDispatched=!0)},onTouchEnd:function(){this.dragStarted&&(this.dragStarted=!1)}}),MainFrame.Interpretor.LongPress=MainFrame.Interpretor.Press.extend({hasMoved:!1,onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.eventData=e.changedTouches?e.changedTouches[0]:e,t.startTime=(new Date).getTime(),t.hasMoved=!1,t.longPressTimeout=setTimeout(function(){MainFrame.EventHandler.dispatch("longPress",[t],t.initiator)},750)),MainFrame.Event.preventDefault(e)},onTouchMove:function(){this.hasMoved=!0,clearTimeout(this.longPressTimeout)},onTouchEnd:function(){var e=this;e.endTime=(new Date).getTime();var t=(e.endTime-e.startTime)/1e3;(e.hasMoved||750>t)&&clearTimeout(e.longPressTimeout),e.hasMoved=!1}}),MainFrame.Interpretor.MouseWheel=MainFrame.Abstract.Interpretor.extend({addListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.bind(e,MainFrame.Event.wheel,this)},removeListeners:function(){var e=this.initiator.containerElement;MainFrame.Event.unbind(e,Event.wheel,this)},handleEvent:function(e){e.type===MainFrame.Event.wheel&&this.onScroll(e)},onScroll:function(e){this.target.scrolling||(this.target.scrolling=!0,this.scrolledDistance=0);var t=e.detail||e.wheelDelta;this.scrolledDistance+=t,MainFrame.EventHandler.dispatch("wheelScroll",[this],this.target),MainFrame.Event.preventDefault(e)},canPropagate:function(e){var t=e.srcElement||e.target,a=t.tagName.match(/input|textarea|select/i);return a&&t!==this.initiator.containerElement?!1:!0}}),MainFrame.Interpretor.MouseWheelDown=MainFrame.Interpretor.MouseWheel.extend({onScroll:function(e){this.canPropagate(e)&&("Moz"===MainFrame.Browser.vendorPrefix&&e.detail>0||e.wheelDelta<0)&&MainFrame.EventHandler.dispatch("wheelDown",[this],this.target),MainFrame.Event.preventDefault(e)}}),MainFrame.Interpretor.MouseWheelLeft=MainFrame.Interpretor.MouseWheel.extend({onScroll:function(e){this.canPropagate(e)&&"Moz"!==MainFrame.Browser.vendorPrefix&&e.wheelDeltaX>0&&MainFrame.EventHandler.dispatch("wheelLeft",[this],this.target),MainFrame.Event.preventDefault(e)}}),MainFrame.Interpretor.MouseWheelRight=MainFrame.Interpretor.MouseWheel.extend({onScroll:function(e){this.canPropagate(e)&&"Moz"!==MainFrame.Browser.vendorPrefix&&e.wheelDeltaX<0&&MainFrame.EventHandler.dispatch("wheelRight",[this],this.target),MainFrame.Event.preventDefault(e)}}),MainFrame.Interpretor.MouseWheelUp=MainFrame.Interpretor.MouseWheel.extend({onScroll:function(e){this.canPropagate(e)&&("Moz"===MainFrame.Browser.vendorPrefix&&e.detail<0||e.wheelDelta>0)&&MainFrame.EventHandler.dispatch("wheelUp",[this],this.target),MainFrame.Event.preventDefault(e)}}),MainFrame.Interpretor.PinchEnd=MainFrame.Interpretor.Pinch.extend({onTouchEnd:function(e){this.pinchStarted&&(this.pinchStarted&&MainFrame.Event.isMultiTouch(e)&&(this.initialDistance=this.getDistance(e.touches)),MainFrame.EventHandler.dispatch("pinchEnd",[this],this.initiator),this.pinchStarted=!1)}}),MainFrame.Interpretor.PinchStart=MainFrame.Interpretor.Pinch.extend({onTouchMove:function(e){var t=this;if(t.pinchStarted&&MainFrame.Event.isMultiTouch(e)){var a=e.touches[0],i=e.touches[1];if(t.centerX=(a.pageX+i.pageX)/2,t.centerY=(a.pageY+i.pageY)/2,t.distance=t.getDistance(e.touches),"undefined"==typeof e.scale){var r=t.distance/t.initialDistance;t.scale=r}else t.scale=e.scale;MainFrame.EventHandler.dispatch("pinchStart",[this],this.initiator)}}}),MainFrame.Interpretor.SinglePress=MainFrame.Interpretor.Press.extend({clicks:0,onTouchStart:function(e){var t=this;e.changedTouches&&e.changedTouches[0]?(t.initialX=e.changedTouches[0].pageX,t.initialY=e.changedTouches[0].pageY):(t.initialX=e.pageX,t.initialY=e.pageY),MainFrame.Event.isMultiTouch(e)||(t.clicks++,t.hasMoved=!1,t.eventData=e.changedTouches?e.changedTouches[0]:e),MainFrame.Event.preventDefault(e)},onTouchEnd:function(e){var t=this;t.hasMoved?t.clicks=0:setTimeout(function(){if(1===t.clicks){t.showTapEffect();var a=t.initiator instanceof MainFrame.Element.Catalog,i=a&&t.validCatalogTarget(e),r=!a;(r||i)&&MainFrame.EventHandler.dispatch("singleClick",[t],t.initiator)}t.clicks=0},300),t.hasMoved=!1}}),MainFrame.Interpretor.SwipeDown=MainFrame.Interpretor.Swipe.extend({onTouchEnd:function(e){this.dragStarted&&(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.isDragged&&(this.totalDistanceY>parseInt(this.initiator.getDimensionY(),10)/2||this.dragDuration<400&&Math.abs(this.totalDistanceY)>Math.abs(this.totalDistanceX)&&this.totalDistanceY>0)&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeDown",[this],this.initiator)),this.isDragged=!1)}}),MainFrame.Interpretor.SwipeLeft=MainFrame.Interpretor.Swipe.extend({onTouchEnd:function(e){this.dragStarted&&(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.isDragged&&this.dragDuration<400&&Math.abs(this.totalDistanceX)>Math.abs(this.totalDistanceY)&&this.totalDistanceX<0&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeLeft",[this],this.initiator)),this.isDragged=!1)}}),MainFrame.Interpretor.SwipeRight=MainFrame.Interpretor.Drag.extend({onTouchEnd:function(e){this.dragStarted&&(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.isDragged&&this.dragDuration<400&&Math.abs(this.totalDistanceX)>Math.abs(this.totalDistanceY)&&this.totalDistanceX>0&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeRight",[this],this.initiator)),this.isDragged=!1)}}),MainFrame.Interpretor.SwipeUp=MainFrame.Interpretor.Drag.extend({onTouchEnd:function(e){this.dragStarted&&(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.isDragged&&(this.totalDistanceY<-parseInt(this.initiator.getDimensionY(),10)/2||this.dragDuration<400&&Math.abs(this.totalDistanceY)>Math.abs(this.totalDistanceX)&&this.totalDistanceY<0)&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeUp",[this],this.initiator)),this.isDragged=!1)}}),MainFrame.Animate={time:Date.now,desiredFrames:60,millisecondsPerSecond:1e3,running:{},counter:1,requestAnimationFrame:function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame,t=!!e;if(e&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(e.toString())&&(t=!1),t)return function(t,a){e(t,a)};var a=60,i={},r=0,n=1,s=null,o=+new Date;return function(e){var t=n++;return i[t]=e,r++,null===s&&(s=setInterval(function(){var e=+new Date,t=i;i={},r=0;for(var a in t)t.hasOwnProperty(a)&&(t[a](e),o=e);e-o>2500&&(clearInterval(s),s=null)},1e3/a)),t}}(),stop:function(e){var t=this,a=null!=t.running[e];return a&&(t.running[e]=null),a},isRunning:function(e){return null!=this.running[e]},start:function(e,t,a,i,r,n){var s=this,o=s.time(),l=o,c=0,d=0,g=s.counter++;if(n||(n=document.body),g%20===0){var h={};for(var u in s.running)h[u]=!0;s.running=h}var m=function(h){var u=h!==!0,p=s.time();if(!s.running[g]||t&&!t(g))return s.running[g]=null,void(a&&a(s.desiredFrames-d/((p-o)/s.millisecondsPerSecond),g,!1));if(u)for(var f=Math.round((p-l)/(s.millisecondsPerSecond/s.desiredFrames))-1,v=0,M=Math.min(f,4);M>v;v++)m(!0),d++;i&&(c=(p-o)/i,c>1&&(c=1));var b=r?r(c):c;e(b,p,u)!==!1&&1!==c||!u?u&&(l=p,s.requestAnimationFrame(m,n)):(s.running[g]=null,a&&a(s.desiredFrames-d/((p-o)/s.millisecondsPerSecond),g,1===c||null==i))};return s.running[g]=!0,s.requestAnimationFrame(m,n),g}},MainFrame.Easing=MainFrame.Class.extend({options:null,__frictionFactor:.9,__eventTimeoutInterval:750,__isSingleTouch:!1,__isTracking:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__minScrollLeft:0,__maxScrollTop:0,__minScrollTop:0,__isEnabled:!1,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,__target:null,__completedEvent:"",onCompletionDispatch:function(e){this.__completedEvent=e},onTranslationDispatch:function(e){this.__translationEvent=e},setTarget:function(e){this.__target=e,this.__targetContainer||(this.__targetContainer=e.containerElement)},setZoomLevel:function(e){this.__zoomLevel=e},setScrollPosition:function(e,t){this.__scrollLeft=e,this.__scrollTop=t},setOptions:function(e){var t={scrollingX:!0,scrollingY:!0,animating:!0,bouncing:!0,locking:!0,animationDuration:250};for(var a in e)t[a]=e[a];this.options=t},setScrollLeftLimits:function(e,t){this.__minScrollLeft=e,this.__maxScrollLeft=t},setScrollTopLimits:function(e,t){this.__minScrollTop=e,this.__maxScrollTop=t},startWithEvent:function(e){this.options||this.setOptions({}),this.__isEnabled=!0,this.onTouchStart(e),this.onTouchMove(e)},stop:function(){this.__isEnabled=!1,this.__eventTimeout&&clearTimeout(this.__eventTimeout),this.removeListeners()},handleEvent:function(e){e.type===MainFrame.Event.move?this.onTouchMove(e):(e.type===MainFrame.Event.end||e.type===MainFrame.Event.cancel||e.type===MainFrame.Event.out)&&this.onTouchEnd(e)},onTouchStart:function(e){var t=this,a=e.touches?e.touches[0]:e,i=e.timeStamp||Date.now();t.__eventTimeout&&clearTimeout(t.__eventTimeout),t.__isDecelerating&&(MainFrame.Animate.stop(t.__isDecelerating),t.__isDecelerating=!1);var r,n,s=MainFrame.Event.isSingleTouch(e);s?(r=a.pageX,n=a.pageY):(r=Math.abs(e.touches[0].pageX+e.touches[1].pageX)/2,n=Math.abs(e.touches[0].pageY+e.touches[1].pageY)/2),t.__initialTouchLeft=r,t.__initialTouchTop=n,t.__lastTouchLeft=r,t.__lastTouchTop=n,t.__lastTouchMove=i,t.__isTracking=!0,t.__isDragging=!s,t.__positions=[],t.__isSingleTouch=s,MainFrame.Event.preventDefault(e)},onTouchMove:function(e){var t=this,a=e.touches?e.touches[0]:e,i=e.timeStamp||Date.now();if(e.scale,t.__isTracking){var r,n;MainFrame.Event.isMultiTouch(e)?(r=Math.abs(e.touches[0].pageX+e.touches[1].pageX)/2,n=Math.abs(e.touches[0].pageY+e.touches[1].pageY)/2):(r=a.pageX,n=a.pageY);var s=t.__positions;if(t.__isDragging){var o=r-t.__lastTouchLeft,l=n-t.__lastTouchTop,c=t.__scrollLeft,d=t.__scrollTop,g=t.__zoomLevel;if(t.__enableScrollX){c-=o;var h=t.__maxScrollLeft,u=t.__minScrollLeft;(c>h||u>c)&&(t.options.bouncing?c+=o/2:c=c>h?h:u>c?u:0)}if(t.__enableScrollY){d-=l;var m=t.__maxScrollTop,p=t.__minScrollTop;(d>m||p>d)&&(t.options.bouncing?d+=l/2:d=d>m?m:p>d?p:0)}s.length>60&&s.splice(0,30),s.push(c,d,i),t.__publish(c,d,g)}else{var f=3,v=5,M=Math.abs(r-t.__initialTouchLeft),b=Math.abs(n-t.__initialTouchTop);t.__enableScrollX=t.options.scrollingX&&M>=f,t.__enableScrollY=t.options.scrollingY&&b>=f,s.push(t.__scrollLeft,t.__scrollTop,i),t.__isDragging=M>=v||b>=v}t.__lastTouchLeft=r,t.__lastTouchTop=n,t.__lastTouchMove=i}},onTouchEnd:function(e){var t=this,a=e.timeStamp||Date.now();if(t.__isTracking&&(t.__isTracking=!1,this.removeListeners(),t.__isDragging)){if(t.__isDragging=!1,t.__isSingleTouch&&t.options.animating&&a-t.__lastTouchMove<=100){for(var i=t.__positions,r=i.length-1,n=r,s=r;s>0&&i[s]>t.__lastTouchMove-100;s-=3)n=s;if(n!==r){var o=i[r]-i[n],l=t.__scrollLeft-i[n-2],c=t.__scrollTop-i[n-1];t.__decelerationVelocityX=l/o*(1e3/60),t.__decelerationVelocityY=c/o*(1e3/60),Math.abs(t.__decelerationVelocityX)>1||Math.abs(t.__decelerationVelocityY)>1?t.__startDeceleration(a):(t.repositionTarget(),t.triggerCompletionEvent())}else t.repositionTarget(),t.triggerCompletionEvent()}else t.repositionTarget(),t.triggerCompletionEvent();t.__positions.length=0}},__publish:function(e,t,a,i){var r=this,n=r.__isAnimating;n&&alert("!!!!wasAnimating!!!!"),i&&r.options.animating,r.__scheduledLeft=r.__scrollLeft=e,r.__scheduledTop=r.__scrollTop=t,r.__scheduledZoom=r.__zoomLevel=a,r.__isEnabled!==!1&&(MainFrame.Util.setTransformDuration(r.__targetContainer,0),r.__invert?90==r.__rotation?MainFrame.Util.setPosition(r.__targetContainer,-t,e,a):MainFrame.Util.setPosition(r.__targetContainer,t,-e,a):MainFrame.Util.setPosition(r.__targetContainer,-e,-t,a),MainFrame.EventHandler.dispatch(r.__translationEvent,[r.__target]),r.__target.translatedX=-e,r.__target.translatedY=-t,r.__target.containerElement.translatedX=-e,r.__target.containerElement.translatedY=-t)
},__startDeceleration:function(){var e=this;e.__minDecelerationScrollLeft=e.__minScrollLeft,e.__minDecelerationScrollTop=e.__minScrollTop,e.__maxDecelerationScrollLeft=e.__maxScrollLeft,e.__maxDecelerationScrollTop=e.__maxScrollTop;var t=function(t,a,i){e.__stepThroughDeceleration(i)},a=function(){return Math.abs(e.__decelerationVelocityX)>=.1||Math.abs(e.__decelerationVelocityY)>=.1},i=function(){e.__isDecelerating=!1,e.scrollTo(e.__scrollLeft,e.__scrollTop,e.options.snapping),e.__isEnabled&&(e.repositionTarget(),e.triggerCompletionEvent())};e.__isDecelerating=MainFrame.Animate.start(t,a,i)},__stepThroughDeceleration:function(e){var t=this,a=t.__scrollLeft+t.__decelerationVelocityX,i=t.__scrollTop+t.__decelerationVelocityY;if(!t.options.bouncing,e?t.__publish(a,i,t.__zoomLevel):(t.__scrollLeft=a,t.__scrollTop=i),t.options.paging||(t.__decelerationVelocityX*=t.__frictionFactor,t.__decelerationVelocityY*=t.__frictionFactor),t.options.bouncing){var r=0,n=0,s=.03,o=.08;a<t.__minDecelerationScrollLeft?r=t.__minDecelerationScrollLeft-a:a>t.__maxDecelerationScrollLeft&&(r=t.__maxDecelerationScrollLeft-a),i<t.__minDecelerationScrollTop?n=t.__minDecelerationScrollTop-i:i>t.__maxDecelerationScrollTop&&(n=t.__maxDecelerationScrollTop-i),0!==r&&(r*t.__decelerationVelocityX<=0?t.__decelerationVelocityX+=r*s:t.__decelerationVelocityX=r*o),0!==n&&(n*t.__decelerationVelocityY<=0?t.__decelerationVelocityY+=n*s:t.__decelerationVelocityY=n*o)}},scrollTo:function(e,t,a,i){var r=this;r.__isDecelerating&&(MainFrame.Animate.stop(r.__isDecelerating),r.__isDecelerating=!1),null!=i&&i!==r.__zoomLevel?(e*=i,t*=i,r.__computeScrollMax(i)):i=r.__zoomLevel,r.options.scrollingX?r.options.paging?e=Math.round(e/r.__clientWidth)*r.__clientWidth:r.options.snapping&&(e=Math.round(e/r.__snapWidth)*r.__snapWidth):e=r.__scrollLeft,r.options.scrollingY?r.options.paging?t=Math.round(t/r.__clientHeight)*r.__clientHeight:r.options.snapping&&(t=Math.round(t/r.__snapHeight)*r.__snapHeight):t=r.__scrollTop;var n=Math.ceil(e),s=Math.ceil(t);e=e>0?Math.min(r.__maxScrollLeft,n):Math.max(r.__minScrollLeft,n),t=t>0?Math.min(r.__maxScrollTop,s):Math.max(r.__minScrollTop,s),e===r.__scrollLeft&&t===r.__scrollTop&&(a=!1),r.__publish(e,t,i,a)},scrollBy:function(e,t,a){var i=this,r=i.__isAnimating?i.__scheduledLeft:i.__scrollLeft,n=i.__isAnimating?i.__scheduledTop:i.__scrollTop;i.scrollTo(r+(e||0),n+(t||0),a)},addListeners:function(){var e=this,t=document.body;MainFrame.Event.bind(t,MainFrame.Event.move,e),MainFrame.Event.bind(t,MainFrame.Event.end,e),MainFrame.Event.bind(t,MainFrame.Event.cancel,e)},removeListeners:function(){var e=this,t=document.body;MainFrame.Event.unbind(t,MainFrame.Event.move,e),MainFrame.Event.unbind(t,MainFrame.Event.end,e),MainFrame.Event.unbind(t,MainFrame.Event.cancel,e)},repositionTarget:function(){var e=this;e.__scrollLeft=e.__scrollLeft>0?Math.min(e.__maxScrollLeft,e.__scrollLeft):Math.max(e.__minScrollLeft,e.__scrollLeft),e.__scrollTop=e.__scrollTop>0?Math.min(e.__maxScrollTop,e.__scrollTop):Math.max(e.__minScrollTop,e.__scrollTop),MainFrame.Util.setTransformDuration(e.__targetContainer,300),e.__invert?90==e.__rotation?MainFrame.Util.setPosition(e.__targetContainer,-e.__scrollTop,e.__scrollLeft,e.__zoomLevel,!0):MainFrame.Util.setPosition(e.__targetContainer,e.__scrollTop,-e.__scrollLeft,e.__zoomLevel,!0):MainFrame.Util.setPosition(e.__targetContainer,-e.__scrollLeft,-e.__scrollTop,e.__zoomLevel,!0),MainFrame.EventHandler.dispatch(e.__translationEvent,[e.__target]),e.__target.translatedX=-e.__scrollLeft,e.__target.translatedY=-e.__scrollTop,e.__target.containerElement.translatedX=-e.__scrollLeft,e.__target.containerElement.translatedY=-e.__scrollTop},triggerCompletionEvent:function(){var e=this;e.__target&&(e.__eventTimeout=setTimeout(function(){MainFrame.EventHandler.dispatch(e.__completedEvent,[e.__target]),e.stop()},e.__eventTimeoutInterval))}}),!function(){var e={doc:document,getElement:function(e){return"string"==typeof e?document.getElementById(e):e},createElement:function(e,t,a,i){var r=document.createElement(e);if(t&&(r.className=t),a)if(i){var n=a.parentNode;n.insertBefore(r,a)}else a.appendChild(r);return r},removeElement:function(e){try{e.parentNode.removeChild(e)}catch(t){MainFrame.Util.showError("There was an error while removing an element"),console.log(t)}},emptyElement:function(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)},hasClass:function(e,t){var a=e.className;return!!a&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(a)},addClass:function(e,t){e&&e.classList.add(t)},removeClass:function(e,t){e&&e.classList.remove(t)},setPosition:function(e,t,a,i,r){var n=MainFrame.Browser.hasTransformLevel;t+="",a+="";var s=-1===t.indexOf("%")?"px":"",o=-1===a.indexOf("%")?"px":"";"undefined"==typeof i?i=1:"object"==typeof i&&"undefined"!=typeof i.x&&"undefined"!=typeof i.y&&(i=i.x+","+i.y),r="undefined"==typeof r?!1:r,0!==n||r?1===n||0===n&&r?e.style[MainFrame.Browser.vendorPrefix+"Transform"]="translate("+t+s+","+a+o+") scale("+i+")":2===n&&(e.style.marginLeft=t?t/i+s:"",e.style.marginTop=a?a/i+o:"",e.style.zoom=i||""):e.style[MainFrame.Browser.vendorPrefix+"Transform"]="translate3d("+t+s+","+a+o+",0) scale("+i+")"},setRotation:function(e,t){e.style[MainFrame.Browser.vendorPrefix+"Transform"]="rotate("+t+"deg)"},setPositionAndRotation:function(e,t,a,i,r,n){var s=MainFrame.Browser.hasTransformLevel;t+="",a+="";var o=-1===t.indexOf("%")?"px":"",l=-1===a.indexOf("%")?"px":"";i="undefined"==typeof i?1:i,r="undefined"==typeof r?0:r,n="undefined"==typeof n?!1:n,0!==s||n?1===s||0===s&&n?e.style[MainFrame.Browser.vendorPrefix+"Transform"]="translate("+t+o+","+a+l+") scale("+i+") rotate("+r+"deg)":2===s&&(e.style.marginLeft=t?t/i+o:"",e.style.marginTop=a?a/i+l:"",e.style.zoom=i||""):e.style[MainFrame.Browser.vendorPrefix+"Transform"]="translate3d("+t+o+","+a+l+",0) scale("+i+") rotate("+r+"deg)"},setTransformRotationTranslationScale:function(e,t,a,i,r,n,s){var o=MainFrame.Browser.hasTransformLevel,l=t?"rotate("+t+"deg)":"",c="";(a||i)&&(0!==o||s?(1===o||0===o&&s)&&(c="translate("+a+"px,"+i+"px)"):c="translate3d("+a+"px,"+i+"px, 0)"),"undefined"==typeof n&&(n=r);var d="";"undefined"!=typeof r&&(d="scale("+r+", "+n+")");var g=[l,c,d].join(" ");e.style[MainFrame.Browser.vendorPrefix+"Transform"]=g},setTransformDuration:function(e,t,a){a="undefined"==typeof a?"ms":a,t="undefined"==typeof t?"0":t,e.style[MainFrame.Browser.vendorPrefix+"TransitionDuration"]=t+a},setTransform:function(e,t){var a=MainFrame.Browser.hasTransformLevel,i="",r=0,n=0;t.translation?(r=t.translation,n=t.translation):(t.translationX&&(r=t.translationX),t.translationY&&(n=t.translationY)),(r||n)&&(0!==a||t.disable3D?(1===a||0===a&&disable3D)&&(i="translate("+r+"px,"+n+"px)"):i="translate3d("+r+"px,"+n+"px, 0)",e.translatedX=r,e.translatedY=n);var s="",o=1,l=1;t.scale?(o=t.scale,l=t.scale):(t.scaleX&&(o=t.scaleX),t.scaleY&&(l=t.scaleY)),(o>0||l>0)&&(s="scale("+o+", "+l+")",e.scaleX=o,e.scaleY=l);var c="";if(t.rotation)c="rotate("+t.rotation+"deg)",e.rotation=t.rotation;else{var d="",g="";t.rotationX&&(d="rotateX("+t.rotationX+"deg)",e.rotationX=t.rotationX),t.rotationY&&(g="rotateY("+t.rotationY+"deg)",e.rotationY=t.rotationY),c=[d,g].join(" ")}var h=[i,s,c].join(" ");e.style[MainFrame.Browser.vendorPrefix+"Transform"]=h},setTransition:function(e,t,a,i){t=t||0,a=a||0,i=i||"all",e.style[MainFrame.Browser.vendorPrefix+"Transition"]=t+"ms "+a+"ms "+i},clearTransformations:function(e){e.style[MainFrame.Browser.vendorPrefix+"Transform"]="",e.style[MainFrame.Browser.vendorPrefix+"TransitionDelay"]="",e.style[MainFrame.Browser.vendorPrefix+"TransitionDuration"]=""},createClass:function(e,t){if(document.styleSheets&&0!=document.getElementsByTagName("head").length){var a,i=document.styleSheets,r=i.length;if(r>0)for(var n=0;r>n;n++)if(!i[n].disabled){var s=i[n].media;if(a=typeof s,"string"==a?(""==s||-1!=s.indexOf("screen"))&&(styleSheet=i[n]):"object"==a&&(""==s.mediaText||-1!=s.mediaText.indexOf("screen"))&&(styleSheet=i[n]),"undefined"!=typeof styleSheet)break}if("undefined"==typeof styleSheet){var o=document.createElement("style");for(o.type="text/css",document.getElementsByTagName("head")[0].appendChild(o),n=0;r>n;n++)i[n].disabled||(styleSheet=i[n]);var s=styleSheet.media;a=typeof s}if("string"==a){var l=styleSheet.rules||styleSheet.cssRules,c=l?l.length:0;for(n=0;c>n;n++)if(l[n].selectorText.toLowerCase()==e.toLowerCase())return void(l[n].style.cssText=t);styleSheet.addRule(e,t)}else if("object"==a){for(n=0;n<styleSheet.cssRules.length;n++)if(styleSheet.cssRules[n].selectorText&&styleSheet.cssRules[n].selectorText.toLowerCase()==e.toLowerCase())return void(styleSheet.cssRules[n].style.cssText=t);styleSheet.insertRule(e+"{"+t+"}",0)}}},stringToXML:function(e){var t,a;if(!e||"string"!=typeof e)return null;try{window.DOMParser?(a=new DOMParser,t=a.parseFromString(e,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e))}catch(i){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||MainFrame.Util.showError("Invalid XML: "+e),t},setDragTranslation:function(e,t){e.translatedX+=t.distanceX,e.translatedY+=t.distanceY,e.scale=MainFrame.Util.setDefault(e.scale,1),MainFrame.Util.setTransformDuration(e.containerElement,0),MainFrame.Util.setPosition(e.containerElement,e.translatedX,e.translatedY,e.scale)},setObjectPosition:function(e,t,a,i,r,n){e.translatedX=a,e.translatedY=i,MainFrame.Util.setTransformDuration(e.containerElement,t),MainFrame.Util.setPosition(e.containerElement,a,i,r,n)},existingClasses:{},classExists:function(e){if("undefined"!=typeof MainFrame.Util.existingClasses[e])return MainFrame.Util.existingClasses[e];if(MainFrame.Browser.isFileProtocol)return!0;try{if(document.styleSheets)for(var t=0,a=document.styleSheets.length;a>t;t++)for(var i=document.styleSheets[t],r=i.rules||i.cssRules,n=0,s=r?r.length:0;s>n;n++){var o=r[n];if(o.selectorText==="."+e)return MainFrame.Util.existingClasses[e]=!0,!0}}catch(l){MainFrame.Util.showError(l)}return MainFrame.Util.existingClasses[e]=!1,!1},click:function(e){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}};MainFrame.Util.extend(MainFrame.Util,e)}(),!function(){var e={getMainFrame:function(){return MainFrame.Manager.Scoping.getById("mainframe")},getAppURL:function(){var e=MainFrame.Util.getMainFrame();return e.appURL?e.appURL:""},getAppId:function(){var e=MainFrame.Util.getMainFrame();return e.appId?e.appId:""},getDefaultLanguage:function(){var e=MainFrame.Util.getMainFrame();return e?e.defaultLanguage:null},getResURL:function(){var e=MainFrame.Util.getMainFrame();return e.resURL||MainFrame.Global.initializationVariables.appFolder+"/res/"},getDataURL:function(){var e=MainFrame.Util.getMainFrame();return e.dataURL||MainFrame.Global.initializationVariables.appFolder+"/data/"},setDefaultLanguage:function(e){if(e){var t=MainFrame.Util.getMainFrame();t.defaultLanguage=e}else MainFrame.Util.showError("Default language was not given correctly.")},setLanguage:function(e,t){MainFrame.Manager.Language.getById(e)?(MainFrame.DataParser.parseLanguage(MainFrame.Manager.Language.getById(e),t),MainFrame.Util.setDefaultLanguage(e)):MainFrame.Util.showError('Language "'+e+'" not found!')}};MainFrame.Util.extend(MainFrame.Util,e)}(),!function(){var ConditionUtilities={bindConditionResize:function(e){MainFrame.Publisher.subscribe("browser:resize",e,function(){e.refresh()})},evaluateCondition:function(conditionString){var processedString=conditionString;processedString=processedString.replace(/landscape/g,"'landscape'"),processedString=processedString.replace(/portrait/g,"'portrait'");var orientation=1===MainFrame.Browser.orientation?"portrait":"landscape";processedString=processedString.replace(/orientation/g,"'"+orientation+"'"),processedString=processedString.replace(/desktop/g,"'desktop'"),processedString=processedString.replace(/tablet/g,"'tablet'"),processedString=processedString.replace(/phone/g,"'phone'");var device=EnvDetection.deviceType.toLowerCase();processedString=processedString.replace(/device/g,"'"+device+"'"),processedString=processedString.replace(/condition\.([a-zA-Z0-1_:]{0,})/,function(e,t){var a=t,i=MainFrame.Manager.CustomCondition.getById(a);return"'"+i+"'"}),processedString=processedString.replace(/ and /g," && "),processedString=MainFrame.Util.interpretString(processedString).interpretedString,-1!==processedString.indexOf("isSelectedForDiaporama")&&(processedString=MainFrame.Util.interpretSelectedForDiaporama(processedString)),-1!==processedString.indexOf("wishlistNotEmpty")&&(processedString=MainFrame.Util.interpretWishlistConditions(processedString)),-1!==processedString.indexOf("isFileProtocol")&&(processedString=MainFrame.Util.interpretFileProtocol(processedString)),-1!==processedString.indexOf("multiSearchLoaded")&&(processedString=MainFrame.Util.interpretMultiSearchLoaded(processedString)),processedString=MainFrame.Util.interpretCatalogFirstLastPage(processedString);var result=!1;try{var result=eval(processedString)}catch(e){MainFrame.Util.showError('Condition evaluation error for the string: "'+conditionString+'", evaluated as "'+processedString+'"'),console.log(e)}return result},validateConditionDevice:function(e){for(var t=e.split(","),a=0,i=t.length;i>a;a++){var e=t[a];if("phone"===e&&"Phone"===EnvDetection.deviceType)return!0;if("tablet"===e&&"Tablet"===EnvDetection.deviceType)return!0;if("desktop"===e&&"Desktop"===EnvDetection.deviceType)return!0}return!1},validateConditionOrientation:function(e){return"landscape"===e&&2===MainFrame.Browser.orientation?!0:"portrait"===e&&1===MainFrame.Browser.orientation?!0:!1},validateConditionMinWidth:function(e){return MainFrame.Browser.width<e?!1:!0},validateConditionMaxWidth:function(e){return MainFrame.Browser.width>e?!1:!0},validateConditionMinHeight:function(e){return MainFrame.Browser.height<e?!1:!0},validateConditionMaxHeight:function(e){return MainFrame.Browser.height>e?!1:!0},interpretSelectedForDiaporama:function(conditionString){var regEx=/isSelectedForDiaporama\((.*?),(.*?)\)/g;return conditionString=conditionString.replace(regEx,function(firstMatch,selectionModuleId,page){var hasMathExpression=-1!==page.indexOf("+")||-1!==page.indexOf("-");hasMathExpression&&(page=eval(page));var selectionModule=MainFrame.Manager.Scoping.getById(selectionModuleId);return selectionModule&&selectionModule.selectedPages&&selectionModule.selectedPages[page]?"true":"false"})},interpretFileProtocol:function(e){var t=/isFileProtocol/g;return e=e.replace(t,function(){return MainFrame.Browser.isFileProtocol?"true":"false"})},interpretMultiSearchLoaded:function(e){var t=/multiSearchLoaded/g;return e=e.replace(t,function(){return MainFrame.Search.loaded?"true":"false"})},interpretCatalogFirstLastPage:function(e){var t=MainFrame.Manager.Scoping.getById("catalog");if(t){var a=t.currentPage,i=0==a||1===a,r=t.isLastPage(a),n=/isFirstPageCatalog/g;e=e.replace(n,function(){return i?"true":"false"});var n=/isLastPageCatalog/g;e=e.replace(n,function(){return r?"true":"false"})}return e},interpretWishlistConditions:function(e){var t=MainFrame.Manager.Itemlist;if(t){var a=t.getTotalItems(),i=/wishlistNotEmpty/g;e=e.replace(i,function(){return a?"true":"false"})}return e}};MainFrame.Util.extend(MainFrame.Util,ConditionUtilities)}(),!function(){var e={logParameters:function(e,t){var a=e.toString(),i=a.slice(a.indexOf("(")+1,a.indexOf(")")).match(/([^\s,]+)/g);console.log("/*********************************************/"),t&&console.log('Logging parameters for "'+t+'"');for(var r=0,n=e.arguments.length;n>r;r++)console.log('Value of parameter "'+i[r]+'" is:'),console.log(e.arguments[r]);console.log("/*********************************************/")},showError:function(e){console.error?console.error(e):console.log?console.log(e):MainFrame.DEBUG===!0&&alert(e)},warn:function(e){console.warn?console.warn(e):console.log?console.log(e):MainFrame.DEBUG===!0&&alert(e)},logOnScreen:function(e,t){if(!MainFrame.Util.console){var a=document.createElement("p");a.setAttribute("class","v7-debug"),document.body.appendChild(a),MainFrame.Util.console=a}t===!0&&(e=MainFrame.Util.console.innerHTML+"<br/>"+e),MainFrame.Util.console.innerHTML=e}};MainFrame.Util.extend(MainFrame.Util,e)}(),MainFrame.Application=MainFrame.Abstract.Element.extend({resizeTimer:null,initialize:function(e,t,a,i){this.id="mainframe",MainFrame.Manager.Scoping.register("mainframe",this),this.catalogSettings=i,MainFrame.EventHandlerCore.initialize(),MainFrame.Browser.initialize(),this.setAppURL(a),this.setRefferal(),this.createContainer(e),this.setSize(),this.getConfigData(t),this.resize(),this.bindResizeEvents(),this.bindFullScreenChange()},bindResizeEvents:function(){this.bindOrientationChange(),this.bindResize()},bindOrientationChange:function(){var e=this;MainFrame.Event.bind(window,"orientationchange",function(){e.resize(),MainFrame.EventHandler.dispatch("resize"),window.scrollTo(0,1),setTimeout(function(){e.resize()},400),clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.resize(),MainFrame.EventHandler.dispatch("resizeEnd")},300)})},bindResize:function(){var e=this;MainFrame.Event.bind(window,MainFrame.Event.resize,function(){if(!e.blockResize){var t=MainFrame.Util.getActiveElement(),a=t.nodeName.toLowerCase();if(a&&("input"===a||"textarea"===a)&&1===MainFrame.Browser.orientation)return;e.resize(),MainFrame.EventHandler.dispatch("resize"),MainFrame.Publisher.publish("browser:resize"),window.scrollTo(0,1),clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.resize(),MainFrame.EventHandler.dispatch("resizeEnd")},300)}})},bindFullScreenChange:function(){MainFrame.Event.bind(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange  MSFullscreenChange fullscreenChange",function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(MainFrame.EventHandler.dispatch("fullscreenEnabled"),MainFrame.EventHandler.dispatch("onFullscreen")):(MainFrame.EventHandler.dispatch("fullscreenDisabled"),MainFrame.EventHandler.dispatch("onNormalScreen"))})},resize:function(){MainFrame.Browser.refresh(),this.initDimension(),this._resize()},requestConfirmation:function(e){var t=e?e:"defaultConfirmation";if(MainFrame.Browser.hasTouch){var a=MainFrame.Manager.Text.getById(t);confirm(a)?this.startAction():this.cancelAction()}else{var e=new MainFrame.Element.Confirmation;if(e){MainFrame.Manager.Scoping.register(t,e);var i=MainFrame.Util.getMainFrame();i.addSubObject(e),e.addSuperObject(i),e.readData(MainFrame.Manager.Confirmation.getById(t)),e.resize(),e.targetAction=this,i.confirmation=e}}},actionConfirmed:function(){var e=this;e.closeConfirmation(),setTimeout(function(){MainFrame.Util.removeElement(e.confirmation.overlay),e.confirmation.targetAction.startAction(),e.cleanConfirmation()},300)},actionCanceled:function(){var e=this;e.closeConfirmation(),setTimeout(function(){MainFrame.Util.removeElement(e.confirmation.overlay),e.confirmation.targetAction.cancelAction(),e.cleanConfirmation()},300)},closeConfirmation:function(){var e=this;MainFrame.Util.removeElement(e.confirmation.containerElement),MainFrame.Util.removeClass(e.confirmation.overlay,"v7--fade-out"),MainFrame.Util.addClass(e.confirmation.overlay,"v7--fade-in")},cleanConfirmation:function(){delete this.confirmation,MainFrame.EventHandlerCore.removeHandler(null,"confirmNotification"),MainFrame.EventHandlerCore.removeHandler(null,"declineNotification")},setAppURL:function(e){if("undefined"!=typeof e){var t=-1!==e.indexOf("ssid"),a=-1!==e.indexOf("?"),i=t&&a;if(i){var r=MainFrame.Util.urlGET("ssid"),n=e.split("?");this.appURL=n[0]+"?ssid="+r+"&"+n[1]}else this.appURL=e}else this.appURL=null},setRefferal:function(){var e=MainFrame.Util.getRefferal();e&&(this.refferal=e)},setSize:function(){this.initPosition(),this.initDimension()},initPosition:function(){this.positionX="0",this.positionY="0"},initDimension:function(){this.setDimensionX("100%"),this.setDimensionY("100%")},createContainer:function(e){this.containerElement=MainFrame.Util.getElement(e),this.containerElement._application&&MainFrame.Util.showError("MainFrame Application container is already initialized."),this.containerElement._application=!0,this.containerElement.setAttribute("data-type","container"),this.containerElement.setAttribute("class","v7__app v7__elem--container")},addSystemActions:function(){},getConfigData:function(e){var t=this;e=MainFrame.Util.setDefault(e,MainFrame.Global.initializationVariables.appFolder+"/config/main.xml"),e=MainFrame.Util.getAppURL()+e;var a=-1!==e.indexOf("main_phone"),i=a?MainFrame.JSONData.main_phone:MainFrame.JSONData.main;i?this.initData(i):MainFrame.Util.request(MainFrame.Browser.isFileProtocol?{url:e,onSuccess:function(e){textData=JSON.stringify(e);var a=t.processData(textData);i=JSON.parse(a),t.initData(i)}}:{url:e,onSuccess:function(e){var a=t.processData(e),i=new DOMParser,r=i.parseFromString(a,"application/xml"),n=r.documentElement,s=MainFrame.DataParser.parseXml(n);t.initData(s)}})},processData:function(e){var t=e;MainFrame.Global.settings.encoded&&(t=window.atob(t));var a=new RegExp("{GET:(.*?)}","g");if(t=t.replace(a,function(e,t){return MainFrame.Util.urlGET(t)||""}),MainFrame.Global&&MainFrame.Global.initializationVariables)for(var i in MainFrame.Global.initializationVariables){var r=i,n=MainFrame.Global.initializationVariables[i],s=new RegExp("{global:"+r+"}","g");t=t.replace(s,n)}return t=this.specificProcessData(t)},specificProcessData:function(e){return e},initData:function(e){var t=this;t._data=e;var a=MainFrame.DataParser.getNodeNamed(e,"system"),i=MainFrame.DataParser.getNodeNamed(a,"appConfig");MainFrame.DataParser.parseAppConfig.call(t,i),t.loadManagersData(),t.addSystemActions(),MainFrame.DataParser.registerInManager(MainFrame.Manager.LibraryNode,"libraries","library","id",a),t.addPreloadScreen(e)},loadApp:function(){var e=this,t=e._data,a=MainFrame.DataParser.getNodeNamed(t,"system");MainFrame.DataParser.parseSystem(a);var i=MainFrame.DataParser.getNodesWithNodeName(t,"details");if(i.forEach(function(e){MainFrame.DataParser.parseDetails(e)}),"Phone"===EnvDetection.deviceType){var r=MainFrame.DataParser.getNodeNamed(t,"phoneSystem");MainFrame.DataParser.parseSystem(r)}var n=MainFrame.DataParser.getNodeNamed(a,"code");n&&MainFrame.DataParser.parseCode(n);var s=MainFrame.DataParser.getDefaultLanguage(a);s&&(MainFrame.Util.setDefaultLanguage(s),MainFrame.Util.setLanguage(s)),e.initManagers();var o=MainFrame.DataParser.getNodeNamed(t,"mainframe");return o?(MainFrame.DataParser.parseElement.call(e,o),e.tapEffect&&e.tapEffect.enabled&&e.initTapPoint(),MainFrame.EprintShop&&MainFrame.EprintShop.init(),e.resize(),e.removePreloadScreen(),e.dispatchCustomCatalogTriggers(),MainFrame.Global.settings.parseHTML&&e.initHTML(),MainFrame.EventHandler.dispatch("applicationReady"),MainFrame.Router.active&&MainFrame.Router.init(),MainFrame.Util.getItem("appLoaded",!1)||(MainFrame.EventHandler.dispatch("firstLoad"),MainFrame.Util.saveItem("appLoaded",!0,!1)),window.ktaLoaded&&window.ktaLoaded(),this._data=null,void delete this._data):void MainFrame.Util.showError("Application initialization error! The mainframe data must exist")},initManagers:function(){"undefined"!=typeof MainFrame.Manager.Bookmarks&&MainFrame.Manager.Bookmarks.initPagemarks()},initHTML:function(){var e=document.body;MainFrame.DataParser.parseHTMLData(e)},dispatchCustomCatalogTriggers:function(){var e="catalog",t=MainFrame.Manager.Scoping.getById(e);if(t){var a=t.currentPage,i=0===a||1===a,r=t.isLastPage(a);i?MainFrame.EventHandler.dispatch("catalogFirstPage",[t]):r&&MainFrame.EventHandler.dispatch("catalogLastPage",[t])}},loadManagersData:function(){for(var e in MainFrame.Manager){var t=MainFrame.Manager[e];t.initList&&t.initList()}},initTapPoint:function(){var e=(this.tapEffect.data,"v7tap--effect-"+this.tapEffect.type),t=document.createElement("div");t.setAttribute("id","v7-tap-point"),t.setAttribute("class","v7__tap-point__inner");var a=document.createElement("div");t.appendChild(a);var i=document.createElement("div");i.setAttribute("class","v7__tap-point__inner "+e),a.appendChild(i),this.containerElement.appendChild(t),this.tapEffect.animationAreaContainer=t,this.tapEffect.animationCenterContainer=i},addPreloadScreen:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"preload");if(t){var a=MainFrame.DataParser.getNodeNamed(t,"preloader"),i=new MainFrame.Element.Preloader({superObject:this,data:a});i.increment(),this.preloadScreen=i,MainFrame.DataParser.parsePreload.call(i,t)}else this.loadApp()},removePreloadScreen:function(){this.preloadScreen&&this.preloadScreen.update()}}),!function(){var e={parseBookmarks:function(e){if(MainFrame.DataParser.basicParse.call(this,e),MainFrame.DataParser.getSourceModule.call(this,e),this.type=e.attributes.type?e.attributes.type:"verticalList",this.autoHideOnZoom="false"===e.attributes.autoHideOnZoom||"0"===e.attributes.autoHideOnZoom?!1:!0,e.childNodes.length)for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t];"bookmarkTemplate"===i.nodeName&&(this.bookmarkTemplateData=i)}},parseBookmarkBtn:function(e){if(MainFrame.DataParser.getSourceModule.call(this,e),this.page=e.attributes.page?e.attributes.page:"current","true"===e.attributes.mainButton&&(this.isMainButton=!0),this.autoHideOnZoom="false"===e.attributes.autoHideOnZoom||"0"===e.attributes.autoHideOnZoom?!1:!0,e.childNodes.length>1)for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t];if("on"===i.nodeName){var r=new MainFrame.Element.Item({superObject:this,data:i});r.setVisible(!1),this.onElement=r}if("off"===i.nodeName){var n=new MainFrame.Element.Item({superObject:this,data:i});n.setVisible(!1),this.offElement=n}}var s=!1;MainFrame.DataParser.basicParse.call(this,e,s),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e))}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.AddBookmark=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getBookmarkPage();MainFrame.Manager.Bookmarks.getById(e)||MainFrame.Manager.Bookmarks.register(e,!0),this.endAndClearAction()},getBookmarkPage:function(){var e=this.getTarget();if("2"===e.API_VERSION)var t=e.currentPage,a=(e.pageReferences[t],e.pagesOnScreen),i=e.settings.pages.totalPages;else var t=e.currentPage,r=e.getContainerForCurrentPagingType(t),n=e.pages[r],a=n.numbers.length,i=e.totalPages;var s,o=1===a,l=this.getParam("page")||"current";switch(l){case"left":s=t;break;case"right":s=o&&this.initiatorObject.isMainButton&&"right"===l?t:e.currentPage+1;break;case"current":s=t;break;default:s=l}return s=parseInt(s,10),s>i?s=i:0===s&&(s=1),s}}),MainFrame.Action.RemoveBookmark=MainFrame.Action.AddBookmark.extend({startAction:function(){var e=this.getBookmarkPage();MainFrame.Manager.Bookmarks.getById(e)&&MainFrame.Manager.Bookmarks.unregisterById(e),this.endAndClearAction()}}),MainFrame.Action.ToggleBookmark=MainFrame.Action.AddBookmark.extend({startAction:function(){var e=this.getBookmarkPage();MainFrame.Manager.Bookmarks.getById(e)?MainFrame.Manager.Bookmarks.unregisterById(e):MainFrame.Manager.Bookmarks.register(e,!0),this.endAndClearAction()}}),MainFrame.Manager.Bookmarks=new MainFrame.Abstract.Manager({id:"bookmarks",hasLocalStorage:!0,hasEventPublishing:!0}),MainFrame.Manager.Bookmarks.initPagemarks=function(){var e=this,t=MainFrame.Util.urlGET("pagemarks");if(t){var a=t.split(",");a.forEach(function(t){e.list[t]=!0})}},MainFrame.Manager.Bookmarks.getSortedPages=function(){var e=[];for(var t in MainFrame.Manager.Bookmarks.list)e.push(parseInt(t,10));var a=function(e,t){return e-t};return e.sort(a),e},MainFrame.Manager.Bookmarks.saveList=function(){this.localStorageKey&&MainFrame.Util.saveItem(this.localStorageKey,this.list,!0),MainFrame.Publisher.publish("manager.bookmarks:change",{})},MainFrame.Element.Bookmarks=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseBookmarks.call(this,e),this.bindEvents(),this.buildBookmarks()},bindEvents:function(){if(MainFrame.Publisher.subscribe("manager.bookmarks:change",this,this.onUpdate),this.autoHideOnZoom){var e=this.sourceModuleId,t=e+":willZoomIn",a=e+":zoomOut";MainFrame.Publisher.subscribe(t,this,this.onZoomIn),MainFrame.Publisher.subscribe(a,this,this.onZoomOut)}},onUpdate:function(){this.buildBookmarks()},onZoomIn:function(){this.hide()},onZoomOut:function(){this.show()},buildBookmarks:function(){this.empty(),("verticalList"===this.type||"horizontalList"===this.type)&&this.buildStandardBookmarks(),this.resize()},buildStandardBookmarks:function(){for(var e,t,a=this.sourceModule,i=0,r=MainFrame.Manager.Bookmarks.getTotalItems(),n=MainFrame.Manager.Bookmarks.getSortedPages(),s=0,o=0;r>i;i++){var l=new MainFrame.Element.Item({superObject:this,data:this.bookmarkTemplateData}),c=n[i];if("2"===a.API_VERSION)var d=a.pageReferences[c].number;else var d=a.pageNumbers[c];l.setAction("id:goToPageBookmark;params:page="+c);var g=l.getSubObjectWithId("bookmarkPage"),h=g.getText();h=h.replace("#page",d),g.setText(h),l.altTextPage=d,e=e||l.getDimensionX(),t=t||l.getDimensionY(),"horizontalList"===this.type?(l.containerElement.style.display="inline-block",s+=e,o=t):(s=e,o+=t)}this.setDimensionX(s),this.setDimensionY(o)}}),MainFrame.Element.BookmarkBtn=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseBookmarkBtn.call(this,e),this.bindEvents(),this.updateState()},bindEvents:function(){var e=this.sourceModuleId,t=e+":pageChanged";if(MainFrame.Publisher.subscribe(t,this,this.onUpdate),MainFrame.Publisher.subscribe("manager.bookmarks:change",this,this.onUpdate),this.autoHideOnZoom){var a=e+":willZoomIn",i=e+":zoomOut";MainFrame.Publisher.subscribe(a,this,this.onZoomIn),MainFrame.Publisher.subscribe(i,this,this.onZoomOut)}},onUpdate:function(){this.updateState()},onZoomIn:function(){this.hide()},onZoomOut:function(){this.updateState()},updateState:function(){var e=this.sourceModule;if("2"===e.API_VERSION){var t=e.currentPage,a=(e.pageReferences[t],e.pagesOnScreen),i="single"===e.settings.pages.coverType,r=t;switch(this.page){case"left":r=t;break;case"right":r=i&&1===t?t:t+1;break;case"current":r=t;break;default:r=this.page}r=parseInt(r,10),r>e.settings.pages.totalPages&&(r=e.settings.pages.totalPages);var n=1===a,s=!this.isMainButton;n&&s?this.hide():this.show(),n&&this.isMainButton&&"right"===this.page&&(r=t),MainFrame.Manager.Bookmarks.getById(r)?this.turnOn():this.turnOff()}else this.updateState_deprecated()},updateState_deprecated:function(){var e=this.sourceModule,t=e.currentPage,a=e.getContainerForCurrentPagingType(t),i=e.pages[a],r=i.numbers.length,n=t;switch(0===t&&(t=1),this.page){case"left":n=t;break;case"right":n=t+1;break;case"current":n=t;break;default:n=this.page}n=parseInt(n,10),n>e.totalPages&&(n=e.totalPages);var s=1===r,o=!this.isMainButton;s&&o?this.hide():this.show(),s&&this.isMainButton&&"right"===this.page&&(n=t),MainFrame.Manager.Bookmarks.getById(n)?this.turnOn():this.turnOff()},turnOn:function(){this.onElement.show(),this.offElement.hide()},turnOff:function(){this.offElement.show(),this.onElement.hide()}}),!function(){MainFrame.DataParser.elements.bookmarks=MainFrame.Element.Bookmarks,MainFrame.DataParser.elements.bookmarkBtn=MainFrame.Element.BookmarkBtn}(),MainFrame.Abstract.Page=MainFrame.Class.extend({number:null,pageType:null,initialize:function(){this.pageType={}},readData:function(e){MainFrame.DataParser.parsePage.call(this,e)}}),MainFrame.Action.BasePageCatalog=MainFrame.Abstract.Action.extend({startAction:function(){this.endAndClearAction()},isPageRestricted:function(e,t){var a="undefined"!=typeof e.settings.pages.pageRestriction;return a&&t>=e.settings.pages.pageRestriction?!0:!1},updateContainersSingle:function(e,t,a,i){e.settings.static?this.updateContainersSingle_static(e,a):this.updateContainersSingle_dynamic(e,t,a,i)
},updateContainersSingle_static:function(e,t){var a=e.pageContainers.indexOf(t),i=a+1,r=a-1;e.currentPageContainers={page:e.pageContainers[a]},e.nextPageContainers={page:e.pageContainers[i]},e.previousPageContainers={page:e.pageContainers[r]}},updateContainersSingle_dynamic:function(e,t,a,i){e.currentPageContainers={page:a},e.nextPageContainers={page:i},e.previousPageContainers={page:t}},updateContainersDouble:function(e,t,a,i,r,n,s){e.settings.static?this.updateContainersDouble_static(e,i):this.updateContainersDouble_dynamic(e,t,a,i,r,n,s)},updateContainersDouble_static:function(e,t){var a=e.pageContainers.indexOf(t),i=a+1,r=a+2,n=a+3,s=a-2,o=a-1;e.currentPageContainers={left:e.pageContainers[a],right:e.pageContainers[i]},e.nextPageContainers={left:e.pageContainers[r],right:e.pageContainers[n]},e.previousPageContainers={left:e.pageContainers[s],right:e.pageContainers[o]}},updateContainersDouble_dynamic:function(e,t,a,i,r,n,s){e.currentPageContainers={left:i,right:r},e.nextPageContainers={left:n,right:s},e.previousPageContainers={left:t,right:a}},updateZIndexSingle:function(e,t,a,i){e.settings.static?this.updateZIndexSingle_static(e):this.updateZIndexSingle_dynamic(t,a,i)},updateZIndexSingle_static:function(e){for(var t=e.settings.pages.totalPages+1,a=e.currentPage,i=0,r=e.pageContainers.length;r>i;i++){var n=i,s=e.pageContainers[i];n>=a?(s.container.style.zIndex=t,t--):s.container.style.zIndex=""}},updateZIndexSingle_dynamic:function(e,t,a){e.container.style.zIndex="0",t.container.style.zIndex="2",a.container.style.zIndex="1"},updateZIndexDouble:function(e,t,a,i,r,n,s){e.settings.static?this.updateZIndexDouble_static(e):this.updateZIndexDouble_dynamic(e,t,a,i,r,n,s)},updateZIndexDouble_static:function(e){var t=e.currentPage,a=e.settings.pages,i="single"===a.coverType;i&&1===t&&(t=0);for(var r=a.totalPages+1,n=0,s=e.pageContainers.length;s>n;n+=2){var o=n-2,l=e.pageContainers[n],c=e.pageContainers[n+1];l.container.style.zIndex=o===t?r+1:"",o>=t?(c.container.style.zIndex=r,r-=2):c.container.style.zIndex=""}},updateZIndexDouble_dynamic:function(e,t,a,i,r,n,s){t.container.style.zIndex="1",a.container.style.zIndex="3",i.container.style.zIndex="6",r.container.style.zIndex="4",n.container.style.zIndex="7",s.container.style.zIndex="2";var o=e.catalogContainer,l=-1!==window.navigator.userAgent.indexOf("Firefox");l||(o.appendChild(t.container),o.appendChild(a.container),o.appendChild(i.container),o.appendChild(r.container),o.appendChild(n.container),o.appendChild(s.container))},updatePageTypeSingle:function(e,t,a,i){e.settings.static?this.updatePageTypeSingle_static(e):this.updatePageTypeSingle_dynamic(t,a,i)},updatePageTypeSingle_static:function(e){for(var t=e.currentPage,a=0,i=e.pageContainers.length;i>a;a++){var r=a,n=e.pageContainers[a];t>r?n.container.setAttribute("data-page-type","previous"):r===t?n.container.setAttribute("data-page-type","current"):n.container.setAttribute("data-page-type","next")}},updatePageTypeSingle_dynamic:function(e,t,a){e.container.setAttribute("data-page-type","previous"),t.container.setAttribute("data-page-type","current"),a.container.setAttribute("data-page-type","next")},updatePageTypeDouble:function(e,t,a,i,r,n,s){e.settings.static?this.updatePageTypeDouble_static(e):this.updatePageTypeDouble_dynamic(t,a,i,r,n,s)},updatePageTypeDouble_static:function(e){var t=e.currentPage,a=e.settings.pages,i="single"===a.coverType;i&&1===t&&(t=0);for(var r=0,n=e.pageContainers.length;n>r;r+=2){var s=r-2,o=e.pageContainers[r],l=e.pageContainers[r+1];t>s?(o.container.setAttribute("data-page-type","previous"),l.container.setAttribute("data-page-type","previous")):s===t?(o.container.setAttribute("data-page-type","current"),l.container.setAttribute("data-page-type","current")):(o.container.setAttribute("data-page-type","next"),l.container.setAttribute("data-page-type","next"))}},updatePageTypeDouble_dynamic:function(e,t,a,i,r,n){e.container.setAttribute("data-page-type","previous"),t.container.setAttribute("data-page-type","previous"),a.container.setAttribute("data-page-type","current"),i.container.setAttribute("data-page-type","current"),r.container.setAttribute("data-page-type","next"),n.container.setAttribute("data-page-type","next")},updateClassesSingle:function(e,t,a,i){e.settings.static?this.updateClassesSingle_static(e):this.updateClassesSingle_dynamic(e,t,a,i)},updateClassesSingle_static:function(e){for(var t=e.currentPage,a=0,i=e.pageContainers.length;i>a;a++){var r=a,n=e.pageContainers[a];t>r?(n.container.classList.remove(e.cssClasses["flip-page-current"]),n.container.classList.add(e.cssClasses["flip-page-back-single"])):r===t?(n.container.classList.add(e.cssClasses["flip-page-current"]),n.container.classList.remove(e.cssClasses["flip-page-back-single"])):(n.container.classList.remove(e.cssClasses["flip-page-current"]),n.container.classList.remove(e.cssClasses["flip-page-back-single"]))}},updateClassesSingle_dynamic:function(e,t,a,i){a.container.classList.add(e.cssClasses["flip-page-current"]),a.container.classList.remove(e.cssClasses["flip-page-back-single"]),i.container.classList.remove(e.cssClasses["flip-page-current"]),i.container.classList.remove(e.cssClasses["flip-page-back-single"]),t.container.classList.remove(e.cssClasses["flip-page-current"]),t.container.classList.add(e.cssClasses["flip-page-back-single"])},updateClassesDouble:function(e,t,a,i,r,n,s){e.settings.static?this.updateClassesDouble_static(e):this.updateClassesDouble_dynamic(e,t,a,i,r,n,s)},updateClassesDouble_static:function(e){var t=e.currentPage,a=e.settings.pages,i="single"===a.coverType;i&&1===t&&(t=0);for(var r=0,n=e.pageContainers.length;n>r;r+=2){var s=r-2,o=e.pageContainers[r],l=e.pageContainers[r+1];t>s?(o.container.classList.remove(e.cssClasses["flip-page-front-left"]),o.container.classList.remove(e.cssClasses["flip-page-current"]),l.container.classList.remove(e.cssClasses["flip-page-current"]),l.container.classList.add(e.cssClasses["flip-page-back-right"])):s===t?(o.container.classList.remove(e.cssClasses["flip-page-front-left"]),o.container.classList.add(e.cssClasses["flip-page-current"]),l.container.classList.add(e.cssClasses["flip-page-current"]),l.container.classList.remove(e.cssClasses["flip-page-back-right"])):(o.container.classList.add(e.cssClasses["flip-page-front-left"]),o.container.classList.remove(e.cssClasses["flip-page-current"]),l.container.classList.remove(e.cssClasses["flip-page-current"]),l.container.classList.remove(e.cssClasses["flip-page-back-right"]))}},updateClassesDouble_dynamic:function(e,t,a,i,r,n,s){i.container.classList.remove(e.cssClasses["flip-page-front-left"]),i.container.classList.add(e.cssClasses["flip-page-current"]),r.container.classList.add(e.cssClasses["flip-page-current"]),r.container.classList.remove(e.cssClasses["flip-page-back-right"]),t.container.classList.remove(e.cssClasses["flip-page-front-left"]),t.container.classList.remove(e.cssClasses["flip-page-current"]),a.container.classList.remove(e.cssClasses["flip-page-current"]),a.container.classList.add(e.cssClasses["flip-page-back-right"]),n.container.classList.add(e.cssClasses["flip-page-front-left"]),n.container.classList.remove(e.cssClasses["flip-page-current"]),s.container.classList.remove(e.cssClasses["flip-page-current"]),s.container.classList.remove(e.cssClasses["flip-page-back-right"])},clearPageBackgrounds:function(e){e.isSinglePage||e.isDoublePage&&(e.currentPageContainers.left.container.style.backgroundColor="",e.currentPageContainers.right.container.style.backgroundColor="",e.previousPageContainers.left.container.style.backgroundColor="",e.previousPageContainers.right.container.style.backgroundColor="",e.nextPageContainers.left.container.style.backgroundColor="",e.nextPageContainers.right.container.style.backgroundColor="")},slideCatalog:function(e,t,a,i){var r=100*-a;"horizontal"===t?(e.sliderContainer.translatedX=r+"%",e.sliderContainer.translatedY="0"):(e.sliderContainer.translatedX="0",e.sliderContainer.translatedY=r+"%"),MainFrame.Util.setTransformDuration(e.sliderContainer,i,"s"),MainFrame.Util.setPosition(e.sliderContainer,e.sliderContainer.translatedX,e.sliderContainer.translatedY)},updateIndexAfterSlide:function(e,t,a,i,r){var n=100*a,s=100*i,o=100*r;e.previousPageContainers.main.setAttribute("data-index",a),e.currentPageContainers.main.setAttribute("data-index",i),e.nextPageContainers.main.setAttribute("data-index",r),"horizontal"===t?(e.previousPageContainers.main.style.left=n+"%",e.currentPageContainers.main.style.left=s+"%",e.nextPageContainers.main.style.left=o+"%"):(e.previousPageContainers.main.style.top=n+"%",e.currentPageContainers.main.style.top=s+"%",e.nextPageContainers.main.style.top=o+"%")},updateContentAfterSlide:function(e){var t=e.currentPage;if(e.isSinglePage){var a=t;e.updatePageImage(e.currentPageContainers.page,a),e.updatePageContent();var i=t+1;e.updatePageImage(e.nextPageContainers.page,i);var r=t-1;e.updatePageImage(e.previousPageContainers.page,r)}else{var n="single"===e.settings.pages.coverType;n&&1===t&&(t=0);var s=t,o=t+1;e.updatePageImage(e.currentPageContainers.left,s),e.updatePageImage(e.currentPageContainers.right,o),e.updatePageContent();var l=t+2,c=t+3;e.updatePageImage(e.nextPageContainers.left,l),e.updatePageImage(e.nextPageContainers.right,c);var d=t-2,g=t-1;e.updatePageImage(e.previousPageContainers.left,d),e.updatePageImage(e.previousPageContainers.right,g)}0===t||1===t?e.previousPageContainers.main.style.opacity="0":e.isLastPage(t)&&(e.nextPageContainers.main.style.opacity="0")},adjustPageShadow:function(e,t,a){var i="single"===e.settings.pages.coverType;i&&1===a&&(a=0);var r=a,n=a+1,s=e.pageReferences[r],o=e.pageReferences[n],l=t.outerShadow;s&&o?(l.style.width="100%",l.style.left="0"):s?(l.style.width="50%",l.style.left="0"):o&&(l.style.width="50%",l.style.left="50%"),l.style.height="100%",l.style.top="0"},makeAllContainersVisible:function(e){e.isDoublePage?(e.previousPageContainers.left.container.style.display="",e.previousPageContainers.right.container.style.display="",e.currentPageContainers.left.container.style.display="",e.currentPageContainers.right.container.style.display="",e.nextPageContainers.left.container.style.display="",e.nextPageContainers.right.container.style.display=""):(e.previousPageContainers.page.container.style.display="",e.currentPageContainers.page.container.style.display="",e.nextPageContainers.page.container.style.display="")},afterNextDoubleFlip:function(e,t,a,i,r,n,s){var o=this;a.container.style.webkitTransform="",a.container.style.transform="",a.container.style.webkitTransition="none",a.container.style.transition="none",i.container.style.webkitTransform="",i.container.style.transform="",i.container.style.webkitTransition="none",i.container.style.transition="none",o.updateClassesDouble(e,t,a,i,r,n,s),o.updateZIndexDouble(e,t,a,i,r,n,s),o.updatePageTypeDouble(e,t,a,i,r,n,s),e.updatePageContent();var l=e.currentPage+2,c=e.currentPage+3;n.image.imageUrl=null,s.image.imageUrl=null,e.settings.static||(e.updatePageImage(n,l),e.updatePageImage(s,c))},afterPreviousDoubleFlip:function(e,t,a,i,r,n,s){var o=this;s.container.style.webkitTransform="",s.container.style.transform="",s.container.style.webkitTransition="none",s.container.style.transition="none",t.container.style.webkitTransform="",t.container.style.transform="",t.container.style.webkitTransition="none",t.container.style.transition="none",o.updateClassesDouble(e,i,r,n,s,t,a),o.updateZIndexDouble(e,i,r,n,s,t,a),o.updatePageTypeDouble(e,i,r,n,s,t,a),e.updatePageContent();var l=e.currentPage-2,c=e.currentPage-1;i.image.imageUrl=null,r.image.imageUrl=null,e.settings.static||(e.updatePageImage(i,l),e.updatePageImage(r,c))}}),MainFrame.Action.BaseZoomPageCatalog=MainFrame.Abstract.Action.extend({startAction:function(){},determineNaturalSizeScale:function(e,t){var a=t.currentPageSize,i=this.getBestZoomSize(e,t),r=i.width/a.width,n=i.height/a.height;return this.naturalSizeScale={x:r,y:n},r},getBestZoomSize:function(e,t){var a,i,r=t.currentCatalogSize,n=t.settings.pages.sizes;return n.forEach(function(n){var s=n.width,o=t.isSinglePage?s:2*s,l=o/r.width,c=Math.abs(e-l);("undefined"==typeof a||a>c)&&(a=c,i=n)}),this.bestPageSize=i,i},getStandardSize:function(e){var t,a=e.determineOptimumSize(),i=e.settings.pages.sizes;return i.forEach(function(e){e.width===a&&(t=e)}),t},setDisplayForOtherPages:function(e,t){var a=this;e.pageContainers.forEach(function(i){a.isNotCurrentContainer(i,e)&&(i.container.style.display=t)})},isNotCurrentContainer:function(e,t){if(t.isDoublePage){if(e===t.currentPageContainers.left)return!1;if(e===t.currentPageContainers.right)return!1}else if(e===t.currentPageContainers.page)return!1;return!0},calculateZoomPosition:function(e,t){var a=this.getParam("sourceEvent"),i=a.lastEvent||a.eventData;if(this.naturalSizeScale)var r=this.naturalSizeScale.x,n=this.naturalSizeScale.y;else var r=t,n=t;var s=e.currentCatalogSize,o=e.getPositionX()+s.x+s.width/2,l=e.getPositionY()+s.y+s.height/2,c=parseFloat(i.clientX),d=parseFloat(i.clientY),g=o-c,h=l-d,u=g*(r-1),m=h*(n-1),s=e.currentCatalogSize,p=e.currentPageSize;1===e.pagesOnScreen?(p.width,p.height):(2*p.width,p.height);var f=1===e.currentPage,v=e.isLastPage(e.currentPage),M=(s.width*r-s.width)/2,b=s.y-s.height*(n-1)/2,F=-M,A=-b;return u>0&&u>M&&(u=M),0>u&&F>u&&(u=F),m>A?m=A:b>m&&(m=b),e.isDoublePage&&1===e.pagesOnScreen&&("flip"===e.settings.navigationType?f?(u=-(s.width*r)/4,e.settings.pages.centerFirst===!0&&(u+=s.width/4)):v&&(u=s.width*r/4,e.settings.pages.centerLast===!0&&(u-=e.currentCatalogSize.width/4)):f?(u=-(s.width*r)/4,e.settings.pages.centerFirst===!0&&(u+=e.currentCatalogSize.width/2)):v&&(u=s.width*r/4,e.settings.pages.centerLast===!0&&(u-=e.currentCatalogSize.width/2))),u=Math.round(u),m=Math.round(m),{x:u,y:m}},getPageSourceForPageData:function(e,t,a){var i="false"===this.getParam("naturalSize")?!1:!0;if(i){if(a>1)var r=this.getBestZoomSize(a,e);else var r=this.getStandardSize(e);var n=t.sizes[r.width].normal;if(-1!==n.indexOf("/"))var s=MainFrame.Util.getAppURL()+n;else var s=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+n;return s}if(a>1)var o="hd";else{var o="standard";"undefined"!=typeof e.settings.pages.useHdAbove&&MainFrame.Browser.width>e.settings.pages.useHdAbove&&(o="hd")}return MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+t[o]},updateContainerImages:function(e,t,a){var i="undefined"!=typeof e.settings.pages.sizes;i?this.updateContainerImagesWithSizes(e,t,a):this.updateContainerImages_deprecated(e,a)},updateContainerImagesWithSizes:function(e,t,a){if(e.isSinglePage){var i=e.currentPage;pageData=e.pageReferences[i],pageContainer=e.currentPageContainers.page,pageData&&this.updateContainerImage(e,pageContainer,pageData,t,a)}else{var i=e.currentPage;1===i&&(i=0);var r=i,n=i+1,s=e.pageReferences[r],o=e.pageReferences[n],l=e.currentPageContainers.left,c=e.currentPageContainers.right;s&&this.updateContainerImage(e,l,s,t,a),o&&this.updateContainerImage(e,c,o,t,a)}},updateContainerImage:function(e,t,a,i,r){var n=t.image,s=-1!==window.navigator.userAgent.indexOf("Firefox");if(s){var o=t.preloadImage;o.style.display="block",o.onload=function(){setTimeout(function(){n.src=l,o.onload=null,"normal"===r&&(o.src=MainFrame.Util.emptyImageUrl,o.style.display="")},100)};var l=this.getPageSourceForPageData(e,a,i);o.src=l}else{var o=new Image;o.onload=function(){n.src=this.src},o.src=this.getPageSourceForPageData(e,a,i)}},updateContainerImages_deprecated:function(e,t){if("zoom"===t)var a="hd";else{var a="standard";"undefined"!=typeof e.settings.pages.useHdAbove&&MainFrame.Browser.width>e.settings.pages.useHdAbove&&(a="hd")}if(e.isSinglePage){var i=e.currentPage;if(pageData=e.pageReferences[i],containerImage=e.currentPageContainers.page.image,pageData){var r=new Image;r.onload=function(){containerImage.src=this.src},r.src=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+pageData[a]}}else{var i=e.currentPage,n="single"===e.settings.pages.coverType;n&&1===i&&(i=0);var s=i,o=i+1,l=e.pageReferences[s],c=e.pageReferences[o],d=e.currentPageContainers.left.image,g=e.currentPageContainers.right.image;if(l){var h=new Image;h.onload=function(){d.src=this.src},h.src=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+l[a]}if(c){var u=new Image;u.onload=function(){g.src=this.src},u.src=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+c[a]}}},hidePage:function(e,t){if(e.isDoublePage&&2===e.pagesOnScreen){var a="left"===t?"right":"left",i=e.currentPageContainers[a],r=MainFrame.Util.createElement("div",e.cssClasses["single-zoom-overlay"],i.container),n=this.getParam("overlayColor")||"#000000",s=this.getParam("overlayOpacity")||"0.8";r.style.backgroundColor=n,setTimeout(function(){r.style.opacity=s},100),i.singleZoomOverlay=r}},showHiddenPage:function(e){if(e.isDoublePage){var t=e.currentPageContainers;t.left.singleZoomOverlay&&(MainFrame.Util.removeElement(t.left.singleZoomOverlay),delete t.left.singleZoomOverlay),t.right.singleZoomOverlay&&(MainFrame.Util.removeElement(t.right.singleZoomOverlay),delete t.right.singleZoomOverlay)}},setTransitionAndPerspective:function(e,t){e.style.transition="transform "+t+"s",e.style.perspective="none",e.style.webkitTransition="-webkit-transform "+t+"s",e.style.webkitPerspective="none"},getScaledSize:function(e,t){if("undefined"!=typeof this.bestPageSize)var a=this.bestPageSize.width,i=this.bestPageSize.height;else var r=e.currentPageSize,a=r.width*t,i=r.height*t;return e.isDoublePage&&(a=2*a),{width:a,height:i}},zoomIn:function(e,t,a,i){var r=this;r.setDisplayForOtherPages(e,"none"),MainFrame.EventHandler.dispatch("#"+e.id+".willZoomIn"),r.setTransitionAndPerspective(t,i);var n=r.calculateZoomPosition(e,a);if(t.translatedX=n.x,t.translatedY=n.y,e.scale=a,this.naturalSizeScale)var s=this.naturalSizeScale;else var s=a;MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,s,!0),"flip"===e.settings.navigationType&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity="0"),r.updateContainerImages(e,a,"zoom");var o=r.getParam("page");("left"===o||"right"===o)&&r.hidePage(e,o)},resizeMaps:function(e,t,a){if(e&&e.settings.maps.active)if(e.isSinglePage){var i=e.currentPageContainers.page,r=i.maps;r.resize(t,a)}else{var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=n.maps,l=s.maps;o.resize(t,a),l.resize(t,a)}},resizePrices:function(e,t,a){if(e&&e.settings.prices.active)if(e.isSinglePage){var i=e.currentPageContainers.page,r=i.prices;r.resize(t,a)}else{var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=n.prices,l=s.prices;o.resize(t,a),l.resize(t,a)}}}),!function(){var e={parseCatalog:function(e){MainFrame.DataParser.basicParse.call(this,e),e.attributes.catalogId&&MainFrame.DataParser.parseCatalogSettings.call(this,e.attributes.catalogId)},parseCatalogSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);if(this.settings={},this.settingsId=e,t.childNodes)for(var a=0,i=t.childNodes.length;i>a;a++){var r=t.childNodes[a];"pages"===r.nodeName&&MainFrame.DataParser.parsePages.call(this,r),"search"===r.nodeName&&MainFrame.DataParser.parseSearch&&MainFrame.DataParser.parseSearch.call(this,r),"maps"===r.nodeName&&MainFrame.DataParser.parseMaps&&MainFrame.DataParser.parseMaps.call(this,r),"prices"===r.nodeName&&MainFrame.DataParser.parsePriceSettings&&MainFrame.DataParser.parsePriceSettings.call(this,r)}},parseMaps:function(e){var t=this,a=("Phone"!==EnvDetection.deviceType,"Phone"===EnvDetection.deviceType,"true"===e.attributes.active?!0:!1);if(a){if(t.hasMaps=!0,t.maps=new MainFrame.Maps({containerElement:!1}),t.mapsSettings={},t.mapsSettings.dataSrcMaps=e.attributes.data,t.mapsSettings.baseUrlMaps=e.attributes.baseUrl,t.mapsSettings.finUrlMaps=e.attributes.finUrl,e.attributes.mapsConfigXml){var i=MainFrame.Util.getAppURL()+e.attributes.mapsConfigXml;MainFrame.Util.request({url:i,xmlResponse:!0,onSuccess:function(e){var a=e.documentElement;MainFrame.DataParser.parseMapsSettings.call(t.mapsSettings,a)}})}if(e.attributes.mediasConfigXml&&!MainFrame.Manager.Media.preloaded){var r=MainFrame.Util.getAppURL()+e.attributes.mediasConfigXml;MainFrame.Util.request({url:r,xmlResponse:!0,onSuccess:function(e){var t=e.documentElement,a=MainFrame.DataParser.parseXml(t);MainFrame.DataParser.registerDataInManager(MainFrame.Manager.Media,"media","id",a);var i=MainFrame.DataParser.getChildrenWithNodeName(a,"details");for(index=0,totalDetails=i.length;totalDetails>index;index++){var r=i[index];MainFrame.DataParser.parseDetails(r)}}})}if(e.attributes.mapsZipUrl&&MainFrame.Browser.hasBlobSupport&&"undefined"!=typeof zip){var n=new zip.fs.FS;zip.useWebWorkers=!1;var s=e.attributes.mapsZipUrl;s=MainFrame.Util.localizePath(s);var o=MainFrame.Util.getAppURL()+s;n.importHttpContent(o,!1,function(){t.mapsSettings.zips={};for(var e=0,a=n.root.children.length;a>e;e++){var i=n.root.children[e];t.mapsSettings.zips[i.name]=i}},function(){console.log("maps xml unzip error!")})}}},parsePage:function(e){if(e.childNodes.length>0){for(var t=0,a=e.childNodes.length;a>t;t++){var i=e.childNodes[t];if(i.attributes){for(var r=[],n=0,s=i.childNodes.length;s>n;n++)i.childNodes[n].attributes&&i.childNodes[n].attributes.skinId&&r.push(i.childNodes[j].attributes.skinId);this.pageType[i.nodeName]=r}}this.pageType.empty=[MainFrame.Util.emptyImageUrl,MainFrame.Util.emptyImageUrl]}},parsePages:function(e){var t=this;if(t.settings.pages={},t.totalPages=parseInt(e.attributes.nr,10),t.pages=[],t.settings.pages.dataSrc=e.attributes.data,t.settings.pages.pageGETParam=e.attributes.pageGETParam||"page",t.pagingType=e.attributes.catalogType,t.pageOffset=e.attributes.offset,t.pageNotChangedInterval=e.attributes.pageNotChangedInterval||1e3,t.commonDataSrc=e.attributes.commonUrl||"common/data/",t.hasPngText="true"===e.attributes.pngText?!0:!1,t.settings.useXJpgForZoom="true"===e.attributes.useXJpgForZoom?!0:!1,t.settings.progressiveImageLoading="false"===e.attributes.progressiveLoad?!0:!1,t.settings.loadCurrentPage="false"===e.attributes.loadCurrentPage?!1:!0,t.settings.pages.positionX="0",t.settings.pages.positionY="0",t.settings.pages.dimensionX="100%",t.settings.pages.dimensionY="100%","true"===e.attributes.useShadow||"1"===e.attributes.useShadow){if(t.settings.useShadow=!0,"Desktop"===EnvDetection.deviceType)var a=e.attributes.size||"98%|98%",i=e.attributes.pos||"1%|1%";else var a=e.attributes.size||"96%|96%",i=e.attributes.pos||"2%|2%";var r=a.split("|"),n=i.split("|");t.settings.pages.positionX=n[0],t.settings.pages.positionY=n[1],t.settings.pages.dimensionX=r[0],t.settings.pages.dimensionY=r[1]}var s=e.attributes.pngPages;if(s){var o=MainFrame.DataParser.getPngPages.call(t,s);this.settings.pngPages=o}if(e.attributes.centerFirstLast){var l=e.attributes.centerFirstLast;t.settings.pages.centerFirst="false"===l?!1:!0,t.settings.pages.centerLast="false"===l?!1:!0}e.attributes.centerFirst&&(t.settings.pages.centerFirst="false"===e.attributes.centerFirst?!1:!0),e.attributes.centerLast&&(t.settings.pages.centerLast="false"===e.attributes.centerLast?!1:!0),e.attributes.useHdAbove&&(t.settings.pages.useHdAbove=e.attributes.useHdAbove);var c=!1;if(e.attributes.pageNumbers){var d=e.attributes.pageNumbers;if(""!==g){var g=MainFrame.Util.extractPageNumbers(d);g.length&&(c=!0)}}MainFrame.DataParser.getBorders.call(this,e);var h=MainFrame.DataParser.getNodeNamed(e,"pageNumbering");if(e.attributes.pageNumberingXml){var u=MainFrame.Util.getAppURL()+e.attributes.pageNumberingXml;MainFrame.Util.request({url:u,xmlResponse:!0,onSuccess:function(e){var a=e.documentElement,i=MainFrame.DataParser.parseXml(a);MainFrame.DataParser.parsePageNumbering.call(t,i)}})}else h?MainFrame.DataParser.parsePageNumbering.call(t,h):MainFrame.DataParser.parsePageNumbering.call(t);t.normalSize=MainFrame.DataParser.getSizeFromAttribute("normalSize",e),c?(t.totalPages=g.length,t.hasCustomPages=!0,MainFrame.DataParser.fillCatalogPages.call(t,g)):MainFrame.DataParser.fillCatalogPages.call(t),this.lastPage=this.pageNumbers[this.totalPages]},getPngPages:function(e){var t=[];if("all"===e)for(var a=1,i=this.totalPages;i>a;a++){var r=MainFrame.Util.zeroFill(a);t.push(r)}else for(var n=e.split(","),s=0,o=n.length;o>s;s++){var l=n[s];if(-1!==l.indexOf("-"))for(var c=l.split("-"),d=parseInt(c[0],10),g=parseInt(c[1],10),a=d;g>=a;a++){var r=MainFrame.Util.zeroFill(a);t.push(r)}else{var r=MainFrame.Util.zeroFill(l);t.push(r)}}return t},addPage:function(e,t){if("undefined"==typeof t||t.length<1)return void e.push(null);for(var a=new MainFrame.Abstract.Page,i=[],r=[],n=[],s=[],o=[],l=[],c=[],d=0,g=t.length;g>d;d++){var h=t[d],u=this.settings.pngPages&&-1!==this.settings.pngPages.indexOf(h),m=u?"png":"jpg";i.push(h+"hd.png"),r.push(h+"."+m),s.push(this.commonDataSrc+h+"v."+m),o.push(MainFrame.Util.emptyImageUrl),n.push(h+"hd."+m),l.push(this.commonDataSrc+h+".pdf"),c.push(h)}a.pageType.normal=r,a.pageType.zoom=n,a.pageType.diapo=s,a.pageType.pdf=l,a.pageType.png=i,a.pageType.empty=o,a.numbers=c,e.push(a)},fillCatalogPages:function(e){var t=this;if(t.pageIndexes=[],"1"===t.pagingType||"2"===t.pagingType){t.singlePages=[];for(var a=0;a<t.totalPages;a++){var i=e?e[a]:a+1;MainFrame.DataParser.addPage.call(t,t.singlePages,[MainFrame.Util.zeroFill(i)]),t.pageIndexes.push(parseInt(i,10))}t.doublePages=[];var i=e?e[0]:1;MainFrame.DataParser.addPage.call(t,t.doublePages,[MainFrame.Util.zeroFill(i)]);for(var a=2;a<=t.totalPages;a+=2){var r=[],n=e?e[a-1]:a,s=MainFrame.Util.zeroFill(n);if(r.push(s),a+1<=t.totalPages){var o=e?e[a]:a+1,l=MainFrame.Util.zeroFill(o);r.push(l)}MainFrame.DataParser.addPage.call(t,t.doublePages,r)}}},parsePageNumbering:function(e){if(this.pageNumbers=[],this.pageNumbers.push(null),e){if(e.childNodes.length)for(var t=1,a=e.childNodes.length;a>=t;t++){var i=e.childNodes[t-1];if(i.attributes){var r=i.attributes.pub;this.pageNumbers.push(r)}}}else for(var t=1;t<=this.totalPages;t++){var r;r=this.pageOffset?t<=this.pageOffset?MainFrame.Util.romanize(t):t-this.pageOffset+"":t+"",this.pageNumbers.push(r)}}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),!function(){var e={parseFlipCatalog:function(e){MainFrame.DataParser.basicParse.call(this,e),e.attributes.catalogId&&MainFrame.DataParser.parseFlipCatalogSettings.call(this,e.attributes.catalogId)},parseFlipCatalogSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);if(this.settings={},this.settingsId=e,this.settings.static="true"===t.attributes["static"]?!0:!1,this.settings.maps={active:!1},this.settings.prices={active:!1},t.childNodes){var a=MainFrame.DataParser.getNodeNamed(t,"pages");a&&MainFrame.DataParser.parsePages.call(this,a);var i=MainFrame.DataParser.getNodeNamed(t,"pageSizes");i&&MainFrame.DataParser.parsePageSizes.call(this,i);var r=MainFrame.DataParser.getNodeNamed(t,"pageFiles");r&&MainFrame.DataParser.parsePageFiles.call(this,r);var n=MainFrame.DataParser.getNodeNamed(t,"maps");n&&MainFrame.DataParser.parseMaps&&MainFrame.DataParser.parseMaps.call(this,n);var s=MainFrame.DataParser.getNodeNamed(t,"customMaps");s&&MainFrame.DataParser.parseCustomMaps&&MainFrame.DataParser.parseCustomMaps.call(this,s);var o=MainFrame.DataParser.getNodeNamed(t,"search");o&&MainFrame.DataParser.parseSearch&&MainFrame.DataParser.parseSearch.call(this,o);var l=MainFrame.DataParser.getNodeNamed(t,"prices");l&&MainFrame.DataParser.parsePriceSettings&&MainFrame.DataParser.parsePriceSettings.call(this,l)}var c=t.attributes.navigationType;c?"flip"!==c&&"verticalSlide"!==c&&"horizontalSlide"!==c&&(c="horizontalSlide"):c="Desktop"===EnvDetection.deviceType&&"double"===this.settings.pages.catalogType?"flip":"horizontalSlide";var d=window.navigator.userAgent,g=d.indexOf("Trident/7.0")>0;if(g)if("false"!==t.attributes.disableFlipForIE11)c="horizontalSlide";else{var h=MainFrame.Util.getMainFrame();h.containerElement.style.borderRadius="2px",h.containerElement.style.opacity="1",h.containerElement.style.filter="none"}this.settings.navigationType=c},parsePageSizes:function(e){for(var t=[],a=0,i=e.childNodes.length;i>a;a++){var r=e.childNodes[a],n=r.attributes.name,s=r.attributes.size.split("|"),o=parseInt(s[0],10),l=parseInt(s[1],10),c={};c.name=n,c.width=o,c.height=l,t.push(c)}var d=function(e,t){return e.width<t.width?-1:e.width>t.width?1:0};this.settings.pages.sizes=t.sort(d)},parsePageFiles:function(e){var t={};e.childNodes.forEach(function(e){var a=e.nodeName,i=e.attributes.name;t[a]=i}),this.settings.pages.pageFiles=t},parsePages:function(e){var t=this,a={},i=e.attributes.catalogType||"2";"1"===i?a.catalogType="single":"2"===i&&(a.catalogType="double"),a.totalPages=parseInt(e.attributes.nr,10),a.offset=e.attributes.offset?parseInt(e.attributes.offset,10):0,e.attributes.pageRestriction&&(a.pageRestriction=parseInt(e.attributes.pageRestriction,10)),"true"===e.attributes.disableDrag&&(a.disableDrag=!0),a.disableSinglePage="true"===e.attributes.disableSinglePage?!0:!1;var r=e.attributes.cover;"double"!==r&&(r="single"),a.coverType=r;var n=MainFrame.DataParser.getSizeFromAttribute("normalSize",e);a.normalSize=n;var s=MainFrame.DataParser.getInsertedPages(e);if(a.insertedPages=s,a.pageGETParam=e.attributes.pageGETParam||"page",a.loadCurrentPage="false"===e.attributes.loadCurrentPage?!1:!0,a.useXJpgForZoom="true"===e.attributes.useXJpgForZoom?!0:!1,a.useXJpgForZoom){var o=e.attributes.xJpgPages;if(o)var l=MainFrame.DataParser.getPagesArrayFromString(o);else for(var l=[],c=1;c<=a.totalPages;c++)l.push(c);a.xJpgPages=l}a.progressiveImageLoading="false"===e.attributes.progressiveLoad?!1:!0,a.customPages=MainFrame.DataParser.getCustomPages(e);var d=e.attributes.customPagePostfix;if(a.customPagePostfix=MainFrame.Util.processAttribute(d).interpretedString,e.attributes.useHdAbove&&(a.useHdAbove=e.attributes.useHdAbove),a.pdfPrefix=e.attributes.pdfPrefix?e.attributes.pdfPrefix:"",a.centerFirst=!1,a.centerLast=!1,e.attributes.centerFirstLast){var g=e.attributes.centerFirstLast;a.centerFirst="false"===g?!1:!0,a.centerLast="false"===g?!1:!0}e.attributes.centerFirst&&(a.centerFirst="false"===e.attributes.centerFirst?!1:!0),e.attributes.centerLast&&(a.centerLast="false"===e.attributes.centerLast?!1:!0);var h=MainFrame.DataParser.getNodeNamed(e,"pageNumbering");if(e.attributes.pageNumberingXml){var u=MainFrame.Util.getAppURL()+e.attributes.pageNumberingXml;MainFrame.Util.request({url:u,parsedXmlResponse:!0,onSuccess:function(e){MainFrame.DataParser.parsePageNumbering.call(t,e)}})}else h?MainFrame.DataParser.parsePageNumbering.call(t,h):MainFrame.DataParser.parsePageNumbering.call(t);a.dataSrc=e.attributes.data||"html/data/",a.commonSrc=e.attributes.commonUrl||"common/data/",a.useShadow="true"===e.attributes.useShadow||"1"===e.attributes.useShadow?!0:!1;var m=e.attributes.chaptersId;if(m){var p=MainFrame.Manager.Settings.getById(m);if(p){var f=MainFrame.DataParser.parseChapters(p);a.chaptersId=m,a.chapters=f}}t.settings.pages=a},parseMaps:function(e){var t=this;t.settings.maps={};var a="true"===e.attributes.active?!0:!1;if(a){if(t.settings.maps.active=!0,t.settings.maps.hasMaps=!0,t.settings.maps.dataSrcMaps=e.attributes.data,t.settings.maps.baseUrlMaps=e.attributes.baseUrl,t.settings.maps.finUrlMaps=e.attributes.finUrl,e.attributes.mapsConfigXml){var i=MainFrame.Util.getAppURL()+e.attributes.mapsConfigXml;MainFrame.Util.request({url:i,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(e){MainFrame.DataParser.parseMapsSettings.call(t.settings.maps,e)}})}if(e.attributes.mediasConfigXml)if("undefined"==typeof MainFrame.Manager.Media)MainFrame.Util.warn("The mediasConfigXml attribute is specified but the Medias module is not included in the source files! Please check src-mini.js");else if(!MainFrame.Manager.Media.preloaded){var r=MainFrame.Util.getAppURL()+e.attributes.mediasConfigXml;MainFrame.Util.request({url:r,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(e){MainFrame.DataParser.registerDataInManager(MainFrame.Manager.Media,"media","id",e);var t=MainFrame.DataParser.getChildrenWithNodeName(e,"details");for(index=0,totalDetails=t.length;totalDetails>index;index++){var a=t[index];
MainFrame.DataParser.parseDetails(a)}}})}if(e.attributes.mapsZipUrl&&MainFrame.Browser.hasBlobSupport&&"undefined"!=typeof zip&&!MainFrame.Browser.isFileProtocol){var n=new zip.fs.FS;zip.useWebWorkers=!1;var s=e.attributes.mapsZipUrl;s=MainFrame.Util.localizePath(s);var o=MainFrame.Util.getAppURL()+s;n.importHttpContent(o,!1,function(){t.settings.maps.zips={};for(var e=0,a=n.root.children.length;a>e;e++){var i=n.root.children[e];t.settings.maps.zips[i.name]=i}},function(){console.log("maps xml unzip error!")})}}else t.settings.maps.active=!1,t.settings.maps.hasMaps=!1},getCustomPages:function(e){var t=e.attributes.customPages;return t?this.getPagesArrayFromString(t):[]},getInsertedPages:function(e){var t=[],a=MainFrame.DataParser.getNodeNamed(e,"insertedPages");return a&&a.childNodes.forEach(function(e){var a=e.attributes.insertAfter,i=e.attributes.insertBefore,r=e.attributes.pages,n=MainFrame.DataParser.getPagesArrayFromString(r),s=e.attributes.suffix;a&&(a=parseInt(a,10)),i&&(i=parseInt(i,10)),t.push({insertAfter:a,insertBefore:i,pages:n,suffix:s})}),t},getPagesArrayFromString:function(e){var t=[];if(e)for(var a=e.split(","),i=0,r=a.length;r>i;i++){var n=a[i];if(-1===n.indexOf("-"))n=parseInt(n,10),t.push(n);else for(var s=n.split("-"),o=parseInt(s[0],10),l=parseInt(s[1],10),n=o;l>=n;n++)t.push(n)}return t}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),!function(){var e={parsePagePreview:function(e){MainFrame.DataParser.basicParse.call(this,e),MainFrame.DataParser.getSourceModule.call(this,e);var t=this.sourceModule,a=t.settings.pages,i=e.attributes.useShadow;if(this.useShadow="true"===i?!0:"false"===i?!1:a.useShadow,"undefined"==typeof this.settings&&(this.settings={}),this.settings.borders={},MainFrame.DataParser.getBorders.call(this.settings.borders,e),this.centerFirst=a.centerFirst,this.centerLast=a.centerLast,e.attributes.centerFirstLast){var r=e.attributes.centerFirstLast;this.centerFirst="false"===r?!1:!0,this.centerLast="false"===r?!1:!0}e.attributes.centerFirst&&(this.centerFirst="false"===e.attributes.centerFirst?!1:!0),e.attributes.centerLast&&(this.centerLast="false"===e.attributes.centerLast?!1:!0),e.attributes.loadOnlyWithImage&&(this.loadOnlyWithImage="true"===e.attributes.loadOnlyWithImage?!0:!1);var n=e.attributes.quality||"auto";this.quality=n;var s=e.attributes.mode||"single";this.setMode(s);var o=e.attributes.number||"currentPage";this.setPageNumber(o),MainFrame.Browser.hasTouch||(MainFrame.DataParser.getAltId.call(this,e),MainFrame.DataParser.getHandCursor.call(this,e))}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.ToggleZoomPageCatalog=MainFrame.Action.BaseZoomPageCatalog.extend({startAction:function(){var e=this.getTarget();if(e){if("idle"!==e.state)return;var t=this.getParam("duration");if(t)var a=parseFloat(t,10);else var a=.5;var i=this.getParam("force"),r=this.getParam("scale"),n="false"===this.getParam("naturalSize")?!1:!0,s=this.getParam("minScale"),o=r?parseFloat(r,10):2,l=s?parseFloat(s,10):1.1,c="undefined"!=typeof e.settings.pages.sizes;if(c&&n&&(o=this.determineNaturalSizeScale(o,e),l>o&&(o=2,this.useOldZoom=!0)),"zoomOut"===i&&1===e.scale)return void this.endAndClearAction();if("zoomIn"===i&&e.scale>1)return void this.endAndClearAction();e.easing&&e.easing.stop(),e.setCatalogState("zooming"),this.toggleZoom(e,a,i,o)}else this.endAndClearAction()},toggleZoom:function(e,t,a,i){if("true"===this.getParam("old_zoom")||this.useOldZoom===!0)this.toggleZoom_old(e,t,a,i);else{var r="undefined"!=typeof e.settings.pages.sizes;r?"flip"===e.settings.navigationType?this.toggleZoom_flip(e,t,a,i):this.toggleZoom_slide(e,t,a,i):this.toggleZoom_old(e,t,a,i)}}});var proto=MainFrame.Action.ToggleZoomPageCatalog.prototype;proto.toggleZoom_old=function(e,t,a,i){var r=this;if("flip"===e.settings.navigationType)var n=e.catalogContainer;else var n=e.currentPageContainers.main;r.setTransitionAndPerspective(n,t);var s=function(){n.style.transition="",e.transformScale=e.scale,1===e.scale?("flip"===e.settings.navigationType&&MainFrame.Browser.noPreserve3D!==!0&&(n.style.perspective="3000px",n.style.webkitPerspective="3000px"),r.setDisplayForOtherPages(e,""),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedOut")):MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedIn"),MainFrame.Publisher.publish(o,{}),MainFrame.Event.unbind(n,MainFrame.Event.transitionEnd,s),setTimeout(function(){e.setCatalogState("idle"),r.endAndClearAction()},500)};if(MainFrame.Event.bind(n,MainFrame.Event.transitionEnd,s),1===e.scale&&"zoomOut"!==a){var o=e.id+":zoomIn";MainFrame.Publisher.publish(e.id+":willZoomIn",{}),r.zoomIn_old(e,n,i,t)}else if(1!==e.scale&&"zoomIn"!==a){var o=e.id+":zoomOut";r.zoomOut_old(e,n,i,t)}},proto.zoomIn_old=function(e,t,a){var i=this;i.setDisplayForOtherPages(e,"none"),MainFrame.EventHandler.dispatch("#"+e.id+".willZoomIn");var r=this.calculateZoomPosition(e,a);t.translatedX=r.x,t.translatedY=r.y,e.scale=a,MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,a,!0),"flip"===e.settings.navigationType&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity="0"),i.updateContainerImages(e,a,"zoom");var n=i.getParam("page");("left"===n||"right"===n)&&i.hidePage(e,n)},proto.zoomOut_old=function(e,t){var a=this;MainFrame.EventHandler.dispatch("#"+e.id+".willZoomOut"),MainFrame.Util.setPosition(t,0,0,1,!0),"flip"===e.settings.navigationType&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity="1"),a.updateContainerImages(e,1,"normal"),e.scale=1,a.showHiddenPage(e)};var proto=MainFrame.Action.ToggleZoomPageCatalog.prototype;proto.toggleZoom_flip=function(e,t,a,i){var r=this,n=e.catalogContainer,s=function(){if(n.style.transition="",e.transformScale=1,1===e.scale)MainFrame.Browser.noPreserve3D!==!0&&(n.style.perspective="3000px",n.style.webkitPerspective="3000px"),r.setDisplayForOtherPages(e,""),"flip"===e.settings.navigationType&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity="1"),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedOut");else{r.convertScaledTranslation_flip(e,n,i);var t=!0;r.resizeMaps(e,t),r.resizePrices(e,t),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedIn")}MainFrame.Publisher.publish(o,{}),MainFrame.Event.unbind(n,MainFrame.Event.transitionEnd,s),setTimeout(function(){e.setCatalogState("idle"),r.endAndClearAction()},500)};if(MainFrame.Event.bind(n,MainFrame.Event.transitionEnd,s),1===e.scale&&"zoomOut"!==a){var o=e.id+":zoomIn";MainFrame.Publisher.publish(e.id+":willZoomIn",{}),r.zoomIn(e,n,i,t)}else if(1!==e.scale&&"zoomIn"!==a){var o=e.id+":zoomOut";r.zoomOut_flip(e,n,i,t)}},proto.zoomOut_flip=function(e,t,a,i){var r=this;r.resetTranslationForZoomOut_flip(e,t);var n=!1;r.resizeMaps(e,n),r.resizePrices(e,n),MainFrame.EventHandler.dispatch("#"+e.id+".willZoomOut"),r.setTransitionAndPerspective(t,i),MainFrame.Util.setPosition(t,0,0,1,!0),r.updateContainerImages(e,1,"normal"),e.scale=1,r.showHiddenPage(e)},proto.resetTranslationForZoomOut_flip=function(e,t){this.setTransitionAndPerspective(t,0);var a=e.currentCatalogSize,i=a.width,r=a.height;t.style.width=i+"px",t.style.height=r+"px";var n=a.width*(e.scale-1)/2,s=a.height*(e.scale-1)/2;t.translatedX=Math.round(t.translatedX+n),t.translatedY=Math.round(t.translatedY+s),MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,e.scale,!0),window.getComputedStyle(t,null).getPropertyValue("transform")},proto.convertScaledTranslation_flip=function(e,t,a){var i=e.currentCatalogSize,r=this.getScaledSize(e,a);if(t.style.width=r.width+"px",t.style.height=r.height+"px",this.naturalSizeScale)var n=this.naturalSizeScale.x,s=this.naturalSizeScale.y;else var n=a,s=a;var o=i.width*(n-1)/2,l=i.height*(s-1)/2;t.translatedX=Math.round(t.translatedX-o),t.translatedY=Math.round(t.translatedY-l);var c=1;MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,c,!0)};var proto=MainFrame.Action.ToggleZoomPageCatalog.prototype;proto.toggleZoom_slide=function(e,t,a,i){var r=this,n=e.currentPageContainers.main,s=e.currentPageContainers.wrapper,o=function(){if(n.style.transition="",e.transformScale=1,1===e.scale)r.setDisplayForOtherPages(e,""),n.style.perspective="",n.style.transform="",n.style.webkitTransition="",n.style.width="",n.style.height="",MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedOut");else{r.convertScaledTranslation_slide(e,n,s,i);var t=!0;r.resizeMaps(e,t),r.resizePrices(e,t),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedIn")}MainFrame.Publisher.publish(l,{}),MainFrame.Event.unbind(n,MainFrame.Event.transitionEnd,o),setTimeout(function(){e.setCatalogState("idle"),r.endAndClearAction()},500)};if(MainFrame.Event.bind(n,MainFrame.Event.transitionEnd,o),1===e.scale&&"zoomOut"!==a){var l=e.id+":zoomIn";MainFrame.Publisher.publish(e.id+":willZoomIn",{}),r.zoomIn(e,n,i,t)}else if(1!==e.scale&&"zoomIn"!==a){var l=e.id+":zoomOut";r.zoomOut_slide(e,n,s,i,t)}},proto.zoomOut_slide=function(e,t,a,i,r){var n=this;n.resetTranslationForZoomOut_slide(e,t,a,i);var s=!1;n.resizeMaps(e,s),n.resizePrices(e,s),MainFrame.EventHandler.dispatch("#"+e.id+".willZoomOut"),n.setTransitionAndPerspective(t,r),MainFrame.Util.setPosition(t,0,0,1,!0),n.updateContainerImages(e,1,"normal"),e.scale=1,n.showHiddenPage(e)},proto.resetTranslationForZoomOut_slide=function(e,t,a,i){this.setTransitionAndPerspective(t,0);var r=e.currentCatalogSize;t.style.width="",t.style.height="",a.style.width=r.width+"px",a.style.height=r.height+"px",a.style.left=r.x+"px",a.style.top=r.y+"px";var n=r.width*(i-1)/2,s=r.height*(i-1)/2;n-=r.x*i/2,s-=r.y*i/2,t.translatedX=Math.round(t.translatedX+n),t.translatedY=Math.round(t.translatedY+s),MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,e.scale,!0),window.getComputedStyle(t,null).getPropertyValue("transform")},proto.convertScaledTranslation_slide=function(e,t,a,i){var r=e.currentCatalogSize,n=this.getScaledSize(e,i);if(t.style.width=n.width+"px",t.style.height=n.height+"px",a.style.width=n.width+"px",a.style.height=n.height+"px",a.style.left="0px",a.style.top="0px",this.naturalSizeScale)var s=this.naturalSizeScale.x,o=this.naturalSizeScale.y;else var s=i,o=i;var l=r.width*(s-1)/2,c=r.height*(o-1)/2,d=2;l-=r.x-d,c-=r.y-d,t.translatedX=Math.round(t.translatedX-l),t.translatedY=Math.round(t.translatedY-c);var g=1;MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,g,!0)},MainFrame.Action.ApplyEasingZoomCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if("undefined"!=typeof e._onMouseMove)return void this.endAndClearAction();var t=new MainFrame.Easing;e.easing=t,t.onCompletionDispatch("easeEndZoomCatalog");var a=this.calculateZoomLimits(e);if("flip"===e.settings.navigationType)var i=e.catalogContainer;else var i=e.currentPageContainers.main;var r=e.transformScale,n={translatedX:Math.round(i.translatedX),translatedY:Math.round(i.translatedY),containerElement:i,scale:r};t.setScrollLeftLimits(a.limitLeft,a.limitRight),t.setScrollTopLimits(a.limitTop,a.limitBottom),t.setTarget(n),t.addListeners(),t.setZoomLevel(r),t.setScrollPosition(-n.translatedX,-n.translatedY);var s=this.getParam("sourceEvent").currentEvent;t.startWithEvent(s),this.endAndClearAction()},calculateZoomLimits:function(e){var t=e.currentCatalogSize,a=e.scale,i=1===e.currentPage,r=e.isLastPage(e.currentPage),n=t.x-t.width*(a-1)/2,s=t.y-t.height*(a-1)/2,o=-n,l=-s,c="undefined"!=typeof e.transformScale&&1===e.transformScale&&e.transformScale!==e.scale;if(c)if("flip"===e.settings.navigationType)var d=t.width*(a-1)/2,g=t.height*(a-1)/2;else{var d=t.width*(a-1)/2,g=t.height*(a-1)/2;d-=t.x*a/2,g-=t.y*a/2}else var d=0,g=0;n+=d,o+=d,s+=g,l+=g;var h=e.isDoublePage&&("undefined"!=typeof e.currentPageContainers.left.singleZoomOverlay||"undefined"!=typeof e.currentPageContainers.right.singleZoomOverlay);return 1===e.pagesOnScreen||h?e.currentPageSize.width:2*e.currentPageSize.width,e.isDoublePage&&1===e.pagesOnScreen&&("flip"===e.settings.navigationType?i?(n=t.width*a/4+d,o=n,e.settings.pages.centerFirst===!0&&(n-=e.currentCatalogSize.width/4,o-=e.currentCatalogSize.width/4)):r&&(n=-(t.width*a)/4+d,o=n,e.settings.pages.centerLast===!0&&(n+=e.currentCatalogSize.width/4,o+=e.currentCatalogSize.width/4)):i?(n=t.width*a/4+d,o=n,e.settings.pages.centerFirst===!0&&(n-=e.currentCatalogSize.width/2,o-=e.currentCatalogSize.width/2)):r&&(n=-(t.width*a)/4+d,o=n,e.settings.pages.centerLast===!0&&(n+=e.currentCatalogSize.width/2,o+=e.currentCatalogSize.width/2))),n=Math.round(n),o=Math.round(o),s=Math.round(s),l=Math.round(l),{limitLeft:n,limitRight:o,limitTop:s,limitBottom:l}}}),MainFrame.Action.PinchZoomPageCatalog=MainFrame.Action.ToggleZoomPageCatalog.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getTarget();if("flip"===t.settings.navigationType)var a=t.catalogContainer;else var a=t.currentPageContainers.main;var i=this.getParam("minScale");if(i)var r=parseFloat(i,10);else var r=.5;var n=this.getParam("maxScale");if(n)var s=parseFloat(n,10);else var s=4;if(e.scale>r&&e.scale<s){var o=t.scale*e.scale,l=this.calculatePinchZoomPosition(t,e,o),c="undefined"!=typeof t.settings.pages.sizes,d="true"===this.getParam("old_zoom")?!0:!1;if(d||!c)this.pinchZoom_old(t,a,l,o);else if("flip"===t.settings.navigationType)this.pinchZoom_flip(t,a,l,o);else{var g=t.currentPageContainers.wrapper;this.pinchZoom_slide(t,a,g,l,o)}}this.endAndClearAction()},pinchZoom_old:function(e,t,a,i){e.isBeingPinched=!0,MainFrame.Util.setTransformDuration(t,0),"flip"===e.settings.navigationType&&(t.style.perspective="none"),t.translatedX=a.x,t.translatedY=a.y,t.scale=i,e.transformScale=i,MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,t.scale)},pinchZoom_flip:function(e,t,a,i){MainFrame.Util.setTransformDuration(t,0),container.style.perspective="none",e.isBeingPinched||this.resetTranslationForZoomOut_flip(e,t,i),e.isBeingPinched=!0,t.translatedX=a.x,t.translatedY=a.y,t.scale=i,MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,t.scale)},pinchZoom_slide:function(e,t,a,i,r){MainFrame.Util.setTransformDuration(t,0),e.isBeingPinched||this.resetTranslationForZoomOut_slide(e,t,a,r),e.isBeingPinched=!0,t.translatedX=i.x,t.translatedY=i.y,t.scale=r,MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,t.scale)},calculatePinchZoomPosition:function(e,t,a){if("flip"===e.settings.navigationType)var i=e.catalogContainer;else var i=e.currentPageContainers.main;"undefined"==typeof i.translatedX&&(i.translatedX=0),"undefined"==typeof i.translatedY&&(i.translatedY=0);var r=e.getDimensionX(),n=e.getDimensionY(),s=e.getPositionX(),o=e.getPositionY(),l=r/2,c=n/2,d=parseFloat(t.initialCenterX)-s,g=parseFloat(t.initialCenterY)-o,h=l+i.translatedX,u=c+i.translatedY,m=(h-d)/a,p=(u-g)/a,f=l-m,v=c-p,M=(l-f)*(a-1),b=(c-v)*(a-1);return{x:M,y:b}}}),MainFrame.Action.RepositionAfterPinchCatalog=MainFrame.Action.ToggleZoomPageCatalog.extend({startAction:function(){var e=this,t=e.getTarget(),a=e.getParam("sourceEvent");if("flip"===t.settings.navigationType)var i=t.catalogContainer,r=null;else var i=t.currentPageContainers.main,r=t.currentPageContainers.wrapper;if(t&&a.scale){var n=e.getParam("minScale");if(n)var s=parseFloat(n,10);else var s=1;var o=e.getParam("maxScale");if(o)var l=parseFloat(o,10);else var l=3;var c=e.getParam("duration");if(c)var d=parseFloat(c,10);else var d=.5;if(t.isChangingPages!==!0){scale=s&&a.scale<s?s:l&&a.scale>l?l:a.scale;var g="undefined"!=typeof t.settings.pages.sizes,h="true"===this.getParam("old_zoom")?!0:!1;if(g&&!h){scale>1.2&&(scale=e.determineNaturalSizeScale(scale,t),s>scale&&scale>1.2&&(scale=s),1.2>scale&&(scale=1));var u=this.calculatePinchZoomPosition(t,i,a,scale);e.repositionAfterPinch(t,i,r,u,scale,d)}else{var u=this.calculatePinchZoomPosition_old(t,i,a,scale);e.repositionAfterPinch_old(t,i,u,scale,d)}t.easing&&t.easing.stop()}}else e.endAndClearAction()},repositionAfterPinch_old:function(e,t,a,i,r){var n=this;t.translatedX=a.x,t.translatedY=a.y,t.scale=i;var s=function(){if(container.style.transition="",1===e.scale?("flip"===e.settings.navigationType&&MainFrame.Browser.noPreserve3D!==!0&&(container.style.perspective="3000px"),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedOut")):MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedIn"),i>1)var t=e.id+":zoomIn";else if(1===i&&1!==e.scale)var t=e.id+":zoomOut";e.scale=i,e.isBeingPinched=!1,t&&MainFrame.Publisher.publish(t,{}),MainFrame.Event.unbind(container,MainFrame.Event.transitionEnd,s),n.endAndClearAction()};MainFrame.Event.bind(t,MainFrame.Event.transitionEnd,s),t.style.transition="transform "+r+"s",t.style.webkitTransition="-webkit-transform "+r+"s",MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,t.scale,!0)},repositionAfterPinch:function(e,t,a,i,r,n){var s=this;t.translatedX=i.x,t.translatedY=i.y,t.scale=r;var o=function(){if(t.style.transition="",e.transformScale=1,e.isBeingPinched=!1,1===e.scale){"flip"===e.settings.navigationType&&MainFrame.Browser.noPreserve3D!==!0&&(t.style.perspective="3000px"),"flip"!==e.settings.navigationType&&(t.style.perspective="",t.style.transform="",t.style.webkitTransition="",t.style.width="",t.style.height="");var i=!1;s.resizeMaps(e,i),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedOut"),e.settings.pages.useShadow&&"flip"===e.settings.navigationType&&(e.outerShadowContainer.style.display="")}else{s.updateContainerImages(e,r,"zoom"),s.convertScaledTranslation(e,t,a,r);var i=!0;s.resizeMaps(e,i,r),MainFrame.EventHandler.dispatch("#"+e.id+".hasZoomedIn"),e.settings.pages.useShadow&&"flip"===e.settings.navigationType&&(e.outerShadowContainer.style.display="none")}if(r>1)var n=e.id+":zoomIn";else if(1===r&&1!==e.scale)var n=e.id+":zoomOut";n&&MainFrame.Publisher.publish(n,{}),MainFrame.Event.unbind(t,MainFrame.Event.transitionEnd,o),s.endAndClearAction()};MainFrame.Event.bind(t,MainFrame.Event.transitionEnd,o),t.style.transition="transform "+n+"s",t.style.webkitTransition="-webkit-transform "+n+"s",1===r?(s.updateContainerImages(e,1,"normal"),MainFrame.Util.setPosition(t,0,0,r,!0)):MainFrame.Util.setPosition(t,t.translatedX,t.translatedY,r,!0),e.scale=r},convertScaledTranslation:function(e,t,a,i){"flip"===e.settings.navigationType?this.convertScaledTranslation_flip(e,t,i):this.convertScaledTranslation_slide(e,t,a,i)},resetTranslationForZoomOut:function(e,t,a,i){"flip"===e.settings.navigationType?this.resetTranslationForZoomOut_flip(e,t,i):this.resetTranslationForZoomOut_slide(e,t,a,i)},calculatePinchZoomPosition:function(e,t,a,i){if("undefined"==typeof t.translatedX&&(t.translatedX=0),"undefined"==typeof t.translatedY&&(t.translatedY=0),this.naturalSizeScale)var r=this.naturalSizeScale.x,n=this.naturalSizeScale.y;else var r=i,n=i;var s=e.getDimensionX(),o=e.getDimensionY(),l=e.getPositionX(),c=e.getPositionY(),d=s/2,g=o/2,h=parseFloat(a.initialCenterX,10),u=parseFloat(a.initialCenterY,10),m=h-l,p=u-c,f=m-d,v=p-g,M=f*r,b=v*n,F=-(M-f),A=-(b-v);return{x:F,y:A}},calculatePinchZoomPosition_old:function(e,t,a,i){"undefined"==typeof t.translatedX&&(t.translatedX=0),"undefined"==typeof t.translatedY&&(t.translatedY=0);var r=e.getDimensionX(),n=e.getDimensionY(),s=e.getPositionX(),o=e.getPositionY(),l=r/2,c=n/2,d=parseFloat(a.initialCenterX)-s,g=parseFloat(a.initialCenterY)-o,h=l+t.translatedX,u=c+t.translatedY,m=(h-d)/i,p=(u-g)/i,f=l-m,v=c-p,M=(l-f)*(i-1),b=(c-v)*(i-1);return{x:M,y:b}}}),MainFrame.Action.ZoomToScaleCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getTarget(),a=parseFloat(this.getParam("scale")),i=parseFloat(this.getParam("duration")),r=t.containers[t.currentIndex],n=!1;if(a>t.scale?(t.setState("isZoomingIn"),n=!0):a<t.scale&&(t.setState("isZoomingOut"),n=!0),n){e=1===a?"normal":"zoomed",r.translatedX=0,r.translatedY=0,t.overlayTranslatedX=r.translatedX,t.overlayTranslatedY=r.translatedY,MainFrame.Util.setPosition(r.containerElement,r.translatedX,r.translatedY,a),MainFrame.Util.setTransformDuration(r.containerElement,i);var s=this;setTimeout(function(){t.scale=a,t.setState(e),s.endAndClearAction()},i)}else this.endAndClearAction()}}),MainFrame.Action.BindHoverDragZoomCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this,a=e.currentCatalogSize,i=a.width*e.scale,r=a.height*e.scale,n=a.width*e.scale,s=a.height*e.scale,o=i-a.width,l=r-a.height,c=1===e.currentPage,d=e.isLastPage(e.currentPage),g=e.settings.pages.centerFirst,h=e.settings.pages.centerLast,u=n<=a.width,m=(s<=a.height,0),p=i/2-a.width;if(r-a.height,1===e.pagesOnScreen&&"double"===e.settings.pages.catalogType)if(c){g?(m=-Math.round(a.width/4),"flip"!==e.settings.navigationType&&(m*=e.scale)):m=-a.x*e.scale;var f=i-a.width+m,v=f-p}else if(d){h?(m=Math.round(a.width/4),"flip"!==e.settings.navigationType&&(m*=e.scale)):m=-a.x*e.scale;var f=-m,v=f-p}if("flip"===e.settings.navigationType)var M=e.catalogContainer;else var M=e.currentPageContainers.main;var b=function(i){var r=t.getMousePercentagePositionOnCatalog(i,e),n=-(r.x/100)*o,s=-(r.y/100)*l;"flip"!==e.settings.navigationType&&(n+=a.x,s+=a.y),1===e.pagesOnScreen&&"double"===e.settings.pages.catalogType&&(u?n=M.translatedX:c?(n=-(v+p*(r.x/100)),h||(n-=a.x)):d&&(n=v+p*(r.x/100),h||(n-=a.x))),MainFrame.Util.setTransform(M,{translationX:n,translationY:s})};MainFrame.Event.bind(M,"mousemove",b),e._onMouseMove=b}this.endAndClearAction()},getMousePercentagePositionOnCatalog:function(e,t){var a=e.clientX,i=e.clientY,r=t.currentCatalogSize,n=t.getPositionX()+r.x,s=t.getPositionY()+r.y,o=a-n,l=i-s,c=100*o/r.width,d=100*l/r.height;return 0>c?c=0:c>100&&(c=100),0>d?d=0:d>100&&(d=100),{x:c,y:d}}}),MainFrame.Action.UnbindHoverDragZoomCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e&&"undefined"!=typeof e._onMouseMove){if("flip"===e.settings.navigationType)var t=e.catalogContainer;else var t=e.currentPageContainers.main;MainFrame.Event.unbind(t,"mousemove",e._onMouseMove),e._onMouseMove=null,delete e._onMouseMove}this.endAndClearAction()}}),MainFrame.Action.DragPageCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("sourceEvent");"flip"===e.settings.navigationType&&e.settings.pages.disableDrag!==!0&&this.flipDrag(e,t),"horizontalSlide"===e.settings.navigationType&&this.horizontalDrag(e,t),"verticalSlide"===e.settings.navigationType&&this.verticalDrag(e,t),this.endAndClearAction()}else MainFrame.Util.showError("DragPageCatalog error! The target does not exist"),this.endAndClearAction()}});var proto=MainFrame.Action.DragPageCatalog.prototype;proto.flipDrag=function(e,t){if(e.isSinglePage!==!0){var t=this.paramsObject.sourceEvent;if(this.isValidDrag(t)){var a=this.getDragStartingPosition(e,t);"right_margin"===a?this.flipDragForward(e,t):"left_margin"===a&&this.flipDragBackward(e,t)}}},proto.isValidDrag=function(e){var t=this.getParam("minDistance");if(t)var a=parseInt(t,10);else var a=5;var i=Math.abs(e.totalDistanceX)>a||Math.abs(e.totalDistanceY)>a;return i},proto.resetTransitionDurationForContainer=function(e){var t=0;e.container.style.webkitTransition="-webkit-transform "+t+"s",e.container.style.transition="transform "+t+"s"},proto.hideDynamicContentForContainer=function(e,t){e.hideHighlightedTextInContainer(t),e.hideNotesInContainer(t),e.hideMapZonesForContainer(t)},proto.flipDragForward=function(e,t){var a=e.currentPageContainers.left,i=e.currentPageContainers.right,r=e.nextPageContainers.left;if(e.nextPageContainers.right,e.previousPageContainers.left,e.previousPageContainers.right,"idle"===e.state){this.resetTransitionDurationForContainer(r),this.resetTransitionDurationForContainer(i),this.hideDynamicContentForContainer(e,a),this.hideDynamicContentForContainer(e,i);var n=e.currentPage;n+2===e.settings.pages.totalPages&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.width=e.currentPageSize.width+"px"),e.setCatalogState("flip_dragged_forward")}var s=this.getDragPositionPercentageOnCatalog(e,t),o=180*s/100;if(1===e.currentPage&&e.settings.pages.centerFirst){var l=e.currentCatalogSize.x-s/100*e.currentPageSize.width/2;l<=e.currentCatalogSize.x&&(e.catalogContainer.style.left=l+"px",e.catalogContainer.left=l,e.settings.pages.useShadow&&(e.outerShadowContainer.style.left=l+e.currentPageSize.width+"px"))}i.rotationY=o-180,r.rotationY=o,r.container.style.webkitTransform="rotateY("+r.rotationY+"deg)",r.container.style.transform="rotateY("+r.rotationY+"deg)",i.container.style.webkitTransform="rotateY("+i.rotationY+"deg)",i.container.style.transform="rotateY("+i.rotationY+"deg)"},proto.flipDragBackward=function(e,t){var a=e.currentPageContainers.left,i=e.currentPageContainers.right,r=(e.nextPageContainers.left,e.nextPageContainers.right,e.previousPageContainers.left,e.previousPageContainers.right);if("idle"===e.state){if(e.settings.static){var n=e.settings.pages.totalPages;a.container.style.zIndex=n+5,r.container.style.zIndex=n+3}else a.container.style.zIndex="10",r.container.style.zIndex="9";this.resetTransitionDurationForContainer(a),this.resetTransitionDurationForContainer(r),this.hideDynamicContentForContainer(e,a),this.hideDynamicContentForContainer(e,i);var s=e.currentPage;s-1===1&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.width=e.currentPageSize.width+"px",e.outerShadowContainer.style.left=e.currentCatalogSize.x+e.currentPageSize.width+"px"),e.setCatalogState("flip_dragged_backward")}var o=this.getDragPositionPercentageOnCatalog(e,t),l=180*o/100;if(e.currentPage===e.settings.pages.totalPages&&e.settings.pages.centerLast){var c=e.currentCatalogSize.x+e.currentPageSize.width/2-o/100*e.currentPageSize.width/2;c>=e.currentCatalogSize.x&&(e.catalogContainer.style.left=c+"px",e.catalogContainer.left=c,e.settings.pages.useShadow&&(e.outerShadowContainer.style.left=c+"px"))}a.rotationY=l,r.rotationY=l-180,r.container.style.webkitTransform="rotateY("+r.rotationY+"deg)",r.container.style.transform="rotateY("+r.rotationY+"deg)",a.container.style.webkitTransform="rotateY("+a.rotationY+"deg)",a.container.style.transform="rotateY("+a.rotationY+"deg)"},proto.getDragPositionOnCatalog=function(e,t){var a=t.currentCatalogSize,i=t.getPositionX()+a.x,r=t.currentPage;return 1===r&&t.settings.pages.centerFirst?i-=Math.round(a.width/4,10):t.isLastPage(r)&&t.settings.pages.centerLast&&(i+=Math.round(a.width/4,10)),e-i},proto.getDragStartingPosition=function(e,t){var a=e.currentCatalogSize,i=a.width,r=this.getParam("marginPercentage");if(r)var n=parseFloat(r,10);else var n=10;var s=i*n/100,o=this.getDragPositionOnCatalog(t.initialX,e);return s>=o?"left_margin":o>=i-s?"right_margin":"outside_margins"},proto.getDragPositionPercentageOnCatalog=function(e,t){var a=e.currentCatalogSize,i=a.width,r=this.getDragPositionOnCatalog(t.currentX,e),n=100*r/i;return n>100?100:0>n?0:n};var proto=MainFrame.Action.DragPageCatalog.prototype;proto.horizontalDrag=function(e,t){if("undefined"==typeof e.sliderContainer.translatedX)e.sliderContainer.translatedX=0;else{var a=e.sliderContainer.translatedX+"",i=-1!==a.indexOf("%");if(i){var r=e.getDimensionX(),n=-r*e.currentSlideIndex;e.sliderContainer.translatedX=n}}e.sliderContainer.translatedX+=t.distanceX,e.sliderContainer.translatedY=0,MainFrame.Util.setTransformDuration(e.sliderContainer,0),MainFrame.Util.setPosition(e.sliderContainer,e.sliderContainer.translatedX,e.sliderContainer.translatedY)},proto.verticalDrag=function(e,t){if("undefined"==typeof e.sliderContainer.translatedY)e.sliderContainer.translatedY=0;else{var a=e.sliderContainer.translatedY+"",i=-1!==a.indexOf("%");if(i){var r=e.getDimensionY(),n=-r*e.currentSlideIndex;e.sliderContainer.translatedY=n}}e.sliderContainer.translatedX=0,e.sliderContainer.translatedY+=t.distanceY,MainFrame.Util.setTransformDuration(e.sliderContainer,0),MainFrame.Util.setPosition(e.sliderContainer,e.sliderContainer.translatedX,e.sliderContainer.translatedY)},MainFrame.Action.DragPageZoomCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getTarget();MainFrame.Util.setDragTranslation(t.containers[t.currentIndex],e),t.overlayTranslatedX=t.containers[t.currentIndex].translatedX,t.overlayTranslatedY=t.containers[t.currentIndex].translatedY,t.maps&&MainFrame.Util.setDragTranslation(t.maps,e),this.endAndClearAction()}}),MainFrame.Action.GoBackCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(parseFloat(MainFrame.Util.setDefault(this.getParam("duration"),0)),e.viewedPages.length<2)this.endAndClearAction();else{e.viewedPages.pop();var t=e.viewedPages.pop();"undefined"!=typeof t&&MainFrame.ActionManager.doAction(e,e,e.id,"goToPageCatalog","false",[{page:t}])}this.endAndClearAction()}}),MainFrame.Action.GoBackToChapterCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=(parseFloat(MainFrame.Util.setDefault(this.getParam("duration"),0)),this.getChapterStartingPages(e));if(e){for(var a=e.currentPage,i=1,r=0,n=t.length;n>r;r++){var s=t[r];a>=s&&(i=s)}MainFrame.ActionManager.doAction(e,e,e.id,"goToPageCatalog","false",[{page:i}])}this.endAndClearAction()},getChapterStartingPages:function(e){var t=this.getParam("chapterPages"),a=t.split(","),i=[];return a.forEach(function(t){var a=e.getPageForPageNumber(t);i.push(a)}),i}}),MainFrame.Action.MoveSliderBall=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("indicator"),t=MainFrame.Manager.Scoping.getById(e),a=this.getParam("sourceEvent");t.translatedX||(t.translatedX=0),t.translatedX+=parseInt(a.pageX,10)-parseInt(t.getPositionX(),10),t.positionX=a.pageX+"",MainFrame.Util.setPosition(t.containerElement,t.translatedX,0),this.endAndClearAction()}}),MainFrame.Action.PauseAutoplay=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();"true"===this.getParam("reset")?!0:!1,e.isAutoplaying&&(clearInterval(e.autoplayInterval),e.isAutoplaying=!1),this.endAndClearAction()}}),MainFrame.Action.RemovePageRestriction=MainFrame.Abstract.Action.extend({startAction:function(){console.log("removePageRestriction");var e=this.getTarget();e&&delete e.settings.pages.pageRestriction,this.endAndClearAction()}}),MainFrame.Action.RepositionAfterDragCatalog=MainFrame.Action.BasePageCatalog.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("duration");if(t)var a=parseFloat(t,10);else var a=.3;"flip"===e.settings.navigationType&&(e.settings.pages.disableDrag!==!0?this.flipReposition(e,a):this.endAndClearAction()),"horizontalSlide"===e.settings.navigationType&&this.horizontalReposition(e,a),"verticalSlide"===e.settings.navigationType&&this.verticalReposition(e,a)}else MainFrame.Util.showError("DragPageCatalog error! The target does not exist"),this.endAndClearAction()}});var proto=MainFrame.Action.RepositionAfterDragCatalog.prototype;proto.flipReposition=function(e,t){var a=this.paramsObject.sourceEvent,i=a.dragDuration<250,r=Math.abs(a.totalDistanceX)>10||Math.abs(a.totalDistanceY)>10;if(i&&r)var n=!0;else var n=!1;"flip_dragged_forward"===e.state?this.flipRepositionForward(e,t,n):"flip_dragged_backward"===e.state&&this.flipRepositionBackward(e,t,n)},proto.showDynamicContentForContainer=function(e,t){e.showHighlightedTextInContainer(t),e.showNotesInContainer(t),e.showMapZonesForContainer(t)},proto.clearDynamicContentForContainer=function(e,t){e.clearHighlightedTextInContainer(t),e.clearNotesInContainer(t),e.hideMapsForContainer(t)},proto.flipRepositionForward=function(e,t,a){var i=(e.currentPageContainers.left,e.currentPageContainers.right),r=e.nextPageContainers.left,n=(e.nextPageContainers.right,e.previousPageContainers.left,e.previousPageContainers.right,this.getParam("turnPagePercentage"));if(n)var s=parseFloat(n,10);else var s=50;r.rotationY>=180-180*s/100&&!a?(r.rotationY=180,i.rotationY=0,this.flipRepositionForward_reset(e,t)):(r.rotationY=0,i.rotationY=-180,this.flipRepositionForward_updatePage(e,t))},proto.flipRepositionForward_reset=function(e,t){var a=this;if(1===e.currentPage&&e.settings.pages.centerFirst){var i=e.currentCatalogSize.x-Math.round(e.currentCatalogSize.width/4);
if(e.settings.pages.useShadow){var r=e.currentCatalogSize.x+Math.round(e.currentCatalogSize.width/4);TweenMax.to(e.outerShadowContainer,t,{left:r})}TweenMax.to(e.catalogContainer,t,{left:i}),delete e.catalogContainer.left}var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=(e.nextPageContainers.right,e.previousPageContainers.left,e.previousPageContainers.right,function(){e.currentPage+2===e.settings.pages.totalPages&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.width=e.currentCatalogSize.width+"px"),a.showDynamicContentForContainer(e,n),a.showDynamicContentForContainer(e,s),MainFrame.Event.unbind(o.container,MainFrame.Event.transitionEnd,l),e.setCatalogState("idle"),e.turningPage=!1,a.endAndClearAction()});MainFrame.Event.bind(o.container,MainFrame.Event.transitionEnd,l),o.container.style.webkitTransition="-webkit-transform "+t+"s",o.container.style.transition="transform "+t+"s",o.container.style.webkitTransform="rotateY("+o.rotationY+"deg)",o.container.style.transform="rotateY("+o.rotationY+"deg)",s.container.style.webkitTransition="-webkit-transform "+t+"s",s.container.style.transition="transform "+t+"s",s.container.style.webkitTransform="rotateY("+s.rotationY+"deg)",s.container.style.transform="rotateY("+s.rotationY+"deg)"},proto.flipRepositionForward_updatePage=function(e,t){var a=this,i=e.currentPageContainers.left,r=e.currentPageContainers.right,n=e.nextPageContainers.left,s=e.nextPageContainers.right,o=e.previousPageContainers.left,l=e.previousPageContainers.right;if(a.clearDynamicContentForContainer(e,i),a.clearDynamicContentForContainer(e,r),r.container.style.webkitTransition="-webkit-transform "+t+"s",r.container.style.transition="transform "+t+"s",r.container.style.webkitTransform="rotateY("+r.rotationY+"deg)",r.container.style.transform="rotateY("+r.rotationY+"deg)",1===e.currentPage&&e.settings.pages.centerFirst&&(TweenMax.to(e.catalogContainer,t,{left:e.currentCatalogSize.x}),delete e.catalogContainer.left),e.settings.static){var c=e.settings.pages.totalPages;r.container.style.zIndex=c+1,i.container.style.zIndex=""}else r.container.style.zIndex="10";e.incrementCurrentPage(),a.updateContainersDouble(e,i,r,n,s,o,l);var d=function(){a.afterNextDoubleFlip(e,i,r,n,s,o,l),a.showDynamicContentForContainer(e,i),a.showDynamicContentForContainer(e,r),MainFrame.Event.unbind(n.container,MainFrame.Event.transitionEnd,d),e.setCatalogState("idle"),e.turningPage=!1,a.endAndClearAction()};if(MainFrame.Event.bind(n.container,MainFrame.Event.transitionEnd,d),n.rotationY+=Math.random()/1e4,n.container.style.webkitTransition="-webkit-transform "+t+"s",n.container.style.transition="transform "+t+"s",n.container.style.webkitTransform="rotateY("+n.rotationY+"deg)",n.container.style.transform="rotateY("+n.rotationY+"deg)",e.settings.static){var c=e.settings.pages.totalPages;n.container.style.zIndex=c}else n.container.style.zIndex="9"},proto.flipRepositionBackward=function(e,t,a){var i=e.currentPageContainers.left,r=(e.currentPageContainers.right,e.nextPageContainers.left,e.nextPageContainers.right,e.previousPageContainers.left,e.previousPageContainers.right),n=this.getParam("turnPagePercentage");if(n)var s=parseFloat(n,10);else var s=50;i.rotationY<=180*s/100&&!a?(i.rotationY=0,r.rotationY=-180,this.flipRepositionBackward_reset(e,t)):(i.rotationY=180,r.rotationY=-0,this.flipRepositionBackward_updatePage(e,t))},proto.flipRepositionBackward_reset=function(e,t){var a=this;if(e.currentPage===e.settings.pages.totalPages&&e.settings.pages.centerLast){var i=e.currentCatalogSize.x+Math.round(e.currentCatalogSize.width/4);if(e.settings.pages.useShadow){var r=e.currentCatalogSize.x+Math.round(e.currentCatalogSize.width/4);TweenMax.to(e.outerShadowContainer,t,{left:r})}TweenMax.to(e.catalogContainer,t,{left:i}),delete e.catalogContainer.left}var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=(e.nextPageContainers.left,e.nextPageContainers.right,e.previousPageContainers.left,e.previousPageContainers.right),l=function(){e.currentPage-1===1&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.width=e.currentCatalogSize.width+"px",e.outerShadowContainer.style.left=e.currentCatalogSize.x+"px"),a.showDynamicContentForContainer(e,n),a.showDynamicContentForContainer(e,s),MainFrame.Event.unbind(o.container,MainFrame.Event.transitionEnd,l),e.setCatalogState("idle"),e.turningPage=!1,a.endAndClearAction()};MainFrame.Event.bind(o.container,MainFrame.Event.transitionEnd,l),o.container.style.webkitTransition="-webkit-transform "+t+"s",o.container.style.transition="transform "+t+"s",o.container.style.webkitTransform="rotateY("+o.rotationY+"deg)",o.container.style.transform="rotateY("+o.rotationY+"deg)",n.container.style.webkitTransition="-webkit-transform "+t+"s",n.container.style.transition="transform "+t+"s",n.container.style.webkitTransform="rotateY("+n.rotationY+"deg)",n.container.style.transform="rotateY("+n.rotationY+"deg)"},proto.flipRepositionBackward_updatePage=function(e,t){var a=this,i=e.currentPageContainers.left,r=e.currentPageContainers.right,n=e.nextPageContainers.left,s=e.nextPageContainers.right,o=e.previousPageContainers.left,l=e.previousPageContainers.right;if(a.clearDynamicContentForContainer(e,i),a.clearDynamicContentForContainer(e,r),i.container.style.webkitTransition="-webkit-transform "+t+"s",i.container.style.transition="transform "+t+"s",i.container.style.webkitTransform="rotateY("+i.rotationY+"deg)",i.container.style.transform="rotateY("+i.rotationY+"deg)",e.currentPage===e.settings.pages.totalPages&&e.settings.pages.centerLast&&(TweenMax.to(e.catalogContainer,t,{left:e.currentCatalogSize.x}),delete e.catalogContainer.left),e.settings.static){var c=e.settings.pages.totalPages;i.container.style.zIndex=c+5}else i.container.style.zIndex="10";e.decrementCurrentPage(),a.updateContainersDouble(e,n,s,o,l,i,r);var d=function(){a.afterPreviousDoubleFlip(e,i,r,n,s,o,l),a.showDynamicContentForContainer(e,i),a.showDynamicContentForContainer(e,r),MainFrame.Event.unbind(l.container,MainFrame.Event.transitionEnd,d),e.setCatalogState("idle"),e.turningPage=!1,a.endAndClearAction()};if(MainFrame.Event.bind(l.container,MainFrame.Event.transitionEnd,d),l.rotationY+=Math.random()/1e4,l.container.style.webkitTransition="-webkit-transform "+t+"s",l.container.style.transition="transform "+t+"s",l.container.style.webkitTransform="rotateY("+l.rotationY+"deg)",l.container.style.transform="rotateY("+l.rotationY+"deg)",e.settings.static){var c=e.settings.pages.totalPages;l.container.style.zIndex=c+3}else l.container.style.zIndex="9"};var proto=MainFrame.Action.RepositionAfterDragCatalog.prototype;proto.horizontalReposition=function(e,t){var a=-100*e.currentSlideIndex;e.sliderContainer.translatedX=a+"%",e.sliderContainer.translatedY=0;var i=this;MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,function(){i.endAndClearAction()}),MainFrame.Util.setTransformDuration(e.sliderContainer,t,"s"),MainFrame.Util.setPosition(e.sliderContainer,e.sliderContainer.translatedX,e.sliderContainer.translatedY)},proto.verticalReposition=function(e,t){var a=-100*e.currentSlideIndex;e.sliderContainer.translatedX=0,e.sliderContainer.translatedY=a+"%";var i=this;MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,function(){i.endAndClearAction()}),MainFrame.Util.setTransformDuration(e.sliderContainer,t,"s"),MainFrame.Util.setPosition(e.sliderContainer,e.sliderContainer.translatedX,e.sliderContainer.translatedY)},MainFrame.Action.SetCatalogState=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("state");e&&e.setCatalogState(t),this.endAndClearAction()}}),MainFrame.Action.SetCatalogType=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("type");e.changeCatalogType(t),this.endAndClearAction()}}),MainFrame.Action.SetPageNumbering=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("pageSource")),t=MainFrame.Manager.Scoping.getById(this.getParam("numberingSource")),a=this.getParam("display")||"double",i=(MainFrame.Util.setDefault(this.getParam("separator"),"-"),this.getTarget());if(e&&t&&i){var r=e.currentPage,n=t.getHashPageString(r);if("single"===a){var s=t.pageReferences[r];i.setText(s.number)}else i.setText(n)}this.endAndClearAction()}}),MainFrame.Action.SetTextPage=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("source"));if(e){var t,a,i,r=this.getParam("displayValue"),n=(parseInt(this.getParam("page"),10),parseInt(this.getParam("graphic"),10)||1);switch(r){case"previousPage":console.log("Action.SetTextPage with displayValue = previousPage is not implemented");break;case"nextPage":console.log("Action.SetTextPage with displayValue = nextPage is not implemented");break;case"page":console.log("Action.SetTextPage with displayValue = page is not implemented");break;case"totalPages":a=e.pageOffset?e.totalPages-e.pageOffset+"":e.totalPages+"";break;case"currentPage":default:t=e.currentPage+(n-1),a=e.pageNumbers[t||1]}i=a;var s=this.getParam("textTemplateId");if(s&&-1===s.indexOf("#")){var o=MainFrame.Manager.Text.getById(s);o&&-1!==o.indexOf("##page")&&(o=o.replace("##page",a)),i=o}var l=this.getTarget();l.setText(i)}else MainFrame.Util.showError("SetTextPage source module is invalid. No object found with the id "+this.getParam("source"));this.endAndClearAction()}}),MainFrame.Action.SetTogglePageStateIcon=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("types").split("|"),a=this.getParam("imageSources").split("|"),i=this.getParam("pagingTypeSourceId"),r=MainFrame.Manager.Scoping.getById(i);if(t.length===a.length){for(var n=0,s=t.length;s>n;n++)if(r.pagingType==t[n]){var o=e.skins[0],l=o.containerElement,c=MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+a[n];l.style.backgroundImage="url('"+c+"')"}}else MainFrame.Util.showError("setTogglePageStateIcon error. The number of image sources must match the number of types");this.endAndClearAction()}}),MainFrame.Action.StartAutoplay=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=parseInt(this.getParam("duration"),10),a="true"===this.getParam("reverse")?!0:!1,i="true"===this.getParam("loop")?!0:!1;MainFrame.EventHandler.dispatch("doAutoplay"),e.isAutoplaying=!0;var r="doAutoplay";e.autoplayInterval=setInterval(function(){e.getNextPage()>e.totalPages?i?a?r="reverseAutoplay":MainFrame.EventHandler.dispatch("resetAutoplay"):(clearInterval(e.autoplayInterval),e.isAutoplaying=!1):e.currentPage<2&&"reverseAutoplay"===r&&(r="doAutoplay"),MainFrame.EventHandler.dispatch(r)},t),this.endAndClearAction()}}),MainFrame.Action.StopEasingCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e.easing&&e.easing.stop(),this.endAndClearAction()}}),MainFrame.Action.ToggleCatalogType=MainFrame.Abstract.Action.extend({startAction:function(){for(var e,t=this.getTarget(),a=this.getParam("types"),i=a.split("|"),r=0,n=i.length,s=!1;n>r;r++)t.pagingType==i[r]&&(s=!0,e=r==n-1?i[0]:i[r+1]);s||(e=i[0]),t.changeCatalogType(e),this.endAndClearAction()}}),MainFrame.Action.GoToPageCatalog=MainFrame.Action.BasePageCatalog.extend({startAction:function(){var e=this.getTarget();if(e){if("idle"!==e.state)return;if("flip"===e.settings.navigationType&&e.turningPage===!0)return;var t=this.getParam("pageNumber");if(t)var a=e.getPageForPageNumber(t);else{var a=this.getParam("page");a=a?"initiatorsGoToPage"===a?this.initiatorObject.goToPage:"lastPage"===a?e.settings.pages.totalPages:parseInt(a,10):1}if(e.isValidPageValue(a)){if(this.isPageRestricted(e,a))return void this.endAndClearAction();if(e.isDoublePage){var i=a%2!==0,r=1!==a,n="single"===e.settings.pages.coverType;n?i&&r&&(a-=1):e.isRightPage(a)&&(a-=1)}var s=e.currentPage;if(s===a)return void this.endAndClearAction();var o=this.getParam("duration");o&&parseFloat(o,10);var l=this,c=function(){s>a?l.goBackwards(e,a):a>s&&l.goForward(e,a)};"flip"===e.settings.navigationType&&e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity="0"),e.shouldCenterPage(s)?e.uncenterPage({onComplete:c}):c()}else this.endAndClearAction()}else this.endAndClearAction()},goForward:function(e,t){if("flip"===e.settings.navigationType&&this.goForwardFlip(e,t),"horizontalSlide"===e.settings.navigationType||"verticalSlide"===e.settings.navigationType){var a="horizontalSlide"===e.settings.navigationType?"horizontal":"vertical";this.goForwardSlide(e,t,a)}},goBackwards:function(e,t){if("flip"===e.settings.navigationType&&this.goBackwardsFlip(e,t),"horizontalSlide"===e.settings.navigationType||"verticalSlide"===e.settings.navigationType){var a="horizontalSlide"===e.settings.navigationType?"horizontal":"vertical";this.goBackwardsSlide(e,t,a)}}});var proto=MainFrame.Action.GoToPageCatalog.prototype;proto.goForwardFlip=function(e,t){e.settings.static?e.isSinglePage?this.goForwardSingleFlip_static(e,t):this.goForwardDoubleFlip_static(e,t):e.isSinglePage?this.goForwardSingleFlip_dynamic(e,t):this.goForwardDoubleFlip_dynamic(e,t)},proto.goForwardSingleFlip_static=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.page,s=e.nextPageContainers.page,o=e.previousPageContainers.page;e.clearHighlightedTextInContainer(n),e.clearNotesInContainer(n),e.hideMapsForContainer(n);do{e.turningPage=!0;var n=e.currentPageContainers.page,s=e.nextPageContainers.page,o=e.previousPageContainers.page,l=function(){a.updateZIndexSingle(e,n,s,o),n.container.style.opacity="",n.container.style.webkitTransform="",n.container.style.transform="",n.container.style.webkitTransition="none",n.container.style.transition="none",e.currentPage===t&&e.updatePageContent(),a.updateClassesSingle(e,n,s,o),a.updatePageTypeSingle(e,n,s,o),e.turningPage=!1};e.incrementCurrentPage(),a.updateContainersSingle(e,n,s,o),n.container.style.webkitTransition="transform "+r+"s, opacity "+r+"s",n.container.style.transition="transform "+r+"s, opacity "+r+"s",n.container.style.webkitTransform="rotateY(-100deg)",n.container.style.transform="rotateY(-100deg)",n.container.style.opacity="0",l()}while(e.currentPage<t);a.endAndClearAction()},proto.goForwardDoubleFlip_static=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=e.nextPageContainers.right,c=e.previousPageContainers.left,d=e.previousPageContainers.right;e.clearHighlightedTextInContainer(n),e.clearHighlightedTextInContainer(s),e.clearNotesInContainer(n),e.clearNotesInContainer(s),e.hideMapsForContainer(n),e.hideMapsForContainer(s);var g=e.settings.pages.totalPages;s.container.style.zIndex=g+1;do{e.turningPage=!0;var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=e.nextPageContainers.right,c=e.previousPageContainers.left,d=e.previousPageContainers.right;s.container.style.webkitTransition="-webkit-transform "+r+"s",s.container.style.transition="transform "+r+"s",s.container.style.webkitTransform="rotateY(-180deg)",s.container.style.transform="rotateY(-180deg)",e.incrementCurrentPage(),a.updateContainersDouble(e,n,s,o,l,c,d);var h=function(){a.updateClassesDouble(e,n,s,o,l,c,d),a.updateZIndexDouble(e,n,s,o,l,c,d),a.updatePageTypeDouble(e,n,s,o,l,c,d),e.currentPage===t&&(s.container.style.webkitTransform="",s.container.style.transform="",s.container.style.webkitTransition="none",s.container.style.transition="none",o.container.style.webkitTransform="",o.container.style.transform="",o.container.style.webkitTransition="none",o.container.style.transition="none",e.updatePageContent()),e.turningPage=!1};o.container.style.webkitTransition="-webkit-transform "+r+"s",o.container.style.transition="transform "+r+"s",o.container.style.webkitTransform="rotateY(0deg)",o.container.style.transform="rotateY(0deg)";var g=e.settings.pages.totalPages;o.container.style.zIndex=g,h()}while(e.currentPage<t);a.endAndClearAction()},proto.goForwardSingleFlip_dynamic=function(e,t){var a=this;e.turningPage=!0;var i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.page,s=e.nextPageContainers.page,o=e.previousPageContainers.page;e.clearHighlightedTextInContainer(n),e.clearNotesInContainer(n),e.hideMapsForContainer(n),e.hidePricesForContainer(s);var l=function(){a.updateContainersSingle(e,n,s,o);var t=function(){clearTimeout(l),a.updateZIndexSingle(e,n,s,o),n.container.style.opacity="",n.container.style.webkitTransform="",n.container.style.transform="",n.container.style.webkitTransition="none",n.container.style.transition="none",a.updateClassesSingle(e,n,s,o),a.updatePageTypeSingle(e,n,s,o),e.updatePageContent();var i=e.currentPage+1;e.updatePageImage(o,i);var r=e.currentPage-1;e.updatePageImage(n,r),MainFrame.Event.unbind(n.container,MainFrame.Event.transitionEnd,t),e.turningPage=!1,e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity=""),a.endAndClearAction()};MainFrame.Event.bind(n.container,MainFrame.Event.transitionEnd,t),n.container.style.webkitTransition="transform "+r+"s, opacity "+r+"s",n.container.style.transition="transform "+r+"s, opacity "+r+"s",n.container.style.webkitTransform="rotateY(-100deg)",n.container.style.transform="rotateY(-100deg)",n.container.style.opacity="0";var i=MainFrame.Util.secondsToMiliseconds(r)+100,l=setTimeout(function(){MainFrame.Event.unbind(n.container,MainFrame.Event.transitionEnd,t),t()},i)};e.setCurrentPage(t);var c=e.currentPage;e.updatePageImage(s,c,{}),l()},proto.goForwardDoubleFlip_dynamic=function(e,t){var a=this;e.turningPage=!0;var i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=e.nextPageContainers.right,c=e.previousPageContainers.left,d=e.previousPageContainers.right;e.clearHighlightedTextInContainer(n),e.clearHighlightedTextInContainer(s),e.clearNotesInContainer(n),e.clearNotesInContainer(s),e.hideMapsForContainer(n),e.hideMapsForContainer(s),e.hidePricesForContainer(o),e.hidePricesForContainer(l),e.setCurrentPage(t),n.container.style.zIndex="6";var g=e.currentPage,h=e.currentPage+1,u=function(){s.container.style.webkitTransition="transform "+r+"s",s.container.style.transition="transform "+r+"s",s.container.style.webkitTransition="-webkit-transform "+r+"s",s.container.style.transform="rotateY(-180deg)",s.container.style.zIndex="10",a.updateContainersDouble(e,n,s,o,l,c,d);var t=function(){clearTimeout(g),s.container.style.webkitTransform="",s.container.style.transform="",s.container.style.webkitTransition="none",s.container.style.transition="none",o.container.style.webkitTransform="",o.container.style.transform="",o.container.style.webkitTransition="none",o.container.style.transition="none",a.updateClassesDouble(e,n,s,o,l,c,d),a.updateZIndexDouble(e,n,s,o,l,c,d),a.updatePageTypeDouble(e,n,s,o,l,c,d),e.updatePageContent();var i=e.currentPage+2,r=e.currentPage+3;c.image.imageUrl=null,d.image.imageUrl=null,e.updatePageImage(c,i),e.updatePageImage(d,r);var h=e.currentPage-2,u=e.currentPage-1;n.image.imageUrl=null,s.image.imageUrl=null,e.updatePageImage(n,h),e.updatePageImage(s,u),MainFrame.Event.unbind(o.container,MainFrame.Event.transitionEnd,t),e.turningPage=!1,e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity=""),a.endAndClearAction()};MainFrame.Event.bind(o.container,MainFrame.Event.transitionEnd,t),o.container.style.webkitTransition="-webkit-transform "+r+"s",o.container.style.transition="transform "+r+"s",o.container.style.webkitTransform="rotateY(0deg)",o.container.style.transform="rotateY(0deg)",o.container.style.zIndex="9";var i=MainFrame.Util.secondsToMiliseconds(r)+100,g=setTimeout(function(){MainFrame.Event.unbind(o.container,MainFrame.Event.transitionEnd,t),t()},i)};o.image.imageUrl=null,l.image.imageUrl=null;var m=function(){e.updatePageImage(l,h,{}),u()};e.updatePageImage(o,g,{}),m()},proto.goBackwardsFlip=function(e,t){e.settings.static?e.isSinglePage?this.goBackwardsSingleFlip_static(e,t):this.goBackwardsDoubleFlip_static(e,t):e.isSinglePage?this.goBackwardsSingleFlip_dynamic(e,t):this.goBackwardsDoubleFlip_dynamic(e,t)},proto.goBackwardsSingleFlip_static=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.page,s=e.nextPageContainers.page,o=e.previousPageContainers.page;e.clearHighlightedTextInContainer(n),e.clearNotesInContainer(n),e.hideMapsForContainer(n);do{var n=e.currentPageContainers.page,s=e.nextPageContainers.page,o=e.previousPageContainers.page;e.turningPage=!0;var l=function(){a.updateZIndexSingle(e,s,o,n),a.updateClassesSingle(e,s,o,n),a.updatePageTypeSingle(e,s,o,n),e.currentPage===t&&e.updatePageContent(),e.turningPage=!1};e.decrementCurrentPage(),a.updateContainersSingle(e,s,o,n);var c=e.settings.pages.totalPages;o.container.style.zIndex=c+2,o.container.style.webkitTransition="-webkit-transform "+r+"s",o.container.style.transition="transform "+r+"s",o.container.style.webkitTransform="rotateY(0deg)",o.container.style.transform="rotateY(0deg)",l()}while(e.currentPage>t);a.endAndClearAction()},proto.goBackwardsDoubleFlip_static=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=e.nextPageContainers.right,c=e.previousPageContainers.left,d=e.previousPageContainers.right;e.clearHighlightedTextInContainer(n),e.clearHighlightedTextInContainer(s),e.clearNotesInContainer(n),e.clearNotesInContainer(s),e.hideMapsForContainer(n),e.hideMapsForContainer(s);var g=e.settings.pages.totalPages;n.container.style.zIndex=g+5;do{e.turningPage=!0;var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=e.nextPageContainers.right,c=e.previousPageContainers.left,d=e.previousPageContainers.right;n.container.style.webkitTransition="-webkit-transform "+r+"s",n.container.style.transition="transform "+r+"s",n.container.style.webkitTransform="rotateY(180deg)",n.container.style.transform="rotateY(180deg)",e.decrementCurrentPage(),a.updateContainersDouble(e,o,l,c,d,n,s);var h=function(){e.currentPage===t&&(d.container.style.webkitTransform="",d.container.style.transform="",d.container.style.webkitTransition="none",d.container.style.transition="none",n.container.style.webkitTransform="",n.container.style.transform="",n.container.style.webkitTransition="none",n.container.style.transition="none",e.updatePageContent()),a.updateClassesDouble(e,o,l,c,d,n,s),a.updateZIndexDouble(e,o,l,c,d,n,s),a.updatePageTypeDouble(e,o,l,c,d,n,s),e.turningPage=!1};d.container.style.webkitTransition="-webkit-transform "+r+"s",d.container.style.transition="transform "+r+"s",d.container.style.webkitTransform="rotateY(0deg)",d.container.style.transform="rotateY(0deg)";var g=e.settings.pages.totalPages;d.container.style.zIndex=g+3,h()}while(e.currentPage>t);a.endAndClearAction()},proto.goBackwardsSingleFlip_dynamic=function(e,t){var a=this;e.turningPage=!0;var i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.page,s=e.nextPageContainers.page,o=e.previousPageContainers.page;e.clearHighlightedTextInContainer(n),e.clearNotesInContainer(n),e.hideMapsForContainer(n),e.hidePricesForContainer(o);var l=function(){a.updateContainersSingle(e,s,o,n);var t=function(){clearTimeout(l),a.updateZIndexSingle(e,s,o,n),o.container.style.webkitTransform="",o.container.style.transform="",o.container.style.webkitTransition="none",o.container.style.transition="none",a.updateClassesSingle(e,s,o,n),a.updatePageTypeSingle(e,s,o,n),e.updatePageContent();var i=e.currentPage+1;e.updatePageImage(n,i);var r=e.currentPage-1;e.updatePageImage(s,r),MainFrame.Event.unbind(o.container,MainFrame.Event.transitionEnd,t),e.turningPage=!1,e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity=""),a.endAndClearAction()};MainFrame.Event.bind(o.container,MainFrame.Event.transitionEnd,t),o.container.style.zIndex="3",o.container.style.webkitTransition="-webkit-transform "+r+"s",o.container.style.transition="transform "+r+"s",o.container.style.webkitTransform="rotateY(0deg)",o.container.style.transform="rotateY(0deg)";var i=MainFrame.Util.secondsToMiliseconds(r)+100,l=setTimeout(function(){MainFrame.Event.unbind(o.container,MainFrame.Event.transitionEnd,t),t()},i)};e.setCurrentPage(t);var c=e.currentPage;e.updatePageImage(o,c,{}),l()},proto.goBackwardsDoubleFlip_dynamic=function(e,t){var a=this;e.turningPage=!0;var i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.currentPageContainers.left,s=e.currentPageContainers.right,o=e.nextPageContainers.left,l=e.nextPageContainers.right,c=e.previousPageContainers.left,d=e.previousPageContainers.right;e.clearHighlightedTextInContainer(n),e.clearHighlightedTextInContainer(s),e.clearNotesInContainer(n),e.clearNotesInContainer(s),e.hideMapsForContainer(n),e.hideMapsForContainer(s),e.hidePricesForContainer(c),e.hidePricesForContainer(d),e.setCurrentPage(t),n.container.style.zIndex="6";var g="single"===e.settings.pages.coverType;g&&1===t&&(t=0);var h=t,u=t+1,m=function(){n.container.style.webkitTransition="-webkit-transform "+r+"s",n.container.style.transition="transform "+r+"s",n.container.style.webkitTransform="rotateY(180deg)",n.container.style.transform="rotateY(180deg)",n.container.style.zIndex="10",a.updateContainersDouble(e,o,l,c,d,n,s);var i=function(){clearTimeout(h),n.container.style.webkitTransform="",n.container.style.transform="",n.container.style.webkitTransition="none",n.container.style.transition="none",d.container.style.webkitTransform="",d.container.style.transform="",d.container.style.webkitTransition="none",d.container.style.transition="none",a.updateClassesDouble(e,o,l,c,d,n,s),a.updateZIndexDouble(e,o,l,c,d,n,s),a.updatePageTypeDouble(e,o,l,c,d,n,s),e.updatePageContent();var r=t+2,g=t+3;e.updatePageImage(n,r),e.updatePageImage(s,g);var u=t-2,m=t-1;e.updatePageImage(o,u),e.updatePageImage(l,m),MainFrame.Event.unbind(d.container,MainFrame.Event.transitionEnd,i),e.turningPage=!1,e.settings.pages.useShadow&&(e.outerShadowContainer.style.opacity=""),a.endAndClearAction()};MainFrame.Event.bind(d.container,MainFrame.Event.transitionEnd,i),d.container.style.webkitTransition="-webkit-transform "+r+"s",d.container.style.transition="transform "+r+"s",d.container.style.webkitTransform="rotateY(0deg)",d.container.style.transform="rotateY(0deg)",d.container.style.zIndex="9";var g=MainFrame.Util.secondsToMiliseconds(r)+100,h=setTimeout(function(){MainFrame.Event.unbind(d.container,MainFrame.Event.transitionEnd,i),i()},g)},p=function(){e.updatePageImage(d,u,{}),m()};e.updatePageImage(c,h,{}),p()};var proto=MainFrame.Action.GoToPageCatalog.prototype;proto.goForwardSlide=function(e,t,a){e.previousPageContainers.main.style.opacity="",e.nextPageContainers.main.style.opacity="",e.isSinglePage?this.goForwardSingleSlide(e,t,a):this.goForwardDoubleSlide(e,t,a)},proto.goForwardSingleSlide=function(e,t,a){var i=this,r=this.getParam("duration");if(r)var n=parseFloat(r,10);else var n=.5;var s=e.previousPageContainers,o=e.currentPageContainers,l=e.nextPageContainers;this.clearPageBackgrounds(e),e.clearHighlightedTextInContainer(o.page),e.clearNotesInContainer(o.page),e.hideMapsForContainer(o.page),e.setCurrentPage(t);var c=e.currentPage;currentIndex=e.currentSlideIndex,previousIndex=currentIndex-1,nextIndex=currentIndex+1;var d=function(){var t=100*currentIndex;l.main.setAttribute("data-index",currentIndex),"horizontal"===a?l.main.style.left=t+"%":l.main.style.top=t+"%";var r=function(){clearTimeout(d),i.updateIndexAfterSlide(e,a,previousIndex,currentIndex,nextIndex),i.updateContentAfterSlide(e),i.clearPageBackgrounds(e),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.slideCatalog(e,a,currentIndex,n);var c=MainFrame.Util.secondsToMiliseconds(n)+100,d=setTimeout(function(){MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),r()},c);e.previousPageContainers=o,e.currentPageContainers=l,e.nextPageContainers=s},g=c;e.updatePageImage(l.page,g,{}),d()},proto.goForwardDoubleSlide=function(e,t,a){var i=this,r=this.getParam("duration");if(r)var n=parseFloat(r,10);else var n=.5;var s=e.previousPageContainers,o=e.currentPageContainers,l=e.nextPageContainers;this.clearPageBackgrounds(e),e.clearHighlightedTextInContainer(o.left),e.clearHighlightedTextInContainer(o.right),e.clearNotesInContainer(o.left),e.clearNotesInContainer(o.right),e.hideMapsForContainer(o.left),e.hideMapsForContainer(o.right),e.setCurrentPage(t),e.previousPageContainers=o,e.currentPageContainers=l,e.nextPageContainers=s;var c=e.currentPage;currentIndex=e.currentSlideIndex,previousIndex=currentIndex-1,nextIndex=currentIndex+1,e.settings.pages.useShadow&&(this.adjustPageShadow(e,e.currentPageContainers,c),this.adjustPageShadow(e,e.nextPageContainers,c+2),this.adjustPageShadow(e,e.previousPageContainers,c-2));var d=function(){var t=100*currentIndex;l.main.setAttribute("data-index",currentIndex),"horizontal"===a?l.main.style.left=t+"%":l.main.style.top=t+"%";var r=function(){clearTimeout(o),i.updateIndexAfterSlide(e,a,previousIndex,currentIndex,nextIndex),i.updateContentAfterSlide(e),i.clearPageBackgrounds(e),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.slideCatalog(e,a,currentIndex,n);var s=MainFrame.Util.secondsToMiliseconds(n)+100,o=setTimeout(function(){MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),r()},s)},g=c,h=c+1,u=function(){e.updatePageImage(l.right,h,{}),d()};e.updatePageImage(l.left,g,{}),u()},proto.goBackwardsSlide=function(e,t,a){e.isSinglePage?this.goBackwardsSingleSlide(e,t,a):this.goBackwardsDoubleSlide(e,t,a)},proto.goBackwardsSingleSlide=function(e,t,a){var i=this,r=this.getParam("duration");if(r)var n=parseFloat(r,10);else var n=.5;var s=e.previousPageContainers,o=e.currentPageContainers,l=e.nextPageContainers;e.clearHighlightedTextInContainer(o.page),e.clearNotesInContainer(o.page),e.hideMapsForContainer(o.page),e.setCurrentPage(t);var c=e.currentPage;currentIndex=e.currentSlideIndex,previousIndex=currentIndex-1,nextIndex=currentIndex+1;var d="single"===e.settings.pages.coverType;d&&1===c&&(c=0);var g=function(){var t=100*currentIndex;s.main.setAttribute("data-index",currentIndex),"horizontal"===a?s.main.style.left=t+"%":s.main.style.top=t+"%";var r=function(){clearTimeout(d),i.updateIndexAfterSlide(e,a,previousIndex,currentIndex,nextIndex),i.updateContentAfterSlide(e),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.slideCatalog(e,a,currentIndex,n);var c=MainFrame.Util.secondsToMiliseconds(n)+100,d=setTimeout(function(){MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),r()},c);e.previousPageContainers=o,e.currentPageContainers=s,e.nextPageContainers=l},h=c;e.updatePageImage(s.page,h,{}),g()},proto.goBackwardsDoubleSlide=function(e,t,a){var i=this,r=this.getParam("duration");if(r)var n=parseFloat(r,10);else var n=.5;var s=e.previousPageContainers,o=e.currentPageContainers,l=e.nextPageContainers;e.clearHighlightedTextInContainer(o.left),e.clearHighlightedTextInContainer(o.right),e.clearNotesInContainer(o.left),e.clearNotesInContainer(o.right),e.hideMapsForContainer(o.left),e.hideMapsForContainer(o.right),this.clearPageBackgrounds(e),e.setCurrentPage(t),e.previousPageContainers=o,e.currentPageContainers=s,e.nextPageContainers=l;
var c=e.currentPage;currentIndex=e.currentSlideIndex,previousIndex=currentIndex-1,nextIndex=currentIndex+1,e.settings.pages.useShadow&&(this.adjustPageShadow(e,e.currentPageContainers,c),this.adjustPageShadow(e,e.nextPageContainers,c+2),this.adjustPageShadow(e,e.previousPageContainers,c-2));var d="single"===e.settings.pages.coverType;d&&1===c&&(c=0);var g=function(){var t=100*currentIndex;s.main.setAttribute("data-index",currentIndex),"horizontal"===a?s.main.style.left=t+"%":s.main.style.top=t+"%";var r=function(){clearTimeout(l),i.updateIndexAfterSlide(e,a,previousIndex,currentIndex,nextIndex),i.updateContentAfterSlide(e),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,r),i.slideCatalog(e,a,currentIndex,n);var o=MainFrame.Util.secondsToMiliseconds(n)+100,l=setTimeout(function(){MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,r),r()},o)},h=c,u=c+1,m=function(){e.updatePageImage(s.right,u,{}),g()};e.updatePageImage(s.left,h,{}),m()},MainFrame.Action.NextPageCatalog=MainFrame.Action.BasePageCatalog.extend({startAction:function(){var e=this.getTarget();if(e){if("idle"!==e.state)return;var t=e.getNextPageValue();if(e.isValidPageValue(t)){if(this.makeAllContainersVisible(e),this.isPageRestricted(e,t))return void this.endAndClearAction();var a=this,i=function(){if("flip"===e.settings.navigationType){if(e.turningPage===!0)return;a.nextPageFlip(e)}else if("horizontalSlide"===e.settings.navigationType||"verticalSlide"===e.settings.navigationType){var t="horizontalSlide"===e.settings.navigationType?"horizontal":"vertical";a.nextPageSlide(e,t)}},r=e.currentPage;e.shouldCenterPage(r)?e.uncenterPage({onComplete:i}):i()}}else this.endAndClearAction()}});var proto=MainFrame.Action.NextPageCatalog.prototype;proto.nextPageFlip=function(e){e.isSinglePage?this.nextPageSingleFlip(e):this.nextPageDoubleFlip(e)},proto.nextPageSingleFlip=function(e){var t=this;e.turningPage=!0;var a=this.getParam("duration");if(a)var i=parseFloat(a,10);else var i=.5;var r=e.currentPageContainers.page,n=e.nextPageContainers.page,s=e.previousPageContainers.page;e.clearHighlightedTextInContainer(r),e.clearNotesInContainer(r),e.hideMapsForContainer(r);var o=function(){if(t.updateZIndexSingle(e,r,n,s),r.container.style.opacity="",r.container.style.webkitTransform="",r.container.style.transform="",r.container.style.webkitTransition="none",r.container.style.transition="none",t.updateClassesSingle(e,r,n,s),t.updatePageTypeSingle(e,r,n,s),e.updatePageContent(),!e.settings.static){var a=e.currentPage+1;e.updatePageImage(s,a)}MainFrame.Event.unbind(r.container,MainFrame.Event.transitionEnd,o),e.turningPage=!1,t.endAndClearAction()};MainFrame.Event.bind(r.container,MainFrame.Event.transitionEnd,o),e.incrementCurrentPage(),t.updateContainersSingle(e,r,n,s),r.container.style.webkitTransition="transform "+i+"s, opacity "+i+"s",r.container.style.transition="transform "+i+"s, opacity "+i+"s",r.container.style.webkitTransform="rotateY(-100deg)",r.container.style.transform="rotateY(-100deg)",r.container.style.opacity="0"},proto.nextPageDoubleFlip=function(e){var t=this;e.turningPage=!0;var a=this.getParam("duration");if(a)var i=parseFloat(a,10);else var i=.5;e.increaseNavigationSpeed&&(i=.1);var r=e.currentPageContainers.left,n=e.currentPageContainers.right,s=e.nextPageContainers.left,o=e.nextPageContainers.right,l=e.previousPageContainers.left,c=e.previousPageContainers.right;if(e.clearHighlightedTextInContainer(r),e.clearHighlightedTextInContainer(n),e.clearNotesInContainer(r),e.clearNotesInContainer(n),e.hideMapsForContainer(r),e.hideMapsForContainer(n),n.container.style.webkitTransition="-webkit-transform "+i+"s",n.container.style.transition="transform "+i+"s",n.container.style.webkitTransform="rotateY(-180deg)",n.container.style.transform="rotateY(-180deg)",r.container.style.zIndex="6",e.settings.static){var d=e.settings.pages.totalPages;n.container.style.zIndex=d+1,r.container.style.zIndex=""}else n.container.style.zIndex="10";e.incrementCurrentPage(),t.updateContainersDouble(e,r,n,s,o,l,c);var g=function(){if(t.afterNextDoubleFlip(e,r,n,s,o,l,c),MainFrame.Event.unbind(s.container,MainFrame.Event.transitionEnd,g),e.turningPage=!1,t.endAndClearAction(),e.navigationEventsQueue.length){var a=e.navigationEventsQueue.splice(0,1)[0];e.increaseNavigationSpeed=!0,a()}else e.increaseNavigationSpeed=!1};if(MainFrame.Event.bind(s.container,MainFrame.Event.transitionEnd,g),s.container.style.webkitTransition="-webkit-transform "+i+"s",s.container.style.transition="transform "+i+"s",s.container.style.webkitTransform="rotateY(0deg)",s.container.style.transform="rotateY(0deg)",e.settings.static){var d=e.settings.pages.totalPages;s.container.style.zIndex=d}else s.container.style.zIndex="9"};var proto=MainFrame.Action.NextPageCatalog.prototype;proto.nextPageSlide=function(e,t){e.previousPageContainers.main.style.opacity="",e.nextPageContainers.main.style.opacity="",e.isSinglePage?this.nextPageSingleSlide(e,t):this.nextPageDoubleSlide(e,t)},proto.nextPageSingleSlide=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.previousPageContainers,s=e.currentPageContainers,o=e.nextPageContainers;e.clearHighlightedTextInContainer(s.page),e.clearNotesInContainer(s.page),e.hideMapsForContainer(s.page),e.incrementCurrentPage();var l=e.currentPage,c=e.currentSlideIndex,d=c-1,g=c+1;e.previousPageContainers=s,e.currentPageContainers=o,e.nextPageContainers=n,e.nextPageContainers.page.image.src="",o.page.container.style.backgroundColor="";var h=function(){a.updateIndexAfterSlide(e,t,d,c,g),e.nextPageTimer&&(clearTimeout(e.nextPageTimer),e.nextPageTimer=null),e.nextPageTimer=setTimeout(function(){a.updateContentAfterSlide(e),a.clearPageBackgrounds(e)},200),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,h),a.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,h);var u=100*g;e.nextPageContainers.main.setAttribute("data-index",g),e.nextPageContainers.main.style.left="horizontal"===t?u+"%":u+"%";var m=e.pageReferences[l+1];if(m&&e.settings.pages.progressiveImageLoading!==!1){e.nextPageContainers.page.thumbRequest&&(e.nextPageContainers.page.thumbRequest.abort(),e.nextPageContainers.page.thumbRequest=null);var p=MainFrame.Util.getAppURL()+m.small;e.nextPageContainers.page.thumbRequest=MainFrame.Util.request({url:p,onSuccess:function(){e.nextPageContainers.page.image.src=p,e.nextPageContainers.page.image.imageUrl=p}})}this.slideCatalog(e,t,c,r)},proto.nextPageDoubleSlide=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=this.getParam("defaultBackgroundColor");if(n)var s=n;else var s="#ffffff";var o=e.previousPageContainers,l=e.currentPageContainers,c=e.nextPageContainers;e.clearHighlightedTextInContainer(l.left),e.clearHighlightedTextInContainer(l.right),e.clearNotesInContainer(l.left),e.clearNotesInContainer(l.right),e.hideMapsForContainer(l.left),e.hideMapsForContainer(l.right),e.incrementCurrentPage();var d=e.currentPage,g=e.currentSlideIndex,h=g-1,u=g+1;e.previousPageContainers=l,e.currentPageContainers=c,e.nextPageContainers=o,e.nextPageContainers.left.image.src="",e.nextPageContainers.right.image.src="",c.left.container.style.backgroundColor=s,c.right.container.style.backgroundColor=e.isValidPageValue(d+1)?s:"",e.settings.pages.useShadow&&this.adjustPageShadow(e,e.nextPageContainers,d+2);var m=function(){a.updateIndexAfterSlide(e,t,h,g,u),e.nextPageTimer&&(clearTimeout(e.nextPageTimer),e.nextPageTimer=null),e.nextPageTimer=setTimeout(function(){a.updateContentAfterSlide(e),a.clearPageBackgrounds(e)},200),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,m),a.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,m);var p=100*u;e.nextPageContainers.main.setAttribute("data-index",u),"horizontal"===t?e.nextPageContainers.main.style.left=p+"%":e.nextPageContainers.main.style.top=p+"%";var f=e.pageReferences[d+2],v=e.pageReferences[d+3];if(f&&e.settings.pages.progressiveImageLoading!==!1){e.nextPageContainers.left.thumbRequest&&(e.nextPageContainers.left.thumbRequest.abort(),e.nextPageContainers.left.thumbRequest=null);var M=MainFrame.Util.getAppURL()+f.small;e.nextPageContainers.left.thumbRequest=MainFrame.Util.request({url:M,onSuccess:function(){e.nextPageContainers.left.image.src=M,e.nextPageContainers.left.image.imageUrl=M}})}if(v&&e.settings.pages.progressiveImageLoading!==!1){e.nextPageContainers.right.thumbRequest&&(e.nextPageContainers.right.thumbRequest.abort(),e.nextPageContainers.right.thumbRequest=null);var b=MainFrame.Util.getAppURL()+v.small;e.nextPageContainers.right.thumbRequest=MainFrame.Util.request({url:b,onSuccess:function(){e.nextPageContainers.right.image.src=b,e.nextPageContainers.right.image.imageUrl=b}})}this.slideCatalog(e,t,g,r)},MainFrame.Action.PreviousPageCatalog=MainFrame.Action.BasePageCatalog.extend({startAction:function(){var e=this.getTarget();if(e){if("idle"!==e.state)return;var t=e.getPreviousPageValue();if(e.isValidPageValue(t)){if(this.makeAllContainersVisible(e),this.isPageRestricted(e,t))return void this.endAndClearAction();var a=this,i=function(){if("flip"===e.settings.navigationType){if(e.turningPage===!0)return;return void a.previousPageFlip(e)}if("horizontalSlide"===e.settings.navigationType||"verticalSlide"===e.settings.navigationType){var t="horizontalSlide"===e.settings.navigationType?"horizontal":"vertical";a.previousPageSlide(e,t)}},r=e.currentPage;e.shouldCenterPage(r)?e.uncenterPage({onComplete:i}):i()}}else this.endAndClearAction()}});var proto=MainFrame.Action.PreviousPageCatalog.prototype;proto.previousPageFlip=function(e){e.isSinglePage?this.previousPageSingleFlip(e):this.previousPageDoubleFlip(e)},proto.previousPageSingleFlip=function(e){var t=this;e.turningPage=!0;var a=this.getParam("duration");if(a)var i=parseFloat(a,10);else var i=.5;var r=e.currentPageContainers.page,n=e.nextPageContainers.page,s=e.previousPageContainers.page;e.clearHighlightedTextInContainer(r),e.clearNotesInContainer(r),e.hideMapsForContainer(r);var o=function(){if(t.updateZIndexSingle(e,n,s,r),s.container.style.webkitTransform="",s.container.style.transform="",s.container.style.webkitTransition="none",s.container.style.transition="none",t.updateClassesSingle(e,n,s,r),t.updatePageTypeSingle(e,n,s,r),e.updatePageContent(),!e.settings.static){var a=e.currentPage-1;e.updatePageImage(n,a)}MainFrame.Event.unbind(s.container,MainFrame.Event.transitionEnd,o),e.turningPage=!1,t.endAndClearAction()};if(MainFrame.Event.bind(s.container,MainFrame.Event.transitionEnd,o),e.decrementCurrentPage(),t.updateContainersSingle(e,n,s,r),e.settings.static){var l=e.settings.pages.totalPages;s.container.style.zIndex=l+2}else s.container.style.zIndex="3";s.container.style.webkitTransition="-webkit-transform "+i+"s",s.container.style.transition="transform "+i+"s",s.container.style.webkitTransform="rotateY(0deg)",s.container.style.transform="rotateY(0deg)"},proto.previousPageDoubleFlip=function(e){var t=this;e.turningPage=!0;var a=this.getParam("duration");if(a)var i=parseFloat(a,10);else var i=.5;e.increaseNavigationSpeed&&(i=.1);var r=e.currentPageContainers.left,n=e.currentPageContainers.right,s=e.nextPageContainers.left,o=e.nextPageContainers.right,l=e.previousPageContainers.left,c=e.previousPageContainers.right;if(e.clearHighlightedTextInContainer(r),e.clearHighlightedTextInContainer(n),e.clearNotesInContainer(r),e.clearNotesInContainer(n),e.hideMapsForContainer(r),e.hideMapsForContainer(n),r.container.style.webkitTransition="-webkit-transform "+i+"s",r.container.style.transition="transform "+i+"s",r.container.style.webkitTransform="rotateY(180deg)",r.container.style.transform="rotateY(180deg)",r.container.style.zIndex="6",e.settings.static){var d=e.settings.pages.totalPages;r.container.style.zIndex=d+5}else r.container.style.zIndex="10";e.decrementCurrentPage(),t.updateContainersDouble(e,s,o,l,c,r,n);var g=function(){if(t.afterPreviousDoubleFlip(e,r,n,s,o,l,c),MainFrame.Event.unbind(c.container,MainFrame.Event.transitionEnd,g),e.turningPage=!1,t.endAndClearAction(),e.navigationEventsQueue.length){var a=e.navigationEventsQueue.splice(0,1)[0];e.increaseNavigationSpeed=!0,a()}else e.increaseNavigationSpeed=!1};if(MainFrame.Event.bind(c.container,MainFrame.Event.transitionEnd,g),c.container.style.webkitTransition="-webkit-transform "+i+"s",c.container.style.transition="transform "+i+"s",c.container.style.webkitTransform="rotateY(0deg)",c.container.style.transform="rotateY(0deg)",e.settings.static){var d=e.settings.pages.totalPages;c.container.style.zIndex=d+3}else c.container.style.zIndex="9"};var proto=MainFrame.Action.PreviousPageCatalog.prototype;proto.previousPageSlide=function(e,t){e.previousPageContainers.main.style.opacity="",e.nextPageContainers.main.style.opacity="",e.isSinglePage?this.previousPageSingleSlide(e,t):this.previousPageDoubleSlide(e,t)},proto.previousPageSingleSlide=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=e.previousPageContainers,s=e.currentPageContainers,o=e.nextPageContainers;e.clearHighlightedTextInContainer(s.page),e.clearNotesInContainer(s.page),e.hideMapsForContainer(s.page),e.decrementCurrentPage();var l=e.currentPage,c=e.currentSlideIndex,d=c-1,g=c+1;e.previousPageContainers=o,e.currentPageContainers=n,e.nextPageContainers=s,e.previousPageContainers.page.image.src="",n.page.container.style.backgroundColor="";var h=function(){a.updateIndexAfterSlide(e,t,d,c,g),e.previousPageTimer&&(clearTimeout(e.previousPageTimer),e.previousPageTimer=null),e.previousPageTimer=setTimeout(function(){a.updateContentAfterSlide(e),a.clearPageBackgrounds(e)},200),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,h),a.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,h);var u=100*d;e.previousPageContainers.main.setAttribute("data-index",d),"horizontal"===t?e.previousPageContainers.main.style.left=u+"%":e.previousPageContainers.main.style.top=u+"%";var m=e.pageReferences[l-1];if(m&&e.settings.pages.progressiveImageLoading!==!1){e.previousPageContainers.page.thumbRequest&&(e.previousPageContainers.page.thumbRequest.abort(),e.previousPageContainers.page.thumbRequest=null);var p=MainFrame.Util.getAppURL()+m.small;e.previousPageContainers.page.thumbRequest=MainFrame.Util.request({url:p,onSuccess:function(){e.previousPageContainers.page.image.src=p,e.previousPageContainers.page.image.imageUrl=p}})}this.slideCatalog(e,t,c,r)},proto.previousPageDoubleSlide=function(e,t){var a=this,i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.5;var n=this.getParam("defaultBackgroundColor");if(n)var s=n;else var s="#ffffff";var o=e.previousPageContainers,l=e.currentPageContainers,c=e.nextPageContainers;e.clearHighlightedTextInContainer(l.left),e.clearHighlightedTextInContainer(l.right),e.clearNotesInContainer(l.left),e.clearNotesInContainer(l.right),e.hideMapsForContainer(l.left),e.hideMapsForContainer(l.right),e.decrementCurrentPage();var d=e.currentPage,g=e.currentSlideIndex,h=g-1,u=g+1;e.previousPageContainers=c,e.currentPageContainers=o,e.nextPageContainers=l,e.previousPageContainers.left.image.src="",e.previousPageContainers.right.image.src="",o.left.container.style.backgroundColor=s,o.right.container.style.backgroundColor=e.isValidPageValue(d+1)?s:"",o.left.container.style.backgroundColor=e.isValidPageValue(d-2)?s:"",o.right.container.style.backgroundColor=e.isValidPageValue(d-1)?s:"",e.settings.pages.useShadow&&this.adjustPageShadow(e,e.previousPageContainers,d-2);var m=function(){a.updateIndexAfterSlide(e,t,h,g,u),e.previousPageTimer&&(clearTimeout(e.previousPageTimer),e.previousPageTimer=null),e.previousPageTimer=setTimeout(function(){a.updateContentAfterSlide(e),a.clearPageBackgrounds(e)},200),MainFrame.Event.unbind(e.sliderContainer,MainFrame.Event.transitionEnd,m),a.endAndClearAction()};MainFrame.Event.bind(e.sliderContainer,MainFrame.Event.transitionEnd,m);var p=100*h;e.previousPageContainers.main.setAttribute("data-index",h),"horizontal"===t?e.previousPageContainers.main.style.left=p+"%":e.previousPageContainers.main.style.top=p+"%";var f=e.pageReferences[d-2],v=e.pageReferences[d-1];if(f&&e.settings.pages.progressiveImageLoading!==!1){e.previousPageContainers.left.thumbRequest&&(e.previousPageContainers.left.thumbRequest.abort(),e.previousPageContainers.left.thumbRequest=null);var M=MainFrame.Util.getAppURL()+f.small;e.previousPageContainers.left.thumbRequest=MainFrame.Util.request({url:M,onSuccess:function(){e.previousPageContainers.left.image.src=M,e.previousPageContainers.left.image.imageUrl=M}})}if(v&&e.settings.pages.progressiveImageLoading!==!1){e.previousPageContainers.right.thumbRequest&&(e.previousPageContainers.right.thumbRequest.abort(),e.previousPageContainers.right.thumbRequest=null);var b=MainFrame.Util.getAppURL()+v.small;e.previousPageContainers.right.thumbRequest=MainFrame.Util.request({url:b,onSuccess:function(){e.previousPageContainers.right.image.src=b,e.previousPageContainers.right.image.imageUrl=b}})}this.slideCatalog(e,t,g,r)},MainFrame.Interpretor.DragScroller=MainFrame.Interpretor.Drag.extend({isNotZoomMapOrOverlay:function(e){var t=e.className,a=-1===t.indexOf("v7__maps__zoom-map-element")&&null!==e.parentNode&&null!==e.parentNode.parentNode&&"undefined"!=typeof e.parentNode.parentNode.className&&-1===e.parentNode.parentNode.className.indexOf("v7__maps__zoom-map-element"),i=-1===t.indexOf("v7__overlay")&&-1===t.indexOf("v7__elem__catalog__zoom-map-overlay"),r=-1===t.indexOf("v7__elem__catalog__slide-page-container");return a&&i&&r}}),MainFrame.Interpretor.PressScroller=MainFrame.Interpretor.Press.extend({isNotZoomMapOrOverlay:function(e){var t=-1===e.className.indexOf("v7__maps__zoom-map-element")&&null!==e.parentNode&&null!==e.parentNode.parentNode&&"undefined"!=typeof e.parentNode.parentNode.className&&-1===e.parentNode.parentNode.className.indexOf("v7__maps__zoom-map-element"),a=-1===e.className.indexOf("v7__overlay");return t&&a}}),MainFrame.Interpretor.DragEndNormalScroller=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragStarted=!1,this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.isDragged){var t=e.srcElement||e.target;this.isNotZoomMapOrOverlay(t)&&this.dragDuration>250&&Math.abs(this.totalDistanceX)<Math.abs(this.initiator.getDimensionX())/2&&"normal"===this.target.state&&MainFrame.EventHandler.dispatch("dragEndNormalScroller",[this],this.target)}this.isDragged=!1}}}),MainFrame.Interpretor.DragEndScroller=MainFrame.Interpretor.DragScroller.extend({onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.dragStarted=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.initialX=t.currentEvent.pageX,t.initialY=t.currentEvent.pageY,t.totalDistanceX=0,t.totalDistanceY=0,t.dragStartedTime=(new Date).getTime()),MainFrame.Event.preventDefault(e)},onTouchMove:function(e){var t=this;t.dragStarted&&(t.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragStarted=!1,this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.isDragged){var t=e.srcElement||e.target;this.isNotZoomMapOrOverlay(t)&&this.dragDuration>250&&Math.abs(this.totalDistanceX)<Math.abs(this.initiator.getDimensionX())/2&&MainFrame.EventHandler.dispatch("dragEndScroller",[this],this.target)}this.isDragged=!1}}}),MainFrame.Interpretor.DragEndZoomScroller=MainFrame.Interpretor.DragScroller.extend({onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.dragStarted=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.initialX=t.currentEvent.pageX,t.initialY=t.currentEvent.pageY,t.totalDistanceX=0,t.totalDistanceY=0,t.dragStartedTime=(new Date).getTime()),MainFrame.Event.preventDefault(e)},onTouchMove:function(e){var t=this;t.dragStarted&&(t.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragStarted=!1,this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.isDragged){var t=e.srcElement||e.target;"zoomed"===this.target.state&&this.isNotZoomMapOrOverlay(t)&&MainFrame.EventHandler.dispatch("dragEndZoomScroller",[this],this.target)}this.isDragged=!1}}}),MainFrame.Interpretor.DragNormal=MainFrame.Interpretor.DragScroller.extend({onTouchStart:function(e){var t=this,a=MainFrame.Util.getActiveElement();a.blur();var i=e.srcElement||e.target;MainFrame.Event.isMultiTouch(e)||"textarea"===i.nodeName.toLowerCase()||(t.dragStarted=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.initialX=this.currentEvent.pageX,t.initialY=this.currentEvent.pageY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=0,t.totalDistanceY=0,t.dragStartedTime=(new Date).getTime()),MainFrame.Event.preventDefault(e),MainFrame.Event.stop(e)},onTouchMove:function(e){var t=this,a=e.srcElement||e.target;t.dragStarted&&"normal"===t.target.state&&!MainFrame.Event.isMultiTouch(e)&&this.isNotZoomMapOrOverlay(a)&&"textarea"!==a.nodeName.toLowerCase()&&(t.target.isDragged=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=this.currentEvent.pageX,t.currentY=this.currentEvent.pageY,t.distanceX=this.currentEvent.pageX-t.previousX,t.distanceY=this.currentEvent.pageY-t.previousY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY,MainFrame.EventHandler.dispatch("dragNormal",[this],this.target))}}),MainFrame.Interpretor.DragStartNormalScroller=MainFrame.Interpretor.DragScroller.extend({onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.dragStarted=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e),t.dragStartDispatched=!1,MainFrame.Event.preventDefault(e)},onTouchMove:function(e){var t=this;t.dragStarted&&!t.dragStartDispatched&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,e.srcElement||e.target,"zoomed"!==this.target.state&&(MainFrame.EventHandler.dispatch("dragStartNormalScroller",[t],t.target),t.dragStartDispatched=!0))},onTouchEnd:function(){this.dragStarted&&(this.dragStarted=!1)}}),MainFrame.Interpretor.DragStartZoomScroller=MainFrame.Interpretor.DragStartNormalScroller.extend({onTouchMove:function(e){var t=this;if(t.dragStarted&&!t.dragStartDispatched){t.currentEvent=e.changedTouches?e.changedTouches[0]:e;var a=e.srcElement||e.target;"zoomed"===this.target.state&&this.isNotZoomMapOrOverlay(a)&&(MainFrame.EventHandler.dispatch("dragStartZoomScroller",[t],t.target),t.dragStartDispatched=!0)}}}),MainFrame.Interpretor.DragZoom=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this,a=e.srcElement||e.target;t.dragStarted&&"zoomed"===t.target.state&&this.isNotZoomMapOrOverlay(a)&&(t.target.isDragged=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=this.currentEvent.pageX,t.currentY=this.currentEvent.pageY,t.distanceX=this.currentEvent.pageX-t.previousX,t.distanceY=this.currentEvent.pageY-t.previousY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY,MainFrame.EventHandler.dispatch("dragZoom",[this],this.target))}}),MainFrame.Interpretor.SinglePressOnScroller=MainFrame.Interpretor.Press.extend({clicks:0,onTouchStart:function(e){var t=this;e.changedTouches&&e.changedTouches[0]?(t.initialX=e.changedTouches[0].pageX,t.initialY=e.changedTouches[0].pageY):(t.initialX=e.pageX,t.initialY=e.pageY),MainFrame.Event.isMultiTouch(e)||(t.clicks++,t.hasMoved=!1,t.eventData=e.changedTouches?e.changedTouches[0]:e),MainFrame.Event.preventDefault(e)},onTouchEnd:function(e){var t=this;t.hasMoved?t.clicks=0:setTimeout(function(){if(1===t.clicks){var a=e.srcElement||e.target,i=-1===a.className.indexOf("v7__maps__zone"),r=-1===a.className.indexOf("v7__maps__hotspot"),n="textarea"!==a.tagName.toLowerCase();i&&r&&n?MainFrame.EventHandler.dispatch("singlePressOnScroller",[t],t.initiator):"textarea"===a.tagName.toLowerCase()&&a.focus()}t.clicks=0},300),t.hasMoved=!1}}),MainFrame.Interpretor.SwipeLeftNormal=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1;var t=e.srcElement||e.target;this.isNotZoomMapOrOverlay(t)&&this.dragDuration<250&&Math.abs(this.totalDistanceX)>Math.abs(this.totalDistanceY)&&this.totalDistanceX<0&&"normal"===this.target.state&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeLeftNormal",[this],this.target))}}}),MainFrame.Interpretor.SwipeRightNormal=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.target.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,this.target.isDragged){var t=e.srcElement||e.target;this.isNotZoomMapOrOverlay(t)&&this.dragDuration<250&&Math.abs(this.totalDistanceX)>Math.abs(this.totalDistanceY)&&this.totalDistanceX>0&&"normal"===this.target.state&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeRightNormal",[this],this.target))}this.target.isDragged=!1}}}),MainFrame.Interpretor.TapLeftMarginScroller=MainFrame.Interpretor.PressScroller.extend({__thresholdX:200,clicks:0,onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.clicks++,t.hasMoved=!1,t.eventData=e.changedTouches?e.changedTouches[0]:e),MainFrame.Event.preventDefault(e)},onTouchMove:function(){this.hasMoved=!0},onTouchEnd:function(e){var t=this;t.currentEvent=e.changedTouches?e.changedTouches[0]:e;var a=e.srcElement||e.target;this.isNotZoomMapOrOverlay(a)&&!t.hasMoved&&"normal"===this.target.state?setTimeout(function(){1===t.clicks&&t.isWithinBounds(t.currentEvent)&&MainFrame.EventHandler.dispatch("tapLeftMarginScroller",[t],t.initiator),t.clicks=0},300):t.clicks=0,t.hasMoved=!1},isWithinBounds:function(e){var t=this,a=t.initiator.getPositionX(),i=t.initiator.getPositionY(),r=(t.initiator.getDimensionX(),t.initiator.getDimensionY());return e.pageY<i?!1:e.pageY>i+r?!1:e.pageX<a?!1:e.pageX>a+t.__thresholdX?!1:!0}}),MainFrame.Interpretor.TapRightMarginScroller=MainFrame.Interpretor.PressScroller.extend({__thresholdX:200,clicks:0,onTouchStart:function(e){var t=this;MainFrame.Event.isMultiTouch(e)||(t.clicks++,t.hasMoved=!1,t.eventData=e.changedTouches?e.changedTouches[0]:e),MainFrame.Event.preventDefault(e)},onTouchMove:function(){this.hasMoved=!0},onTouchEnd:function(e){var t=this;t.currentEvent=e.changedTouches?e.changedTouches[0]:e;var a=e.srcElement||e.target;this.isNotZoomMapOrOverlay(a)&&!t.hasMoved&&"normal"===this.target.state?setTimeout(function(){1===t.clicks&&t.isWithinBounds(t.currentEvent)&&MainFrame.EventHandler.dispatch("tapRightMarginScroller",[t],t.initiator),t.clicks=0},300):t.clicks=0,t.hasMoved=!1},isWithinBounds:function(e){var t=this,a=t.initiator.getPositionX(),i=t.initiator.getPositionY(),r=t.initiator.getDimensionX(),n=t.initiator.getDimensionY();return e.pageY<i?!1:e.pageY>i+n?!1:e.pageX>a+r?!1:e.pageX<a+r-t.__thresholdX?!1:!0}}),MainFrame.Interpretor.ValidDragLeftScroller=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1;var t=e.srcElement||e.target;this.isNotZoomMapOrOverlay(t)&&this.totalDistanceX<-parseInt(this.initiator.getDimensionX(),10)/2&&this.dragDuration>250&&"normal"===this.target.state&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("validDragLeftScroller",[this],this.target))}}}),MainFrame.Interpretor.ValidDragRightScroller=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1;var t=e.srcElement||e.target;this.isNotZoomMapOrOverlay(t)&&this.totalDistanceX>parseInt(this.initiator.getDimensionX(),10)/2&&this.dragDuration>250&&"normal"===this.target.state&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("validDragRightScroller",[this],this.target))}}}),MainFrame.Interpretor.DragEndNormalCatalog=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.isDragged=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=this.currentEvent.pageX,t.currentY=this.currentEvent.pageY,t.distanceX=this.currentEvent.pageX-t.previousX,t.distanceY=this.currentEvent.pageY-t.previousY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){this.dragStarted=!1,this.dragDuration=(new Date).getTime()-this.dragStartedTime;var t=this.target,a=1===t.currentPage,i=t.isLastPage(t.currentPage);if("horizontalSlide"===t.settings.navigationType){var r=Math.abs(this.totalDistanceX)<Math.abs(this.initiator.getDimensionX())/2,n=this.totalDistanceX>0?"left":"right";a&&"left"===n?r=!0:i&&"right"===n&&(r=!0);var s=this.dragDuration>250}else if("verticalSlide"===t.settings.navigationType){var r=Math.abs(this.totalDistanceY)<Math.abs(this.initiator.getDimensionY())/2,n=this.totalDistanceY>0?"up":"down";i&&"up"===n?r=!0:i&&"down"===n&&(r=!0);var s=this.dragDuration>250}else var r=!0,s=!0;if(this.isDragged){var o=e.srcElement||e.target;this.isNotZoomMapOrOverlay(o)&&s&&r&&1===t.scale&&MainFrame.EventHandler.dispatch("dragEndNormalCatalog",[this],t)}this.isDragged=!1}}}),MainFrame.Interpretor.DragNormalCatalog=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this,a=e.srcElement||e.target;t.dragStarted&&1===t.target.scale&&!MainFrame.Event.isMultiTouch(e)&&this.isNotZoomMapOrOverlay(a)&&"textarea"!==a.nodeName.toLowerCase()&&(t.target.isDragged=!0,this.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=this.currentEvent.pageX,t.currentY=this.currentEvent.pageY,t.distanceX=this.currentEvent.pageX-t.previousX,t.distanceY=this.currentEvent.pageY-t.previousY,t.previousX=this.currentEvent.pageX,t.previousY=this.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY,MainFrame.EventHandler.dispatch("dragNormalCatalog",[this],this.target))
}}),MainFrame.Interpretor.DragStartZoomCatalog=MainFrame.Interpretor.DragStartNormalScroller.extend({onTouchMove:function(e){var t=this;if(t.dragStarted&&!t.dragStartDispatched){t.currentEvent=e.changedTouches?e.changedTouches[0]:e;var a=e.srcElement||e.target;1!==this.target.scale&&this.isNotZoomMapOrOverlay(a)&&(MainFrame.EventHandler.dispatch("dragStartZoomCatalog",[t],t.target),t.dragStartDispatched=!0)}}}),MainFrame.Interpretor.SwipeBackNormalCatalog=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.target.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,"horizontalSlide"===this.target.settings.navigationType)var t=Math.abs(this.totalDistanceX)>Math.abs(this.totalDistanceY)&&this.totalDistanceX>0;else if("verticalSlide"===this.target.settings.navigationType)var t=Math.abs(this.totalDistanceY)>Math.abs(this.totalDistanceX)&&this.totalDistanceY>0;else var t=!1;var a=e.srcElement||e.target;this.isNotZoomMapOrOverlay(a)&&this.dragDuration<250&&t&&1===this.target.scale&&this.target.isBeingPinched!==!0&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeBackNormalCatalog",[this],this.target))}}}),MainFrame.Interpretor.SwipeNextNormalCatalog=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,"horizontalSlide"===this.target.settings.navigationType)var t=Math.abs(this.totalDistanceX)>Math.abs(this.totalDistanceY)&&this.totalDistanceX<0;else if("verticalSlide"===this.target.settings.navigationType)var t=Math.abs(this.totalDistanceY)>Math.abs(this.totalDistanceX)&&this.totalDistanceY<0;else var t=!1;var a=e.srcElement||e.target;this.isNotZoomMapOrOverlay(a)&&this.dragDuration<250&&t&&1===this.target.scale&&this.target.isBeingPinched!==!0&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("swipeNextNormalCatalog",[this],this.target))}}}),MainFrame.Interpretor.ValidDragBackCatalog=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,"horizontalSlide"===this.target.settings.navigationType)var t=this.totalDistanceX>parseInt(this.initiator.getDimensionX(),10)/2;else if("verticalSlide"===this.target.settings.navigationType)var t=this.totalDistanceY>parseInt(this.initiator.getDimensionY(),10)/2;else var t=!1;var a=e.srcElement||e.target;this.isNotZoomMapOrOverlay(a)&&t&&this.dragDuration>250&&1===this.target.scale&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("validDragBackCatalog",[this],this.target))}}}),MainFrame.Interpretor.ValidDragNextCatalog=MainFrame.Interpretor.DragScroller.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.previousX=t.currentEvent.pageX,t.previousY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(e){if(this.dragStarted){if(this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.dragStarted=!1,"horizontalSlide"===this.target.settings.navigationType)var t=this.totalDistanceX<-parseInt(this.initiator.getDimensionX(),10)/2;else if("verticalSlide"===this.target.settings.navigationType)var t=this.totalDistanceY<-parseInt(this.initiator.getDimensionY(),10)/2;else var t=!1;var a=e.srcElement||e.target;this.isNotZoomMapOrOverlay(a)&&t&&this.dragDuration>250&&1===this.target.scale&&(this.eventData=e.changedTouches?e.changedTouches[0]:e,MainFrame.EventHandler.dispatch("validDragNextCatalog",[this],this.target))}}}),!function(){var e={calculatePinchZoomPosition:function(e){var t=this.getTarget(),a=parseFloat(t.getDimensionX()),i=parseFloat(t.getDimensionY()),r=parseFloat(t.getPositionX()),n=parseFloat(t.getPositionY()),s=a/2,o=i/2,l=parseFloat(this.getParam("sourceEvent").initialCenterX)-r,c=parseFloat(this.getParam("sourceEvent").initialCenterY)-n,d=s+t.overlayTranslatedX,g=o+t.overlayTranslatedY,h=(d-l)/t.scale,u=(g-c)/t.scale,m=s-h,p=o-u,f=(s-m)*(e-1),v=(o-p)*(e-1);return{x:f,y:v}},calculateZoomPosition:function(){var e=this.getTarget(),t=this.getParam("sourceEvent"),a=t.lastEvent||t.eventData,i=parseFloat(a.clientX),r=parseFloat(a.clientY),n=parseFloat(this.getParam("scale")),s=parseFloat(e.getDimensionX()),o=parseFloat(e.getDimensionY()),l=parseFloat(e.getPositionX()),c=parseFloat(e.getPositionY()),d=l+s/2,g=c+o/2,h=(d-i)*n,u=(g-r)*n,m=e.containers[e.currentIndex].graphics.length,p=e.getPageSize(!0),f=(parseFloat(e.getDimensionX())-p.pageWidth*m)/2,v=(parseFloat(e.getDimensionY())-p.pageHeight)/2,M=s/2*(n-1)-f*n,b=o/2*(n-1)-v*n;if(h=h>M?M:-M>h?-M:h,u=u>b?b:-b>u?-b:u,"undefined"!=typeof e.settings.pages.centerFirst&&e.settings.pages.centerFirst,p.pageWidth*n*m<s){var F=e.getCurrentContainer().getObjectProperty("{#catalog.pageX}");h=s-2*F-m*p.pageWidth}return{x:h,y:u}},calculateZoomLimits:function(e){var t=e.containers[e.currentIndex],a=t.graphics.length,i=e.getPageSize(!0),r=Math.ceil(Math.ceil(i.pageWidth)*a*e.scale),n=Math.ceil(i.pageHeight*e.scale),s=parseFloat(e.getDimensionX()),o=parseFloat(e.getDimensionY()),l=r-s,c=n-o,d=l/2,g=-d,h=c/2,u=-h;return s>=r&&(g=0,d=0),o>=n&&(u=0,h=0),1===a&&(g=-i.pageWidth*(e.scale-1),d=-g),{limitLeft:g,limitRight:d,limitTop:u,limitBottom:h}},getPageForLabel:function(e,t){for(var a=0,i=t.length;i>a;a++){var r=t[a];if(e===r)return a}return null},extractPageNumbers:function(e){var t=e.replace(/\d{1,}_\d{1,}/g,function(e){for(var t=e.split("_"),a=parseInt(t[0],10),i=parseInt(t[1],10),r=[];i>=a;a++)r.push(a);return r.join(",")});return t.split(",")},drawZoomCanvasContent:function(e){var t=e.zoomContainer.zoomCanvas,a=t.getContext("2d"),i=t.width,r=t.height;if(a.clearRect(0,0,i,r),e.settings.pages.useXJpgForZoom){if(e.isSinglePage){var n=e.currentPage,s=e.pageReferences[n];if(s){var o=new Image;o.onload=function(){a.drawImage(o,0,0,i,r)},o.src=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+s.hdx}}else if(e.isDoublePage){var l=e.currentPage,c=l+1,d=e.pageReferences[l],g=e.pageReferences[c],h=i/2;if(d){var u=new Image;u.onload=function(){a.drawImage(u,0,0,h,r)},u.src=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+d.hdx}if(g){var m=new Image;m.onload=function(){a.drawImage(m,h,0,h,r)},m.src=MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+g.hdx}}}else if(e.isSinglePage){var o=e.currentPageContainers.page.image;a.drawImage(o,0,0,i,r)}else if(e.isDoublePage){var u=e.currentPageContainers.left.image,m=e.currentPageContainers.right.image,h=i/2;a.drawImage(u,0,0,h,r),a.drawImage(m,h,0,h,r)}},drawZoomPrices:function(e){if(e.isSinglePage){var t=e.zoomContainer.pricePage,a=e.currentPage;e.initPricesForContainerAndPage(t,a),t.prices.resizePricesContainer()}else{var a=e.currentPage,i="single"===e.settings.pages.coverType;i&&1===a&&(a=0);var r=e.zoomContainer.pricePageLeft,n=e.zoomContainer.pricePageRight,s=a,o=a+1;e.initPricesForContainerAndPage(r,s),e.initPricesForContainerAndPage(n,o),r.prices.resizePricesContainer(),n.prices.resizePricesContainer()}},getHdSrc:function(e,t){var a=e.pageReferences[t];if(a.hd)var i=a.hd;var r=-1!==i.indexOf("/");return r?MainFrame.Util.getAppURL()+i:MainFrame.Util.getAppURL()+e.settings.pages.dataSrc+i}};MainFrame.Util.extend(MainFrame.Util,e)}(),MainFrame.Element.PagePreview=MainFrame.Abstract.Element.extend({cssClasses:{"page-container":"v7__elem__page-preview__page-container",full:"v7__elem__page-preview__full-page",half:"v7__elem__page-preview__half-page",left:"v7__elem__page-preview__page-left",right:"v7__elem__page-preview__page-right","shadow-container":"v7__elem__catalog__shadow-container","page-shadow":"v7__elem__catalog__shadow-container--shadow"},setMode:function(e){this.mode=e},setPageNumber:function(e){this.pageNumber=e,this.drawPage()},getPageNumber:function(){var e=this.sourceModule,t="double"===this.mode||"current"===this.mode&&e.isDoublePage,a=e.currentPage,i=this.pageNumber;switch(i){case"currentPage":return this.shouldRedraw=!0,a;case"previousPage":return this.shouldRedraw=!0,t?a-2===0?1:a-2:a-1;case"nextPage":return this.shouldRedraw=!0,t?a+2:a+1;case"leftPage":return this.shouldRedraw=!0,a;case"rightPage":return this.shouldRedraw=!0,a+1;case"lastPage":var r=e.singlePages.length,n=r-1;return n;default:return parseInt(i,10)}},getPageIndex:function(e){var t=this.sourceModule;switch(this.mode){case"single":return t.getContainerForPagingType(e,"1");case"double":return t.getContainerForPagingType(e,"2");case"current":default:return t.getContainerForCurrentPagingType(e)}},getPageObjectType:function(){switch(this.quality){case"low":return"diapo";case"normal":return"normal";case"high":default:return"zoom"}},getImageSourceForPageData:function(e){var t=this.sourceModule,a=t.settings.pages,i="undefined"!=typeof a.sizes;if(!e)return MainFrame.Util.emptyImageUrl;switch(this.quality){case"low":return this.getLowQualitySource(e);case"normal":return i?this.getAutoQualitySource(e):this.getNormalQualitySource(e);case"high":return this.getHighQualitySource(e);case"auto":return i?this.getAutoQualitySource(e):this.getHighQualitySource(e);default:if(i){var r=parseInt(this.quality,10);return this.getPageSizeQualitySource(e,r)}return this.getHighQualitySource(e)}},getLowQualitySource:function(e){return MainFrame.Util.getAppURL()+e.small},getNormalQualitySource:function(e){var t=this.sourceModule;return MainFrame.Util.getAppURL()+t.settings.pages.dataSrc+e.standard},getHighQualitySource:function(e){var t=this.sourceModule;if(-1!==e.hd.indexOf("/"))var a="";else var a=t.settings.pages.dataSrc;return MainFrame.Util.getAppURL()+a+e.hd},getAutoQualitySource:function(e){var t,a,i=this.sourceModule,r=i.settings.pages.sizes,n=r.length,s=n-1,o=this.getDimensionX();for(this.getDimensionY();s>=0;s--){var l=r[s],c=l.width-o;"undefined"==typeof t?(t=c,a=l):c>=0&&t>c&&(t=c,a=l)}var d=e.sizes[a.width];return MainFrame.Util.getAppURL()+d.normal},getPageSizeQualitySource:function(e,t){for(var a=this.sourceModule,i=a.settings.pages.sizes,r=i.length,n=0;r>n;n++){var s=i[n];if(s.width===t||s.height===t)var o=s}var l="undefined"==typeof o;if(l)return this.getAutoQualitySource(e);var c=e.sizes[o.width];return MainFrame.Util.getAppURL()+c.normal},getPageObject:function(e){var t,a=this.sourceModule;switch(this.mode){case"single":t=a.singlePages[e];break;case"double":t=a.doublePages[e];break;case"current":default:t=a.pages[e]}if(t){var i=this.getPageObjectType();return t.pageType[i]}return MainFrame.Util.showError("PagePreview getPageObject error"),null},readData:function(e){MainFrame.DataParser.parsePagePreview.call(this,e);var t=this.sourceModuleId+":pageChanged",a=this.sourceModuleId+":orientationChanged";MainFrame.Publisher.subscribe(t,this,this.onPageChange),MainFrame.Publisher.subscribe(a,this,this.onPageChange)},createPageContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses["page-container"],this.contentElement);this.pageContainer=e,this.pageImages={}},createOuterShadowContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses["shadow-container"]+" "+this.cssClasses["page-shadow"],this.contentElement);this.outerShadowContainer=e},addPageImage:function(e,t,a){if("undefined"==typeof this.pageImages[t+"-"+a]){var i=this.cssClasses[t]+" "+this.cssClasses[a],r=MainFrame.Util.createElement("img",i,this.pageContainer);this.pageImages[t+"-"+a]=r}else var r=this.pageImages[t+"-"+a];var n=e===MainFrame.Util.emptyImageUrl&&this.loadOnlyWithImage;n||(r.src=e)},onPageChange:function(){this.shouldRedraw&&this.drawPage()},drawPage:function(){var e=this.sourceModule;if("2"===e.API_VERSION){this.useShadow&&"undefined"==typeof this.outerShadowContainer&&(this.contentElement.style.overflow="visible",this.createOuterShadowContainer()),"undefined"==typeof this.pageContainer&&(this.pageContainerSize={},this.createPageContainer());var t=this.mode;"current"===t&&(t=e.isSinglePage?"single":"double"),this.setPageContent(t),this.resizePageContainer(t),this.useShadow&&this.resizeOuterShadowContainer(t),this.settings.borders.hasBorders&&this.drawBorders(t);var a=this.getPageNumber();"double"===t&&this.shouldCenterPage(t,a)?this.centerPage(a):this.uncenterPage(t)}else this.drawPage_deprecated()},drawPage_deprecated:function(){var e=this.sourceModule,t=this.getPageNumber(),a=this.getPageIndex(t),i=this.getPageObject(a),r=this.getPageObjectType();hasDefaultLocation="diapo"===r?!1:!0,e.buildGraphicsInSubContainer(this,a,r,hasDefaultLocation,i),"single"===this.mode&&(this.centeredDiv.style.textAlign="center"),e.settings.useShadow&&(this.contentElement.style.overflow="visible")},shouldCenterPage:function(e,t){if("double"===e){var a="single"===this.sourceModule.settings.pages.coverType;a&&1===t&&(t=0);var i=t,r=this.sourceModule.settings.pages.totalPages;if(0===i&&this.centerFirst)return!0;if(i===r&&this.centerLast)return!0}return!1},resizePageContainer:function(e){var t=this.sourceModule,a="single"===e?t.settings.pages.normalSize.width:2*t.settings.pages.normalSize.width,i=t.settings.pages.normalSize.height,r=a/i,n=this.getDimensionX(),s=this.getDimensionY(),o=n/s,l=r>o;if(l){this.pageContainer.style.width="100%",this.pageContainer.style.left="0";var c=Math.floor(n/r),d=(s-c)/2;this.pageContainer.style.height=c+"px",this.pageContainer.style.top=d+"px",this.pageContainerSize.width=n,this.pageContainerSize.height=c,this.pageContainerSize.x=0,this.pageContainerSize.y=d}else{this.pageContainer.style.height="100%",this.pageContainer.style.top="0";var g=Math.floor(s*r),h=(n-g)/2;this.pageContainer.style.width=g+"px",this.pageContainer.style.left=h+"px",this.pageContainerSize.width=g,this.pageContainerSize.height=s,this.pageContainerSize.x=h,this.pageContainerSize.y=0}},resizeOuterShadowContainer:function(e){var t=(this.sourceModule,this.pageContainerSize);if("double"===e&&1===this.pagesOnScreen){var a=t.width/2;this.leftPageMissing?(this.outerShadowContainer.style.width=a+"px",this.outerShadowContainer.style.left=t.x+a+"px"):(this.outerShadowContainer.style.width=a+"px",this.outerShadowContainer.style.left=t.x+"px")}else this.outerShadowContainer.style.width=t.width+"px",this.outerShadowContainer.style.left=t.x+"px";this.outerShadowContainer.style.height=t.height+"px",this.outerShadowContainer.style.top=t.y+"px"},drawBorders:function(e){var t=(this.sourceModule,this.settings.borders);if("double"===e&&1===this.pagesOnScreen)if(this.resetBorders(this.pageContainer.style),this.leftPageMissing){var a=this.pageImages["half-right"].style;this.pageImages["half-left"].style.border=""}else{var a=this.pageImages["half-left"].style;this.pageImages["half-right"].style.border=""}else{this.pageImages["half-left"]&&this.resetBorders(this.pageImages["half-left"].style),this.pageImages["half-right"]&&this.resetBorders(this.pageImages["half-right"].style);var a=this.pageContainer.style}a.borderTopWidth=t.borderTopWidth+"px",a.borderRightWidth=t.borderRightWidth+"px",a.borderBottomWidth=t.borderBottomWidth+"px",a.borderLeftWidth=t.borderLeftWidth+"px",a.borderTopStyle=t.borderTopStyle,a.borderRightStyle=t.borderRightStyle,a.borderBottomStyle=t.borderBottomStyle,a.borderLeftStyle=t.borderLeftStyle,a.borderTopColor=t.borderTopColor,a.borderRightColor=t.borderRightColor,a.borderBottomColor=t.borderBottomColor,a.borderLeftColor=t.borderLeftColor},resetBorders:function(e){e.borderTopWidth="0px",e.borderRightWidth="0px",e.borderBottomWidth="0px",e.borderLeftWidth="0px"},setPageContent:function(e){var t=this.sourceModule,a=this.getPageNumber();if("single"===e){var i=t.pageReferences[a],r=this.getImageSourceForPageData(i);this.addPageImage(r,"full","left")}else{var n="single"===t.settings.pages.coverType,s=a%2===0;if(n)if(s)var o=a,l=a+1;else var o=a-1,l=a;else if(s)var o=a-1,l=a;else var o=a,l=a+1;var c=t.pageReferences[o],d=t.pageReferences[l],g=this.getImageSourceForPageData(c),h=this.getImageSourceForPageData(d);c?d?(this.pagesOnScreen=2,this.leftPageMissing=!1,this.rightPageMissing=!1):(this.pagesOnScreen=1,this.leftPageMissing=!1,this.rightPageMissing=!0):(this.pagesOnScreen=1,this.leftPageMissing=!0,this.rightPageMissing=!1),this.addPageImage(g,"half","left"),this.addPageImage(h,"half","right")}},centerPage:function(e){if(1===e){var t=this.pageImages["half-right"];t.style.left="25%"}else{var a=this.pageImages["half-left"];a.style.left="25%"}if(this.useShadow){var i=this.pageContainerSize.width/4;this.outerShadowContainer.style.left=this.pageContainerSize.x+i+"px"}},uncenterPage:function(e){var t=this.pageImages["half-left"],a=this.pageImages["half-right"];t&&(t.style.left="0"),a&&(a.style.left="50%"),this.useShadow&&this.resizeOuterShadowContainer(e)}}),MainFrame.Element.Catalog=MainFrame.Abstract.Element.extend({API_VERSION:"2",state:"loading",scale:1,zoomScale:2,currentPage:1,currentSlideIndex:0,currentPageSize:{},currentCatalogSize:{},navigationEventsQueue:null,cssClasses:{"catalog-container":"v7__elem__catalog__catalog-container","zoom-container":"v7__elem__catalog__zoom-container","zoom-content":"v7__elem__catalog__zoom-content","zoom-canvas":"v7__elem__catalog__zoom-canvas","single-zoom-overlay":"v7__elem__catalog__single-zoom-overlay","zoom-map-container":"v7__elem__catalog__zoom-map-container","zoom-map-overlay":"v7__elem__catalog__zoom-map-overlay","maps-container":"v7__elem__catalog__maps-container","prices-container":"v7__elem__catalog__prices-container","zoom-prices-main":"v7__elem__catalog__zoom-prices--main","zoom-prices-left":"v7__elem__catalog__zoom-prices--left","zoom-prices-right":"v7__elem__catalog__zoom-prices--right","notes-container":"v7__elem__catalog__notes-container","shadow-container":"v7__elem__catalog__shadow-container","page-shadow":"v7__elem__catalog__shadow-container--shadow","page-inner-shadow":"v7__elem__catalog__inner-shadow-container","page-inner-shadow-left":"v7__elem__catalog__flip-page--inner-shadow-left","page-inner-shadow-right":"v7__elem__catalog__flip-page--inner-shadow-right","text-highlight":"v7__elem__catalog__highlight-container"},initialize:function(e){e=e||{},this._properties={},this._properties.def={},this._properties.original={},e.superObject&&this.addSuperObject(e.superObject),this.id=e.id||MainFrame.Util.generateItemId.call(this),MainFrame.Manager.Scoping.register(this.id,this),this.createContainerElement(e.insertBeforeElement),this.pages=[],this.viewedPages=[],e.data&&(this.readData(e.data),this.initCatalog(),this.resize())},readData:function(e){MainFrame.DataParser.parseFlipCatalog.call(this,e)},initCatalog:function(){this.navigationEventsQueue=[],this.generatePages(),this.viewedPages=[],this.containerRatio=this.determineContainerRatio(),this.orientation=this.determineCatalogOrientation(),this.determinePageType(),this.catalogRatio=this.determineCatalogRatio();var e=this.determineCurrentPage();if(this.setCurrentPage(e),this.setLastPageValue(),this.settings.pages.useShadow&&"flip"===this.settings.navigationType&&this.createFlipOuterShadowContainer(),this.createCatalogContainer(),("horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType)&&this.createSliderContainer(),"flip"===this.settings.navigationType&&(this.catalogContainer.style.perspective=MainFrame.Browser.noPreserve3D===!0?"none":"3000px",this.catalogContainer.style.transform="translate(0px, 0px)"),this.createPageContainers(),"horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType){var t="horizontalSlide"===this.settings.navigationType?"horizontal":"vertical";this.placeSlideContainers(t)}this.createTextHighlightContainers(),this.settings.pages.useShadow&&"flip"===this.settings.navigationType&&this.createFlipInnerShadowContainers(),this.addPageContent(),this.createZoomContainer(),this.createZoomMapContainer(),this.settings.prices.active&&this.initPrices(),this.settings.maps.active&&this.initMaps(),this.createNotesContainer(),this.initNotes(),this.state="idle",MainFrame.EventHandler.dispatch("catalogLoaded")},setCatalogState:function(e){this.state=e},createCatalogContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses["catalog-container"],this.contentElement);this.catalogContainer=e},createTextHighlightContainers:function(){var e=this;this.pageContainers.forEach(function(t){e.createTextHighlightContainer(t)})},createTextHighlightContainer:function(e){var t=MainFrame.Util.createElement("div",this.cssClasses["text-highlight"],e.container);e.highlight=t},createZoomContainer:function(){this.zoomContainer={};var e=MainFrame.Util.createElement("div",this.cssClasses["zoom-container"],this.contentElement);this.zoomContainer.container=e;var t=MainFrame.Util.createElement("div",this.cssClasses["zoom-content"],e);this.zoomContainer.wrapper=t;var a=MainFrame.Util.createElement("canvas",this.cssClasses["zoom-canvas"],t);this.zoomContainer.zoomCanvas=a,this.settings.prices.active===!0&&this.createPricesZoomContainers()},createPricesZoomContainers:function(){if(this.isSinglePage){var e=MainFrame.Util.createElement("div",this.cssClasses["zoom-prices-main"],this.zoomContainer.wrapper);this.zoomContainer.pricePage={},this.zoomContainer.pricePage.container=e}else{var t=MainFrame.Util.createElement("div",this.cssClasses["zoom-prices-left"],this.zoomContainer.wrapper);this.zoomContainer.pricePageLeft={},this.zoomContainer.pricePageLeft.container=t;var a=MainFrame.Util.createElement("div",this.cssClasses["zoom-prices-right"],this.zoomContainer.wrapper);this.zoomContainer.pricePageRight={},this.zoomContainer.pricePageRight.container=a}},createZoomMapContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses["zoom-map-container"],this.contentElement);this.zoomMapContainer=e;var t=MainFrame.Util.createElement("div",this.cssClasses["zoom-map-overlay"],e);this.zoomMapOverlay=t},createPageContainers:function(){switch(this.settings.navigationType){case"horizontalSlide":MainFrame.Util.addClass(this.catalogContainer,this.cssClasses["slide-container"]),this.createSlidePageContainers();break;case"verticalSlide":MainFrame.Util.addClass(this.catalogContainer,this.cssClasses["slide-container"]),this.createSlidePageContainers();break;case"flip":MainFrame.Util.addClass(this.catalogContainer,this.cssClasses["flip-container"]),this.contentElement.style.overflow="visible",this.containerElement.style.overflow="visible",this.createFlipPageContainers()}},addPageContent:function(){switch(this.settings.navigationType){case"horizontalSlide":this.updateSlidePageContainers();break;case"verticalSlide":this.updateSlidePageContainers();break;case"flip":this.updateFlipPageContainers()}},updatePageImage:function(e,t,a){a="undefined"!=typeof a?a:{};var i="undefined"!=typeof this.settings.pages.sizes;i?this.updatePageImageWithSizes(e,t,a):this.updatePageImage_deprecated(e,t,a)},updatePageImageWithSizes:function(e,t,a){var i="function"==typeof a.callback?a.callback:null,r=this.pageReferences[t];if(r){var n="undefined"!=typeof a.imageType?a.imageType:null;if("small"===n)var s=MainFrame.Util.getAppURL()+r.small;else if("standard"===n)var s=MainFrame.Util.getAppURL()+this.settings.pages.dataSrc+r.standard;else if("hd"===n)var s=MainFrame.Util.getAppURL()+this.settings.pages.dataSrc+r.hd;else{var o=this.determineOptimumSize(),l=r.sizes[o].normal;if(-1!==l.indexOf("/"))var s=MainFrame.Util.getAppURL()+l;else var s=MainFrame.Util.getAppURL()+this.settings.pages.dataSrc+l}if(s===e.image.imageUrl)return void(i&&i());this.settings.pages.useShadow&&this.isDoublePage&&"flip"===this.settings.navigationType&&e.innerShadow&&(e.innerShadow.style.display="block"),e.request&&(e.request.abort(),e.request=null,e.image.src=MainFrame.Util.emptyImageUrl,e.image.imageUrl=MainFrame.Util.emptyImageUrl),e.image.style.display="block",this.settings.pages.progressiveImageLoading&&(e.image.src=MainFrame.Util.getAppURL()+r.small),e.request=MainFrame.Util.request({url:s,onSuccess:function(){e.image.src=s,e.image.imageUrl=s,i&&i()}})}else e.image.style.display="none",e.image.src=MainFrame.Util.emptyImageUrl,e.image.imageUrl=MainFrame.Util.emptyImageUrl,this.settings.pages.useShadow&&this.isDoublePage&&"flip"===this.settings.navigationType&&(e.innerShadow.style.display="none"),i&&i()},updatePageImage_deprecated:function(e,t,a){a="undefined"!=typeof a?a:{};var i="standard";"undefined"!=typeof this.settings.pages.useHdAbove&&MainFrame.Browser.width>this.settings.pages.useHdAbove&&(i="hd");var r="function"==typeof a.callback?a.callback:null,n="undefined"!=typeof a.imageType?a.imageType:i,s=this.pageReferences[t];if(s){if("small"===n)var o=MainFrame.Util.getAppURL()+s[n];else var o=MainFrame.Util.getAppURL()+this.settings.pages.dataSrc+s[n];if(o===e.image.imageUrl)return void(r&&r());this.settings.pages.useShadow&&this.isDoublePage&&"flip"===this.settings.navigationType&&e.innerShadow&&(e.innerShadow.style.display="block"),e.request&&(e.request.abort(),e.request=null,e.image.src=MainFrame.Util.emptyImageUrl,e.image.imageUrl=MainFrame.Util.emptyImageUrl),e.image.style.display="block",this.settings.pages.progressiveImageLoading&&(e.image.src=MainFrame.Util.getAppURL()+s.small),e.request=MainFrame.Util.request({url:o,onSuccess:function(){e.image.src=o,e.image.imageUrl=o,r&&r()}})}else e.image.style.display="none",e.image.src=MainFrame.Util.emptyImageUrl,e.image.imageUrl=MainFrame.Util.emptyImageUrl,this.settings.pages.useShadow&&this.isDoublePage&&"flip"===this.settings.navigationType&&(e.innerShadow.style.display="none"),r&&r()},determineOptimumSize:function(e){if("undefined"!=typeof this.optimumSize&&e!==!0)return this.optimumSize;var t=this.getDimensionX(),a=(this.getDimensionY(),this.settings.pages.sizes),i=a.length,t=this.currentCatalogSize.width;if(this.currentCatalogSize.height,this.isSinglePage)var r=t;else var r=t/2;for(var n,s,o=i-1;o>=0;o--){var l=a[o],c=l.width-r;"undefined"==typeof s?(s=c,n=l.width):c>=0&&s>c&&(s=c,n=l.width)}return this.optimumSize=n,n},determineMaximumSize:function(){if(this.maximumSize)return this.maximumSize;var e=this.settings.pages.sizes,t=e.length,a=t-1,i=e[a];return this.maximumSize=i.width,this.maximumSize},clearHighlightedTextInContainer:function(e){e.highlight&&MainFrame.Util.emptyElement(e.highlight)},showHighlightedTextInContainer:function(e){e.highlight&&(e.highlight.style.opacity="")},hideHighlightedTextInContainer:function(e){e.highlight&&(e.highlight.style.opacity="0")},initMaps:function(){if(this.isSinglePage){var e=this.currentPageContainers.page,t=this.currentPage;this.initMapsForContainerAndPage(e,t)}else{var a=this.settings.pages.coverType,i="single"===a,t=this.currentPage;1===t&&i&&(t=0);var r=this.currentPageContainers.left,n=this.currentPageContainers.right,s=t,o=t+1;this.initMapsForContainerAndPage(r,s),this.initMapsForContainerAndPage(n,o)}},initMapsForContainerAndPage:function(e,t){if(this.settings.maps.active){if(!e.maps){var a=MainFrame.Util.createElement("div",this.cssClasses["maps-container"],e.container);e.maps=new MainFrame.Maps({superObject:this,containerElement:a})}e.maps.drawMapsForPage(t)}},hideMapsForContainer:function(e){e.maps&&(e.maps.containerElement.style.display="none",e.maps.clearIframeElements())},showMapZonesForContainer:function(e){e.maps&&(e.maps.zonesContainer.style.display="")},hideMapZonesForContainer:function(e){e.maps&&(e.maps.zonesContainer.style.display="none")},initPrices:function(){if(this.isSinglePage){var e=this.currentPageContainers.page,t=this.nextPageContainers.page,a=this.previousPageContainers.page,i=this.currentPage,r=i+1,n=i-1;this.initPricesForContainerAndPage(e,i),this.initPricesForContainerAndPage(t,r),t.prices&&t.prices.hide(),this.initPricesForContainerAndPage(a,n),a.prices&&a.prices.hide()}else{var s=this.settings.pages.coverType,o="single"===s,i=this.currentPage;1===i&&o&&(i=0);var l=this.currentPageContainers.left,c=this.currentPageContainers.right,d=this.nextPageContainers.left,g=this.nextPageContainers.right,h=this.previousPageContainers.left,u=this.previousPageContainers.right,m=i,p=i+1,f=i+2,v=i+3,M=i-2,b=i-1;this.initPricesForContainerAndPage(l,m),this.initPricesForContainerAndPage(c,p),this.initPricesForContainerAndPage(d,f),this.initPricesForContainerAndPage(g,v),d.prices&&d.prices.hide(),g.prices&&g.prices.hide(),this.initPricesForContainerAndPage(h,M),this.initPricesForContainerAndPage(u,b),h.prices&&h.prices.hide(),u.prices&&u.prices.hide()}},initPricesForContainerAndPage:function(e,t){if(!e.prices){var a=MainFrame.Util.createElement("div",this.cssClasses["prices-container"],e.container);e.prices=new MainFrame.Prices({superObject:this,containerElement:a})}e.prices.drawPricesForPage(t),e.prices.resizePricesContainer(),e.prices.show()},hidePricesForContainer:function(e){e.prices&&e.prices.hide()},initNotes:function(){if("undefined"!=typeof MainFrame.Element.Notes)if(this.isSinglePage){var e=this.currentPageContainers.page,t=this.currentPage;this.initNotesForContainerAndPage(e,t)}else{var a=this.settings.pages.coverType,i="single"===a,t=this.currentPage;1===t&&i&&(t=0);var r=this.currentPageContainers.left,n=this.currentPageContainers.right,s=t,o=t+1;this.initNotesForContainerAndPage(r,s),this.initNotesForContainerAndPage(n,o)}},createNotesContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses["notes-container"],this.contentElement);this.notesContainer=e},initNotesForContainerAndPage:function(e,t){"undefined"==typeof e.notes&&(e.notes=[]),this.clearNotesInContainer(e),this.drawNotesForContainerAndPage(e,t)},clearNotesInContainer:function(e){if(this.notesContainer&&(this.notesContainer.style.opacity=""),e.notes)for(;e.notes.length;){var t=e.notes.splice(0,1)[0];t.superObject.removeSubObject(t)}},showNotesInContainer:function(){this.notesContainer&&(this.notesContainer.style.opacity="")},hideNotesInContainer:function(){this.notesContainer&&(this.notesContainer.style.opacity="0")},drawNotesForContainerAndPage:function(e,t){for(var a=MainFrame.Manager.Notes.getNotesForPage(t),i=a.length,r=0;i>r;r++){var n=a[r];n.noteIndex=r,this.drawNote(n,e)}},drawNote:function(e,t){var a=(this.currentPageSize,this.settings.pages.normalSize,"noteTemplate"),i=MainFrame.Util.createElement("div","v7__elem__note",this.notesContainer),r=MainFrame.Manager.Resource.getById(a),n=new MainFrame.Abstract.Note({superObject:this,containerElement:i,data:r});if(n.setDimensionX(e.width),n.setDimensionY(e.height),e.sideIconMode){var s=n.getSubObjectWithRole("note");s&&s.hide()}n.note=e,n.sideIconMode=e.sideIconMode;var o=n.getSubObjectWithId("noteText");o.setText(e.text),n.noteId=e.noteId;var l=n.getSubObjectWithId("closeNoteBtn");l.setAction("id:removeNote;params:noteId="+e.noteId),MainFrame.Manager.Scoping.register(a+"_"+e.noteId,n),n.resize();var c=MainFrame.Util.getMainFrame();MainFrame.Event.bind(o.containerElement,"focus",function(){c.blockResize=!0}),MainFrame.Event.bind(o.containerElement,"blur",function(){c.blockResize=!1}),t.notes.push(n)},updatePageContent:function(){if("flip"===this.settings.navigationType){var e="undefined"!=typeof this.previousPagesOnScreen&&this.pagesOnScreen!==this.previousPagesOnScreen,t=this.isDoublePage&&1===this.previousPagesOnScreen&&1===this.pagesOnScreen;
(e||t)&&1===this.previousPagesOnScreen&&this.settings.pages.useShadow&&this.resizeFlipOuterShadowContainer()}if(this.shouldCenterPage(this.currentPage)){var a=this;this.centerPage({animated:!0,onComplete:function(){a.settings.prices.active&&a.initPrices(),a.settings.maps.active&&a.initMaps(),a.initNotes()}})}else this.settings.prices.active&&this.initPrices(),this.settings.maps.active&&this.initMaps(),this.initNotes()},shouldCenterPage:function(e){if(this.isDoublePage){var t=this.settings.pages,a="single"===t.coverType;a&&1===e&&(e=0);var i=e,r=t.totalPages;if(0===i&&t.centerFirst)return!0;if(i===r&&t.centerLast)return!0}return!1},setLastPageValue:function(){var e=this.settings.pages.totalPages,t=this.pageReferences[e];this.lastPage=t.pageIndex,this.lastPageNumber=t.number},setLeftRightPageValues:function(){if(this.isSinglePage){this.leftPageNumber="";var e=this.currentPage,t=this.pageReferences[e];this.rightPageNumber=t.number,this.leftPage=this.currentPage,this.rightPage=this.currentPage}else{var e=this.currentPage,a="single"===this.settings.pages.coverType;a&&1===e&&(e=0);var i=e,r=e+1,n=this.pageReferences[i],s=this.pageReferences[r];this.leftPageNumber=n?n.number:"",this.rightPageNumber=s?s.number:"",this.leftPage=1===this.currentPage?1:i,s&&(this.rightPage=r)}},setPreviousNextPageValues:function(){if(this.isSinglePage)var e=this.currentPage,t=e-1,a=e+1,i=this.pageReferences[t],r=this.pageReferences[a];else{var e=this.currentPage,n="single"===this.settings.pages.coverType;n&&1===e&&(e=0);var s=e,o=e+1,t=s-1,a=o+1,i=this.pageReferences[t],r=this.pageReferences[a]}this.previousPageNumber=i?i.number:"",this.nextPageNumber=r?r.number:""},setCurrentPage:function(e){if(this.isValidPageValue(e)){var t=this.currentPage;this.toDoBeforePageIsSet(e),this.currentPage=e,this.toDoAfterPageWasSet(e,t)}},toDoBeforePageIsSet:function(){},toDoAfterPageWasSet:function(e,t){if(this.setLeftRightPageValues(),this.setPreviousNextPageValues(),this.previousPagesOnScreen=this.pagesOnScreen,this.pagesOnScreen=this.determineNumberOfPagesOnScreen(),this.managePageLeftTriggers(e,t),this.manangePageReachedTriggers(e),this.viewedPages.push(e),"horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType){var a=this.determineCurrentSlideIndex();this.currentSlideIndex=a}this.managePageChangedEvents(e),MainFrame.Router.active&&this.updateHash(e);var i="undefined"!=typeof this.previousPagesOnScreen&&this.pagesOnScreen!==this.previousPagesOnScreen,r=this.isDoublePage&&1===this.previousPagesOnScreen&&1===this.pagesOnScreen;"flip"===this.settings.navigationType&&(i||r)&&(2===this.previousPagesOnScreen&&this.settings.pages.useShadow&&this.resizeFlipOuterShadowContainer(),1===this.previousPagesOnScreen&&r&&this.settings.pages.useShadow&&this.resizeFlipOuterShadowContainer()),(i||r)&&(this.notesContainer&&this.resizeNotesContainer(),MainFrame.Publisher.publish(this.id+":resized",{}))},managePageLeftTriggers:function(e,t){var a=this,i=this.isDoublePage,r=t;if(1==r){var n="#"+a.id+".firstPageLeft";MainFrame.EventHandler.dispatch(n,[a]),MainFrame.EventHandler.dispatch("catalogFirstPageLeft",[a])}else if(i&&(r==this.settings.pages.totalPages||r==this.settings.pages.totalPages-1)||r==this.settings.pages.totalPages){var s="#"+a.id+".lastPageLeft";MainFrame.EventHandler.dispatch(s,[a]),MainFrame.EventHandler.dispatch("catalogLastPageLeft",[a])}},manangePageReachedTriggers:function(e){var t=this;if(1===e){var a="#"+this.id+".firstPageReached";MainFrame.EventHandler.dispatch(a,[t]),MainFrame.EventHandler.dispatch("catalogFirstPage",[t])}if(this.isLastPage(e)){var i="#"+this.id+".lastPageReached";MainFrame.EventHandler.dispatch(i,[t]),MainFrame.EventHandler.dispatch("catalogLastPage",[t])}var r="#"+this.id+".page"+e+"Reached";if(MainFrame.EventHandler.dispatch(r,[t]),this.isDoublePage&&e>1&&e!==this.settings.pages.totalPages){var n=e+1,s="#"+this.id+".page"+n+"Reached";MainFrame.EventHandler.dispatch(s,[t])}},getLastViewedPage:function(){if(this.viewedPages.length){var e=this.viewedPages.length,t=e-1;return this.viewedPages[t]}return null},isLastPage:function(e){if(this.isSinglePage){if(e===this.settings.pages.totalPages)return!0}else if(1===this.pagesOnScreen){if(e===this.settings.pages.totalPages)return!0}else if(2===this.pagesOnScreen&&e+1===this.settings.pages.totalPages)return!0;return!1},determineNumberOfPagesOnScreen:function(){if(this.isSinglePage)return 1;var e="single"===this.settings.pages.coverType;if(e){var t=1===this.currentPage;if(t)return 1;var a=this.currentPage===this.settings.pages.totalPages;return a?1:2}var a=this.currentPage===this.settings.pages.totalPages;return a?1:2},managePageChangedEvents:function(){var e=this;MainFrame.Util.saveItem("catalog_"+e.id+"_currentPage",e.currentPage),MainFrame.Publisher.publish(e.id+":pageChanged",{page:e.currentPage}),MainFrame.EventHandler.dispatch("pageChangedCatalog")},updateHash:function(e){var t=this.settings.pages.pageGETParam,a=t,i=this.getHashPageString(e);MainFrame.Router.paths.length&&MainFrame.Router.paths.forEach(function(e){if(e.id===t){var i=MainFrame.Util.clearSlashes(e.hash);a=i.split("/")[0]}});var r=MainFrame.Router.get(),n=r.split("/"),s=0,o=n.length,l=o/2;if(o%2!==0)var c=a+"/"+i;else{for(var d=!1;l>s;s++){var g=2*s,h=g+1,u=n[g];u===a&&(n[h]=i,d=!0)}d===!1&&(n.push(a),n.push(i));var c=n.join("/")}MainFrame.Router.set(c)},getHashPageString:function(e){var t="single"===this.settings.pages.coverType;if(t){if(1===e||this.isSinglePage){var a=this.pageReferences[e];return a.number}if(this.isDoublePage){var i=this.pageReferences[e],r=this.pageReferences[e+1];return r?i.number+"-"+r.number:i.number}}else{if(this.isSinglePage){var a=this.pageReferences[e];return a.number}if(this.isDoublePage){var i=this.pageReferences[e],r=this.pageReferences[e+1];return r?i.number+"-"+r.number:i.number}}},determineCurrentPage:function(){var e=1,t=this.settings.pages,a=t.pageGETParam,i=MainFrame.Util.urlGET(a),r=MainFrame.Util.urlGET("prodId"),n=this.getPageForURLValue(i);if(this.isValidPageValue(n))e=n;else if(r)r.length>=5&&(n=parseInt(r.substr(0,4),10),this.goToMapId=r.substr(4),this.isValidPageValue(n)&&(e=n));else if(MainFrame.Router.active){var s=MainFrame.Router.getHashForId(a);if(s){var o=s.split("/")[0],i=MainFrame.Router.getHashValue(o),n=this.getPageForURLValue(i);this.isValidPageValue(n)&&(e=n)}}else if(t.loadCurrentPage){var l=MainFrame.Util.getItem("catalog_"+this.id+"_currentPage");l&&(n=parseInt(l,10),this.isValidPageValue(n)&&(e=n))}var c="single"===this.settings.pages.coverType;if(c){var d=e%2===1,g=1!==e;this.isDoublePage&&d&&g&&(e-=1)}else this.isRightPage(e)&&(e-=1);return"undefined"!=typeof t.pageRestriction&&e>=t.pageRestriction&&(e=1),e},determineCurrentSlideIndex:function(){var e=this.currentPage,t=this.determineSlideIndexFor(e);return t},determineSlideIndexFor:function(e){if(this.isSinglePage)var t=this.portraitPages;else if(this.isDoublePage)var t=this.landscapePages;for(var a=1,i=t.length;i>a;a++)for(var r=t[a],n=0,s=r.length;s>n;n++){var o=r[n];if(o.pageIndex===e)return a-1}},determineCurrentPageAfterOrientationChange:function(){var e=this.currentPage,t=e%2===1,a=1!==e;this.isDoublePage&&t&&a&&(e-=1),this.setCurrentPage(e)},getPageForURLValue:function(e){if(e&&-1!==e.indexOf("-"))var t=e.split("-")[0];else var t=e;var a=this.getPageForPageNumber(t);return a},getPageForPageNumber:function(e){for(var t=1,a=this.pageReferences.length;a>t;t++){var i=this.pageReferences[t];if(i.number==e)return t}return null},incrementCurrentPage:function(){var e=this.getNextPageValue();this.setCurrentPage(e)},decrementCurrentPage:function(){var e=this.getPreviousPageValue();this.setCurrentPage(e)},getNextPageValue:function(){if(this.isSinglePage)return this.currentPage+1;if(this.isDoublePage){var e="single"===this.settings.pages.coverType;return e&&1===this.currentPage?2:this.currentPage+2}},getPreviousPageValue:function(){if(this.isSinglePage)return this.currentPage-1;if(this.isDoublePage){var e="single"===this.settings.pages.coverType;return e&&2===this.currentPage?1:this.currentPage-2}},isValidPageValue:function(e){return null===e?!1:"undefined"==typeof e?!1:""===e?!1:isNaN(e)?!1:1>e||e>this.settings.pages.totalPages?!1:!0},isLeftPage:function(e){if(this.isDoublePage){var t="single"===this.settings.pages.coverType;return isEvenPage=e%2===0,t?1===e?!1:isEvenPage?!0:!1:isEvenPage?!1:!0}return null},isRightPage:function(e){if(this.isDoublePage){var t="single"===this.settings.pages.coverType;return isEvenPage=e%2===0,t?1===e?!0:isEvenPage?!1:!0:isEvenPage?!0:!1}return null},determinePageType:function(){var e=this.settings.pages,t="single"===e.catalogType,a="double"===e.catalogType,i=t||a&&"portrait"===this.orientation,r=a&&"landscape"===this.orientation;a&&e.disableSinglePage&&(i=!1,r=!0),this.isSinglePage=i,this.isDoublePage=r},determineCatalogOrientation:function(){return this.containerRatio>=1?"landscape":"portrait"},determineContainerRatio:function(){var e=this.getDimensionX(),t=this.getDimensionY();return e/t},determineCatalogRatio:function(){var e=this.settings.pages;if(this.isSinglePage)var t=parseInt(e.normalSize.width,10),a=parseInt(e.normalSize.height,10);else if(this.isDoublePage)var t=2*parseInt(e.normalSize.width,10),a=parseInt(e.normalSize.height,10);var i=t/a;return i},generatePages:function(){this.pageReferences=this.generatePagesArray(),this.populatePortraitPages(),this.populateLandscapePages(),this.choosePagesByOrientation()},generatePagesArray:function(){var e=[];e.push(null);var t=this.settings.pages,a="undefined"!=typeof t.sizes;if(a)var i=t.sizes.length,r=t.sizes[i-1];for(var n=1;n<=t.totalPages;n++){var s=this.createPageObject(n,r);e.push(s)}if(t.totalPages,t.insertedPages.length){var o=this;t.insertedPages.forEach(function(a){if(a.insertAfter)var i=a.insertAfter+1;else if(a.insertBefore)var i=a.insertBefore;a.pages.forEach(function(a){var n=o.createPageObject(a,r);e.splice(i,0,n),t.totalPages++,i++})})}return e},createPageObject:function(e,t){var a=this.settings.pages,i=a.customPages,r=a.customPagePostfix,n=a.pdfPrefix,s=a.pngPages&&-1!==a.pngPages.indexOf(imageUrl),o=s?"png":"jpg",l=a.pageFiles,c="undefined"!=typeof a.sizes,d=a.useXJpgForZoom,g=a.xJpgPages,h={},u=MainFrame.Util.zeroFill(e);if(-1!==i.indexOf(e)&&(u+=r),this.pageNumbers&&this.pageNumbers.length>1)var m=this.pageNumbers[e];else if(a.offset){var p=a.offset;m=p>=e?MainFrame.Util.romanize(e):e-p+""}else var m=e+"";if(h.pageIndex=e,h.number=m,h.filename=u,h.standard=u+"."+o,h.pngText=u+"hd.png",h.small=a.commonSrc+u+"v."+o,c?(h.hd=t.name.replace("0000",u),h.hdx=d&&-1!==g.indexOf(e)?h.hd.split("."+o).join("x."+o):h.hd):(h.hd=u+"hd."+o,h.hdx=d&&-1!==g.indexOf(e)?u+"hdx."+o:h.hd),h.pdf=a.commonSrc+n+u+".pdf","undefined"!=typeof l)for(var f in l){var v=l[f];if(-1!==v.indexOf("0000"))var M=v.replace("0000",u);else var M=v.replace("*",u);h[f]=M}return h.sizes=this.getPageSizeNames(u),h.notes=[],h},getPageSizeNames:function(e){var t={},a=this.settings.pages;return a.sizes&&a.sizes.forEach(function(a){var i=a.name.replace("0000",e),r=i.split("."),n=r[0];n+="x",r[0]=n;var s=r.join(".");t[a.width]={normal:i,original:s}}),t},populatePortraitPages:function(){var e=[];e.push(null);for(var t=1,a=this.pageReferences.length;a>t;t++){var i=[],r=this.pageReferences[t];i.push(r),e.push(i)}this.portraitPages=e},populateLandscapePages:function(){var e=[];e.push(null);var t="single"===this.settings.pages.coverType;if(t){var a=this.pageReferences[1],i=[a];e.push(i);var r=2}else var r=1;for(var n=this.pageReferences.length;n>r;r+=2){var i=[],s=this.pageReferences[r],o=this.pageReferences[r+1];s&&i.push(s),o&&i.push(o),e.push(i)}this.landscapePages=e},choosePagesByOrientation:function(){this.pages="landscape"===this.orientation?this.landscapePages:this.portraitPages},resize:function(){this._resize();var e=this.orientation;this.containerRatio=this.determineContainerRatio(),this.orientation=this.determineCatalogOrientation(),this.determinePageType(),this.catalogRatio=this.determineCatalogRatio(),this.determineCatalogAndPageSize(),this.settings.pages.useShadow&&("flip"===this.settings.navigationType?this.resizeFlipOuterShadowContainer():("horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType)&&this.resizeSlideOuterShadowContainers()),this.resizeCatalogContainer(),this.resizeZoomContainer(),this.resizeZoomMapContainer(),this.resizeNotesContainer();var t="undefined"!=typeof e&&e!==this.orientation;if(t){var a=this.settings.pages,i="double"===a.catalogType&&a.disableSinglePage;i||this.changeCatalogType()}var r="undefined"!=typeof this.settings.pages.sizes;r&&this.adjustPageSources(),this.shouldCenterPage(this.currentPage)&&this.centerPage({animated:!1}),MainFrame.Publisher.publish(this.id+":resized",{})},adjustPageSources:function(){var e=this.optimumSize,t=!0,a=this.determineOptimumSize(t);e!==a&&this.addPageContent()},changeCatalogType:function(){this.determineCurrentPageAfterOrientationChange();for(var e=[];this.pageContainers.length;)e.push(this.pageContainers.pop());if("horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType){var t="horizontalSlide"===this.settings.navigationType?"horizontal":"vertical";this.createSlidePages(),this.placeSlideContainers(t)}else this.createPageContainers();this.settings.pages.useShadow&&"flip"===this.settings.navigationType&&this.createFlipInnerShadowContainers(),this.addPageContent(),this.settings.prices.active&&this.initPrices(),this.settings.maps.active&&this.initMaps(),this.initNotes();var a=this;e.forEach(function(e){e.notes&&a.clearNotesInContainer(e),MainFrame.Util.removeElement(e.container)}),MainFrame.EventHandler.dispatch("orientationChangedCatalog",[this]),MainFrame.Publisher.publish(this.id+":orientationChanged",{orientation:this.orientation})},determineCatalogAndPageSize:function(){var e=this.catalogRatio>this.containerRatio,t=this.getDimensionX(),a=this.getDimensionY();if(!this.settings.pages.useShadow||"horizontalSlide"!==this.settings.navigationType&&"verticalSlide"!==this.settings.navigationType)r=0,n=0;else{var i=.94;t=Math.floor(t*i),a=Math.floor(a*i);var r=Math.floor(t*(1-i)/2),n=Math.floor(a*(1-i)/2)}if(e){var s=t;s%2!==0&&(s-=1);var o=Math.ceil(s/this.catalogRatio),l=0+r,c=(a-o)/2+n}else{var o=a,s=Math.ceil(o*this.catalogRatio);s%2!==0&&(s-=1);var l=(t-s)/2+r,c=0+n}this.currentPageSize.width=this.isSinglePage?s:s/2,this.currentPageSize.height=o,this.currentCatalogSize.width=s,this.currentCatalogSize.height=o,this.currentCatalogSize.x=l,this.currentCatalogSize.y=c},resizeCatalogContainer:function(){var e=this.currentCatalogSize;if("horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType){var t=e.width,a=e.height,i=e.x,r=e.y,n=this.currentPageContainers.wrapper;n.style.width=t+"px",n.style.height=a+"px",n.style.left=i+"px",n.style.top=r+"px";var s=this.previousPageContainers.wrapper;s.style.width=t+"px",s.style.height=a+"px",s.style.left=i+"px",s.style.top=r+"px";var o=this.nextPageContainers.wrapper;o.style.width=t+"px",o.style.height=a+"px",o.style.left=i+"px",o.style.top=r+"px"}else this.catalogContainer.style.width=e.width+"px",this.catalogContainer.style.height=e.height+"px",this.catalogContainer.style.left=e.x+"px",this.catalogContainer.style.top=e.y+"px"},resizeZoomContainer:function(){var e=this.currentCatalogSize,t=this.zoomScale,a=1/t,i=e.width*t,r=e.height*t,n=e.x-e.width*(t-1)/2,s=e.y-e.height*(t-1)/2,o=this.zoomContainer.zoomCanvas,l=this.zoomContainer.wrapper;o.width=i,o.height=r,l.style.width=i+"px",l.style.height=r+"px",l.style.left=n+"px",l.style.top=s+"px",l.style.webkitTransform="scale("+a+")",l.style.transform="scale("+a+")",l.style.webkitTransition="none",l.style.transition="none",l.translatedX=0,l.translatedY=0,l.scale=a,l.referenceScale=a},resizeZoomMapContainer:function(){var e=this.currentCatalogSize;this.zoomMapContainer.style.width=e.width+"px",this.zoomMapContainer.style.height=e.height+"px",this.zoomMapContainer.style.left=e.x+"px",this.zoomMapContainer.style.top=e.y+"px"},resizeNotesContainer:function(){var e=this.currentCatalogSize;if(1===this.pagesOnScreen&&1===this.currentPage&&this.isDoublePage){var t=this.currentPageSize,a=e.x+t.width;this.notesContainer.style.left=a+"px"}else this.notesContainer.style.left=e.x+"px";this.notesContainer.style.top=e.y+"px"},centerPage:function(e){"undefined"==typeof e&&(e={}),this.isDoublePage&&("horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType?this.centerPageForSlide(e):"flip"===this.settings.navigationType&&this.centerPageForFlip(e))},uncenterPage:function(e){"undefined"==typeof e&&(e={}),this.isDoublePage&&("horizontalSlide"===this.settings.navigationType||"verticalSlide"===this.settings.navigationType?this.uncenterPageForSlide(e):"flip"===this.settings.navigationType&&this.uncenterPageForFlip(e))}});var proto=MainFrame.Element.Catalog.prototype;proto.cssClasses["flip-container"]="v7__elem__catalog__flip-container",proto.cssClasses["flip-page-single"]="v7__elem__catalog__flip-page-single",proto.cssClasses["flip-page-double"]="v7__elem__catalog__flip-page-double",proto.cssClasses["flip-page-image"]="v7__elem__catalog__flip-page-image",proto.cssClasses["flip-page-left"]="v7__elem__catalog__flip-page--left",proto.cssClasses["flip-page-right"]="v7__elem__catalog__flip-page--right",proto.cssClasses["flip-page-current"]="v7__elem__catalog__flip-page--current",proto.cssClasses["flip-page-back-single"]="v7__elem__catalog__flip-page--back-right",proto.cssClasses["flip-page-back-right"]="v7__elem__catalog__flip-page--back-right",proto.cssClasses["flip-page-front-left"]="v7__elem__catalog__flip-page--front-left",proto.createFlipOuterShadowContainer=function(){var e=MainFrame.Util.createElement("div",this.cssClasses["shadow-container"]+" "+this.cssClasses["page-shadow"],this.contentElement);this.outerShadowContainer=e},proto.createFlipInnerShadowContainers=function(){if(this.isDoublePage){var e=this;this.pageContainers.forEach(function(t,a){var i=a%2===0?"left":"right";e.createFlipInnerShadowContainer(t,i)})}},proto.createFlipInnerShadowContainer=function(e,t){var a=MainFrame.Util.createElement("div",this.cssClasses["page-inner-shadow"],e.container);e.innerShadow=a,"left"===t?MainFrame.Util.addClass(a,this.cssClasses["page-inner-shadow-left"]):"right"===t&&MainFrame.Util.addClass(a,this.cssClasses["page-inner-shadow-right"])},proto.createFlipPageContainers=function(){this.settings.static?this.createFlipPageContainers_static():this.createFlipPageContainers_dynamic()},proto.createFlipPageContainers_static=function(){var e=this.settings.pages,t=e.totalPages,a=e.coverType,i="single"===a;if(this.isSinglePage){for(var r=0,n=-1,s=t+1,o=this.currentPage,l=[],c=t;c>=n;n++){var d=!1,g=!1,h=!1;if(r===o)var u="current",d=!0;else if(r===o+1)var h=!0;else if(r===o-1)var g=!0;if(o>r)var u="previous";else if(r>o)var u="next";var m=this.createFlipSinglePageContainer(u),p={};p.page=m,l.push(m),("current"===u||"next"===u)&&(m.container.style.zIndex=s,s--),d?(this.currentPageContainers={},this.currentPageContainers.page=m):g?(this.previousPageContainers={},this.previousPageContainers.page=m):h&&(this.nextPageContainers={},this.nextPageContainers.page=m),r++}this.pageContainers=l}else if(this.isDoublePage){for(var r=-2,n=-1,s=t+1,o=this.currentPage,l=[],c=Math.ceil(t/2);c+1>=n;n++){var f=r,v=r+1;r=v+1,i&&1===o&&(o=0);var d=!1,g=!1,h=!1;if(f===o)var u="current",d=!0;else if(f===o+2)var h=!0;else if(f===o-2)var g=!0;if(o>f)var u="previous";else if(f>o)var u="next";var M=this.createFlipDoublePageContainer("left",u),b=this.createFlipDoublePageContainer("right",u),p={};p.left=M,p.right=b,l.push(M),l.push(b),("current"===u||"next"===u)&&(M.container.style.zIndex=s+1,b.container.style.zIndex=s,s-=2),d?(this.currentPageContainers={},this.currentPageContainers.left=M,this.currentPageContainers.right=b):g?(this.previousPageContainers={},this.previousPageContainers.left=M,this.previousPageContainers.right=b):h&&(this.nextPageContainers={},this.nextPageContainers.left=M,this.nextPageContainers.right=b)}this.pageContainers=l}},proto.createFlipPageContainers_dynamic=function(){if(this.isSinglePage){var e=this.createFlipSinglePageContainer("previous"),t=this.createFlipSinglePageContainer("current"),a=this.createFlipSinglePageContainer("next");this.pageContainers=[e,t,a],this.previousPageContainers={},this.previousPageContainers.page=e,this.currentPageContainers={},this.currentPageContainers.page=t,this.nextPageContainers={},this.nextPageContainers.page=a}else if(this.isDoublePage){var i=this.createFlipDoublePageContainer("left","previous"),r=this.createFlipDoublePageContainer("right","previous"),n=this.createFlipDoublePageContainer("left","current"),s=this.createFlipDoublePageContainer("right","current"),o=this.createFlipDoublePageContainer("left","next"),l=this.createFlipDoublePageContainer("right","next");i.container.style.zIndex="1",r.container.style.zIndex="3",n.container.style.zIndex="6",s.container.style.zIndex="4",o.container.style.zIndex="7",l.container.style.zIndex="2",this.pageContainers=[i,r,n,s,o,l],this.previousPageContainers={},this.previousPageContainers.left=i,this.previousPageContainers.right=r,this.currentPageContainers={},this.currentPageContainers.left=n,this.currentPageContainers.right=s,this.nextPageContainers={},this.nextPageContainers.left=o,this.nextPageContainers.right=l}},proto.createFlipSinglePageContainer=function(e){var t={},a=MainFrame.Util.createElement("div",this.cssClasses["flip-page-single"],this.catalogContainer),i=-1!==window.navigator.userAgent.indexOf("Firefox");if(i){var r=MainFrame.Util.createElement("img",this.cssClasses["flip-page-image"],a);r.src=MainFrame.Util.emptyImageUrl,t.preloadImage=r}var n=MainFrame.Util.createElement("img",this.cssClasses["flip-page-image"],a);return t.container=a,t.image=n,e&&(a.setAttribute("data-page-type",e),"current"===e&&MainFrame.Util.addClass(a,this.cssClasses["flip-page-current"]),"previous"===e&&MainFrame.Util.addClass(a,this.cssClasses["flip-page-back-single"])),t},proto.createFlipDoublePageContainer=function(e,t){var a={},i=MainFrame.Util.createElement("div",this.cssClasses["flip-page-double"],this.catalogContainer),r=-1!==window.navigator.userAgent.indexOf("Firefox");if(r){var n=MainFrame.Util.createElement("img",this.cssClasses["flip-page-image"],i);n.src=MainFrame.Util.emptyImageUrl,a.preloadImage=n}var s=MainFrame.Util.createElement("img",this.cssClasses["flip-page-image"],i);return a.container=i,a.image=s,"left"===e?MainFrame.Util.addClass(i,this.cssClasses["flip-page-left"]):"right"===e&&MainFrame.Util.addClass(i,this.cssClasses["flip-page-right"]),t&&(i.setAttribute("data-page-type",t),"current"===t&&MainFrame.Util.addClass(i,this.cssClasses["flip-page-current"]),"previous"===t&&"right"===e&&MainFrame.Util.addClass(i,this.cssClasses["flip-page-back-right"]),"next"===t&&"left"===e&&MainFrame.Util.addClass(i,this.cssClasses["flip-page-front-left"])),a},proto.updateFlipPageContainers=function(){this.settings.static?this.updateFlipPageContainers_static():this.updateFlipPageContainers_dynamic()},proto.updateFlipPageContainers_static=function(){var e=this;if(this.isSinglePage)var t=0;else var t=-2;e.pageContainers.forEach(function(a,i){e.updatePageImage(a,t+i)})},proto.updateFlipPageContainers_dynamic=function(){if(this.isSinglePage){var e=this.currentPage,t=this.currentPageContainers.page,e=e;this.updatePageImage(t,e);var a=this.nextPageContainers.page,i=e+1;this.updatePageImage(a,i);var r=this.previousPageContainers.page,n=e-1;this.updatePageImage(r,n)}else{var s=this.settings.pages.coverType,o="single"===s,e=this.currentPage;o&&1===e&&(e=0);var l=this.currentPageContainers.left,c=this.currentPageContainers.right,d=e,g=e+1;this.updatePageImage(l,d),this.updatePageImage(c,g);var h=this.nextPageContainers.left,u=this.nextPageContainers.right,m=e+2,p=e+3;this.updatePageImage(h,m),this.updatePageImage(u,p);var f=this.previousPageContainers.left,v=this.previousPageContainers.right,M=e-2,b=e-1;this.updatePageImage(f,M),this.updatePageImage(v,b)}},proto.resizeFlipOuterShadowContainer=function(){var e=this.currentCatalogSize;if(this.isSinglePage)this.outerShadowContainer.style.width=e.width+"px",this.outerShadowContainer.style.height=e.height+"px",this.outerShadowContainer.style.left=e.x+"px",this.outerShadowContainer.style.top=e.y+"px";else if(1===this.pagesOnScreen){var t=this.settings.pages.coverType,a="single"===t,i=this.currentPageSize.width;if(this.outerShadowContainer.style.width=i+"px",this.outerShadowContainer.style.height=e.height+"px",a){var r=1===this.currentPage;if(r){var n=e.x+i;this.outerShadowContainer.style.left=n+"px"}else{var s=e.x;this.outerShadowContainer.style.left=s+"px"}}else{var s=e.x;this.outerShadowContainer.style.left=s+"px"}this.outerShadowContainer.style.top=e.y+"px"}else this.outerShadowContainer.style.width=e.width+"px",this.outerShadowContainer.style.height=e.height+"px",this.outerShadowContainer.style.left=e.x+"px",this.outerShadowContainer.style.top=e.y+"px"},proto.centerPageForFlip=function(e){var t="function"==typeof e.onComplete?e.onComplete:function(){},a="undefined"==typeof e.animated?!0:e.animated,i=this.settings.pages.useShadow,r=this.catalogContainer,n=this.outerShadowContainer,s=this.notesContainer,o=this.getDimensionX(),l=this.currentPageSize,c=this.currentCatalogSize,d=l.width,g=(o-d)/2,h=this.settings.pages.coverType,u="single"===h;if(1===this.currentPage&&u)var m=2*c.x,p=-g+m;else var p=g;if(a){var f=.2;i&&TweenMax.to(n,f,{left:g}),s&&(s.style.opacity="1",TweenMax.to(s,f,{left:g})),TweenMax.to(r,f,{left:p,onComplete:t})}else i&&(n.style.left=g+"px"),s&&(s.style.opacity="1",s.style.left=g+"px"),r.style.left=p+"px",t();MainFrame.Publisher.publish(this.id+":resized",{})},proto.uncenterPageForFlip=function(e){var t="function"==typeof e.onComplete?e.onComplete:function(){},a="undefined"==typeof e.animated?!0:e.animated,i=this.settings.pages.useShadow;if("undefined"==typeof e.duration)var r=.2;else var r=e.duration;var n=this.catalogContainer,s=this.outerShadowContainer,o=this.notesContainer;if(a){if(i){var l=1===this.currentPage,c=this.isLastPage(this.currentPage);l?TweenMax.to(s,r,{left:this.currentCatalogSize.x+this.currentPageSize.width}):c?TweenMax.to(s,r,{left:this.currentCatalogSize.x}):TweenMax.to(s,r,{left:this.currentCatalogSize.x})}TweenMax.to(n,r,{left:this.currentCatalogSize.x,onComplete:t}),o&&(o.style.opacity="0",o.style.left=this.currentCatalogSize.x+"px")}else n.style.left=this.currentCatalogSize.x+"px",o&&(o.style.opacity="0",o.style.left=this.currentCatalogSize.x+"px"),i&&(s.style.left=this.currentCatalogSize.x+"px"),t();MainFrame.Publisher.publish(this.id+":resized",{})};var proto=MainFrame.Element.Catalog.prototype;proto.cssClasses["slide-container"]="v7__elem__catalog__slide-container",proto.cssClasses["slider-container"]="v7__elem__catalog__slider-container",proto.cssClasses["slide-page-container"]="v7__elem__catalog__slide-page-container",proto.cssClasses["slide-page-wrapper"]="v7__elem__catalog__slide-page-wrapper",proto.cssClasses["slide-page-double"]="v7__elem__catalog__slide-page-double",proto.cssClasses["slide-page-image"]="v7__elem__catalog__slide-page-image",proto.cssClasses["slide-page-left"]="v7__elem__catalog__slide-page--left",proto.cssClasses["slide-page-right"]="v7__elem__catalog__slide-page--right",proto.createSlideOuterShadowContainers=function(){this.currentPageContainers.outerShadow=this.createSlideOuterShadowContainer(this.currentPageContainers),this.nextPageContainers.outerShadow=this.createSlideOuterShadowContainer(this.nextPageContainers),this.previousPageContainers.outerShadow=this.createSlideOuterShadowContainer(this.previousPageContainers)},proto.createSlideOuterShadowContainer=function(e){var t=MainFrame.Util.createElement("div",this.cssClasses["shadow-container"]+" "+this.cssClasses["page-shadow"],e.wrapper);return t},proto.createSliderContainer=function(){var e=MainFrame.Util.createElement("div",this.cssClasses["slider-container"],this.catalogContainer);this.sliderContainer=e},proto.createSlidePageContainers=function(){if(this.isSinglePage){var e=this.createSlideContainer();this.previousPageContainers={},this.previousPageContainers.main=e.main,this.previousPageContainers.wrapper=e.wrapper;var t=this.createSlideContainer();this.currentPageContainers={},this.currentPageContainers.main=t.main,this.currentPageContainers.wrapper=t.wrapper;var a=this.createSlideContainer();this.nextPageContainers={},this.nextPageContainers.main=a.main,this.nextPageContainers.wrapper=a.wrapper}else if(this.isDoublePage){var e=this.createSlideContainer(),t=this.createSlideContainer(),a=this.createSlideContainer();this.previousPageContainers={},this.previousPageContainers.main=e.main,this.previousPageContainers.wrapper=e.wrapper,this.currentPageContainers={},this.currentPageContainers.main=t.main,this.currentPageContainers.wrapper=t.wrapper,this.nextPageContainers={},this.nextPageContainers.main=a.main,this.nextPageContainers.wrapper=a.wrapper}this.settings.pages.useShadow&&this.createSlideOuterShadowContainers(),this.createSlidePages()},proto.createSlidePages=function(){if(this.isSinglePage){var e=this.createSlideSinglePageContainer(this.previousPageContainers.wrapper);this.previousPageContainers.page=e;var t=this.createSlideSinglePageContainer(this.currentPageContainers.wrapper);this.currentPageContainers.page=t;var a=this.createSlideSinglePageContainer(this.nextPageContainers.wrapper);this.nextPageContainers.page=a,this.pageContainers=[e,t,a]}else if(this.isDoublePage){var i=this.createSlideDoublePageContainer("left",this.previousPageContainers.wrapper),r=this.createSlideDoublePageContainer("right",this.previousPageContainers.wrapper),n=this.createSlideDoublePageContainer("left",this.currentPageContainers.wrapper),s=this.createSlideDoublePageContainer("right",this.currentPageContainers.wrapper),o=this.createSlideDoublePageContainer("left",this.nextPageContainers.wrapper),l=this.createSlideDoublePageContainer("right",this.nextPageContainers.wrapper);this.previousPageContainers.left=i,this.previousPageContainers.right=r,this.currentPageContainers.left=n,this.currentPageContainers.right=s,this.nextPageContainers.left=o,this.nextPageContainers.right=l,this.pageContainers=[i,r,n,s,o,l]}},proto.createSlideContainer=function(){var e={},t=MainFrame.Util.createElement("div",this.cssClasses["slide-page-container"],this.sliderContainer),a=MainFrame.Util.createElement("div",this.cssClasses["slide-page-wrapper"],t);return e.main=t,e.wrapper=a,e},proto.createSlideSinglePageContainer=function(e){var t={},a=MainFrame.Util.createElement("div",this.cssClasses["slide-page-single"],e),i=-1!==window.navigator.userAgent.indexOf("Firefox");if(i){var r=MainFrame.Util.createElement("img",this.cssClasses["slide-page-image"],a);r.src=MainFrame.Util.emptyImageUrl,t.preloadImage=r}var n=MainFrame.Util.createElement("img",this.cssClasses["slide-page-image"],a);return t.container=a,t.image=n,t},proto.createSlideDoublePageContainer=function(e,t){var a={},i=MainFrame.Util.createElement("div",this.cssClasses["slide-page-double"],t),r=-1!==window.navigator.userAgent.indexOf("Firefox");if(r){var n=MainFrame.Util.createElement("img",this.cssClasses["slide-page-image"],i);n.src=MainFrame.Util.emptyImageUrl,a.preloadImage=n}var s=MainFrame.Util.createElement("img",this.cssClasses["slide-page-image"],i);return a.container=i,a.image=s,"left"===e?MainFrame.Util.addClass(i,this.cssClasses["slide-page-left"]):"right"===e&&MainFrame.Util.addClass(i,this.cssClasses["slide-page-right"]),a},proto.placeSlideContainers=function(e){var t=this.currentSlideIndex,a=t-1,i=t+1,r=this.previousPageContainers.main,n=100*a;r.setAttribute("data-index",a);var s=this.currentPageContainers.main,o=100*t;s.setAttribute("data-index",t);var l=this.nextPageContainers.main,c=100*i;l.setAttribute("data-index",i);var d=100*-t;"horizontal"===e?(this.sliderContainer.translatedX=d+"%",this.sliderContainer.translatedY="0",r.style.left=n+"%",s.style.left=o+"%",l.style.left=c+"%"):(this.sliderContainer.translatedX="0",this.sliderContainer.translatedY=d+"%",r.style.top=n+"%",s.style.top=o+"%",l.style.top=c+"%"),MainFrame.Util.setTransformDuration(this.sliderContainer,0),MainFrame.Util.setPosition(this.sliderContainer,this.sliderContainer.translatedX,this.sliderContainer.translatedY)
},proto.updateSlidePageContainers=function(){if(this.isSinglePage){var e=this.currentPage,t=this.currentPageContainers.page,e=e;this.updatePageImage(t,e);var a=this.nextPageContainers.page,i=e+1;this.updatePageImage(a,i);var r=this.previousPageContainers.page,n=e-1;this.updatePageImage(r,n)}else{var e=this.currentPage,s=(this.settings.pages.totalPages,"single"===this.settings.pages.coverType);s&&1===e&&(e=0);var o=this.currentPageContainers.left,l=this.currentPageContainers.right,c=e,d=e+1;this.updatePageImage(o,c),this.updatePageImage(l,d);var g=this.nextPageContainers.left,h=this.nextPageContainers.right,u=e+2,m=e+3;this.updatePageImage(g,u),this.updatePageImage(h,m);var p=this.previousPageContainers.left,f=this.previousPageContainers.right,v=e-2,M=e-1;this.updatePageImage(p,v),this.updatePageImage(f,M)}},proto.resizeSlideOuterShadowContainers=function(){if(this.isSinglePage){var e=this.currentPageContainers.outerShadow;e.style.width="100%",e.style.height="100%",e.style.left="0",e.style.top="0";var t=this.nextPageContainers.outerShadow;t.style.width="100%",t.style.height="100%",t.style.left="0",t.style.top="0";var a=this.previousPageContainers.outerShadow;a.style.width="100%",a.style.height="100%",a.style.left="0",a.style.top="0"}else{var i=this.currentPage,r=(this.settings.pages.totalPages,"single"===this.settings.pages.coverType);r&&1===i&&(i=0);var n=i,s=i+1,o=this.pageReferences[n],l=this.pageReferences[s],e=this.currentPageContainers.outerShadow;o&&l?(e.style.width="100%",e.style.left="0"):o?(e.style.width="50%",e.style.left="0"):l&&(e.style.width="50%",e.style.left="50%"),e.style.height="100%",e.style.top="0";var c=i+2,d=i+3,g=this.pageReferences[c],h=this.pageReferences[d],t=this.nextPageContainers.outerShadow;g&&h?(t.style.width="100%",t.style.left="0"):g?(t.style.width="50%",t.style.left="0"):h&&(t.style.width="50%",t.style.left="50%"),t.style.height="100%",t.style.top="0";var u=i-2,m=i-1,p=this.pageReferences[u],f=this.pageReferences[m],a=this.previousPageContainers.outerShadow;p&&f?(a.style.width="100%",a.style.left="0"):p?(a.style.width="50%",a.style.left="0"):f&&(a.style.width="50%",a.style.left="50%"),a.style.height="100%",a.style.top="0"}},proto.centerPageForSlide=function(e){var t="function"==typeof e.onComplete?e.onComplete:function(){},a="undefined"==typeof e.animated?!0:e.animated,i=this.settings.pages.useShadow,r=this.currentPageContainers.outerShadow;if(1===this.currentPage)var n=this.currentPageContainers.right.container;else var n=this.currentPageContainers.left.container;if(a){if(i)var s=[n,r];else var s=[n];TweenMax.to(s,.2,{left:"25%",onComplete:t})}else i&&(r.style.left="25%"),n.style.left="25%",t();MainFrame.Publisher.publish(this.id+":resized",{})},proto.uncenterPageForSlide=function(e){var t="function"==typeof e.onComplete?e.onComplete:function(){},a="undefined"==typeof e.animated?!0:e.animated,i=this.settings.pages.useShadow,r=this.currentPageContainers.outerShadow;if(1===this.currentPage)var n=this.currentPageContainers.right.container,s="50%";else var n=this.currentPageContainers.left.container,s="0%";if(a){if(i)var o=[n,r];else var o=[n];TweenMax.to(o,.2,{left:s,onComplete:t})}else n.style.left=s,i&&(r.style.left=s),t();MainFrame.Publisher.publish(this.id+":resized",{})},!function(){MainFrame.DataParser.elements.catalog=MainFrame.Element.Catalog,MainFrame.DataParser.elements.pagePreview=MainFrame.Element.PagePreview}(),!function(){var e={parseDiaporamaCatalog:function(e){MainFrame.DataParser.basicParse.call(this,e),MainFrame.DataParser.getSliderId.call(this,e),MainFrame.DataParser.getLoadingTemplateId.call(this,e),e.attributes.catalogDiaporamaId&&MainFrame.DataParser.parseDiaporamaCatalogSettings.call(this,e.attributes.catalogDiaporamaId)},parseDiaporamaCatalogSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);MainFrame.DataParser.getType.call(this,t),MainFrame.DataParser.getSourceModule.call(this,t),this.isStatic="true"===t.attributes["static"]?!0:!1,this.useCatalogBorders=!0,t.attributes.useCatalogBorders&&(this.useCatalogBorders="true"===t.attributes.useCatalogBorders?!0:!1),t.attributes.pageTemplateId&&(this.pageTemplateId=t.attributes.pageTemplateId),this.autoLoad=!0,t.attributes.autoLoad&&(this.autoLoad="false"==t.attributes.autoLoad||"0"==t.attributes.autoLoad?!1:!0),this.autoDraw="false"===t.attributes.autoDraw||"0"==t.attributes.autoDraw?!1:!0;var a=this.sourceModule;if(t.attributes.pageRange){for(var i,r,n=t.attributes.pageRange,s=n.split("-"),o=parseInt(s[0],10),l=parseInt(s[1],10),c=a.getPageForPageNumber(o),d=MainFrame.Util.zeroFill(c),g=a.getPageForPageNumber(l),h=MainFrame.Util.zeroFill(g),u=0,m=0,p=!1,f=a.pages.length;f>u;u++){var v=a.pages[u];-1!==v.numbers.indexOf(d)&&(i=u,p=!0),p&&m++,-1!==v.numbers.indexOf(h)&&(r=u,p=!1)}this.pageRange={start:i,end:r,length:m}}else{var f=a.isSinglePage?a.settings.pages.totalPages:a.landscapePages.length-1;this.pageRange={start:0,end:f-1,length:f}}for(var u=0,M=t.childNodes.length;M>u;u++){var b=t.childNodes[u];"currentPage"===b.nodeName&&MainFrame.DataParser.parseDiaporamaCatalogCurrentPage.call(this,b),"standardPage"===b.nodeName&&MainFrame.DataParser.parseDiaporamaCatalogStandardPage.call(this,b)}},parseDiaporamaCatalogCurrentPage:function(e){this.currentPageSettings={},MainFrame.DataParser.getBorders.call(this.currentPageSettings,e)},parseDiaporamaCatalogStandardPage:function(e){this.standardPageSettings={},MainFrame.DataParser.getBorders.call(this.standardPageSettings,e)}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.ApplyEasingDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getTarget();switch(t.easing?e=t.easing:(e=new MainFrame.Easing,t.easing=e,e.onTranslationDispatch("easeMoveDiaporama"),e.onCompletionDispatch("easeEndDiaporama")),t.type){case"horizontalList":case"selectionHorizontalList":e.setScrollLeftLimits(t.scroller.leftLimit,t.scroller.rightLimit),e.setScrollTopLimits(0,0),e.setOptions({scrollingY:!1});var t=t.scroller;break;case"verticalList":case"selectionVerticalList":e.setScrollLeftLimits(0,0),e.setScrollTopLimits(t.scroller.topLimit,t.scroller.bottomLimit),e.setOptions({scrollingX:!1});var t=t.scroller;break;default:e.setScrollLeftLimits(t.scroller.leftLimit,t.scroller.rightLimit),e.setScrollTopLimits(0,0);var t=t.scroller}e.setTarget(t),e.addListeners(),e.setScrollPosition(-t.translatedX,-t.translatedY);var a=this.getParam("sourceEvent").currentEvent;e.startWithEvent(a),this.endAndClearAction()}}),MainFrame.Action.DrawDiaporamaPages=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("redraw");if(e){var a=e._pagesDrawn&&"true"!==t;if(a)this.endAndClearAction();else{e.setLoadingScreen();var i=this;setTimeout(function(){for(var t=0;t<e.totalDiapos;t++){var a=e.diapos[t];e.drawPageForDiapo(a.page,a.index)}e.removeLoadingScreen(),i.endAndClearAction()},200),e._pagesDrawn=!0}}else this.endAndClearAction()}}),MainFrame.Action.MultiSelectCheckAll=MainFrame.Abstract.Action.extend({startAction:function(){for(var e=this.getTarget(),t=this.getParam("checkButtonId")||"selectPage",a=0,i=e.diapos.length;i>a;a++){var r=e.diapos[a].page,n=r.getSubObjectWithRole("diaporama-select-checkbox")||r.getSubObjectWithId(t);n.check()}for(var s=1,o=e.sourceModule.settings.pages.totalPages;o>=s;s++)e.selectedPages[s]=!0;MainFrame.EventHandler.dispatch("pageSelectionChanged"),this.endAndClearAction()}}),MainFrame.Action.MultiSelectCheckPage=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("diaporamaId"),a=MainFrame.Manager.Scoping.getById(t),i=this.getParam("checkButtonId")||"selectPage",r=e.getSubObjectWithRole("diaporama-select-checkbox")||e.getSubObjectWithId(i);r.isChecked()?(r.uncheck(),a.selectedPages[e.page]=!1):(r.check(),a.selectedPages[e.page]=!0),MainFrame.EventHandler.dispatch("pageSelectionChanged"),this.endAndClearAction()}}),MainFrame.Action.MultiSelectDownload=MainFrame.Abstract.Action.extend({startAction:function(){for(var e=this.getTarget(),t=(this.getParam("checkButtonId")||"selectPage",this.getParam("errorNoSelectionMessageId")||"noPagesSelected",this.getParam("errorInteractifPdfMessageId")||"interactifPdfError",this.getParam("catalogId")||"catalog"),a=MainFrame.Manager.Scoping.getById(t),i=this.getParam("catalogPdfPath")||a.commonDataSrc+"catalogue.pdf",r=decodeURIComponent(this.getParam("interactifPdfUrl")),n=decodeURIComponent(this.getParam("interactifPdfGetUrl")),s=this.getParam("prefixName")||"",o=[],l=1,c=a.settings.pages.totalPages;c>=l;l++)e.selectedPages[l]&&o.push(l);if(null!==this.getParam("selectionPath")){var d=this.getParam("selectionPath");-1===d.indexOf("http")?d=MainFrame.Util.getAppURL()+d+"/selection.html?url=":d+="/selection.html?url="}else var d=MainFrame.Util.getAppURL()+"common/selection.html?url=";var g=o.length;switch(g){case 0:MainFrame.EventHandler.dispatch("customError",[{errorMessageId:"multiSelectNoPagesSelected"}]);break;case 1:var h=o[0],u=a.pageReferences[h].pdf;window.open(u,"_blank");break;case c:var m=MainFrame.Util.isAbsoluteUrl(i);if(m)var u=i;else var u=MainFrame.Util.getAppURL()+i;window.open(u,"_blank");break;default:var p="download";this.getPdfSelection(p,s,o,r,n)}this.endAndClearAction()},initLoadingWindow:function(){var e=window.open(),t='<img id="loading" src="data:image/gif;base64,R0lGODlhHgAeAPf2AP7+/v39/fDw8O/v7/z8/PHx8e7u7vv7++Xl5fr6+vn5+ebm5gAAAPX19fT09Pb29vPz8/f39/j4+Ofn5/Ly8tTU1O3t7dXV1cnJyezs7Ojo6Orq6uTk5OPj476+vuvr69nZ2cjIyNbW1unp6crKytjY2MvLy9zc3LOzs7KyssfHx+Hh4b+/v9/f3+Li4tPT097e3sDAwNfX193d3dra2sHBwYmJidvb2+Dg4L29vby8vM/Pz7e3t9LS0sTExNDQ0LS0tIiIiLW1tcbGxszMzLi4uLq6uoyMjHBwcMPDw8XFxVhYWLGxsXFxccLCws7Ozra2trCwsG9vb42Njbm5uc3NzXNzc4qKilpaWtHR0bu7u3JycpKSkjs7O3Z2dq+vr66urj09PVlZWaioqKSkpISEhIKCgpqaml5eXnR0dJGRkSIiIltbW2lpaaWlpYaGhouLi1NTUz4+PqmpqXh4eI6OjpWVlZCQkJSUlJ6enpiYmJycnKqqqmpqakNDQ4eHh6Kiop+fn6ysrCUlJW5ubklJSa2trVRUVIODg4WFhUBAQCAgIKGhoV9fX0FBQYGBgaamppaWlmxsbFxcXGBgYFdXV5OTk5mZmTY2NiQkJB8fH21tbXl5eVBQUDw8PHt7ez8/P11dXX9/fzU1NSgoKJubm2dnZzQ0NDMzM52dnVFRUWtra5eXlyoqKk5OTiMjI1VVVQoKCmRkZE1NTaurq0ZGRjk5OTc3N35+fo+Pj0VFRX19fSEhISkpKURERBsbGywsLCcnJ6enpxgYGB4eHmJiYlJSUhoaGk9PT3V1dWFhYR0dHUdHRwUFBQcHBzg4OICAgCsrK6CgoFZWVi4uLmNjY3x8fGhoaGZmZkJCQkhISBYWFmVlZTo6OkxMTBISEnp6eqOjoxUVFS0tLQsLCxwcHBcXFzIyMhkZGRERERMTEzExMQ8PDw4ODiYmJgICAnd3d0pKSgQEBDAwMA0NDf///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgD2ACwAAAAAHgAeAAAI/wDrCRxIsKDBgwgRNoCQsGHCO1YcNgwgZMBAAJjMPRgY4AEAiQOnxbFYD0EsBkQEBihgIABIgTbETWJYgwEDQPVWDijwUuCQYJoe1Rtj8009BwIENOhZT4GqYK+o8GnHDhGAnQIIOIxxhcoIgXuGUbNDYcGEDA0MCGBYLwGFDAIMtuiESZUZDBZ2lTCoYECCBxkWIOgQ4SAMLF1AdZnTsECHBZCXIpzgpYu2vQklIEAwobBDMmokZjDwMaGDFSVOsG2YwAEFBwoKQmAxRUq1SZNgSJQgosIFGTA2xK6nIQiaSkvELKEhMcKFCxWi01hdb4ISQXkCLZCYYIILBBk8JsTMUEMiAp4OA9T4hOREQwgYSOA4kDCAMEJW+uhpCGKIiRAXJHCQBIC0IQU0goygAg4GDQBCAzg8gYEKFdBXUAicXFJDXB0EcYQQFFhgAAQgxKDFdgpMIIMJLhj0wEYDfXFFEEMskAITN0zgQQwmuCTQAQI2NAAXNrgRQAcopABCPT14wIIFTFWRCB4f1LNAku41oIQOS/YExhQtCCQAFChMIFABSWBQGkgxIDDQAR7wAONRJWjFFEE/DHGnQwVAueefBgUEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEhwoAEDBRMqXFjHxsKHAgHUeDCQQC0/CQY6+BIA4kBJdCQIvDEOWAmBB1zJqedRYKlzIe1pGZQJij0FnRjQaSnwSbYud+y54bWIkb0tDBjE4GnvARZffmaQyTQo3JOkpDIuBKKGxwKBbjAxgwLhBowHWsoxCCJQgQMBDgh2KBZH1hQaFB7RSCgA2ogDAgYIMCCSIAhJbBLzgAjBQIECAyIotGCmEqUTEBMYCKxVYYAidloKgNBRoQB7J2Yg9HigQYQICQAIdOCBi7VkVja94MlhAYIFGgYQsKdmixQkSNr8aCmh9wLfCyT3rMEDSIeWBwwMKAChcEIDPoZDt8wgfWE9JQ2vP0xQ4sIClgkjgLEx5Q0tiBxeyLgAI2ECYWXYYAkLEvSwQUIQtEAAAiJc8MIJ4glkgh6GmACBPQukIMQFhUngAgkqHGjPCC2UoAFBCsgWUQxCoDABBzro4MIHIZBQAXz2ABChQlAA4UQ9HHjggQv2vEACCRQwRUMUVJymAQsefOXAEyqo15IKPKxmTwwsDCAQBCZcgCNEO5w2kBI+dAbBCSp6VNpAFfTAVEsUXNhSQAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcKAACgUTKlzIhcvChwIPJEkwUMGSaREGPrB3AOJAL4gcDNTlC4RAC4dmeRx4plMZBfaGOAJVw96DJdtWDjTBZokbezrkhBFi79GiVyl02ouwBU0oGEEVFXGyppUcAQ9j6GHBQWAOWGi+FDjRAsKYLsP2CBTB5ZAagiM+9fHCyh6AOzISZvhTwEmhZgzUzSjY4RGSLU2iQBTEoPGyCgozsJLSZAdECKcYFMLxsJ6TPCt53KmnEMCADjBaDFhZr14CCQoCCISQRJqaI3De0Fh5wIIAAQMOHhghbIqN42VKrExgocDvAQZg2jMAosqQJBtWBnDgoMED6QkbXLAgfbkBRAIVgKAYcR4BBwuyEypQkgJKiiEAHn7gMAGBho4FJRFFCkWAcMAFHyR0wAa9IeCgBgXRoAMGJ5i3QQ4e5HWQAhuAUEEBAgnwwQIGEASgQAGQEEMOHHygggoaFPCCCDTkN1B8ClnAAgtP2LMBBhhAeIIIFyhlDwg6+GBeBkBmJ0EJFSCgFAZOYGVPASRgMJADFwymXQkICaQAEVWA90AHSpE3kAh5GQmRSDoFBAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcOAGDQUTKlyYh9XChwLrhaAwkMAWSRIGFkhRD+JAO38aCORACQ0MgRGwtfE4kEebSAfsPWGDRYW9AHRORWIpcIYVQl/sxRAjpoi9PZ4UmXgIgGA9NVaagHACa0mOHaD8YGs6MABBDGRiuPC6gxASewJudGgA5dAoowlUBLF3hKADPWXgBHqh4FKFhBQCZTDkzd0vTB0KCthzZUoQPl4XchnWapAcGgodgLERxObDAYqWhVoAUQSkCB7HAHr4IAOCDzwJ1ChCZENHew1ExOABBAWY2LwYMIi1TtQCCiao9PZ9g2WAV8IZfJvUQuABCy5O4LDAMkEpO4Z6SLa4XXBAj5gQG0R+KMODjhUeLQwQQGAhEQ9OcmCAOGAABQEGJEQACTp4kMQNEoAggIAGKADBfAUMUNAMSfTAgQL2GBACBjAcIMEBBxSAQAcQ2EOAAwAWQFB9A9VTgQkhjCBABSJkAAECEyDUFVcKFYABBiUIVMFf9mywAAIi8eSCCj8kkOGQGZg4AQLc8XSBCQ8I1MAFFVBkTwII6OhRPSs4UFEJMqBnjwIZkMfTQDic9CZLXnoUEAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcKCBEQUTKlw4JtXChwIB7HAwMEGZXQ8GPjBCAOJAPqwyCPzAKc2KkV5weRyoAtEeCPZmpGnywt6DXZ3IrBQ4oU4QJvZ6NEESwl6gSqFqLgxAMACjIzZo/OjTRkUJNo2aSHh4woeIDQeC/rGRQgORLAbAyDokxN6BC2S20CKoIMcXIDluBACzIyxBDW4cCJGla1ScDQUheEghJEUIvwrn3PITZtIMhRGIoEjRwiMWW2ZEPvxgAvLCIloWJihgb8ICATuFGPLQY8DAF0pisPBgBMZKCrc0DWplq4+IBll81Njde2WDbsQGRbNVLIvABBQ2cOgA2yMAFJCoVLrorhAEU4hKgEBUcAJDiA8e5TBoJLpghCwYTIQQUe8hDwYAjuMbQQn8MAQJP7hwAAIUJUQBBWfMA+AiCA00QQ8tGNBRBi/IsIA9EWxFgQEGNCCQCWYwg0dT/UVEgwgvCACBCy4I8MAABQxwnj317JiQAyJcAAMAECCAAGsFCCBABDu19kIJWzVgJEUHGCAABU3OIEODCiywAJP2KEAiACsBsIACAwXgWgIDEQCBj03as4EGcXokwVYrBQQAIfkEBQoA9gAsAQABABwAHAAACP8A7QkcSHCghQ0FEypcyGPOwocDQTQYeOCMJYINWByAODAEDwMDc02ZIDDDmyMcB9KIYmTiiiNXZNhrMOUak5QCBwhBEcLeiSs2qtgbQ8gKCJwCYwhJsYBGGURP7DVJ8ycBwY0DOWA4arVDCiAkPvzokeFLsj4s7CkYKurmwAQhtLBQMuPAkxUECAJYMeeBjjRoVCERUPABCQ81PJjI+zAOGjFpOChMIMNDDhcQR7RZEonwwwwVAnA0smOhAgoWBBZIKaEIFB8XPD+QUYUEBgxKJHM0EK+LIj/IvNx4cGOHCdtKSHIsMCuMn0KVzKwQSKDBgA0jHKQMoKLGDxcPFkK0QFCPYwpAHHG8EDHxoYNCx6q1WAjigogKHSAyOUZqTZfSBZXwwgUgaBDABhIoNIYGkMwSDTqjYDaQBicsQIFoBXCAQAYEKJBAPTncwkAQ9hywAx6hqKEXQQFMMAECBTyQgQUEGMEAA4skiFMECCyAUAQFCKDdFjd6gNQAHCxglQQCCDDRA3IwsAVSGiAQwUADCLCWPRnYgkp5HNUjgFXUZcmYPREEQiZSAxUwAJscHbAlRwEBACH5BAUKAPYALAIAAQAbABwAAAj/AO0JHEhQIAQDBRMqVPhDycKH9urNIBggB48IAyP4gDiwipMCAgtAQaHBYKpLADjaO6Fjo70FKFBMlMCojBCVAlmwIGJvRUwR9qDYsCFjYT2CAEzE8DACARgwNEYcqaNHAcGjAhf0aDEg5YQcHp4YODFRy5s/GCJ24GGpCMEsKjBkmWBvx40EBA/8gGSvh6U0fUR9IJjgAgYTIbIceAhokxUpUwQkJHADQ4iSD1ekkZLKwUMDNLA+pJJFIQEHBjQYkKDSgQcjQ2Y8ELiixIUKFXqA5KiBzRIsaFbdaVH7doUXDVQOaPQbjSRLOASiHmGBNccESWDDwJiwgQWVOYw8sCTwAQEH6wslUHoGTnJBAhoWTEAwAmIUTNnCyBo88MACBAhMUEACBlhVEARwLJBEE7qMEkcHAw0wgQXJ2dPAABZAoABrCnjgiDl4RHSDNEgEMpBo9gAwQAECBDDHMprk8sQawHiym0AoFrTiAPWMwQADiAi0xhpR4ERBAQjZw8KPe9hTgDfHNIHTAKsJhEMzDCQh0ATMgBKAShRQFAw5Nw5wxGw4EZSGK2lyhAAIOAUEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEhwYAIIBRMqXAjDxMKHAzs4GAiASIwHAw+AUABxoAgSAwRGSOJhgsAHTowQ6CiQgwoiEwew8CCQgJIvKlgKhECCRA8AG1iwAGHvRQoUNx4GAEDwI4YOI7RoEWEACJQiEQiuHLihxAoDB+wJCBGiAoUOHQxcYMKkxMAYjLQwFXjgxIsLJTQQgIEg7EACC0JIKOHmSCI1CwoegFFBRoUTcxWieHPExpkNCgOsqHBBAEQYcIK4CfkQggaWSSo8fEBBwIAELCE4qUGkRQOBCT4sQIBgAQeMHREgkYLECq5AHQ5kmMAbQYesHTU0kdIkjRkyHAQGiAChwAC/EBWYxRiyYwVHhREKsGQRo6NrC+cXUpACC5fJhAcGFKAwgPRCKktMggUSMxREgAGuDeAAAJCoV1ADl12ACCVxUELUQA8YoN5KGDDQChn2FFAABENgcUoeAs0giBmAEARAZPWowgADb/iAySiJZAGKL3FYQFAAD4HQDAO+2KMDL5pYYw8gnoTBh0724MGAJh3YY0Iva9xhTwCfoMIJlJ0Q84JAI9yyiBACUWCFMfE9BMAZKwxUjxi9VIlbFBNBSRArbOjZkQUt6BQQACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEiQYIOCCBMqXJAFgMKHAjkQrCcihIOBBFpAJIijggCBCqqE0CBQAhEnBzYK/FBBhEAKJDBoBLBDRxWVAh9cEAGCgAASJG7YO+HBwwmIAQbWa3GhggYDQ1TQsMeihpODCiEg+FAggb0GO3FEsPBBwAwdOUDYA8CyBhGCBEYgmGsgwQgKDgcGGPHkwQQnQKIIyVCQwAYEE+ZC/MFECBAjFhRmQNDh4sMMUJjEoACxgQGVMiQqlNAAAoWUKkmY6LECYwEDAwQIMCBB5YQgQWzAwWPIHgEKA4LPVqByhI0gV6boSTFhoIIHDQLUUxmhwg8ZC2onLEJLpQ4WSLcwshA3AqIGcJLgIEgYAQuD9/AgapGypYmoowQhKHoPLI+FPDAglIEeBsxwiRerNFECQUXIkUYOxO3AyylcPPDBBoSZYowbEelghyAESUdQG4MQY0YFhdRyxQqUNMJNeQPlldAJ1GQyiwQXOOLJFfagIIYYYOBkDxm/nOJSC4WEcYY99ViiCiJC9gEMBgI1sEQXRggUQR3XRIDTHmoNxIkj6wkEgA4QCFkQCpvIqGZCDoi2UUAAIfkEBQoA9gAsAQABABwAHAAACP8A7QkcSJBggYIIEyq0UKKewocCBzwgiONFg4EAXESAOPBDh4v2AoCokEGgSBUbOdorgADBRQkiLiCwVw9EiCwAVNpTgGACggMPLlzAYW9FCAwtHtbLOXDDggUfIlyogMABCSIkIBBkKvCBBQEODth7wIHDiAQPHkjgECLEQAM0TPzYKqCAAAMUCGRo4HBgPQhZHBiowsKDBwsFAwyoK+ADxBM6YsSo4TihXQsTHwqI4QGDAIj1HKi84UJhgBtALtUpyfEBjBswRqSEYG3NOwYMnJXmCCFFChQoePhY4AAaKXm4dauEgMI3iiJDMLYokurMZ5UrTuConPAFI5VJTEC1TPAnWC8RHHMFYTRBIbdF0dCZgqgiyJEjd2YUBFBt25ouXFAwBggIaWDHBBPwccQfV+wmEBW1WCHIAPaAIIc2dTTAwQoaYGCFJIAINIEPwjDBlVgEJaKIJ1ds0MgSpRjgxYwL7KdQBq44IkYDGiiDRSn25EAIEkDoZA8Vz7hSgj0DmCLGHAKNsQocRsKhywUmeTGNDwLVAwkSFHJUTwonEBTJEgTV44QBRhaEwSd9tfmQfioFBAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcGCABgUTKlzooEOAhRAFOohA8AOHghoiEqRggeCEBQYGrqigQKPABwIGPLCXYMGCDQI7vLjx0GQCAxRCSkAwYYS9DRUurIAYoB5BAQUKUHjggsMECTJkVChQEMDAEF0IUVmpwIDXAxEkKBhQokILe/UacBBRgmA9NAwYZPqD4AHFggc6RBBQwkQIFT7dtonLAIvRhRxUkFgcOKEZZ+QqRHxQJcSOkBBl5DHpAkfNgglcYEDx5YNJBS43FJAgkMKUQudIvSoXwqQDDzk81PBRRfWjbqQyrfmlxDZuDyxqYFggEMILI+H2XNSooIOLBRYaWE2ogc92iDRwRLUEQAtZmNoQKRhhUqNjwnpcuvh5pixBZiZAgPBg7vYIqjBxqDGBD08kNAETH2zggxBMoDABQTuw8QgPHVlgChZHFDBDeDvYkEgKAhkgQhIqfJbAZ/aQIcYSkYxgxSZ4ZMDFFHXgBZEDhLCxygAW0NHEJfZ0aAMVJgn0wxLK/GBPAbtIQYZAUJQhzXcRzXHIEAPBsYoRAhEQxRQQFMkDEQTN0UZbXYYwQJEJVZCIfWxG1AAMRQYEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEiQoISCCBMqfJDhgMKHAmv8IFhgQISB9QoogDiwVCwfAwUIcCAQgAUXFznae8IgHQZ7BAQUKCDQAoIJBFTakzCIATUH9WQKsAcBwYIPDwkAINiGAYNN9QwMMKBgwQQEJBVWgSWqCEkaseiZCUAgwYEGHG4GsBdhA44TCQg2+pbJTyQFZ0wk1ABBAQ4RFXogJTgA26Jev/pAhCDigowLGhISSLRGUw6IAU68uDAAYg46DzhuWHAQYUYQIZxwUHngwwcLEHLaS0CF06FajlB9UamARAgMJn7cEBDBjjFFYcKgEqRSAobnGEjs2CBQQo8oqdQQ0dmixQq+axFSxIhCgSOOFrIT1gthKg7IhxKU6DCRtSAAQ6HQVEqWMuEKLTXEkMQICLmBTCXFcDGACu8R1IAKBYxAggc5eGABQQjQUQYfqxWAixR2ZNBBCxp0wEMU2wUwwgUk/LDUQA4NlIIUSJxRwB1v8KEAFVCgcOFA6SFEwBVNfJLBA3hcYYg9N6SAggg62bOAF0iQwJYeQUBhDwAkRFFDeBwpcQ0LA+XxhgoCHaBCCvVBVIVeAzFRxgkEvTBUlARdkEubeCIUAZQqBQQAOw==" style="width: auto; height: auto; margin: 0 auto; display: block;">';return e.document.write(t),e},getSelectedPagesString:function(e){for(var t=[],a=0,i=e.length;i>a;a++){var r=e[a],n=MainFrame.Util.zeroFill(r)+".pdf";t.push(n)}return t.join(",")},getPdfSelection:function(e,t,a,i,r){var n=this.initLoadingWindow(),s=this.getSelectedPagesString(a),o="prefixName="+t+"&selectedPages="+encodeURIComponent(s),l=new XMLHttpRequest;l.open("POST",i,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var t=l.responseText,a=/sendResult=([a-zA-Z]*)/i,i=t.match(a);if(i&&"true"===i[1]){var s=/filename=(.*?)\.pdf/i,o=t.match(s),c=r+o[1]+".pdf",d=MainFrame.Browser.isHTTPS?"https://":"http://";c=d+"www.interactivpdf.com/OUTPUT/"+o[1]+".pdf","download"===e?n.location=c:"print"===e&&(n.location=d+"www.interactivpdf.com/print.html?path="+encodeURIComponent(c))}else alert("There was an error, please try again later")}},l.send(o)}}),MainFrame.Action.MultiSelectPrint=MainFrame.Action.MultiSelectDownload.extend({startAction:function(){var e=this.getTarget(),t=(this.getParam("checkButtonId")||"selectPage",this.getParam("errorNoSelectionMessageId")||"noPagesSelected"),a=(this.getParam("errorInteractifPdfMessageId")||"interactifPdfError",this.getParam("catalogId")||"catalog"),i=MainFrame.Manager.Scoping.getById(a),r=this.getParam("catalogPdfPath")||i.commonDataSrc+"catalogue.pdf",n=decodeURIComponent(this.getParam("interactifPdfUrl")),s=decodeURIComponent(this.getParam("interactifPdfGetUrl")),o=this.getParam("prefixName")||"",l=MainFrame.Global.initializationVariables.appFolder;"undefined"!=typeof l&&"/"!==l[l.length-1]&&(l+="/");for(var c=[],d=1,g=i.settings.pages.totalPages;g>=d;d++)e.selectedPages[d]&&c.push(d);if(null!==this.getParam("printPath")){var h=this.getParam("printPath");-1===h.indexOf("http")?h=MainFrame.Util.getAppURL()+h+"/print.html?path=":h+="/print.html?path="}else var h=MainFrame.Util.getAppURL()+"common/print.html?path=";if(null!==this.getParam("selectionPath")){var u=this.getParam("selectionPath");-1===u.indexOf("http")?u=MainFrame.Util.getAppURL()+u+"/selection.html?url=":u+="/selection.html?url="}else var u=MainFrame.Util.getAppURL()+"common/selection.html?url=";var m=c.length;switch(m){case 0:MainFrame.Manager.Text.getById(t),MainFrame.EventHandler.dispatch("customError",[{errorMessageId:"multiSelectNoPagesSelected"}]);break;case 1:var p=c[0],f=h+i.pageReferences[p].pdf;window.open(f,"_blank");break;case g:var f=h+encodeURIComponent(r);window.open(f,"_blank");break;default:var v="print";this.getPdfSelection(v,o,c,n,s)}this.endAndClearAction()}}),MainFrame.Action.MultiSelectUncheckAll=MainFrame.Abstract.Action.extend({startAction:function(){for(var e=this.getTarget(),t=this.getParam("checkButtonId")||"selectPage",a=0,i=e.diapos.length;i>a;a++){var r=e.diapos[a].page,n=r.getSubObjectWithRole("diaporama-select-checkbox")||r.getSubObjectWithId(t);n.uncheck()}for(var s=1,o=e.sourceModule.settings.pages.totalPages;o>=s;s++)e.selectedPages[s]=!1;MainFrame.EventHandler.dispatch("pageSelectionChanged"),this.endAndClearAction()}}),MainFrame.Action.MultiSelectUpdateCheckedPages=MainFrame.Abstract.Action.extend({startAction:function(){for(var e=this.getTarget(),t=this.getParam("checkButtonId")||"selectPage",a=0,i=e.diapos.length;i>a;a++){var r=e.diapos[a].page,n=r.getSubObjectWithRole("diaporama-select-checkbox")||r.getSubObjectWithId(t);e.selectedPages[a+1]?n.check():n.uncheck()}this.endAndClearAction()}}),MainFrame.Action.ScrollDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("direction")||"forward",a=parseInt(this.getParam("distance"))||100,i=parseInt(this.getParam("duration"))||300;e&&("horizontalList"===e.type&&e.isStatic!==!0?this.scrollDiaporamaDynamic(e,t,a,i):this.scrollDiaporamaStatic(e,t,a,i)),this.endAndClearAction()},scrollDiaporamaDynamic:function(e,t,a,i){var r=e.scroller,n=r.translatedX||0;if("forward"===t){n-=a;var s=e.getDimensionX(),o=e.diapoPageSize*e.totalDiapos,l=-(o-s);l>n&&(n=l)}else n+=a,n>0&&(n=0);r.translatedX=n,r.translatedY=r.translatedY||0,MainFrame.Util.setTransformDuration(r.containerElement,i),MainFrame.Util.setPosition(r.containerElement,r.translatedX,r.translatedY,1)},scrollDiaporamaStatic:function(e,t,a,i){var r=e.translatedX||0;if("forward"===t){r-=a;var n=e.superObject.getDimensionX(),s=-(e.getDimensionX()-n);s>r&&(r=s)}else r+=a,r>0&&(r=0);e.translatedX=r,e.translatedY=e.translatedY||0,MainFrame.Util.setTransformDuration(e.containerElement,i),MainFrame.Util.setPosition(e.containerElement,e.translatedX,e.translatedY,1)}}),MainFrame.Action.SelectCheckedPage=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=!0;do{if("undefined"!=typeof t.page){var i=t;a=!1}t=t.superObject}while(t.superObject&&a);if(!a){var r=this.getParam("diaporamaId"),n=MainFrame.Manager.Scoping.getById(r);n.selectedPages[i.page]=n.selectedPages[i.page]?!1:!0,MainFrame.EventHandler.dispatch("pageSelectionChanged")}this.endAndClearAction()}}),MainFrame.Action.SelectPage=MainFrame.Abstract.Action.extend({startAction:function(){var multiSelectDiaporama=this.getTarget();if(multiSelectDiaporama){var page=this.getParam("page"),hasMathExpression=-1!==page.indexOf("+")||-1!==page.indexOf("-");hasMathExpression&&(page=eval(page)),multiSelectDiaporama.selectedPages[page]=!0,MainFrame.EventHandler.dispatch("pageSelectionChanged")}this.endAndClearAction()}}),MainFrame.Action.ToggleSelectPage=MainFrame.Abstract.Action.extend({startAction:function(){var multiSelectDiaporama=this.getTarget();if(multiSelectDiaporama){var page=this.getParam("page"),hasMathExpression=-1!==page.indexOf("+")||-1!==page.indexOf("-");hasMathExpression&&(page=eval(page)),multiSelectDiaporama.selectedPages[page]=multiSelectDiaporama.selectedPages[page]?!1:!0,MainFrame.EventHandler.dispatch("pageSelectionChanged")}this.endAndClearAction()}}),MainFrame.Action.UpdateGridPagesDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.translatedY,a=Math.floor(t/e.diapoHeight),i=a!==e.currentIndex,r=t<e.topLimit,n=-t<e.bottomLimit;if(i&&r&&n){var s=e.currentIndex-a,o=s>0;e.currentIndex=a;var l=e.rows.length;if(o){var c=e.rows[l-1],d=c.index+1,g=e.rows.shift();e.rows.push(g)}else{var l=e.rows.length,h=e.rows[0],d=h.index-1,g=e.rows.pop();e.rows.splice(0,0,g)}var u=d*e.diapoHeight;g.element.setPositionY(u),g.element.containerElement.style.top=u+"px",g.index=d;for(var m=g.element.subObjects.length,p=d*m,f=0;m>f;f++){var v=g.element.subObjects[f];e.fillGridDiapoPage(v,p),p++}}this.endAndClearAction()}}),MainFrame.Action.UpdatePagesDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getTarget(),a="horizontalList"===t.type?t.scroller.translatedX:t.scroller.translatedY,i=Math.floor(a/t.diapoPageSize),r=i!==t.currentIndex;if("horizontalList"===t.type){var n=a<=t.scroller.leftLimit,s=-a<=t.scroller.rightLimit;e=n&&s}else{var o=a<=t.scroller.topLimit,l=-a<=t.scroller.bottomLimit;e=o&&l}if(r&&e){var c=t.currentIndex-i,d=c>0;t.currentIndex=i;for(var g=t.diapos.length;0!==c;){if(d){var h=t.diapos[g-1],u=h.index,m=u+1;c--;var p=t.diapos.shift();t.diapos.push(p)}else{var f=t.diapos[0],v=f.index,m=v-1;c++;var p=t.diapos.pop();t.diapos.splice(0,0,p)}"horizontalList"===t.type?(p.page.containerElement.style.left=m*t.diapoPageSize+"px",p.page.setPositionX(m*t.diapoPageSize)):(p.page.containerElement.style.top=m*t.diapoPageSize+"px",p.page.setPositionY(m*t.diapoPageSize)),p.index=m;var M=t.sourceModule.pages.length;p.page.containerElement.style.visibility=m>M-1||0>m?"hidden":"visible",t.drawPageForDiapo(p.page,m)}}this.endAndClearAction()}}),MainFrame.Action.UpdatePagesSelectionDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getTarget(),a="selectionHorizontalList"===t.type?t.scroller.translatedX:t.scroller.translatedY,i=Math.floor(a/t.diapoPageSize),r=i!==t.currentIndex;if("selectionHorizontalList"===t.type){var n=a<t.scroller.leftLimit,s=-a<t.scroller.rightLimit;e=n&&s}else{var o=a<t.scroller.topLimit,l=-a<t.scroller.bottomLimit;e=o&&l}if(r&&e){var c=t.currentIndex-i,d=c>0;t.currentIndex=i;var g=t.diapos.length,h=0;do{if(d){var u=t.diapos[g-1],m=u.index,p=m+1,f=t.diapos.shift();t.diapos.push(f)}else{var v=t.diapos[0],M=v.index,p=M-1,f=t.diapos.pop();t.diapos.splice(0,0,f)}"selectionHorizontalList"===t.type?(f.page.containerElement.style.left=p*t.diapoPageSize+"px",f.page.setPositionX(p*t.diapoPageSize)):(f.page.containerElement.style.top=p*t.diapoPageSize+"px",f.page.setPositionY(p*t.diapoPageSize)),f.index=p;var b=t.sourceModule.singlePages.length;f.page.containerElement.style.visibility=p>b-1||0>p?"hidden":"visible",t.fillListDiapoPage(f.page,p);var M=t.diapos[0].index;h++}while(-M-2!==i&&50>h)}this.endAndClearAction()}}),MainFrame.Action.UpdateSelectedPageDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&(this.updateDiaporamaPagesPosition(),this.updateDiaporamaPagesBorders(),this.updateDiaporamaPagesSelection()),this.endAndClearAction()},updateDiaporamaPagesPosition:function(){var e=this.getTarget(),t=e.sourceModule,a=t.currentContainer,i=e.isStatic&&"Desktop"===EnvDetection.deviceType,r=e.isStatic&&"Desktop"!==EnvDetection.deviceType,n=!e.isStatic,s="verticalList"===e.type,o="horizontalList"===e.type;if(1===t.direction,i){var l=e.superObject.contentElement;if(s)var c=e.diapos[0].page.getDimensionY(),d=c*e.totalDiapos,g=e.getVerticalCenteringTranslation(c,d),h={scrollTop:-1*g};else if(o)var u=e.diapos[0].page.getDimensionX(),m=u*e.totalDiapos,g=e.getHorizontalCenteringTranslation(u,m),h={scrollLeft:-1*g};TweenMax.to(l,.3,h)}else if(r){var l=e.superObject.contentElement;if(s){var c=e.diapos[0].page.getDimensionY(),d=c*e.totalDiapos,g=e.getVerticalCenteringTranslation(c,d);e.translatedY=g,e.translatedX=0}else if(o){var u=e.diapos[0].page.getDimensionX(),m=u*e.totalDiapos,g=e.getHorizontalCenteringTranslation(u,m);e.translatedY=0,e.translatedX=g}MainFrame.Util.setTransformDuration(e.containerElement,300),MainFrame.Util.setPosition(e.containerElement,e.translatedX,e.translatedY,1)}else if(n){if(s){var c=e.diapos[0].page.getDimensionY(),g=-1*a*e.diapoPageSize+(MainFrame.Browser.height-e.diapoPageSize)/2;g>0?g=0:g<-e.scroller.bottomLimit&&(g=-e.scroller.bottomLimit),e.scroller.translatedY=g,e.scroller.translatedX=0}else if(o){var u=e.diapos[0].page.getDimensionX(),g=-1*a*e.diapoPageSize+(MainFrame.Browser.width-e.diapoPageSize)/2;g>0?g=0:g<-e.scroller.rightLimit&&(g=-e.scroller.rightLimit),e.scroller.translatedX=0,e.scroller.translatedY=g}MainFrame.Util.setTransformDuration(e.scroller.containerElement,300),MainFrame.Util.setPosition(e.scroller.containerElement,e.scroller.translatedX,e.scroller.translatedY,1),MainFrame.ActionManager.doAction(e,e,e.id,"updatePagesDiaporama","false",[e])}},updateDiaporamaPagesBorders:function(){var e=this.getTarget(),t=e.sourceModule,a=t.currentPage,i=e.standardPageSettings;i=e.useCatalogBorders?t:{borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopStyle:"none",borderRightStyle:"none",borderBottomStyle:"none",borderLeftStyle:"none",borderTopColor:"#FFFFFF",borderRightColor:"#FFFFFF",borderBottomColor:"#FFFFFF",borderLeftColor:"#FFFFFF"},e.diapos.forEach(function(t){var r=t.page;if(r.goToPage===a)var n=e.currentPageSettings;else var n=i;var s=r.getSubObjectWithId("diaporamaGraphic");s&&s.centeredDiv&&e.applyBorders(s.centeredDiv,n);var o=r.getSubObjectWithRole("diaporama-graphic");o&&e.adjustDiapoBorders(o,r.goToPage)})},updateDiaporamaPagesSelection:function(){var e=this.getTarget(),t=e.sourceModule,a=t.currentPage;e.diapos.forEach(function(e){var t=e.page;t.setState(t.goToPage===a?"select":"deselect")})}}),MainFrame.Action.LoadDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&(e.buildDiaporama(),e.resize()),this.endAndClearAction()}}),MainFrame.Element.DiaporamaCatalog=MainFrame.Abstract.Module.extend({readData:function(e){MainFrame.DataParser.parseDiaporamaCatalog.call(this,e),1==this.autoLoad&&this.buildDiaporama();var t=this.sourceModuleId+":orientationChanged";MainFrame.Publisher.subscribe(t,this,this.onPageChange)},onPageChange:function(){this.easing&&(this.easing.stop(),this.easing=null),this.empty(),this.buildDiaporama()},buildDiaporama:function(){var e=this;switch(this.type){case"horizontalList":this.isStatic?(this.setLoadingScreen(),setTimeout(function(){e.buildStaticHorizontalDiaporama()},200)):this.buildHorizontalDiaporama();break;case"verticalList":this.isStatic?(this.setLoadingScreen(),setTimeout(function(){e.buildStaticVerticalDiaporama()},200)):this.buildVerticalDiaporama();break;case"grid":this.setLoadingScreen(),setTimeout(function(){e.buildGridDiaporama()},200);break;case"selectionHorizontalList":this.buildSelectionHorizontalDiaporama();break;case"selectionVerticalList":this.buildSelectionVerticalDiaporama();break;case"selectionGrid":this.setLoadingScreen(),setTimeout(function(){e.buildSelectionGridDiaporama()},200);break;default:this.buildHorizontalDiaporama()}},buildGridDiaporama:function(){var e=this.sourceModule;this.initScroller(),this.diapos=[];var e=this.sourceModule;this.totalDiapos=e.isSinglePage?e.settings.pages.totalPages:e.landscapePages.length-1;for(var t,a,i,r,n=this.pageTemplateId||"diaporamaPage",s=MainFrame.Manager.Resource.getById(n),o=0,l=0,c=this.getDimensionX(),d=!0,g=document.createDocumentFragment(),h=!1,u=0;u<this.totalDiapos;u++){var m=MainFrame.Util.createElement("div","v7__elem--container",g),p=new MainFrame.Element.Resource({superObject:this.scroller,containerElement:m,data:s});if(d){if(t=p.getDimensionX(),a=p.getDimensionY(),i=Math.floor(c/t),this.totalDiapos<i)var f=this.totalDiapos*t;else var f=i*t;var v=c-f,M=Math.floor(v/2);d=!1}var b=M+l*t,F=o*a;p.setPositionX(b),p.setPositionY(F),p.containerElement.style.left=b+"px",p.containerElement.style.top=F+"px",l++,l===i&&(l=0,o++,u===this.totalDiapos-1&&(h=!0)),this.diapos.push({page:p,index:u}),p.setAction("id:diaporamaGoToPage;params:page=initiatorsGoToPage"),this.drawPageForDiapo(p,u),u===e.currentPage&&(r=o)
}this.scroller.containerElement.appendChild(g),h&&(o-=1);var A=a*(o+1);if(this.scroller.setDimensionY(A),this.scroller.containerElement.style.height=A+"px",this.centerGridDiaporamaVertically(a,r,A),this.layout="grid",this.removeLoadingScreen(),this.hasSlider!==!0)this.scroller.setAction("id:applyVerticalEasing");else{var P=this;setTimeout(function(){Ps.update(P.contentElement)},500)}},centerGridDiaporamaVertically:function(e,t){var a=t*e,i=this.superObject.getDimensionY(),r=-a+(i-e)/2;this.applyVerticalCentering(r)},applyVerticalCentering:function(e){"Desktop"===EnvDetection.deviceType||this.hasSlider===!0?this.contentElement.scrollTop=-1*e:(this.translatedX=0,this.translatedY=e,MainFrame.Util.setTransformDuration(this.containerElement,0),MainFrame.Util.setPosition(this.containerElement,this.translatedX,this.translatedY,1))},buildSelectionHorizontalDiaporama:function(){this.initScroller(),this.diapos=[],this.selectedPages={};var e=2;this.currentIndex=0;var t=this.addListDiapoPage(-e,this.scroller);this.diapoPageSize=t.getDimensionX();var a=Math.ceil(this.getDimensionX()/this.diapoPageSize);this.totalDiapos=this.sourceModule.singlePages.length,this.setBorders(t),this.scroller.leftLimit=0,this.scroller.rightLimit=this.totalDiapos*this.diapoPageSize-this.getDimensionX(),this.scroller.rightLimit<0&&(this.scroller.rightLimit=0);for(var i=-e+1,r=a+e,n=i;r>n;n++)this.addListDiapoPage(n,this.scroller),this.currentPage++;this.scroller.translatedX=0,this.scroller.translatedY=0,MainFrame.Util.setTransformDuration(this.scroller.containerElement,0),MainFrame.Util.setPosition(this.scroller.containerElement,this.scroller.translatedX,this.scroller.translatedY,1);for(var s=Math.floor(this.scroller.translatedX/this.diapoPageSize),n=0,o=this.diapos.length;o>n;n++){var l=-s-e+n;this.diapos[n].page.setPositionX(l*this.diapoPageSize),this.diapos[n].index=l,this.fillListDiapoPage(this.diapos[n].page,l)}this.currentIndex=s},buildSelectionVerticalDiaporama:function(){this.initScroller(),this.diapos=[],this.selectedPages={};var e=2;this.currentIndex=0;var t=this.addListDiapoPage(-e,this.scroller,"vertical");this.diapoPageSize=t.getDimensionY();var a=Math.ceil(this.getDimensionY()/this.diapoPageSize);this.totalDiapos=this.sourceModule.singlePages.length,this.setBorders(t),this.scroller.topLimit=0,this.scroller.bottomLimit=this.totalDiapos*this.diapoPageSize-this.getDimensionY(),this.scroller.bottomLimit<0&&(this.scroller.bottomLimit=0);for(var i=-e+1,r=a+e,n=i;r>n;n++)this.addListDiapoPage(n,this.scroller,"vertical"),this.currentPage++;this.scroller.translatedX=0,this.scroller.translatedY=0,MainFrame.Util.setTransformDuration(this.scroller.containerElement,0),MainFrame.Util.setPosition(this.scroller.containerElement,this.scroller.translatedX,this.scroller.translatedY,1);for(var s=Math.floor(this.scroller.translatedX/this.diapoPageSize),n=0,o=this.diapos.length;o>n;n++){var l=-s-e+n;this.diapos[n].page.setPositionY(l*this.diapoPageSize),this.diapos[n].index=l,this.fillListDiapoPage(this.diapos[n].page,l)}this.currentIndex=s,this.setAction("id:pageSelectionDiaporamaActions")},buildSelectionGridDiaporama:function(){var e=this.sourceModule;this.initScroller(),this.diapos=[],this.selectedPages={},this.totalDiapos=e.settings.pages.totalPages;for(var t,a,i,r,n=this.pageTemplateId||"diaporamaPage",s=MainFrame.Manager.Resource.getById(n),o=0,l=0,c=this.getDimensionX(),d=!0,g=document.createDocumentFragment(),h=1,u=0;u<this.totalDiapos;u++){var m=MainFrame.Util.createElement("div","v7__elem--container",g),p=new MainFrame.Element.Resource({superObject:this.scroller,containerElement:m,data:s});if(d){t=p.getDimensionX(),a=p.getDimensionY(),i=Math.floor(c/t);var f=i*t,v=c-f,M=Math.floor(v/2);d=!1}var b=M+l*t,F=o*a;p.setPositionX(b),p.setPositionY(F),p.containerElement.style.left=b+"px",p.containerElement.style.top=F+"px",l++,l===i&&(l=0,o++,u===this.totalDiapos-1&&(h=!0)),this.diapos.push({page:p,index:u}),this.autoDraw&&this.drawPageForDiapo(p,u),u===e.currentPage&&(r=o)}h&&(o-=1),this.scroller.containerElement.appendChild(g),h&&(o-=1);var A=a*(o+1);if(this.scroller.setDimensionY(A),this.scroller.containerElement.style.height=A+"px",this.centerGridDiaporamaVertically(a,r,A),this.layout="grid",this.removeLoadingScreen(),this.hasSlider!==!0)this.scroller.setAction("id:applyVerticalEasing");else{var P=this;setTimeout(function(){Ps.update(P.contentElement)},500)}},addListDiapoPage:function(e,t,a){var i=this.pageTemplateId||"diaporamaPage",r=MainFrame.Manager.Resource.getById(i),n=new MainFrame.Element.Resource({superObject:t,data:r});"vertical"===a?n.setPositionY(e*parseFloat(n.getDimensionY())):n.setPositionX(e*parseFloat(n.getDimensionX())),n.containerElement.style.display="none";var s=n.getSubObjectWithId("diaporamaGraphic");return s.image=MainFrame.Util.createElement("img","v7__elem__diaporama__graphic",s.contentElement),this.diapos.push({page:n,index:e}),n},fillListDiapoPage:function(e,t){var a=this.sourceModule,i=e.getSubObjectWithId("diaporamaGraphic"),r=e.getSubObjectWithId("selectPage"),n=e.getSubObjectWithId("diaporamaNumber");if(t>=0&&t<this.totalDiapos){e.containerElement.style.display="block";var s=!1,o=!1;this.buildGraphicsInSubContainer(i,t,"diapo",s,o,a.singlePages);var l=this.sourceModule.pageNumbers[t+1];n&&n.setText(l),e.page=t,r&&(this.selectedPages[t+1]?r.check():r.uncheck())}},buildHorizontalDiaporama:function(){this.initScroller(),this.diapos=[];var e=2;this.currentIndex=0;var t=document.createDocumentFragment(),a=this.addDiapoPage(-e,-e,this.scroller,"horizontal",t);this.diapoPageSize=a.getDimensionX();var i=Math.ceil(this.getDimensionX()/this.diapoPageSize),r=this.sourceModule;this.totalDiapos=r.isSinglePage?r.settings.pages.totalPages:r.landscapePages.length-1,this.setBorders(a),this.scroller.leftLimit=0,this.scroller.rightLimit=this.totalDiapos*this.diapoPageSize-this.getDimensionX(),this.scroller.rightLimit<0&&(this.scroller.rightLimit=0);for(var n=-e+1,s=i+e,o=n;s>o;o++)this.addDiapoPage(o,o,this.scroller,"horizontal",t),this.currentPage++;this.scroller.containerElement.appendChild(t);var l=this.getCatalogCurrentContainer(),c=-1*l*this.diapoPageSize+(MainFrame.Browser.width-this.diapoPageSize)/2;c>0?c=0:c<-this.scroller.rightLimit&&(c=-this.scroller.rightLimit),this.scroller.translatedX=c,this.scroller.translatedY=0,MainFrame.Util.setTransformDuration(this.scroller.containerElement,0),MainFrame.Util.setPosition(this.scroller.containerElement,this.scroller.translatedX,this.scroller.translatedY,1);for(var d=Math.floor(this.scroller.translatedX/this.diapoPageSize),o=0,g=this.diapos.length;g>o;o++){var h=-d-e+o;this.diapos[o].page.setPositionX(h*this.diapoPageSize),this.diapos[o].index=h,this.drawPageForDiapo(this.diapos[o].page,h)}this.currentIndex=d,this.setAction("id:diaporamaActions")},getCatalogCurrentContainer:function(){var e=this.sourceModule,t=e.currentPage;if(e.isSinglePage)return t-1;var a="single"===e.settings.pages.coverType;return a&&1===t?0:t%2===0?t/2:(t-1)/2},buildVerticalDiaporama:function(){this.initScroller(),this.diapos=[];var e=2;this.currentIndex=0;var t=document.createDocumentFragment(),a=this.addDiapoPage(-e,-e,this.scroller,"vertical",t);this.diapoPageSize=a.getDimensionY();var i=Math.ceil(this.getDimensionY()/this.diapoPageSize),r=this.sourceModule;this.totalDiapos=r.isSinglePage?r.settings.pages.totalPages:r.landscapePages.length-1,this.setBorders(a),this.scroller.topLimit=0,this.scroller.bottomLimit=this.totalDiapos*this.diapoPageSize-this.getDimensionY(),this.scroller.bottomLimit<0&&(this.scroller.bottomLimit=0);for(var n=-e+1,s=i+e,o=n;s>o;o++)this.addDiapoPage(o,o,this.scroller,"vertical",t),this.currentPage++;this.scroller.containerElement.appendChild(t);var l=this.getCatalogCurrentContainer(),c=-1*l*this.diapoPageSize+(MainFrame.Browser.height-this.diapoPageSize)/2;c>0?c=0:c<-this.scroller.bottomLimit&&(c=-this.scroller.bottomLimit),this.scroller.translatedX=0,this.scroller.translatedY=c,MainFrame.Util.setTransformDuration(this.scroller.containerElement,0),MainFrame.Util.setPosition(this.scroller.containerElement,this.scroller.translatedX,this.scroller.translatedY,1),this.currentIndex=Math.floor(this.scroller.translatedY/this.diapoPageSize);for(var d=Math.floor(this.scroller.translatedY/this.diapoPageSize),o=0,g=this.diapos.length;g>o;o++){var h=-d-e+o;this.diapos[o].page.setPositionY(h*this.diapoPageSize),this.diapos[o].index=h,this.drawPageForDiapo(this.diapos[o].page,h)}this.currentIndex=d,this.setAction("id:diaporamaActions")},buildStaticVerticalDiaporama:function(){var e=this.sourceModule;this.diapos=[];var e=this.sourceModule;this.totalDiapos=e.isSinglePage?e.settings.pages.totalPages:e.landscapePages.length-1;for(var t=document.createDocumentFragment(),a=0;a<this.totalDiapos;a++){var i=this.addDiapoPage(a,a,this,"vertical",t);this.drawPageForDiapo(i,a)}this.containerElement.appendChild(t);var r=i.getDimensionY(),n=r*this.totalDiapos;this.setDimensionY(n),"Desktop"===EnvDetection.deviceType?this.superObject.contentElement.style.overflowY="auto":this.setAction("id:applyVerticalEasing"),this.setAction("id:staticDiaporamaActions"),this.resize(),this.centerStaticDiaporamaVertically(r,n),this.removeLoadingScreen()},centerStaticDiaporamaVertically:function(e,t){var a=this.getVerticalCenteringTranslation(e,t);this.applyVerticalCentering(a)},getVerticalCenteringTranslation:function(e,t){var e=e||this.diapos[0].page.getDimensionY(),t=t||e*this.totalDiapos,a=this.sourceModule.currentPage,i=a*e,r=this.superObject.getDimensionY(),n=-i+(r-e)/2,r=this.superObject.getDimensionY(),s=-(t-r),o=0;return s>n&&(n=s),n>o&&(n=o),n},buildStaticHorizontalDiaporama:function(){var e=this.sourceModule;if(this.diapos=[],this.pageRange)this.totalDiapos=this.pageRange.length;else{var e=this.sourceModule;this.totalDiapos=e.isSinglePage?e.settings.pages.totalPages:e.landscapePages.length-1}var t=document.createDocumentFragment();if(this.pageRange)var a=this.pageRange.start,i=this.pageRange.length;else var a=0,i=this.totalDiapos;for(var r=0;i>r;r++){var n=this.addDiapoPage(a,r,this,"horizontal",t);this.drawPageForDiapo(n,a),a++}this.contentElement.appendChild(t);var s=n.getDimensionX(),o=s*this.totalDiapos;this.setDimensionX(o),this.setAction("id:applyHorizontalEasing"),this.setAction("id:staticDiaporamaActions"),this.resize(),this.centerStaticDiaporamaHorizontally(s,o),this.removeLoadingScreen()},centerStaticDiaporamaHorizontally:function(e,t){var a=this.getHorizontalCenteringTranslation(e,t);this.applyHorizontalCentering(a,t)},getHorizontalCenteringTranslation:function(e,t){var e=e||this.diapos[0].page.getDimensionX(),t=t||e*this.totalDiapos,a=this.sourceModule.currentPage,i=a*e,r=this.superObject.getDimensionX(),n=-i+(r-e)/2,r=this.superObject.getDimensionX(),s=-(t-r),o=0;return s>n&&(n=s),n>o&&(n=o),n},applyHorizontalCentering:function(e){this.translatedY=0,this.translatedX=e,MainFrame.Util.setTransformDuration(this.containerElement,0),MainFrame.Util.setPosition(this.containerElement,this.translatedX,this.translatedY,1)},addDiapoPage:function(e,t,a,i,r){var n=this.pageTemplateId||"diaporamaPage",s=MainFrame.Manager.Resource.getById(n),o=MainFrame.Util.createElement("div","v7__elem--container",r),l=new MainFrame.Element.Resource({superObject:a,containerElement:o,data:s});return"vertical"===i?l.setPositionY(t*parseFloat(l.getDimensionY())):"horizontal"===i&&l.setPositionX(t*parseFloat(l.getDimensionX())),l.containerElement.style.display="none",this.diapos.push({page:l,index:e}),l.setAction("id:diaporamaGoToPage;params:page=initiatorsGoToPage"),l},initScroller:function(){if(this.contentElement.childNodes&&this.contentElement.childNodes[0])var e=!0,t=this.contentElement.childNodes[0];else var e=!1,t=this.contentElement;var a=MainFrame.Util.createElement("div","v7__elem--scroller",t,e);this.scroller=new MainFrame.Abstract.Element({superObject:this,id:this.id+"_scroller",containerElement:a})},setBorders:function(e){if(this.useCatalogBorders){var t=this.sourceModule;e.getDimensionY()/this.sourceModule.getDimensionY()}else{var t={};t.borderTopWidth=0,t.borderRightWidth=0,t.borderBottomWidth=0,t.borderLeftWidth=0,t.borderTopColor="#000",t.borderRightColor="#000",t.borderBottomColor="#000",t.borderLeftColor="#000",t.borderTopStyle="none",t.borderRightStyle="none",t.borderBottomStyle="none",t.borderLeftStyle="none"}},drawPageForDiapo:function(e,t){var a=this.sourceModule,i=(e.getSubObjectWithId("diaporamaGraphic"),e.getSubObjectWithRole("diaporama-graphic")),r=e.getSubObjectWithRole("diaporama-label-flexible"),n=e.getSubObjectWithRole("diaporama-page-number")||e.getSubObjectWithId("diaporamaNumber"),s=e.getSubObjectWithRole("diaporama-page-numbers-centered")||e.getSubObjectWithId("diaporamaNumbersCentered"),o=e.getSubObjectWithRole("diaporama-select-checkbox")||e.getSubObjectWithId("selectPage");if(t>=0&&t<this.totalDiapos){if(e.containerElement.style.display="block",i){if(0===t)var l=1;else if("single"===i.mode||"current"===i.mode&&a.isSinglePage)var l=t+1;else if("double"===i.mode||"current"===i.mode&&a.isDoublePage){var c="single"===a.settings.pages.coverType;if(c)var l=2*t;else var l=2*t+1}this.adjustDiapoBorders(i,l),i.setPageNumber(l);var d=a.pageReferences[l],g=d.number;i.altTextPage=g}var h=l===a.currentPage;h?e.setState("select"):"undefined"!=typeof this.standardPageSettings&&e.setState("deselect");var g,u=[],m=-1!==this.type.indexOf("selection"),p=a.isSinglePage||m?a.portraitPages:a.landscapePages,f=p[t+1];if(f.forEach(function(e){g=e.number,u.push(g)}),n){var v=u.join(" / ");n.setText(v)}if(s){var M=function(e,t){return t=t||"50%",'<span style="width: '+t+'; display: inline-block; text-align: center">'+e+"</span>"},b="";1===u.length?b=M(u[0],"100%"):2===u.length&&(b=M(u[0],"50%")+M(u[1],"50%")),s.containerElement.innerHTML=b}r&&i&&this.adjustFlexibleLabelPosition(r,i),o&&(e.page=t+1,this.selectedPages[t+1]?o.check():o.uncheck()),e.goToPage=l}else e.containerElement.style.display="none"},adjustDiapoBorders:function(e,t){var a=this.sourceModule,i=t===a.currentPage;i&&"undefined"!=typeof this.currentPageSettings?e.settings.borders=this.currentPageSettings:"undefined"!=typeof this.standardPageSettings&&(e.settings.borders=this.standardPageSettings);var r=e.mode;"current"===r&&(r=e.sourceModule.isSinglePage?"single":"double"),e.settings.borders.hasBorders&&e.drawBorders(r)},adjustFlexibleLabelPosition:function(e,t){var a="double"===t.mode||"current"===t.mode&&t.sourceModule.isDoublePage;if(1===t.pagesOnScreen&&a){var i=t.pageContainerSize.width/2,r=t.pageContainerSize.x,n=t.getPositionX(),s=i,o=1===t.pageNumber,l=o&&t.centerFirst||!o&&t.centerLast;if(l)var c=n+r+i/2;else if(o)var c=n+r+i;else var c=n+r}else var i=t.pageContainerSize.width,r=t.pageContainerSize.x,n=t.getPositionX(),s=i,c=n+r;e.setDimensionX(s),e.setPositionX(c),e.resize()},buildGraphicsInSubContainer:function(e,t,a,i,r,n){var s={};r=MainFrame.Util.setDefault(r,!1),a=MainFrame.Util.setDefault(a,"normal");try{s=n[t].pageType[a]}catch(o){console.log("error is "+o),console.log("page is "+t),console.log(this)}e.contentElement.style.textAlign="center",e.contentElement.innerHTML="",e.graphics=[],this.setContainerRatio(e,s.length);var l="v7__elem__catalog__page-container",c=this.sourceModule;c.settings.useShadow===!0&&(l+=" v7__elem__catalog__page-container--shadow",e.contentElement.style.overflow="visible"),e.centeredDiv=MainFrame.Util.createElement("div",l,e.contentElement);var d=t===this.sourceModule.currentPage,g=this.standardPageSettings;g=d?this.currentPageSettings:this.useCatalogBorders?this.sourceModule:{borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopStyle:"none",borderRightStyle:"none",borderBottomStyle:"none",borderLeftStyle:"none",borderTopColor:"#FFFFFF",borderRightColor:"#FFFFFF",borderBottomColor:"#FFFFFF",borderLeftColor:"#FFFFFF"},this.applyBorders(e.centeredDiv,g),e.centeredDiv.style.position="static";var h=g.borderLeftWidth+g.borderRightWidth,u=g.borderTopWidth+g.borderBottomWidth,m=1===s.length&&this.sourceModule.pages===this.sourceModule.doublePages,p=-1!==this.type.indexOf("selection");if(e.pageRatio<e.ratio){var f=e.getDimensionY()-u;e.centeredDiv.style.height=f+"px",m&&!p&&(e.centeredDiv.style.width="50%")}else{e.centeredDiv.style.height="auto";var v=e.getDimensionX()-h;m&&!p&&(v/=2),e.centeredDiv.style.width=v+"px";var M=this.getPageSize(e,!0,g,s.length).pageHeight,b=e.getDimensionY()-M-u;e.centeredDiv.style.marginTop=b/2+"px"}for(var F=0,A=s.length;A>F;F++)e.graphics[F]=this.placeGraphic(e,F,s.length,s[F],i,r);var P=e.centeredDiv.clientWidth||"100%",y=e.superObject,C=y.getSubObjectWithId("diaporamaNumberLabel");C&&(C.setDimensionX(P),C.resize())},applyBorders:function(e,t){e.style.borderTop=t.borderTopWidth+"px "+t.borderTopStyle+" "+t.borderTopColor,e.style.borderRight=t.borderRightWidth+"px "+t.borderRightStyle+" "+t.borderRightColor,e.style.borderBottom=t.borderBottomWidth+"px "+t.borderBottomStyle+" "+t.borderBottomColor,e.style.borderLeft=t.borderLeftWidth+"px "+t.borderLeftStyle+" "+t.borderLeftColor},setContainerRatio:function(e,t){var a=this.sourceModule,i=a.settings.pages.normalSize;e.pageRatio=t*i.width/i.height;var r=e.getDimensionX(),n=1===t&&a.isDoublePage,s=-1!==this.type.indexOf("selection");n&&!s&&(r/=2),e.ratio=r/e.getDimensionY()},getPageSize:function(e,t,a,i){var r=this.sourceModule,n=r.settings.pages.normalSize,i=i||e.graphics.length,s={};if(e.pageRatio<e.ratio){var o=t?a.borderTopWidth+a.borderBottomWidth:0;s.pageHeight=e.getDimensionY()-o,s.pageWidth=s.pageHeight*(this.sourceModule.normalSize.width/this.sourceModule.normalSize.height)}else{var l=t?a.borderLeftWidth+a.borderRightWidth:0,c=e.getDimensionX(),d=1===i&&r.isDoublePage,g=-1!==this.type.indexOf("selection");d&&!g&&(c/=2),s.pageWidth=(c-l)/i,s.pageHeight=s.pageWidth*(n.height/n.width)}return s},placeGraphic:function(e,t,a,i,r,n){r=MainFrame.Util.setDefault(r,!0);var s=MainFrame.Util.getAppURL()+(r?this.dataSrc:"")+i;s=MainFrame.Util.localizePath(s),s=MainFrame.Util.processUrlForCaching(s);var o=new Image;if("true"==n){var l=MainFrame.Util.createElement("canvas","v7__elem__catalog__page-container__graphic v7--loading",e.centeredDiv),c=l.getContext("2d");o.onload=function(){c.drawImage(o,0,0,l.width,l.height)}}else{var l=MainFrame.Util.createElement("img","v7__elem__catalog__page-container__graphic v7--loading",e.centeredDiv);o.onload=function(){l.src=s,l.setAttribute("class","v7__elem__catalog__page-container__graphic")}}return o.src=s,this.updateSizeForGraphic(l,a,e,n),l},updateSizeForGraphic:function(e,t,a,i){if(i=MainFrame.Util.setDefault(i,!1),a.pageRatio<a.ratio)if("true"==i)e.height=parseFloat(a.getDimensionY()),e.width=parseFloat(a.getDimensionY())*a.pageRatio/t;else{e.style.height="100%";var r=a.getDimensionY()*a.pageRatio;e.style.width=r/t+"px"}else"true"==i?(e.width=parseFloat(a.getDimensionX())/t,e.height=parseFloat(a.getDimensionX())/a.pageRatio):(e.style.height="",e.style.width=100/t+"%")},resize:function(){switch(this.type){case"horizontalList":this.isStatic||this.resizeHorizontalDiaporama();break;case"verticalList":this.isStatic||this.resizeVerticalDiaporama();break;case"grid":break;case"selectionHorizontalList":this.resizeHorizontalDiaporama();break;case"selectionVerticalList":this.resizeVerticalDiaporama();break;case"selectionGrid":break;default:this.resizeHorizontalDiaporama()}this._resize()},gridResize:function(){if(this.scroller){var e=this.scroller;if(e.subObjects&&e.subObjects.length)for(var t=e.getDimensionX(),a=(e.subObjects.length,e.subObjects[0]),i=a.getDimensionX(),r=a.getDimensionY(),n=Math.floor(t/(i+this.spacing.x)),s=n*i+(n-1)*this.spacing.x,o=0,l=0,c=t-s,d=Math.floor(c/2),g=0,h=0,u=0,m=e.subObjects.length;m>g;g++){var p=e.subObjects[g],f=d+o,v=l;p.visible!==!1&&(o+=i,h++,this.spacing.x&&(o+=this.spacing.x)),h===n&&(h=0,o=0,u++,l+=r,this.spacing.y&&(l+=this.spacing.y)),p.setPositionX(f),p.setPositionY(v)}}},resizeHorizontalDiaporama:function(){this.scroller&&(this.scroller.rightLimit=this.totalDiapos*this.diapoPageSize-this.getDimensionX(),this.scroller.rightLimit<0&&(this.scroller.rightLimit=0))},resizeVerticalDiaporama:function(){this.scroller&&(this.scroller.bottomLimit=this.totalDiapos*this.diapoPageSize-this.getDimensionY(),this.scroller.bottomLimit<0&&(this.scroller.bottomLimit=0))}}),!function(){MainFrame.DataParser.elements.catalogDiaporama=MainFrame.Element.DiaporamaCatalog}(),!function(){var e={parseDownloads:function(e){MainFrame.DataParser.basicParse.call(this,e),MainFrame.DataParser.getSourceModule.call(this,e),this.templateName=e.attributes.templateName||"downloadTemplate_",this.fitType=e.attributes.fitType||"none"}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.BasePageSelection=MainFrame.Abstract.Action.extend({startAction:function(){this.endAndClearAction()},getSelectedPages:function(){var e=this.getParam("selectionSource");switch(e){case"bookmarks":return this.getSelectedPagesFromBookmarks();case"chapters":return this.getSelectedChapters();case"diaporama":default:return this.getSelectedPagesFromDiaporama()}},getSelectedPagesFromBookmarks:function(){return MainFrame.Manager.Bookmarks.getSortedPages()},getSelectedChapters:function(){var e=this.getTarget(),t=[];return e&&e.subObjects&&(t=this.getChapterURLs(e)),t},getChapterURLs:function(e){for(var t=this.getParam("checkId")||"chapterCheck",a=[],i=0,r=e.subObjects.length;r>i;i++){var n=e.subObjects[i];if(n.role){var s=n,o=s.getSubObjectWithId(t);o&&o.isChecked()&&a.push(s.role)}else n.subObjects&&(a=a.concat(this.getChapterURLs(n)))}return console.log(a),a},getSelectedPagesFromDiaporama:function(){for(var e=[],t=this.getTarget(),a=this.getParam("catalogId")||"catalog",i=MainFrame.Manager.Scoping.getById(a),r=1,n=i.settings.pages.totalPages;n>=r;r++)t.selectedPages[r]&&e.push(r);return e},getSelectionPath:function(){if(null!==this.getParam("selectionPath")){var e=this.getParam("selectionPath");-1===e.indexOf("http")?e=MainFrame.Util.getAppURL()+e+"/selection.html?url=":e+="/selection.html?url="}else var e=MainFrame.Util.getAppURL()+"common/selection.html?url=";return e},initLoadingWindow:function(){var e=window.open(),t='<img id="loading" src="data:image/gif;base64,R0lGODlhHgAeAPf2AP7+/v39/fDw8O/v7/z8/PHx8e7u7vv7++Xl5fr6+vn5+ebm5gAAAPX19fT09Pb29vPz8/f39/j4+Ofn5/Ly8tTU1O3t7dXV1cnJyezs7Ojo6Orq6uTk5OPj476+vuvr69nZ2cjIyNbW1unp6crKytjY2MvLy9zc3LOzs7KyssfHx+Hh4b+/v9/f3+Li4tPT097e3sDAwNfX193d3dra2sHBwYmJidvb2+Dg4L29vby8vM/Pz7e3t9LS0sTExNDQ0LS0tIiIiLW1tcbGxszMzLi4uLq6uoyMjHBwcMPDw8XFxVhYWLGxsXFxccLCws7Ozra2trCwsG9vb42Njbm5uc3NzXNzc4qKilpaWtHR0bu7u3JycpKSkjs7O3Z2dq+vr66urj09PVlZWaioqKSkpISEhIKCgpqaml5eXnR0dJGRkSIiIltbW2lpaaWlpYaGhouLi1NTUz4+PqmpqXh4eI6OjpWVlZCQkJSUlJ6enpiYmJycnKqqqmpqakNDQ4eHh6Kiop+fn6ysrCUlJW5ubklJSa2trVRUVIODg4WFhUBAQCAgIKGhoV9fX0FBQYGBgaamppaWlmxsbFxcXGBgYFdXV5OTk5mZmTY2NiQkJB8fH21tbXl5eVBQUDw8PHt7ez8/P11dXX9/fzU1NSgoKJubm2dnZzQ0NDMzM52dnVFRUWtra5eXlyoqKk5OTiMjI1VVVQoKCmRkZE1NTaurq0ZGRjk5OTc3N35+fo+Pj0VFRX19fSEhISkpKURERBsbGywsLCcnJ6enpxgYGB4eHmJiYlJSUhoaGk9PT3V1dWFhYR0dHUdHRwUFBQcHBzg4OICAgCsrK6CgoFZWVi4uLmNjY3x8fGhoaGZmZkJCQkhISBYWFmVlZTo6OkxMTBISEnp6eqOjoxUVFS0tLQsLCxwcHBcXFzIyMhkZGRERERMTEzExMQ8PDw4ODiYmJgICAnd3d0pKSgQEBDAwMA0NDf///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgD2ACwAAAAAHgAeAAAI/wDrCRxIsKDBgwgRNoCQsGHCO1YcNgwgZMBAAJjMPRgY4AEAiQOnxbFYD0EsBkQEBihgIABIgTbETWJYgwEDQPVWDijwUuCQYJoe1Rtj8009BwIENOhZT4GqYK+o8GnHDhGAnQIIOIxxhcoIgXuGUbNDYcGEDA0MCGBYLwGFDAIMtuiESZUZDBZ2lTCoYECCBxkWIOgQ4SAMLF1AdZnTsECHBZCXIpzgpYu2vQklIEAwobBDMmokZjDwMaGDFSVOsG2YwAEFBwoKQmAxRUq1SZNgSJQgosIFGTA2xK6nIQiaSkvELKEhMcKFCxWi01hdb4ISQXkCLZCYYIILBBk8JsTMUEMiAp4OA9T4hOREQwgYSOA4kDCAMEJW+uhpCGKIiRAXJHCQBIC0IQU0goygAg4GDQBCAzg8gYEKFdBXUAicXFJDXB0EcYQQFFhgAAQgxKDFdgpMIIMJLhj0wEYDfXFFEEMskAITN0zgQQwmuCTQAQI2NAAXNrgRQAcopABCPT14wIIFTFWRCB4f1LNAku41oIQOS/YExhQtCCQAFChMIFABSWBQGkgxIDDQAR7wAONRJWjFFEE/DHGnQwVAueefBgUEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEhwoAEDBRMqXFjHxsKHAgHUeDCQQC0/CQY6+BIA4kBJdCQIvDEOWAmBB1zJqedRYKlzIe1pGZQJij0FnRjQaSnwSbYud+y54bWIkb0tDBjE4GnvARZffmaQyTQo3JOkpDIuBKKGxwKBbjAxgwLhBowHWsoxCCJQgQMBDgh2KBZH1hQaFB7RSCgA2ogDAgYIMCCSIAhJbBLzgAjBQIECAyIotGCmEqUTEBMYCKxVYYAidloKgNBRoQB7J2Yg9HigQYQICQAIdOCBi7VkVja94MlhAYIFGgYQsKdmixQkSNr8aCmh9wLfCyT3rMEDSIeWBwwMKAChcEIDPoZDt8wgfWE9JQ2vP0xQ4sIClgkjgLEx5Q0tiBxeyLgAI2ECYWXYYAkLEvSwQUIQtEAAAiJc8MIJ4glkgh6GmACBPQukIMQFhUngAgkqHGjPCC2UoAFBCsgWUQxCoDABBzro4MIHIZBQAXz2ABChQlAA4UQ9HHjggQv2vEACCRQwRUMUVJymAQsefOXAEyqo15IKPKxmTwwsDCAQBCZcgCNEO5w2kBI+dAbBCSp6VNpAFfTAVEsUXNhSQAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcKAACgUTKlzIhcvChwIPJEkwUMGSaREGPrB3AOJAL4gcDNTlC4RAC4dmeRx4plMZBfaGOAJVw96DJdtWDjTBZokbezrkhBFi79GiVyl02ouwBU0oGEEVFXGyppUcAQ9j6GHBQWAOWGi+FDjRAsKYLsP2CBTB5ZAagiM+9fHCyh6AOzISZvhTwEmhZgzUzSjY4RGSLU2iQBTEoPGyCgozsJLSZAdECKcYFMLxsJ6TPCt53KmnEMCADjBaDFhZr14CCQoCCISQRJqaI3De0Fh5wIIAAQMOHhghbIqN42VKrExgocDvAQZg2jMAosqQJBtWBnDgoMED6QkbXLAgfbkBRAIVgKAYcR4BBwuyEypQkgJKiiEAHn7gMAGBho4FJRFFCkWAcMAFHyR0wAa9IeCgBgXRoAMGJ5i3QQ4e5HWQAhuAUEEBAgnwwQIGEASgQAGQEEMOHHygggoaFPCCCDTkN1B8ClnAAgtP2LMBBhhAeIIIFyhlDwg6+GBeBkBmJ0EJFSCgFAZOYGVPASRgMJADFwymXQkICaQAEVWA90AHSpE3kAh5GQmRSDoFBAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcOAGDQUTKlyYh9XChwLrhaAwkMAWSRIGFkhRD+JAO38aCORACQ0MgRGwtfE4kEebSAfsPWGDRYW9AHRORWIpcIYVQl/sxRAjpoi9PZ4UmXgIgGA9NVaagHACa0mOHaD8YGs6MABBDGRiuPC6gxASewJudGgA5dAoowlUBLF3hKADPWXgBHqh4FKFhBQCZTDkzd0vTB0KCthzZUoQPl4XchnWapAcGgodgLERxObDAYqWhVoAUQSkCB7HAHr4IAOCDzwJ1ChCZENHew1ExOABBAWY2LwYMIi1TtQCCiao9PZ9g2WAV8IZfJvUQuABCy5O4LDAMkEpO4Z6SLa4XXBAj5gQG0R+KMODjhUeLQwQQGAhEQ9OcmCAOGAABQEGJEQACTp4kMQNEoAggIAGKADBfAUMUNAMSfTAgQL2GBACBjAcIMEBBxSAQAcQ2EOAAwAWQFB9A9VTgQkhjCBABSJkAAECEyDUFVcKFYABBiUIVMFf9mywAAIi8eSCCj8kkOGQGZg4AQLc8XSBCQ8I1MAFFVBkTwII6OhRPSs4UFEJMqBnjwIZkMfTQDic9CZLXnoUEAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcKCBEQUTKlw4JtXChwIB7HAwMEGZXQ8GPjBCAOJAPqwyCPzAKc2KkV5weRyoAtEeCPZmpGnywt6DXZ3IrBQ4oU4QJvZ6NEESwl6gSqFqLgxAMACjIzZo/OjTRkUJNo2aSHh4woeIDQeC/rGRQgORLAbAyDokxN6BC2S20CKoIMcXIDluBACzIyxBDW4cCJGla1ScDQUheEghJEUIvwrn3PITZtIMhRGIoEjRwiMWW2ZEPvxgAvLCIloWJihgb8ICATuFGPLQY8DAF0pisPBgBMZKCrc0DWplq4+IBll81Njde2WDbsQGRbNVLIvABBQ2cOgA2yMAFJCoVLrorhAEU4hKgEBUcAJDiA8e5TBoJLpghCwYTIQQUe8hDwYAjuMbQQn8MAQJP7hwAAIUJUQBBWfMA+AiCA00QQ8tGNBRBi/IsIA9EWxFgQEGNCCQCWYwg0dT/UVEgwgvCACBCy4I8MAABQxwnj317JiQAyJcAAMAECCAAGsFCCBABDu19kIJWzVgJEUHGCAABU3OIEODCiywAJP2KEAiACsBsIACAwXgWgIDEQCBj03as4EGcXokwVYrBQQAIfkEBQoA9gAsAQABABwAHAAACP8A7QkcSHCghQ0FEypcyGPOwocDQTQYeOCMJYINWByAODAEDwMDc02ZIDDDmyMcB9KIYmTiiiNXZNhrMOUak5QCBwhBEcLeiSs2qtgbQ8gKCJwCYwhJsYBGGURP7DVJ8ycBwY0DOWA4arVDCiAkPvzokeFLsj4s7CkYKurmwAQhtLBQMuPAkxUECAJYMeeBjjRoVCERUPABCQ81PJjI+zAOGjFpOChMIMNDDhcQR7RZEonwwwwVAnA0smOhAgoWBBZIKaEIFB8XPD+QUYUEBgxKJHM0EK+LIj/IvNx4cGOHCdtKSHIsMCuMn0KVzKwQSKDBgA0jHKQMoKLGDxcPFkK0QFCPYwpAHHG8EDHxoYNCx6q1WAjigogKHSAyOUZqTZfSBZXwwgUgaBDABhIoNIYGkMwSDTqjYDaQBicsQIFoBXCAQAYEKJBAPTncwkAQ9hywAx6hqKEXQQFMMAECBTyQgQUEGMEAA4skiFMECCyAUAQFCKDdFjd6gNQAHCxglQQCCDDRA3IwsAVSGiAQwUADCLCWPRnYgkp5HNUjgFXUZcmYPREEQiZSAxUwAJscHbAlRwEBACH5BAUKAPYALAIAAQAbABwAAAj/AO0JHEhQIAQDBRMqVPhDycKH9urNIBggB48IAyP4gDiwipMCAgtAQaHBYKpLADjaO6Fjo70FKFBMlMCojBCVAlmwIGJvRUwR9qDYsCFjYT2CAEzE8DACARgwNEYcqaNHAcGjAhf0aDEg5YQcHp4YODFRy5s/GCJ24GGpCMEsKjBkmWBvx40EBA/8gGSvh6U0fUR9IJjgAgYTIbIceAhokxUpUwQkJHADQ4iSD1ekkZLKwUMDNLA+pJJFIQEHBjQYkKDSgQcjQ2Y8ELiixIUKFXqA5KiBzRIsaFbdaVH7doUXDVQOaPQbjSRLOASiHmGBNccESWDDwJiwgQWVOYw8sCTwAQEH6wslUHoGTnJBAhoWTEAwAmIUTNnCyBo88MACBAhMUEACBlhVEARwLJBEE7qMEkcHAw0wgQXJ2dPAABZAoABrCnjgiDl4RHSDNEgEMpBo9gAwQAECBDDHMprk8sQawHiym0AoFrTiAPWMwQADiAi0xhpR4ERBAQjZw8KPe9hTgDfHNIHTAKsJhEMzDCQh0ATMgBKAShRQFAw5Nw5wxGw4EZSGK2lyhAAIOAUEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEhwYAIIBRMqXAjDxMKHAzs4GAiASIwHAw+AUABxoAgSAwRGSOJhgsAHTowQ6CiQgwoiEwew8CCQgJIvKlgKhECCRA8AG1iwAGHvRQoUNx4GAEDwI4YOI7RoEWEACJQiEQiuHLihxAoDB+wJCBGiAoUOHQxcYMKkxMAYjLQwFXjgxIsLJTQQgIEg7EACC0JIKOHmSCI1CwoegFFBRoUTcxWieHPExpkNCgOsqHBBAEQYcIK4CfkQggaWSSo8fEBBwIAELCE4qUGkRQOBCT4sQIBgAQeMHREgkYLECq5AHQ5kmMAbQYesHTU0kdIkjRkyHAQGiAChwAC/EBWYxRiyYwVHhREKsGQRo6NrC+cXUpACC5fJhAcGFKAwgPRCKktMggUSMxREgAGuDeAAAJCoV1ADl12ACCVxUELUQA8YoN5KGDDQChn2FFAABENgcUoeAs0giBmAEARAZPWowgADb/iAySiJZAGKL3FYQFAAD4HQDAO+2KMDL5pYYw8gnoTBh0724MGAJh3YY0Iva9xhTwCfoMIJlJ0Q84JAI9yyiBACUWCFMfE9BMAZKwxUjxi9VIlbFBNBSRArbOjZkQUt6BQQACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEiQYIOCCBMqXJAFgMKHAjkQrCcihIOBBFpAJIijggCBCqqE0CBQAhEnBzYK/FBBhEAKJDBoBLBDRxWVAh9cEAGCgAASJG7YO+HBwwmIAQbWa3GhggYDQ1TQsMeihpODCiEg+FAggb0GO3FEsPBBwAwdOUDYA8CyBhGCBEYgmGsgwQgKDgcGGPHkwQQnQKIIyVCQwAYEE+ZC/MFECBAjFhRmQNDh4sMMUJjEoACxgQGVMiQqlNAAAoWUKkmY6LECYwEDAwQIMCBB5YQgQWzAwWPIHgEKA4LPVqByhI0gV6boSTFhoIIHDQLUUxmhwg8ZC2onLEJLpQ4WSLcwshA3AqIGcJLgIEgYAQuD9/AgapGypYmoowQhKHoPLI+FPDAglIEeBsxwiRerNFECQUXIkUYOxO3AyylcPPDBBoSZYowbEelghyAESUdQG4MQY0YFhdRyxQqUNMJNeQPlldAJ1GQyiwQXOOLJFfagIIYYYOBkDxm/nOJSC4WEcYY99ViiCiJC9gEMBgI1sEQXRggUQR3XRIDTHmoNxIkj6wkEgA4QCFkQCpvIqGZCDoi2UUAAIfkEBQoA9gAsAQABABwAHAAACP8A7QkcSJBggYIIEyq0UKKewocCBzwgiONFg4EAXESAOPBDh4v2AoCokEGgSBUbOdorgADBRQkiLiCwVw9EiCwAVNpTgGACggMPLlzAYW9FCAwtHtbLOXDDggUfIlyogMABCSIkIBBkKvCBBQEODth7wIHDiAQPHkjgECLEQAM0TPzYKqCAAAMUCGRo4HBgPQhZHBiowsKDBwsFAwyoK+ADxBM6YsSo4TihXQsTHwqI4QGDAIj1HKi84UJhgBtALtUpyfEBjBswRqSEYG3NOwYMnJXmCCFFChQoePhY4AAaKXm4dauEgMI3iiJDMLYokurMZ5UrTuConPAFI5VJTEC1TPAnWC8RHHMFYTRBIbdF0dCZgqgiyJEjd2YUBFBt25ouXFAwBggIaWDHBBPwccQfV+wmEBW1WCHIAPaAIIc2dTTAwQoaYGCFJIAINIEPwjDBlVgEJaKIJ1ds0MgSpRjgxYwL7KdQBq44IkYDGiiDRSn25EAIEkDoZA8Vz7hSgj0DmCLGHAKNsQocRsKhywUmeTGNDwLVAwkSFHJUTwonEBTJEgTV44QBRhaEwSd9tfmQfioFBAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcGCABgUTKlzooEOAhRAFOohA8AOHghoiEqRggeCEBQYGrqigQKPABwIGPLCXYMGCDQI7vLjx0GQCAxRCSkAwYYS9DRUurIAYoB5BAQUKUHjggsMECTJkVChQEMDAEF0IUVmpwIDXAxEkKBhQokILe/UacBBRgmA9NAwYZPqD4AHFggc6RBBQwkQIFT7dtonLAIvRhRxUkFgcOKEZZ+QqRHxQJcSOkBBl5DHpAkfNgglcYEDx5YNJBS43FJAgkMKUQudIvSoXwqQDDzk81PBRRfWjbqQyrfmlxDZuDyxqYFggEMILI+H2XNSooIOLBRYaWE2ogc92iDRwRLUEQAtZmNoQKRhhUqNjwnpcuvh5pixBZiZAgPBg7vYIqjBxqDGBD08kNAETH2zggxBMoDABQTuw8QgPHVlgChZHFDBDeDvYkEgKAhkgQhIqfJbAZ/aQIcYSkYxgxSZ4ZMDFFHXgBZEDhLCxygAW0NHEJfZ0aAMVJgn0wxLK/GBPAbtIQYZAUJQhzXcRzXHIEAPBsYoRAhEQxRQQFMkDEQTN0UZbXYYwQJEJVZCIfWxG1AAMRQYEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEiQoISCCBMqfJDhgMKHAmv8IFhgQISB9QoogDiwVCwfAwUIcCAQgAUXFznae8IgHQZ7BAQUKCDQAoIJBFTakzCIATUH9WQKsAcBwYIPDwkAINiGAYNN9QwMMKBgwQQEJBVWgSWqCEkaseiZCUAgwYEGHG4GsBdhA44TCQg2+pbJTyQFZ0wk1ABBAQ4RFXogJTgA26Jev/pAhCDigowLGhISSLRGUw6IAU68uDAAYg46DzhuWHAQYUYQIZxwUHngwwcLEHLaS0CF06FajlB9UamARAgMJn7cEBDBjjFFYcKgEqRSAobnGEjs2CBQQo8oqdQQ0dmixQq+axFSxIhCgSOOFrIT1gthKg7IhxKU6DCRtSAAQ6HQVEqWMuEKLTXEkMQICLmBTCXFcDGACu8R1IAKBYxAggc5eGABQQjQUQYfqxWAixR2ZNBBCxp0wEMU2wUwwgUk/LDUQA4NlIIUSJxRwB1v8KEAFVCgcOFA6SFEwBVNfJLBA3hcYYg9N6SAggg62bOAF0iQwJYeQUBhDwAkRFFDeBwpcQ0LA+XxhgoCHaBCCvVBVIVeAzFRxgkEvTBUlARdkEubeCIUAZQqBQQAOw==" style="width: auto; height: auto; margin: 0 auto; display: block;">';return e.document.write(t),e},getSelectedPagesString:function(e){for(var t=[],a=this.getParam("selectionSource"),i=0,r=e.length;r>i;i++){var n=e[i];if("chapters"===a)var s=n;else var s=MainFrame.Util.zeroFill(n)+".pdf";t.push(s)}return t.join(",")},getPdfSelection:function(e,t,a,i,r){var n=this.initLoadingWindow(),s=this.getSelectedPagesString(a),o="prefixName="+t+"&selectedPages="+encodeURIComponent(s),l=new XMLHttpRequest;l.open("POST",i,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var t=l.responseText,a=/sendResult=([a-zA-Z]*)/i,i=t.match(a);if(i&&"true"===i[1]){var s=/filename=(.*?)\.pdf/i,o=t.match(s),c=r+o[1],d=MainFrame.Browser.isHTTPS?"https://":"http://";c=d+"www.interactivpdf.com/OUTPUT/"+o[1]+".pdf","download"===e?n.location=c:"print"===e&&(n.location=d+"www.interactivpdf.com/print.html?path="+encodeURIComponent(c))}else alert("There was an error, please try again later")}},l.send(o)}}),MainFrame.Action.DownloadPage=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("source"));if(e){var t="320",a=this.getPageSource(e,t);if(a){var i=this.getParam("openMethod");if("download"===i){var r=document.createElement("a"),n=a.split("/").pop();
r.href=a,r.download=n,MainFrame.Util.click(r)}else window.open(a,"_blank")}}else MainFrame.Util.showError("Download page source module is invalid. No object found with the id "+this.getParam("source"));this.endAndClearAction()},getPageSource:function(e,t){var a,i=e.settings.pages.pdfPrefix,r=this.getParam("page"),n=this.getParam("type")||"pdf",s=!0,o=e.currentPage,l=o,c=o+1,d=e.leftPageNumber,g=e.rightPageNumber,h="",u="",m=MainFrame.Util.getMainFrame(),p=MainFrame.Util.getAppURL();switch(r){case"current":u=e.pageReferences[o],h="pdf"===n?p+u.pdf:p+e.settings.pages.dataSrc+u.hd,a=d,1==o&&(a=g);break;case"left":u=e.pageReferences[l],h="pdf"===n?p+u.pdf:p+e.settings.pages.dataSrc+u.hd,a=d;break;case"right":u=e.pageReferences[c],u&&(h="pdf"===n?p+u.pdf:p+e.settings.pages.dataSrc+u.hd,a=g);break;case"both":var f=e.pageReferences[l],v=e.pageReferences[c],M=[];f&&M.push(f.filename),v&&M.push(v.filename);var b=M.join("_");h=p+e.settings.pages.commonSrc+i+b+".pdf",a=d+"_"+g;break;case"localURL":h=p+this.getParam("path"),a="catalog.pdf";break;case"URL":s=!1,h=this.getParam("path");break;case"chapter":h=this.getChapterWithPage(e,o),a=h,MainFrame.Util.isAbsoluteUrl(h)||(h=p+h);break;default:this.isChapterId(e,r)?(h=this.getChapterWithId(e,r),a=h,MainFrame.Util.isAbsoluteUrl(h)||(h=p+h)):(r=parseInt(r,10),u=e.pageReferences[r],s=!1,u&&(h=u.pdf))}return s&&"undefined"!=typeof a&&m.hasTracking&&MainFrame.Tracker.sendTrackedEvent(t,"press",this.initiatorObject,[a]),MainFrame.Util.localizePath(h)},isChapterId:function(e,t){var a=e.settings.pages.chapters;return a&&t in a.pdf?!0:!1},getChapterWithPage:function(e,t){var a=e.settings.pages.chapters;if(a){var i=t+"";for(var r in a.pdf){var n=a.pdf[r];if(-1!==n.pages.indexOf(i))return a.settings.dataPath+n.file}}return""},getChapterWithId:function(e,t){var a=e.settings.pages.chapters;if(a){var i=a.pdf[t];if(i)return a.settings.dataPath+i.file}return""}}),MainFrame.Action.DownloadPageSelection=MainFrame.Action.BasePageSelection.extend({startAction:function(){var e=this.getParam("catalogId")||"catalog",t=MainFrame.Manager.Scoping.getById(e),a=this.getParam("catalogPdfPath")||t.commonDataSrc+"catalogue.pdf",i=decodeURIComponent(this.getParam("interactifPdfUrl")),r=decodeURIComponent(this.getParam("interactifPdfGetUrl")),n=this.getParam("prefixName")||"",s=this.getSelectedPages(),o=(this.getSelectionPath(),s.length),l=t.settings.pages.totalPages;switch(o){case 0:MainFrame.EventHandler.dispatch("customError",[{errorMessageId:"downloadPageSelectionNoPagesSelected"}]);break;case 1:var c=s[0],d=t.pageReferences[c].pdf;window.open(d,"_blank");break;case l:var g=MainFrame.Util.isAbsoluteUrl(a);if(g)var d=a;else var d=MainFrame.Util.getAppURL()+a;window.open(d,"_blank");break;default:var h="download";this.getPdfSelection(h,n,s,i,r)}this.endAndClearAction()}}),MainFrame.Action.DownloadSelectedChapters=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=(this.getParam("checkId")||"chapterCheck",this.getParam("noSelectionTrigger")||"noSelectedChapters");if(e&&e.subObjects){for(var a=this.getChapterURLs(e),i=0,r=a.length;r>i;i++){var n=a[i],s=1e3,o=i*s;!function(e,t){setTimeout(function(){window.open(e,"_blank")},t)}(n,o)}0===r&&MainFrame.EventHandler.dispatch(t)}else MainFrame.Util.showError("DownloadSelectedChapters error! The target element does not contain chapter subObjects");this.endAndClearAction()},getChapterURLs:function(e){for(var t=this.getParam("checkId")||"chapterCheck",a=[],i=0,r=e.subObjects.length;r>i;i++){var n=e.subObjects[i];if(n.role){var s=n,o=s.getSubObjectWithId(t);o&&o.isChecked()&&a.push(s.role)}else n.subObjects&&(a=a.concat(this.getChapterURLs(n)))}return a}}),MainFrame.Action.PrintPage=MainFrame.Action.Print.extend({}),MainFrame.Action.PrintPageSelection=MainFrame.Action.BasePageSelection.extend({startAction:function(){var e=this.getParam("errorNoSelectionMessageId")||"multiSelectNoPagesSelected",t=(this.getParam("errorInteractifPdfMessageId")||"interactifPdfError",this.getParam("noSelectionTrigger")||"customError"),a=this.getParam("catalogId")||"catalog",i=MainFrame.Manager.Scoping.getById(a),r=this.getParam("catalogPdfPath")||i.commonDataSrc+"catalogue.pdf",n=decodeURIComponent(this.getParam("interactifPdfUrl")),s=decodeURIComponent(this.getParam("interactifPdfGetUrl")),o=this.getParam("prefixName")||"",l=MainFrame.Global.initializationVariables.appFolder;"undefined"!=typeof l&&"/"!==l[l.length-1]&&(l+="/");var c=this.getParam("selectionSource"),d=this.getSelectedPages(),g=this.getPrintPath(),h=d.length,u=i.settings.pages.totalPages;switch(h){case 0:MainFrame.EventHandler.dispatch(t,[{errorMessageId:e}]);break;case 1:var m=d[0];if("chapters"===c){var p="print";this.getPdfSelection(p,o,d,n,s)}else{var f=g+i.pageReferences[m].pdf;window.open(f,"_blank")}break;case u:var f=g+encodeURIComponent(r);window.open(f,"_blank");break;default:var p="print";this.getPdfSelection(p,o,d,n,s)}this.endAndClearAction()},getPrintPath:function(){if(null!==this.getParam("printPath")){var e=this.getParam("printPath");-1===e.indexOf("http")?e=MainFrame.Util.getAppURL()+e+"/print.html?path=":e+="/print.html?path="}else var e=MainFrame.Util.getAppURL()+"common/print.html?path=";return e}}),MainFrame.Action.PrintDynamicPage=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("source"),t=MainFrame.Manager.Scoping.getById(e);if(t){var a=this.getParam("page"),i=this.getParam("printPagePath")||MainFrame.Util.getAppURL()+"page-printer.html?page=",r=MainFrame.Util.getMainFrame(),n=r.hasTracking,s=t.currentPage;switch(0===s&&(s=1),a){case"current":var o="single"===t.settings.pages.catalogType,l="double"===t.settings.pages.catalogType,c="portrait"===t.orientation,d="landscape"===t.orientation;if(o)var g=s;else if(l)if(c)var g=s;else if(d){var g=s;2===t.pagesOnScreen&&(g+=","+(s+1))}break;case"left":var g=s;break;case"right":var g=s+1;break;case"double":var g=s+","+(s+1);break;case"all":case"catalog":var h=1,u=t.settings.pages.totalPages,g=h+"-"+u;break;default:var g=a}i+=g,i=MainFrame.Util.localizePath(i),n&&MainFrame.Tracker.sendTrackedEvent("310","press",this.initiatorObject,[g]),"true"===this.getParam("download")&&(i+="&download=true"),window.open(i,"_blank")}else MainFrame.Util.showError("Dynamic print page source module is invalid. No object found with the id "+this.getParam("source"));this.endAndClearAction()}}),MainFrame.Element.Downloads=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseDownloads.call(this,e),this.buildDownloads();var t=this.sourceModuleId+":pageChanged",a=this.sourceModuleId+":orientationChanged";MainFrame.Publisher.subscribe(t,this,this.onPageChange),MainFrame.Publisher.subscribe(a,this,this.onPageChange)},onPageChange:function(){this.buildDownloads()},buildDownloads:function(){this.empty();var e=this.sourceModule;if("2"===e.API_VERSION){if(!e.pages[e.currentPage])return;var t=e.pagesOnScreen}else{if(!e.pages[e.currentContainer])return;var t=e.pages[e.currentContainer].numbers.length}var a=MainFrame.Manager.Resource.getById(this.templateName+t),i=new MainFrame.Element.Resource({superObject:this,data:a}),r=i.getSubObjectWithId("catalogPage");if(r){var n=!1;e.buildGraphicsInSubContainer(r,e.currentContainer,"diapo",n)}switch(this.fitType){case"resizeParent":this.superObject.setDimensionX(i.getDimensionX()),this.superObject.setDimensionY(i.getDimensionY()),this.superObject.resize();break;case"resizeSelf":i.setDimensionX(this.superObject.getDimensionX()),i.setDimensionY(this.superObject.getDimensionY());break;case"centerX":i.setPositionX("50% - w / 2");break;case"centerY":i.setPositionY("50% - h / 2");break;case"center":i.setPositionX("50% - w / 2"),i.setPositionY("50% - h / 2");break;case"none":}}}),!function(){MainFrame.DataParser.elements.downloads=MainFrame.Element.Downloads}(),MainFrame.Action.LoadIndexForCharacter=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("character"),t=this.getTarget();if(t){var a=t.index;a.indexMenu&&a.indexMenu.subObjects.forEach(function(t){t.setState(t.character===e?"select":"deselect")}),t.init(e),Ps.update(t.superObject.contentElement)}else MainFrame.Util.showError("LoadIndexForCharacter! Invalid target");this.endAndClearAction()}}),MainFrame.Action.LoadIndexForKeyword=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("keyword"),t=this.getParam("indexId"),a=this.getParam("pages")?this.getParam("pages").split("/"):[],i=MainFrame.Manager.Scoping.getById(t),r=this.getTarget();if(r.empty(),i){for(var n=0,s=a.length,o=[];s>n;n++){var l={},c=a[n];l.name=e,l.pages=[c],o.push(l)}i.hasHtmlTemplates||i.buildListForKeywords(o,r);var d=r.getSubObjectWithId("indexContainerRetourBtn");d&&d.setAction("id:indexBackKeywordAction")}r.resize(),this.endAndClearAction()}}),MainFrame.Element.Index=MainFrame.Abstract.Module.extend({readData:function(e){MainFrame.DataParser.parseIndexContainer.call(this,e),this.setLoadingScreen(),this.initIndex()},loadDataFromKeywords:function(){var e;if(MainFrame.IndexKeywords)var e=MainFrame.IndexKeywords;var t=this.listNonAlphaCharacters&&this.listNonAlphaCharacters===!0?!1:!0;this.characters=MainFrame.Util.extractFirstCharactersFromKeywords(t,e),this.characters.sort(),this.buildIndex()},initIndex:function(){if(this.dataPath){var e=this,t=MainFrame.Util.getAppURL()+this.dataPath;MainFrame.Util.request({url:t,xmlResponse:!0,onSuccess:function(t){MainFrame.DataParser.parseIndexKeywordsXML.call(e,t.documentElement),e.loadDataFromKeywords()}})}else MainFrame.Search.keywordsLoaded&&this.loadDataFromKeywords()},buildIndex:function(){var e=this;e.modulesBuilt=0,e.indexMenu.init(),e.indexPanel.init();var t=function(){e.modulesBuilt++,2===e.modulesBuilt&&e.removeLoadingScreen()};e.indexMenu.onIndexMenuBuilt=t,e.indexPanel.onIndexPanelBuilt=t}}),MainFrame.Element.IndexMenu=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseIndexMenu.call(this,e)},init:function(){if(this.getTemplates()){var e=this;setTimeout(function(){e.buildIndexMenu()},100)}},getTemplates:function(){if(this.charTemplate)return!0;var e=MainFrame.Manager.Resource.getById(this.charTemplateId);return e?(this.charTemplate=e,!0):(MainFrame.Util.showError('IndexMenu error! No resource found for the id: "'+this.charTemplateId+'"'),!1)},buildIndexMenu:function(){switch(this.type){case"verticalList":this.buildVerticalList();break;case"horizontalList":this.buildHorizontalList();break;case"grid":this.buildGrid();break;default:this.buildVerticalList()}this.onIndexMenuBuilt()},buildHorizontalList:function(){for(var e=0,t=this.index.characters,a=t.length,i=0;a>e;e++){var r=t[e],n=new MainFrame.Element.Resource({superObject:this,data:this.charTemplate});n.character=r;var s=n.getSubObjectWithRole("character")||n.getSubObjectWithId("indexMenuCharValue");s&&s.setText(r);var o=n.getDimensionX();n.setPositionX(o*e),i+=o,n.setAction("id:loadIndexForCharacter;params:char="+r),this.index.startingCharacter&&this.index.startingCharacter===r&&n.setState("select")}this.setAction("id:indexMenuHorizontalActions"),this.setDimensionX(i),this.resize()},buildVerticalList:function(){for(var e=this.index.characters,t=0,a=e.length,i=0;a>t;t++){var r=e[t],n=new MainFrame.Element.Resource({superObject:this,data:this.charTemplate});n.character=r;var s=n.getSubObjectWithRole("character")||n.getSubObjectWithId("indexMenuCharValue");s&&s.setText(r);var o=n.getDimensionY();n.setPositionY(o*t),i+=o,n.setAction("id:loadIndexForCharacter;params:char="+r),this.index.startingCharacter&&this.index.startingCharacter===r&&n.setState("select")}this.setAction("id:indexMenuVerticalActions"),this.setDimensionY(i),this.resize()},buildGrid:function(){var e,t,a,i,r=this.index.characters,n=0,s=0,o=0,l=r.length,c=this.getDimensionX();for(this.getDimensionY();l>n;n++){var d=r[n],g=new MainFrame.Element.Resource({superObject:this,data:this.charTemplate});g.character=d;var h=g.getSubObjectWithRole("character")||g.getSubObjectWithId("indexMenuCharValue");h&&h.setText(d),g.setAction("id:loadIndexForCharacter;params:char="+d),this.index.startingCharacter&&this.index.startingCharacter===d&&g.setState("select"),"undefined"==typeof i&&(e=e||g.getDimensionX(),t=t||g.getDimensionY(),i=Math.floor(c/e),a=Math.round((c-i*e)/2));var u=o*e+a,m=s*t;g.setPositionX(u),g.setPositionY(m),o++,o===i&&(o=0,s++)}}}),MainFrame.Element.IndexPanel=MainFrame.Abstract.Module.extend({readData:function(e){MainFrame.DataParser.parseIndexPanel.call(this,e)},init:function(e){if(this.character=e||this.index.startingCharacter,this.empty(),this.setLoadingScreen(),this.getTemplates()){var t=this;setTimeout(function(){t.buildIndexPanel()},300)}},getTemplates:function(){return this.cellTemplate||this.cellTemplateId?this.getXmlTemplates():this.cellTemplateHtml?this.getHtmlTemplates():!1},getXmlTemplates:function(){if(!this.cellTemplate){var e=MainFrame.Manager.Resource.getById(this.cellTemplateId);if(!e)return MainFrame.Util.showError('IndexPanel error! No resource found for the id: "'+this.cellTemplateId+'"'),!1;this.cellTemplate=e}if(!this.cellPageTemplate){var t=MainFrame.Manager.Resource.getById(this.cellPageTemplateId);if(!t)return MainFrame.Util.showError('IndexPanel error! No resource found for the id: "'+this.cellPageTemplateId+'"'),!1;this.cellPageTemplate=t}if(!this.cellHeaderTemplate){var a=MainFrame.Manager.Resource.getById(this.cellHeaderTemplateId);if(!a)return MainFrame.Util.showError('IndexPanel error! No resource found for the id: "'+this.cellHeaderTemplateId+'"'),!1;this.cellHeaderTemplate=a}return!0},getHtmlTemplates:function(){return"undefined"==typeof this.cellTemplateHtml?(MainFrame.Util.showError("IndexPanel error! No html template found, please create <itemHtmlTemplate>"),!1):"undefined"==typeof this.cellPageTemplateHtml?(MainFrame.Util.showError("IndexPanel error! No html template found, please create <pageHtmlTemplate>"),!1):"undefined"==typeof this.cellHeaderTemplateHtml?(MainFrame.Util.showError("IndexPanel error! No html template found, please create <headerHtmlTemplate>"),!1):(this.hasHtmlTemplates=!0,!0)},buildIndexPanel:function(){switch(this.type){case"verticalList":this.buildVerticalList();break;default:this.buildVerticalList()}Ps.update(this.superObject.contentElement),this.onIndexPanelBuilt()},buildVerticalList:function(){this.hasHtmlTemplates?this.buildVerticalList_HTML():this.buildVerticalList_XML()},buildVerticalList_XML:function(){if(this.character){var e=this.index.dataPath?MainFrame.IndexKeywords:null,t=MainFrame.Util.extractKeywordsForCharacter(this.character,e),a=new MainFrame.Element.Resource({superObject:this,containerElement:!1});this.characterList=a;var i=document.createDocumentFragment();a.containerElement=MainFrame.Util.createElement("div","",i),a.createContentElement(),this.buildListForKeywords(t,a),this.contentElement.appendChild(i),"Desktop"!==EnvDetection.deviceType&&a.setAction("id:applyVerticalEasing");var r=a.getSubObjectWithId("indexContainerRetourBtn");r&&r.setAction("id:indexBackAction")}this.resize(),this.removeLoadingScreen()},buildListForKeywords:function(e,t){function a(e,t){return e-t}var i=0,r=new MainFrame.Element.Resource({superObject:t,data:this.cellHeaderTemplate});i+=r.getDimensionY();for(var n=0,s=e.length;s>n;n++){var o=e[n];o.pages.sort(a);var l=new MainFrame.Element.Resource({superObject:t,data:this.cellTemplate}),c=l.getSubObjectWithRole("keyword")||l.getSubObjectWithId("indexKeyword");c.setText(o.name);for(var d=this.index.sourceModule,g=l.getSubObjectWithRole("page-list")||l.getSubObjectWithId("indexPageContainer"),h=g.getDimensionX(),u=0,m=o.pages.length,p=0,f=0;m>u;u++){if(this.usesPageNumbers)var v=o.pages[u],M=d.getPageForPageNumber(v);else var M=o.pages[u],b=d.pageReferences[M],v=b.number;var F=new MainFrame.Element.Resource({superObject:g,data:this.cellPageTemplate}),A=F.getDimensionX(),P=A*p;if(P+A>=h&&(p=0,f++,P=A*p),F.setPositionX(P),f){var y=F.getDimensionY();F.setPositionY(f*y)}var C=F.getSubObjectWithRole("page")||F.getSubObjectWithId("indexPageValue"),E=v;u!==m-1&&(E+=this.pageSeparator),C.setText(E),F.setAction("id:indexGoToPage;params:page="+M),p++}var S=l.getDimensionY();if(f){var w=g.getDimensionY(),I=f*y;g.setDimensionY(w+I),S+=I,l.setDimensionY(S)}l.setPositionY(i),i+=S}"Desktop"===EnvDetection.deviceType&&(i+=this.superObject.getPositionY()),this.characterList.setDimensionY("100%"),this.setDimensionY(i)},buildVerticalList_HTML:function(){if(this.character){var e=this.index.dataPath?MainFrame.IndexKeywords:null,t=MainFrame.Util.extractKeywordsForCharacter(this.character,e),a=new MainFrame.Element.Resource({superObject:this,containerElement:!1});this.characterList=a,a.containerElement=MainFrame.Util.createElement("div","",this.contentElement),a.createContentElement(),a.contentElement.style.overflow="visible",a.contentElement.style.position="relative",a.contentElement.style.height="auto",a.contentElement.innerHTML=this.buildHtmlListForKeywords(t),this.bindHtmlListActions(a,t),"Desktop"!==EnvDetection.deviceType&&a.setAction("id:applyVerticalEasing");var i=a.getSubObjectWithId("indexContainerRetourBtn");i&&i.setAction("id:indexBackAction");var r=a.contentElement.clientHeight;this.setDimensionY(r)}this.resize(),this.removeLoadingScreen()},buildHtmlListForKeywords:function(e){function t(e,t){return e-t}var a="";this.index.sourceModule,a+=this.cellHeaderTemplateHtml;for(var i=0,r=e.length;r>i;i++){var n=e[i];n.pages.sort(t);var s=this.cellTemplateHtml;s=s.replace("##name",n.name);for(var o="",l=0,c=n.pages.length;c>l;l++){var d=n.pages[l],g=this.cellPageTemplateHtml;g=g.replace(/##page/g,d),o+=g}s=s.replace("##pages",o),a+=s}return a},bindHtmlListActions:function(e){for(var t=this.index.sourceModule,a=0,i=e.contentElement.getElementsByTagName("span"),r=i.length;r>a;a++){var n=i[a];if(n.getAttribute&&"page"===n.getAttribute("data-role")){var s=n.getAttribute("data-page-value");page=t.getPageForPageNumber(s);var o=new MainFrame.Element.HtmlItem({superObject:this,containerElement:n});o.setAction("id:indexGoToPage;params:page="+page)}}}}),MainFrame.IndexTrie=new MainFrame.Abstract.Trie,MainFrame.IndexTrie.init=function(e){this.mainTrie=new MainFrame.Abstract.Trie.Node;for(var t in e)this.insertWord(this.mainTrie,t)},!function(){var e={parseIndexContainer:function(e){var t=this;MainFrame.DataParser.getSize.call(t,e),MainFrame.DataParser.getPos.call(t,e),MainFrame.DataParser.getSkinId.call(t,e),MainFrame.DataParser.getLoadingTemplateId.call(this,e),e.attributes.indexContainerId&&(this.settingsId=e.attributes.indexContainerId,MainFrame.DataParser.parseIndexContainerSettings.call(this,this.settingsId)),MainFrame.DataParser.getSourceModule.call(this,e),this.listNonAlphaCharacters=!1,e.attributes.listNonAlphaCharacters&&(this.listNonAlphaCharacters="true"===e.attributes.listNonAlphaCharacters?!0:!1),e.attributes.dataPath&&(this.dataPath=e.attributes.dataPath),e.attributes.startingCharacter&&(this.startingCharacter=e.attributes.startingCharacter),MainFrame.DataParser.parseChildren.call(t,e),MainFrame.DataParser.getSliderId.call(t,e)},parseIndexContainerSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);MainFrame.DataParser.getSourceModule.call(this,t),MainFrame.DataParser.getLoadingTemplateId.call(this,t),this.listNonAlphaCharacters=!1,t.attributes.listNonAlphaCharacters&&(this.listNonAlphaCharacters="true"===t.attributes.listNonAlphaCharacters?!0:!1),t.attributes.dataPath&&(this.dataPath=t.attributes.dataPath),t.attributes.startingCharacter&&(this.startingCharacter=t.attributes.startingCharacter)},parseIndexMenu:function(e){if(MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getAction.call(this,e),MainFrame.DataParser.parseChildren.call(this,e),e.attributes.indexId){var t=e.attributes.indexId,a=MainFrame.Manager.Scoping.getById(t);this.index=a,a.indexMenu=this,MainFrame.DataParser.parseIndexMenuSettings.call(this,a.settingsId);var i=MainFrame.DataParser.getNodeNamed(e,"indexChar");i&&(this.charTemplate=i);var r=e.attributes.layout;r&&("vertical"===r?this.type="verticalList":"horizontal"===r&&(this.type="horizontalList"),delete this.layout)}},parseIndexMenuSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);if(t)for(var a=0,i=t.childNodes.length;i>a;a++){var r=t.childNodes[a];"indexMenu"===r.nodeName&&(MainFrame.DataParser.getType.call(this,r),MainFrame.DataParser.getLoadingTemplateId.call(this,r),r.attributes.charTemplateId&&(this.charTemplateId=r.attributes.charTemplateId))}},parseIndexPanel:function(e){if(MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getAction.call(this,e),MainFrame.DataParser.getLoadingTemplateId.call(this,e),e.attributes.indexId){var t=e.attributes.indexId,a=MainFrame.Manager.Scoping.getById(t);this.index=a,a.indexPanel=this,MainFrame.DataParser.parseIndexPanelSettings.call(this,a.settingsId);var i=e.attributes.layout;i&&("vertical"===i?this.type="verticalList":"horizontal"===i&&(this.type="horizontalList"),delete this.layout),e.attributes.pageSeparator?this.pageSeparator=e.attributes.pageSeparator:this.pageSeparator||(this.pageSeparator=","),this.usesPageNumbers="true"===e.attributes.pageNumbers?!0:!1;var r=MainFrame.DataParser.getNodeNamed(e,"loadingTemplate");r&&(this.loadingTemplateData=r);var n=MainFrame.DataParser.getNodeNamed(e,"headerTemplate");n&&(this.cellHeaderTemplate=n);var s=MainFrame.DataParser.getNodeNamed(e,"itemTemplate");s&&(this.cellTemplate=s);var o=MainFrame.DataParser.getNodeNamed(e,"pageTemplate");o&&(this.cellPageTemplate=o);var l=MainFrame.DataParser.getNodeNamed(e,"headerHtmlTemplate");l&&(this.cellHeaderTemplateHtml=l.value);var c=MainFrame.DataParser.getNodeNamed(e,"itemHtmlTemplate");c&&(this.cellTemplateHtml=c.value);var d=MainFrame.DataParser.getNodeNamed(e,"pageHtmlTemplate");d&&(this.cellPageTemplateHtml=d.value)}MainFrame.DataParser.parseChildren.call(this,e)},parseIndexPanelSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);if(t)for(var a=0,i=t.childNodes.length;i>a;a++){var r=t.childNodes[a];"indexPanel"===r.nodeName&&(MainFrame.DataParser.getType.call(this,r),MainFrame.DataParser.getLoadingTemplateId.call(this,r),r.attributes.cellTemplateId&&(this.cellTemplateId=r.attributes.cellTemplateId),r.attributes.cellPageTemplateId&&(this.cellPageTemplateId=r.attributes.cellPageTemplateId),r.attributes.pageSeparator&&(this.pageSeparator=r.attributes.pageSeparator||""),r.attributes.cellHeaderTemplateId&&(this.cellHeaderTemplateId=r.attributes.cellHeaderTemplateId))}},parseIndexKeywordsXML:function(e){MainFrame.IndexKeywords={};for(var t=e.getElementsByTagName("k"),a=t.length,i=0;a>i;i++){var r=t[i],n=r.firstChild.textContent||r.firstChild.text,s=r.getAttribute("p"),o=[];if(s)for(var l=s.split(","),c=l.length,d=0;c>d;d++){var g=parseInt(l[d],10);o.push(g)}MainFrame.IndexKeywords[n]=o}}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),!function(){var e={extractFirstCharactersFromKeywords:function(e,t){t=t||MainFrame.Keywords;var a={};for(var i in t)if(t.hasOwnProperty(i)){var r=i[0].toLowerCase();a[r]=!0}var n=[];for(var i in a)e?i.match(/[a-z]/i)&&n.push(i):n.push(i);return n.sort(),n},extractKeywordsForCharacter:function(e,t){var a;t?(MainFrame.IndexTrie.isInitialized||MainFrame.IndexTrie.init(MainFrame.IndexKeywords),a=MainFrame.IndexTrie):(MainFrame.SearchTrie.isInitialized||MainFrame.SearchTrie.init(MainFrame.Keywords),t=MainFrame.Keywords,a=MainFrame.SearchTrie);var i=[],r=a.searchWordsBeginningWith(e.toLowerCase());MainFrame.Util.pushKeywordsToResult(r,i,t);var r=a.searchWordsBeginningWith(e.toUpperCase());return MainFrame.Util.pushKeywordsToResult(r,i,t),i},pushKeywordsToResult:function(e,t,a){for(var i=0,r=e.length;r>i;i++){var n=e[i],s={};s.name=n,s.pages=a[n],t.push(s)}}};MainFrame.Util.extend(MainFrame.Util,e)}(),!function(){MainFrame.DataParser.elements.indexPanel=MainFrame.Element.IndexPanel,MainFrame.DataParser.elements.indexMenu=MainFrame.Element.IndexMenu,MainFrame.DataParser.elements.indexContainer=MainFrame.Element.Index}(),MainFrame.Action.BaseRef=MainFrame.Abstract.Action.extend({startAction:function(){this.endAndClearAction()},getMapZone:function(){if("undefined"!=typeof this.mapZone)return this.mapZone;if(this.initiatorObject.superObject&&this.initiatorObject.superObject.zoneItem)var e=this.initiatorObject.superObject;else{var e=this.initiatorObject;e.isHotspot===!0&&(e=e.superObject)}return this.mapZone=e,e},getCatalog:function(){if("undefined"!=typeof this.catalog)return this.catalog;var e=this.getParam("mapsSourceId")||"catalog",t=MainFrame.Manager.Scoping.getById(e);return t?(this.catalog=t,t):void 0},isACheval:function(e){var t=this.getCatalog(),a=t.settings.pages.normalSize.width;return parseInt(e.recX,10)+parseInt(e.recW)>a},extractZoneImage:function(e){var t=this,a=MainFrame.Util.createElement("canvas"),i=this.getMapZone(),r=this.isACheval(i),n=this.getCatalog(),s=n.settings.pages.normalSize.width,o=n.settings.pages.normalSize.height;if(r){var l,c,d=i.page,g=d+1,h=new Image,u=new Image,m=MainFrame.Util.getHdSrc(n,d),p=MainFrame.Util.getHdSrc(n,g),f=!1,v=!1;h.onload=function(){l=this,f=!0,f&&v&&t.drawZoneInCanvas(i,a,l,c,s,o)},h.src=m,u.onload=function(){if(c=this,v=!0,f&&v){t.drawZoneAChevalInCanvas(i,a,l,c,s,o);var r=a.toDataURL("image/png");a=null,e(r)}},u.src=p}else{var M=i.page,b=MainFrame.Util.getHdSrc(n,M),F=new Image;F.onload=function(){var r=this;t.drawZoneInCanvas(a,i,r,s,o);var n=a.toDataURL("image/png");a=null,e(n)},F.src=b}},drawZoneAChevalInCanvas:function(e,t,a,i,r,n){var s=t.getContext("2d"),o=parseInt(e.recX,10),l=parseInt(e.recY,10),c=parseInt(e.recW,10),d=parseInt(e.recH,10),g=o+c,h=g-r,u=c-h,m=a.width/r,p=a.height/n,f=c*m,v=d*p;t.width=f,t.height=v;var M={};M.x=o*m,M.y=l*p,M.width=u*m,M.height=d*p;var b={};b.x=0,b.y=M.y,b.width=h*m,b.height=M.height;var F={};F.x=0,F.y=0,F.width=M.width,F.height=v;var A={};A.x=F.width,A.y=0,A.width=b.width,A.height=v,s.drawImage(a,M.x,M.y,M.width,M.height,F.x,F.y,F.width,F.height),s.drawImage(i,b.x,b.y,b.width,b.height,A.x,A.y,A.width,A.height)},drawZoneInCanvas:function(e,t,a,i,r){var n=parseInt(t.recX,10),s=parseInt(t.recY,10),o=parseInt(t.recW,10),l=parseInt(t.recH,10),c=a.width/i,d=a.height/r,g=o*c,h=l*d;e.width=g,e.height=h;var u={};u.x=n*c,u.y=s*d,u.width=o*c,u.height=l*d;var m={};m.x=0,m.y=0,m.width=g,m.height=h;var p=e.getContext("2d");p.drawImage(a,u.x,u.y,u.width,u.height,m.x,m.y,m.width,m.height)},initLoadingWindow:function(){var e=window.open(),t='<img id="loading" src="data:image/gif;base64,R0lGODlhHgAeAPf2AP7+/v39/fDw8O/v7/z8/PHx8e7u7vv7++Xl5fr6+vn5+ebm5gAAAPX19fT09Pb29vPz8/f39/j4+Ofn5/Ly8tTU1O3t7dXV1cnJyezs7Ojo6Orq6uTk5OPj476+vuvr69nZ2cjIyNbW1unp6crKytjY2MvLy9zc3LOzs7KyssfHx+Hh4b+/v9/f3+Li4tPT097e3sDAwNfX193d3dra2sHBwYmJidvb2+Dg4L29vby8vM/Pz7e3t9LS0sTExNDQ0LS0tIiIiLW1tcbGxszMzLi4uLq6uoyMjHBwcMPDw8XFxVhYWLGxsXFxccLCws7Ozra2trCwsG9vb42Njbm5uc3NzXNzc4qKilpaWtHR0bu7u3JycpKSkjs7O3Z2dq+vr66urj09PVlZWaioqKSkpISEhIKCgpqaml5eXnR0dJGRkSIiIltbW2lpaaWlpYaGhouLi1NTUz4+PqmpqXh4eI6OjpWVlZCQkJSUlJ6enpiYmJycnKqqqmpqakNDQ4eHh6Kiop+fn6ysrCUlJW5ubklJSa2trVRUVIODg4WFhUBAQCAgIKGhoV9fX0FBQYGBgaamppaWlmxsbFxcXGBgYFdXV5OTk5mZmTY2NiQkJB8fH21tbXl5eVBQUDw8PHt7ez8/P11dXX9/fzU1NSgoKJubm2dnZzQ0NDMzM52dnVFRUWtra5eXlyoqKk5OTiMjI1VVVQoKCmRkZE1NTaurq0ZGRjk5OTc3N35+fo+Pj0VFRX19fSEhISkpKURERBsbGywsLCcnJ6enpxgYGB4eHmJiYlJSUhoaGk9PT3V1dWFhYR0dHUdHRwUFBQcHBzg4OICAgCsrK6CgoFZWVi4uLmNjY3x8fGhoaGZmZkJCQkhISBYWFmVlZTo6OkxMTBISEnp6eqOjoxUVFS0tLQsLCxwcHBcXFzIyMhkZGRERERMTEzExMQ8PDw4ODiYmJgICAnd3d0pKSgQEBDAwMA0NDf///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgD2ACwAAAAAHgAeAAAI/wDrCRxIsKDBgwgRNoCQsGHCO1YcNgwgZMBAAJjMPRgY4AEAiQOnxbFYD0EsBkQEBihgIABIgTbETWJYgwEDQPVWDijwUuCQYJoe1Rtj8009BwIENOhZT4GqYK+o8GnHDhGAnQIIOIxxhcoIgXuGUbNDYcGEDA0MCGBYLwGFDAIMtuiESZUZDBZ2lTCoYECCBxkWIOgQ4SAMLF1AdZnTsECHBZCXIpzgpYu2vQklIEAwobBDMmokZjDwMaGDFSVOsG2YwAEFBwoKQmAxRUq1SZNgSJQgosIFGTA2xK6nIQiaSkvELKEhMcKFCxWi01hdb4ISQXkCLZCYYIILBBk8JsTMUEMiAp4OA9T4hOREQwgYSOA4kDCAMEJW+uhpCGKIiRAXJHCQBIC0IQU0goygAg4GDQBCAzg8gYEKFdBXUAicXFJDXB0EcYQQFFhgAAQgxKDFdgpMIIMJLhj0wEYDfXFFEEMskAITN0zgQQwmuCTQAQI2NAAXNrgRQAcopABCPT14wIIFTFWRCB4f1LNAku41oIQOS/YExhQtCCQAFChMIFABSWBQGkgxIDDQAR7wAONRJWjFFEE/DHGnQwVAueefBgUEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEhwoAEDBRMqXFjHxsKHAgHUeDCQQC0/CQY6+BIA4kBJdCQIvDEOWAmBB1zJqedRYKlzIe1pGZQJij0FnRjQaSnwSbYud+y54bWIkb0tDBjE4GnvARZffmaQyTQo3JOkpDIuBKKGxwKBbjAxgwLhBowHWsoxCCJQgQMBDgh2KBZH1hQaFB7RSCgA2ogDAgYIMCCSIAhJbBLzgAjBQIECAyIotGCmEqUTEBMYCKxVYYAidloKgNBRoQB7J2Yg9HigQYQICQAIdOCBi7VkVja94MlhAYIFGgYQsKdmixQkSNr8aCmh9wLfCyT3rMEDSIeWBwwMKAChcEIDPoZDt8wgfWE9JQ2vP0xQ4sIClgkjgLEx5Q0tiBxeyLgAI2ECYWXYYAkLEvSwQUIQtEAAAiJc8MIJ4glkgh6GmACBPQukIMQFhUngAgkqHGjPCC2UoAFBCsgWUQxCoDABBzro4MIHIZBQAXz2ABChQlAA4UQ9HHjggQv2vEACCRQwRUMUVJymAQsefOXAEyqo15IKPKxmTwwsDCAQBCZcgCNEO5w2kBI+dAbBCSp6VNpAFfTAVEsUXNhSQAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcKAACgUTKlzIhcvChwIPJEkwUMGSaREGPrB3AOJAL4gcDNTlC4RAC4dmeRx4plMZBfaGOAJVw96DJdtWDjTBZokbezrkhBFi79GiVyl02ouwBU0oGEEVFXGyppUcAQ9j6GHBQWAOWGi+FDjRAsKYLsP2CBTB5ZAagiM+9fHCyh6AOzISZvhTwEmhZgzUzSjY4RGSLU2iQBTEoPGyCgozsJLSZAdECKcYFMLxsJ6TPCt53KmnEMCADjBaDFhZr14CCQoCCISQRJqaI3De0Fh5wIIAAQMOHhghbIqN42VKrExgocDvAQZg2jMAosqQJBtWBnDgoMED6QkbXLAgfbkBRAIVgKAYcR4BBwuyEypQkgJKiiEAHn7gMAGBho4FJRFFCkWAcMAFHyR0wAa9IeCgBgXRoAMGJ5i3QQ4e5HWQAhuAUEEBAgnwwQIGEASgQAGQEEMOHHygggoaFPCCCDTkN1B8ClnAAgtP2LMBBhhAeIIIFyhlDwg6+GBeBkBmJ0EJFSCgFAZOYGVPASRgMJADFwymXQkICaQAEVWA90AHSpE3kAh5GQmRSDoFBAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcOAGDQUTKlyYh9XChwLrhaAwkMAWSRIGFkhRD+JAO38aCORACQ0MgRGwtfE4kEebSAfsPWGDRYW9AHRORWIpcIYVQl/sxRAjpoi9PZ4UmXgIgGA9NVaagHACa0mOHaD8YGs6MABBDGRiuPC6gxASewJudGgA5dAoowlUBLF3hKADPWXgBHqh4FKFhBQCZTDkzd0vTB0KCthzZUoQPl4XchnWapAcGgodgLERxObDAYqWhVoAUQSkCB7HAHr4IAOCDzwJ1ChCZENHew1ExOABBAWY2LwYMIi1TtQCCiao9PZ9g2WAV8IZfJvUQuABCy5O4LDAMkEpO4Z6SLa4XXBAj5gQG0R+KMODjhUeLQwQQGAhEQ9OcmCAOGAABQEGJEQACTp4kMQNEoAggIAGKADBfAUMUNAMSfTAgQL2GBACBjAcIMEBBxSAQAcQ2EOAAwAWQFB9A9VTgQkhjCBABSJkAAECEyDUFVcKFYABBiUIVMFf9mywAAIi8eSCCj8kkOGQGZg4AQLc8XSBCQ8I1MAFFVBkTwII6OhRPSs4UFEJMqBnjwIZkMfTQDic9CZLXnoUEAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcKCBEQUTKlw4JtXChwIB7HAwMEGZXQ8GPjBCAOJAPqwyCPzAKc2KkV5weRyoAtEeCPZmpGnywt6DXZ3IrBQ4oU4QJvZ6NEESwl6gSqFqLgxAMACjIzZo/OjTRkUJNo2aSHh4woeIDQeC/rGRQgORLAbAyDokxN6BC2S20CKoIMcXIDluBACzIyxBDW4cCJGla1ScDQUheEghJEUIvwrn3PITZtIMhRGIoEjRwiMWW2ZEPvxgAvLCIloWJihgb8ICATuFGPLQY8DAF0pisPBgBMZKCrc0DWplq4+IBll81Njde2WDbsQGRbNVLIvABBQ2cOgA2yMAFJCoVLrorhAEU4hKgEBUcAJDiA8e5TBoJLpghCwYTIQQUe8hDwYAjuMbQQn8MAQJP7hwAAIUJUQBBWfMA+AiCA00QQ8tGNBRBi/IsIA9EWxFgQEGNCCQCWYwg0dT/UVEgwgvCACBCy4I8MAABQxwnj317JiQAyJcAAMAECCAAGsFCCBABDu19kIJWzVgJEUHGCAABU3OIEODCiywAJP2KEAiACsBsIACAwXgWgIDEQCBj03as4EGcXokwVYrBQQAIfkEBQoA9gAsAQABABwAHAAACP8A7QkcSHCghQ0FEypcyGPOwocDQTQYeOCMJYINWByAODAEDwMDc02ZIDDDmyMcB9KIYmTiiiNXZNhrMOUak5QCBwhBEcLeiSs2qtgbQ8gKCJwCYwhJsYBGGURP7DVJ8ycBwY0DOWA4arVDCiAkPvzokeFLsj4s7CkYKurmwAQhtLBQMuPAkxUECAJYMeeBjjRoVCERUPABCQ81PJjI+zAOGjFpOChMIMNDDhcQR7RZEonwwwwVAnA0smOhAgoWBBZIKaEIFB8XPD+QUYUEBgxKJHM0EK+LIj/IvNx4cGOHCdtKSHIsMCuMn0KVzKwQSKDBgA0jHKQMoKLGDxcPFkK0QFCPYwpAHHG8EDHxoYNCx6q1WAjigogKHSAyOUZqTZfSBZXwwgUgaBDABhIoNIYGkMwSDTqjYDaQBicsQIFoBXCAQAYEKJBAPTncwkAQ9hywAx6hqKEXQQFMMAECBTyQgQUEGMEAA4skiFMECCyAUAQFCKDdFjd6gNQAHCxglQQCCDDRA3IwsAVSGiAQwUADCLCWPRnYgkp5HNUjgFXUZcmYPREEQiZSAxUwAJscHbAlRwEBACH5BAUKAPYALAIAAQAbABwAAAj/AO0JHEhQIAQDBRMqVPhDycKH9urNIBggB48IAyP4gDiwipMCAgtAQaHBYKpLADjaO6Fjo70FKFBMlMCojBCVAlmwIGJvRUwR9qDYsCFjYT2CAEzE8DACARgwNEYcqaNHAcGjAhf0aDEg5YQcHp4YODFRy5s/GCJ24GGpCMEsKjBkmWBvx40EBA/8gGSvh6U0fUR9IJjgAgYTIbIceAhokxUpUwQkJHADQ4iSD1ekkZLKwUMDNLA+pJJFIQEHBjQYkKDSgQcjQ2Y8ELiixIUKFXqA5KiBzRIsaFbdaVH7doUXDVQOaPQbjSRLOASiHmGBNccESWDDwJiwgQWVOYw8sCTwAQEH6wslUHoGTnJBAhoWTEAwAmIUTNnCyBo88MACBAhMUEACBlhVEARwLJBEE7qMEkcHAw0wgQXJ2dPAABZAoABrCnjgiDl4RHSDNEgEMpBo9gAwQAECBDDHMprk8sQawHiym0AoFrTiAPWMwQADiAi0xhpR4ERBAQjZw8KPe9hTgDfHNIHTAKsJhEMzDCQh0ATMgBKAShRQFAw5Nw5wxGw4EZSGK2lyhAAIOAUEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEhwYAIIBRMqXAjDxMKHAzs4GAiASIwHAw+AUABxoAgSAwRGSOJhgsAHTowQ6CiQgwoiEwew8CCQgJIvKlgKhECCRA8AG1iwAGHvRQoUNx4GAEDwI4YOI7RoEWEACJQiEQiuHLihxAoDB+wJCBGiAoUOHQxcYMKkxMAYjLQwFXjgxIsLJTQQgIEg7EACC0JIKOHmSCI1CwoegFFBRoUTcxWieHPExpkNCgOsqHBBAEQYcIK4CfkQggaWSSo8fEBBwIAELCE4qUGkRQOBCT4sQIBgAQeMHREgkYLECq5AHQ5kmMAbQYesHTU0kdIkjRkyHAQGiAChwAC/EBWYxRiyYwVHhREKsGQRo6NrC+cXUpACC5fJhAcGFKAwgPRCKktMggUSMxREgAGuDeAAAJCoV1ADl12ACCVxUELUQA8YoN5KGDDQChn2FFAABENgcUoeAs0giBmAEARAZPWowgADb/iAySiJZAGKL3FYQFAAD4HQDAO+2KMDL5pYYw8gnoTBh0724MGAJh3YY0Iva9xhTwCfoMIJlJ0Q84JAI9yyiBACUWCFMfE9BMAZKwxUjxi9VIlbFBNBSRArbOjZkQUt6BQQACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEiQYIOCCBMqXJAFgMKHAjkQrCcihIOBBFpAJIijggCBCqqE0CBQAhEnBzYK/FBBhEAKJDBoBLBDRxWVAh9cEAGCgAASJG7YO+HBwwmIAQbWa3GhggYDQ1TQsMeihpODCiEg+FAggb0GO3FEsPBBwAwdOUDYA8CyBhGCBEYgmGsgwQgKDgcGGPHkwQQnQKIIyVCQwAYEE+ZC/MFECBAjFhRmQNDh4sMMUJjEoACxgQGVMiQqlNAAAoWUKkmY6LECYwEDAwQIMCBB5YQgQWzAwWPIHgEKA4LPVqByhI0gV6boSTFhoIIHDQLUUxmhwg8ZC2onLEJLpQ4WSLcwshA3AqIGcJLgIEgYAQuD9/AgapGypYmoowQhKHoPLI+FPDAglIEeBsxwiRerNFECQUXIkUYOxO3AyylcPPDBBoSZYowbEelghyAESUdQG4MQY0YFhdRyxQqUNMJNeQPlldAJ1GQyiwQXOOLJFfagIIYYYOBkDxm/nOJSC4WEcYY99ViiCiJC9gEMBgI1sEQXRggUQR3XRIDTHmoNxIkj6wkEgA4QCFkQCpvIqGZCDoi2UUAAIfkEBQoA9gAsAQABABwAHAAACP8A7QkcSJBggYIIEyq0UKKewocCBzwgiONFg4EAXESAOPBDh4v2AoCokEGgSBUbOdorgADBRQkiLiCwVw9EiCwAVNpTgGACggMPLlzAYW9FCAwtHtbLOXDDggUfIlyogMABCSIkIBBkKvCBBQEODth7wIHDiAQPHkjgECLEQAM0TPzYKqCAAAMUCGRo4HBgPQhZHBiowsKDBwsFAwyoK+ADxBM6YsSo4TihXQsTHwqI4QGDAIj1HKi84UJhgBtALtUpyfEBjBswRqSEYG3NOwYMnJXmCCFFChQoePhY4AAaKXm4dauEgMI3iiJDMLYokurMZ5UrTuConPAFI5VJTEC1TPAnWC8RHHMFYTRBIbdF0dCZgqgiyJEjd2YUBFBt25ouXFAwBggIaWDHBBPwccQfV+wmEBW1WCHIAPaAIIc2dTTAwQoaYGCFJIAINIEPwjDBlVgEJaKIJ1ds0MgSpRjgxYwL7KdQBq44IkYDGiiDRSn25EAIEkDoZA8Vz7hSgj0DmCLGHAKNsQocRsKhywUmeTGNDwLVAwkSFHJUTwonEBTJEgTV44QBRhaEwSd9tfmQfioFBAAh+QQFCgD2ACwBAAEAHAAcAAAI/wDtCRxIcGCABgUTKlzooEOAhRAFOohA8AOHghoiEqRggeCEBQYGrqigQKPABwIGPLCXYMGCDQI7vLjx0GQCAxRCSkAwYYS9DRUurIAYoB5BAQUKUHjggsMECTJkVChQEMDAEF0IUVmpwIDXAxEkKBhQokILe/UacBBRgmA9NAwYZPqD4AHFggc6RBBQwkQIFT7dtonLAIvRhRxUkFgcOKEZZ+QqRHxQJcSOkBBl5DHpAkfNgglcYEDx5YNJBS43FJAgkMKUQudIvSoXwqQDDzk81PBRRfWjbqQyrfmlxDZuDyxqYFggEMILI+H2XNSooIOLBRYaWE2ogc92iDRwRLUEQAtZmNoQKRhhUqNjwnpcuvh5pixBZiZAgPBg7vYIqjBxqDGBD08kNAETH2zggxBMoDABQTuw8QgPHVlgChZHFDBDeDvYkEgKAhkgQhIqfJbAZ/aQIcYSkYxgxSZ4ZMDFFHXgBZEDhLCxygAW0NHEJfZ0aAMVJgn0wxLK/GBPAbtIQYZAUJQhzXcRzXHIEAPBsYoRAhEQxRQQFMkDEQTN0UZbXYYwQJEJVZCIfWxG1AAMRQYEACH5BAUKAPYALAEAAQAcABwAAAj/AO0JHEiQoISCCBMqfJDhgMKHAmv8IFhgQISB9QoogDiwVCwfAwUIcCAQgAUXFznae8IgHQZ7BAQUKCDQAoIJBFTakzCIATUH9WQKsAcBwYIPDwkAINiGAYNN9QwMMKBgwQQEJBVWgSWqCEkaseiZCUAgwYEGHG4GsBdhA44TCQg2+pbJTyQFZ0wk1ABBAQ4RFXogJTgA26Jev/pAhCDigowLGhISSLRGUw6IAU68uDAAYg46DzhuWHAQYUYQIZxwUHngwwcLEHLaS0CF06FajlB9UamARAgMJn7cEBDBjjFFYcKgEqRSAobnGEjs2CBQQo8oqdQQ0dmixQq+axFSxIhCgSOOFrIT1gthKg7IhxKU6DCRtSAAQ6HQVEqWMuEKLTXEkMQICLmBTCXFcDGACu8R1IAKBYxAggc5eGABQQjQUQYfqxWAixR2ZNBBCxp0wEMU2wUwwgUk/LDUQA4NlIIUSJxRwB1v8KEAFVCgcOFA6SFEwBVNfJLBA3hcYYg9N6SAggg62bOAF0iQwJYeQUBhDwAkRFFDeBwpcQ0LA+XxhgoCHaBCCvVBVIVeAzFRxgkEvTBUlARdkEubeCIUAZQqBQQAOw==" style="width: auto; height: auto; margin: 0 auto; display: block;">';
return e.document.write(t),e},getMaps:function(e){var t=[];if(e&&e.settings.maps.active)if(e.isSinglePage){var a=e.currentPageContainers.page,i=a.maps;t.push(i)}else{var r=e.currentPageContainers.left,n=e.currentPageContainers.right,s=r.maps,o=n.maps;t.push(s),t.push(o)}return t},getPrices:function(e){var t=[];if(e&&e.settings.prices.active)if(e.isSinglePage){var a=e.currentPageContainers.page,i=a.prices;t.push(i)}else{var r=e.currentPageContainers.left,n=e.currentPageContainers.right,s=r.prices,o=n.prices;t.push(s),t.push(o)}return t},extractRefByRefId:function(e,t){for(var a=0,i=e.childNodes.length;i>a;a++){var r=e.childNodes[a],n=r.nodeName;if("ref"===n){var s=r.getElementsByTagName("id");if(s.length){var o=s[0],l=MainFrame.DataParser.getCDATA(o);if(l===t){var c={},d=MainFrame.DataParser.parseXml(r);MainFrame.DataParser.parseRefs(c,d);for(var g in c){var h=c[g];return h}}}}}return null},placeResource:function(e){var t=this.getParam("positioning");if("centered"===t||"center"===t)e.setPositionX("50%-w/2"),e.setPositionY("50%-h/2");else{var a=this.getParam("sourceEvent"),i="undefined"==typeof a.initialX?a.clientX:a.initialX,r="undefined"==typeof a.initialY?a.clientY:a.initialY;r-=e.getDimensionY()/2,0>r&&(r=0),r>MainFrame.Browser.height-e.getDimensionY()&&(r=MainFrame.Browser.height-e.getDimensionY()),i>MainFrame.Browser.width-e.getDimensionX()&&(i-=e.getDimensionX()),e.setPositionX(i),e.setPositionY(r)}},extractRefByZoneId:function(e,t){var a=0,i=e.getElementsByTagName("zone");for(totalZones=i.length;totalZones>a;a++){var r=i[a],n=r.getAttribute("id");if(n===t){var s=r.getElementsByTagName("ref");if(s.length){var o=s[0],l=MainFrame.DataParser.getCDATA(o);if(l)return this.extractRefByRefId(e,l)}}}return null},extractMultiRefsByZoneId:function(e,t){for(var a=[],i=0,r=e.getElementsByTagName("zone"),n=r.length;n>i;i++){var s=r[i],o=s.getAttribute("id");if(o===t)for(var l=0,c=s.childNodes.length;c>l;l++){var d=s.childNodes[l],g=d.nodeName;if("ref"===g){var h=MainFrame.DataParser.getCDATA(d),u=this.extractRefByRefId(e,h);a.push(u)}if("zone"===g){var m=d.getAttribute("id"),p=this.extractMultiRefsByZoneId(e,m);p.forEach(function(e){a.push(e)})}}}return a},baseOpenURL:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=t.settings.maps,i=this.getParam("winName"),r=this.getParam("urlTarget"),n=a.baseUrlMaps,s=a.finUrlMaps;"undefined"==typeof s&&(s="");var o=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],l=o.type,c=o.url,d=t.settings.maps.settings,g=d.hotspotsArr[l].hotspotBaseUrl,h=d.hotspotsArr[l].hotspotFinUrl;n=""!==g?g:void 0===g?n:"",s=""!==h?h:void 0===h?h:"",(c.indexOf("http")>=0||c.indexOf("mailto")>=0)&&(n=s="");var u=n+c+s;MainFrame.ActionManager.doAction(this,this,"catalogue","openURL","false",[{url:u,winName:i,urlTarget:r}])}}),MainFrame.Action.BaseZoomMap=MainFrame.Abstract.Action.extend({startAction:function(){this.endAndClearAction()},hasAssociatedMaps:function(e){var t=e.superObject,a=this.getHDZoomMaps(t);return a.length>1?!0:!1},getHDZoomMaps:function(e){var t=[];return e.subObjects.forEach(function(e){e.id&&-1!==e.id.indexOf("hd_zoom_zone_")&&t.push(e)}),t},getStep:function(){var e=this.getParam("step");if(e)var t=parseFloat(e,10);else var t=.1;return t},getMaxZoneScale:function(e){var t=this.getZoneSize(e),a=e.superObject,i=a.currentCatalogSize,r=i.width/t.width,n=i.height/t.height;return Math.min(r,n)},getMaxZonesScale:function(e){var t=this.getZonesSize(e),a=e.superObject,i=a.currentCatalogSize,r=i.width/t.width,n=i.height/t.height;return Math.min(r,n)},zonesFitInsideContainer:function(e,t){var a=e.superObject,i=this.getZonesSize(e);return this.sizeFitsInsideContainer(a,i,t)},zoneFitsInsideContainer:function(e,t){var a=e.superObject,i=this.getZoneSize(e);return this.sizeFitsInsideContainer(a,i,t)},sizeFitsInsideContainer:function(e,t,a){var i=e.currentCatalogSize,r=t.width*a,n=t.height*a;return r>i.width?!1:n>i.height?!1:!0},getZoneSize:function(e){var t=e.containerElement,a=parseFloat(t.style.left,10),i=parseFloat(t.style.top,10),r=parseFloat(t.style.width,10),n=parseFloat(t.style.height,10);return{x:a,y:i,width:r,height:n}},getZonesSize:function(e){var t,a,i,r,n=e.superObject,s=this.getHDZoomMaps(n),o=this;s.forEach(function(e){var n=o.getZoneSize(e);("undefined"==typeof t||n.x<t)&&(t=n.x),("undefined"==typeof i||n.y<i)&&(i=n.y);var s=n.x+n.width,l=n.y+n.height;("undefined"==typeof a||s>a)&&(a=s),("undefined"==typeof r||l>r)&&(r=l)});var l=a-t,c=r-i;return{x:t,y:i,width:l,height:c}},getTranslation:function(e,t){var a=0,i=0,r=e.superObject,n=r.currentCatalogSize,s=this.getZoneSize(e),o=s.x+s.width/2,l=s.y+s.height/2,c=s.width*t,d=s.height*t,g=l-d/2,h=l+d/2,u=o-c/2,m=o+c/2;return 0>g&&(i=0-g),h>n.height&&(i=n.height-h),0>u&&(a=0-u),m>n.width&&(a=n.width-m),{x:a,y:i}}}),MainFrame.Action.MediaRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mediaId");if(!e){if(this.initiatorObject.ref)var t=this.initiatorObject.ref;else if(this.initiatorObject.refs)var t=this.initiatorObject.refs[0];if(t&&t.url)var e=t.url}if(e){var a=this.getParam("panelPosX")||"0",i=this.getParam("panelPosY")||"0",r=this.getParam("panelWidth")||"100%",n=this.getParam("panelHeight")||"100%",s=MainFrame.Util.getMainFrame(),o=MainFrame.Manager.Media.getById(e),l=new MainFrame.Element.Media({id:"media",superObject:s,data:o});s.mediaReference=l,l.setDimensionX(r),l.setDimensionY(n),l.setPositionX(a),l.setPositionY(i),l.resize()}this.endAndClearAction()}}),MainFrame.Action.AudioRef=MainFrame.Action.MediaRef.extend({}),MainFrame.Action.DiapoRef=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],a=t.url,i=-1===a.indexOf(";");if(i)e=a;else for(var r=a.split(";"),n=0,s=r.length;s>n;n++){var o=r[n].split("=");if("mediaId"===o[0]&&(e=o[1]),"currentItem"===o[0])var l=o[1]}var c=this.getParam("panelPosX")||"0",d=this.getParam("panelPosY")||"0",g=this.getParam("panelWidth")||"100%",h=this.getParam("panelHeight")||"100%",u=MainFrame.Util.getMainFrame(),m=MainFrame.Manager.Media.getById(e);if("undefined"!=typeof l){var p=MainFrame.DataParser.getChildrenWithNodeName(m,"system")[0];modulesData=MainFrame.DataParser.getChildrenWithNodeName(p,"modules")[0],diaporamaSettingsData=MainFrame.DataParser.getChildrenWithNodeName(modulesData,"mediaDiaporama")[0],diaporamaSettingsData.attributes.currentItem=l}var f=new MainFrame.Element.Media({id:"media",superObject:u,data:m});u.mediaReference=f,f.setDimensionX(g),f.setDimensionY(h),f.setPositionX(c),f.setPositionY(d),f.resize(),this.endAndClearAction()}}),MainFrame.Action.VideoRef=MainFrame.Action.MediaRef.extend({}),MainFrame.Action.ShareRef=MainFrame.Abstract.Action.extend({startAction:function(){this.getShareURL(),this.endAndClearAction()},getProdId:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=this.initiatorObject,i=a.superObject,r=(t.currentPage,i.page),n=MainFrame.Util.zeroFill(r)+i.zoneAttributes.id;return n},getCatalogURL:function(){var e=document.location.href,e=e.replace("index.html",""),e=e.replace("appli.html",""),e=e.replace("index.htm",""),e=e.replace("appli.htm",""),t=e.split("?")[0];return t=t.split("#")[0]},getRefSettings:function(e){var t=this.getParam("mapsSourceId"),a=MainFrame.Manager.Scoping.getById(t),i=a.settings.maps,r=i.settings.hotspotsArr,n=r[e];return n},getShareURL:function(e){var t=this.getProdId(),a=this.getRefSettings(e),i="common/facebook/",r=".html";a&&(i=a.hotspotBaseUrl||i,r=a.hotspotFinUrl||r);var n=this.getCatalogURL(),s=n+i+t+r+t;return s},getMediaURL:function(e){var t=this.getProdId(),a=this.getRefSettings(e),i="common/facebook_maps/",r=".jpg";a&&(i=a.hotspotMediaBaseUrl||i,r=a.hotspotMediaFinUrl||r);var n=this.getCatalogURL(),s=n+i+t+r;return s}}),MainFrame.Action.ApplyZoomMapEasing=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getParam("translationEvent"),a="true"===this.getParam("invert")?!0:!1,i=this.getTarget(),r=i.superObject;if(r.easing?e=r.easing:(e=new MainFrame.Easing,r.easing=e,t&&e.onTranslationDispatch(t)),a){var n=this.getParam("rotation");e.__rotation=n,e.__invert=!0}var s=parseFloat(r.containerElement.style.width),o=parseFloat(r.containerElement.style.height),l=parseFloat(r.innerContainer.style.width),c=parseFloat(r.innerContainer.style.height),d=0,g=-(s-l),h=0,u=-(o-c),m=!0,p=!0;d===g&&(m=!1),h===u&&(p=!1),e.setOptions({scrollingX:m,scrollingY:p}),a?(e.setScrollTopLimits(d,g),e.setScrollLeftLimits(h,u)):(e.setScrollLeftLimits(d,g),e.setScrollTopLimits(h,u));var r=r;e.__targetContainer=r.innerContainer,e.setTarget(r),e.addListeners(),e.setScrollPosition(-r.translatedX,-r.translatedY);var f=this.getParam("sourceEvent").currentEvent;e.startWithEvent(f),this.endAndClearAction()}}),MainFrame.Action.ApplyZoomMapScrolling=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.actionItem,a=t.superObject,i=this.paramsObject.sourceEvent,r=i.clientX,n=i.clientY,s=r-a.absoluteLeft,o=n-a.absoluteTop,l=a.maxY,c=a.maxX,d=a.maxTranslationY,g=a.maxTranslationX;if(e.headerCanvases){var h,u;if(e.headerCanvases.forEach(function(e){e.headerData&&("vertical"===e.headerData.type?u=e:"horizontal"===e.headerData.type&&(h=e))}),h){var m=h.getDimensionY();o-=m,l-=m}if(u){var p=u.getDimensionX();s-=p,c-=p}}0>o&&(o=0),0>s&&(s=0);var f=100*s/c,v=100*o/l;t.translatedX=-(f*g)/100,t.translatedY=-(v*d)/100,MainFrame.Util.setTransformDuration(t.containerElement.parentNode,50),MainFrame.Util.setPosition(t.containerElement.parentNode,t.translatedX,t.translatedY,1),h&&(h.translatedX=t.translatedX,h.translatedY=0,MainFrame.Util.setTransformDuration(h.containerElement,50),MainFrame.Util.setPosition(h.containerElement,h.translatedX,h.translatedY,1)),u&&(u.translatedX=0,u.translatedY=t.translatedY,MainFrame.Util.setTransformDuration(u.containerElement,50),MainFrame.Util.setPosition(u.containerElement,u.translatedX,u.translatedY,1)),this.endAndClearAction()}}),MainFrame.Action.CloseZoomMap=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e.zoomMaps&&e.removingZoomMaps!==!0){e.removingZoomMaps=!0,this.zoomInMapsCleanup(e);var t=e.zoomMaps;for(var a in t.normal){var i=t.normal[a];i.containerElement.style.display="block",window.getComputedStyle(i.containerElement,null).getPropertyValue("display")}for(var a in t.hd){var r=t.hd[a];r.superObject.removeSubObject(r)}var n=this.getParam("duration");if(n)var s=parseFloat(n,10);else var s=.3;for(var a in t.normal){var i=t.normal[a];i.containerElement.style.display="block",i.translatedX=0,i.translatedY=0,MainFrame.Util.setTransformDuration(i.containerElement,s,"s"),MainFrame.Util.setPosition(i.containerElement,i.translatedX,i.translatedY,1)}this.removeOverlay(e),this.removeOverflow(e);var o=this;setTimeout(function(){for(var a in t.normal){var i=t.normal[a];i.superObject.removeSubObject(i)}e.zoomMaps.normal={},e.zoomMaps.hd={},e.zoomMapContainer.style.display="none",e.removingZoomMaps=!1,e.setCatalogState("idle"),o.endAndClearAction()},MainFrame.Util.secondsToMiliseconds(s)+50)}else e.setCatalogState("idle"),this.endAndClearAction()},zoomInMapsCleanup:function(e){e.zoomMapContainer.style.transform="",delete e.zoomMapContainer.scale,e.zoomMapOverlayClone&&(MainFrame.Util.removeElement(e.zoomMapOverlayClone),delete e.zoomMapOverlayClone),e.zoomMapOverlay.style.visibility=""},removeOverlay:function(e){window.requestAnimationFrame(function(){e.zoomMapOverlay.style.opacity="0"})},removeOverflow:function(e){if(e.isSinglePage){var t=e.currentPageContainers.page.maps;t.zonesContainer.style.overflow=""}else{var a=e.currentPageContainers.left,i=e.currentPageContainers.right,r=a.maps;if(r.zonesContainer.style.overflow="",i&&i.maps){var n=i.maps;n.zonesContainer.style.overflow=""}}}}),MainFrame.Action.ContainerPopupRef=MainFrame.Abstract.Action.extend({startAction:function(){console.log("Ref: Container popup"),this.endAndClearAction()}}),MainFrame.Action.DeliciousRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="delicious",t=this.getShareURL(e);"https://delicious.com/save?v=5&url="+encodeURIComponent(t),this.endAndClearAction()}}),MainFrame.Action.DiggRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="digg",t=this.getShareURL(e),a="http://digg.com/submit?url="+encodeURIComponent(t);window.open(a,"_blank"),this.endAndClearAction()}}),MainFrame.Action.DrawMapsInContainers=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e.settings.maps.hasMaps)for(var t=this.getParam("containers"),a=t.split("/"),i=0,r=a.length;r>i;i++){var n=a[i];if(this.isSinglePage){if("current"===n)var s=e.currentPageContainers.page,o=e.currentPage;else if("next"===n)var s=e.nextPageContainers.page,o=e.getNextPageValue();else if("previous"===n)var s=e.previousPageContainers.page,o=e.getPreviousPageValue();e.initMapsForContainerAndPage(s,o)}else{if("current"===n){var l=e.currentPage,c="single"===e.settings.pages.coverType;c&&1===l&&c&&(l=0);var d=e.currentPageContainers.left,g=e.currentPageContainers.right}else if("next"===n)var l=e.getNextPageValue(),d=e.nextPageContainers.left,g=e.nextPageContainers.right;else if("previous"===n)var l=e.getPreviousPageValue(),d=e.previousPageContainers.left,g=e.previousPageContainers.right;var h=l,u=l+1;e.initMapsForContainerAndPage(d,h),e.initMapsForContainerAndPage(g,u)}}this.endAndClearAction()}}),MainFrame.Action.EmailRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e=this.getProdId();console.log("Email "+e),this.endAndClearAction()}}),MainFrame.Action.EmbedVideoRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=t.settings.maps,i=this.initiatorObject.ref,r=i.type,n=i.url,s=t.settings.maps.settings,o=s.hotspotsArr[r].hotspotBaseUrl,l=s.hotspotsArr[r].hotspotFinUrl,c=a.baseUrlMaps||"",d=a.finUrlMaps||"";c=""!==o?o:void 0===o?c:"",d=""!==l?l:void 0===l?l:"",(n.indexOf("http")>=0||n.indexOf("mailto")>=0)&&(c=d="");try{"undefined"!=typeof V7&&V7.embedVideo&&V7.embedVideo(c+n+d)}catch(g){console.error("The embedVideo method is not implemented ! Check kta.js !")}this.endAndClearAction()}}),MainFrame.Action.FacebookRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="facebook",t=this.getShareURL(e),a="http://www.facebook.com/sharer.php?u="+encodeURIComponent(t);window.open(a,"_blank"),this.endAndClearAction()}}),MainFrame.Action.GoogleRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="google",t=this.getShareURL(e),a="https://plus.google.com/share?url="+encodeURIComponent(t);window.open(a,"_blank"),this.endAndClearAction()}}),MainFrame.Action.Goto1Ref=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=this.initiatorObject.ref,i=a.url,r=this.getTarget(),n=a.url,s=t.getPageForPageNumber(n);if(s){var o=t,l="undefined"!=typeof o.settings.pages.pageRestriction;if(l&&s>=o.settings.pages.pageRestriction)return void this.endAndClearAction();MainFrame.ActionManager.doAction(r,r,e,"goToPageCatalog","false",[{page:s}])}else MainFrame.Util.showError('Page not found for page label "'+i+'"');this.endAndClearAction()}}),MainFrame.Action.GotoRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=this.initiatorObject.ref,i=a.url,r=this.getTarget(),n=a.url,s=t.getPageForPageNumber(n);if(s){var o=t,l="undefined"!=typeof o.settings.pages.pageRestriction;if(l&&s>=o.settings.pages.pageRestriction)return void this.endAndClearAction();MainFrame.ActionManager.doAction(r,r,e,"goToPageCatalog","false",[{page:s}])}else MainFrame.Util.showError('Page not found for page label "'+i+'"');this.endAndClearAction()}}),MainFrame.Action.GoToPageMap=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("prodId");if(e&&t){e.goToMapId=t.substr(4);var a=parseInt(t.substr(0,4),10);if(e.isSinglePage)if(a===e.currentPage){var i=e.currentPageContainers.page,r=i.maps;r.drawMapsForPage(a)}else MainFrame.ActionManager.doAction(e,e,e.id,"goToPageCatalog","false",[{page:a}]);else{if(e.isRightPage(a))var n=a-1,s=a;else var n=a,s=a+1;if(n===e.currentPage||s===e.currentPage){var o=e.currentPageContainers.left,l=e.currentPageContainers.right,c=o.maps,d=l.maps;c.drawMapsForPage(n),d.drawMapsForPage(s)}else MainFrame.ActionManager.doAction(e,e,e.id,"goToPageCatalog","false",[{page:a}])}}this.endAndClearAction()}}),MainFrame.Action.HideMaps=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getMaps(e);t.forEach(function(e){e.hideMaps()})}this.endAndClearAction()}}),MainFrame.Action.HideMapsContent=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e&&e.settings.maps.active)if(e.isSinglePage){var t=e.currentPageContainers.page;t.maps&&t.maps.hideCustomContent()}else{var a=e.currentPageContainers.left,i=e.currentPageContainers.right;a.maps&&a.maps.hideCustomContent(),i.maps&&i.maps.hideCustomContent()}this.endAndClearAction()}}),MainFrame.Action.HideMapsForZoomedPage=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getMaps(e);t.forEach(function(e){e.hideMapsForZoomedPage()})}this.endAndClearAction()}}),MainFrame.Action.HideVideoAfterPlay=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("hideTargetId"),t=MainFrame.Manager.Scoping.getById(e),a=this.getParam("videoId"),i=document.getElementById(a);if(i&&t){var r=this.getParam("duration");if(r)var n=parseFloat(r,10);else var n=.3;var s=this,o=function(){MainFrame.ActionManager.doAction(t,t,e,"hide","false",[{duration:n}]),MainFrame.Event.unbind(i,"ended",o),s.endAndClearAction()};MainFrame.Event.bind(i,"ended",o)}else this.endAndClearAction()}}),MainFrame.Action.IframeRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],t=e.url,a=new MainFrame.Element.Resource,i=this.getParam("containerId")||"iframeContainer";a.id=i,MainFrame.Manager.Scoping.register(i,a);var r=this.getTarget();a.addSuperObject(r),r.addSubObject(a);var n=this.getParam("width")||"50%",s=this.getParam("height")||"50%";a.setPositionX("50%-w/2"),a.setPositionY("50%-h/2"),a.setDimensionX(n),a.setDimensionY(s),a.resize();var o=MainFrame.Util.createElement("iframe","",a.containerElement);o.style.width="100%",o.style.height="100%",o.style.border="0px",o.src=t,this.endAndClearAction()}}),MainFrame.Action.InitYoutubeIframe=MainFrame.Abstract.Action.extend({startAction:function(){function e(){switch(a){case"play":default:i.playVideo()}}if("undefined"==typeof YT)return MainFrame.Util.showError('The Youtube API script is not included. Please insert <script src="https://www.youtube.com/iframe_api"></script>'),void this.endAndClearAction();var t=this.getParam("iframeId"),a=this.getParam("action")||"play",i=new YT.Player(t,{events:{onReady:e}});this.endAndClearAction()}}),MainFrame.Action.InternalRef=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=this.getTarget(),a=this.getParam("mapsSourceId"),i=MainFrame.Manager.Scoping.getById(a),r=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0];if(r.infos&&r.infos.children&&r.infos.children.value&&(e=r.infos.children.value.value),e){var n=parseInt(e.substr(0,4)),s=i.getContainerForCustomPage(n),o=e.substr(4);i.goToMapId=o,MainFrame.ActionManager.doAction(t,t,a,"goToPageCatalog","false",[{page:s}])}else MainFrame.Util.showError("No prodId found for reference:"+r);this.endAndClearAction()}}),MainFrame.Action.LdcRef=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.initiatorObject,t=this.getParam("refId"),a=this.getParam("zoneId"),i=this.getParam("page");if((t||a)&&i){var r=this.getParam("mapsSourceId"),n=MainFrame.Manager.Scoping.getById(r),s=MainFrame.Util.zeroFill(i),o=MainFrame.Util.getAppURL()+n.settings.maps.dataSrcMaps+"/"+s+".xml",l=this;MainFrame.Util.request({url:o,xmlResponse:!0,onSuccess:function(e){var i=e.documentElement;if(t)var r=l.extractRefByRefId(i,t);else if(a){var r=l.extractRefByZoneId(i,a),n="true"===l.getParam("scrollshopMultiZone");if(n)var s=l.extractMultiRefsByZoneId(i,a)}r&&l.openRef(r,s)}})}else if(e.ref){var c=e.ref;if("undefined"!=typeof e.refs){var d=[];for(var g in e.refs){var h=e.refs[g];h.id=g,d.push(h)}}this.openRef(c,d)}else if(e.refs&&e.refs.length){var c=e.refs[0];this.openRef(c)}},openRef:function(e,t){var a=this.getParam("mapsSourceId"),i=MainFrame.Manager.Scoping.getById(a),r=i.settings.maps.settings.hotspotsArr,n="false"===this.getParam("templateCaching")?!1:!0,s=this.getParam("templateId"),o=this.getParam("templateType"),l={};l.ref=e,l.refId=e.url,l.baseUrl=r[e.type].hotspotBaseUrl,l.finUrl=r[e.type].hotspotFinUrl,l.templateId=s,l.templateType=o,"ldc"===e.type&&r.ldc.useMultiPanel===!1&&("undefined"!=typeof t&&t.length>1?l.complementaryRefs=t:"undefined"!=typeof this.initiatorObject.refs&&this.initiatorObject.refs.length>1&&(l.complementaryRefs=this.initiatorObject.refs)),MainFrame.Manager.Variables.register("productId",e.url);var c=this.getParam("resourceId"),d=MainFrame.Manager.Scoping.getById(c);if(!c||!d)return MainFrame.Util.showError('LDC loading error! The resource with id: "'+c+'" does not exist!'),void this.endAndClearAction();var g=n?MainFrame.Manager.Cache.getById(s):null;if(g)MainFrame.EprintShop.loadProductDataInTarget(g,d,l);else switch(o){case"html":var h=MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/eps/templates/"+s+".html";MainFrame.Util.request({url:h,onSuccess:function(e){e?(n&&MainFrame.Manager.Cache.register(s,e),MainFrame.EprintShop.loadProductDataInTarget(e,d,l)):MainFrame.Util.showError("LDC loading error! The "+o+' template with id: "'+c+'" cannot be loaded from the path: '+h)}});break;case"xml":default:g=MainFrame.Manager.Resource.getById(s),g||(1===MainFrame.Browser.orientation?(s+="Portrait",g=MainFrame.Manager.Resource.getById(s)):(s+="Landscape",g=MainFrame.Manager.Resource.getById(s))),n&&MainFrame.Manager.Cache.register(s,g),MainFrame.EprintShop.loadProductDataInTarget(g,d,l)}this.endAndClearAction()}}),MainFrame.Action.LinkedinRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="linkedin",t=this.getShareURL(e),a="http://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(t);window.open(a,"_blank"),this.endAndClearAction()}}),MainFrame.Action.MailPageRef=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getParam("formId")||"mapToFriend",t=MainFrame.Manager.Resource.getById(e),a=(this.getParam("mailUrl"),this.getTarget());if(a&&t){var i=new MainFrame.Element.Resource({id:e,superObject:a,data:t}),r=this.getMapZone(),n=i.getSubObjectWithRole("page-preview");n&&n.setPageNumber(r.page);var s=i.getSubObjectWithRole("form-prodId");if(s){var o=this.getProdId(r);s.setText(o)}}this.endAndClearAction()},getProdId:function(e){var t=this.getCatalog();if(t.isSinglePage)return MainFrame.Util.zeroFill(e.page);var a="single"===t.settings.pages.coverType;if(a){if(1==e.page)return MainFrame.Util.zeroFill(1);if(t.isLeftPage(e.page))var i=parseInt(e.page),r=i+1;else var n=parseInt(e.page),i=n-1;return MainFrame.Util.zeroFill(i)+MainFrame.Util.zeroFill(n)}if(t.isLeftPage(e.page))var i=parseInt(e.page),r=i+1;else var r=parseInt(e.page),i=r-1;return MainFrame.Util.zeroFill(i)+MainFrame.Util.zeroFill(r)}}),MainFrame.Action.MailRef=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getParam("formId")||"mapToFriend",t=MainFrame.Manager.Resource.getById(e),a=(this.getParam("mailUrl"),this.getTarget());if(a&&t){var i=new MainFrame.Element.Resource({id:e,superObject:a,data:t}),r=function(e){var t=i.getSubObjectWithRole("map-preview");t&&t.setSource(e)};this.extractZoneImage(r);var n=i.getSubObjectWithRole("form-prodId"),s=this.getMapZone();if(n){var o=MainFrame.Util.zeroFill(s.page)+s.zoneAttributes.id;n.setText(o)}}this.endAndClearAction()}}),MainFrame.Action.MailtoRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=t.getCurrentContainer().maps,i=a.baseUrlMaps,r=a.finUrlMaps;"undefined"==typeof r&&(r="");var n=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],s=(n.type,n.url);(s.indexOf("http")>=0||s.indexOf("mailto")>=0)&&(i=r="");var o=i+s,l=document.createEvent("MouseEvents"),c=document.createElement("a");c.href=o,l.initEvent("click",!0,!0),c.dispatchEvent(l),this.endAndClearAction()}}),MainFrame.Action.PdfRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=MainFrame.Manager.Scoping.getById(e),a=t.settings.maps,i=a.baseUrlMaps,r=a.finUrlMaps;"undefined"==typeof r&&(r="");var n=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],s=n.type,o=n.url,l=a.settings.hotspotsArr[s].hotspotBaseUrl,c=a.settings.hotspotsArr[s].hotspotFinUrl;i=""!==l?l:void 0===l?i:"",r=""!==c?c:void 0===c?c:"",(o.indexOf("http")>=0||o.indexOf("mailto")>=0)&&(i=r=""),window.open(i+o+r),this.endAndClearAction()}}),MainFrame.Action.PinterestRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="pinterest",t=this.getShareURL(e),a=this.getMediaURL(e),i=this.getParam("text"),r=this.getParam("textId")||"pinterestDescription";!i&&r&&(i=MainFrame.Manager.Text.getById(r)),i||(i="");var n=MainFrame.Util.replaceSharingKeywords(i),s="https://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(t)+"&media="+encodeURIComponent(a)+"&description="+encodeURIComponent(n);window.open(s,"_blank"),this.endAndClearAction()}}),MainFrame.Action.PrintPageRef=MainFrame.Action.Print.extend({getPage:function(){var e=this.initiatorObject.ref;return e&&e.url?e.url:this.getParam("page")}}),MainFrame.Action.PrintRef=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this,t=this.initLoadingWindow(),a=function(a){e.printBase64Image(t,a),e.endAndClearAction()},i=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0];i.url?this.extractImageFromURL(i.url,a):this.extractZoneImage(a)},printBase64Image:function(e,t){var a='<img src="'+t+'" style="width: auto; height: auto; max-width: 100%; max-height: 100%; margin: 0 auto; display: block; position: absolute; top: 0; left: 0; bottom: 0; right: 0;">',i=e.document.getElementById("loading");i.style.display="none",e.document.write(a),e.print()},extractImageFromURL:function(e,t){var a=new Image,i=document.createElement("canvas"),r=i.getContext("2d");a.setAttribute("crossOrigin","anonymous"),a.onload=function(){i.width=this.width,i.height=this.height,r.drawImage(this,0,0);var e=i.toDataURL("image/png");i=null,t(e)},a.src=e}}),MainFrame.Action.Share_facebookRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=this.getParam("winName"),a=MainFrame.Manager.Scoping.getById(e),i=a.getCurrentContainer().maps,r=i.baseUrlMaps,n=i.finUrlMaps;"undefined"==typeof n&&(n="");var s=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],o=s.type,l=s.url,c=a.mapsSettings.settings.hotspotsArr[o].hotspotBaseUrl,d=a.mapsSettings.settings.hotspotsArr[o].hotspotFinUrl;r=""!==c?c:void 0===c?r:"",n=""!==d?d:void 0===d?d:"",(l.indexOf("http")>=0||l.indexOf("mailto")>=0)&&(r=n="");var g="http://www.facebook.com/sharer.php?u="+r+l+n;MainFrame.ActionManager.doAction(this,this,"catalogue","openURL","false",[{url:g,winName:t}]),this.endAndClearAction()}}),MainFrame.Action.Share_googleplusRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=this.getParam("winName"),a=MainFrame.Manager.Scoping.getById(e),i=a.getCurrentContainer().maps,r=i.baseUrlMaps,n=i.finUrlMaps;"undefined"==typeof n&&(n="");var s=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],o=s.type,l=s.url,c=a.mapsSettings.settings.hotspotsArr[o].hotspotBaseUrl,d=a.mapsSettings.settings.hotspotsArr[o].hotspotFinUrl;r=""!==c?c:void 0===c?r:"",n=""!==d?d:void 0===d?d:"",(l.indexOf("http")>=0||l.indexOf("mailto")>=0)&&(r=n="");var g="https://plus.google.com/share?url="+r+l+n;MainFrame.ActionManager.doAction(this,this,"catalogue","openURL","false",[{url:g,winName:t}]),this.endAndClearAction()}}),MainFrame.Action.Share_linkedinRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=this.getParam("winName"),a=MainFrame.Manager.Scoping.getById(e),i=a.getCurrentContainer().maps,r=i.baseUrlMaps,n=i.finUrlMaps;"undefined"==typeof n&&(n="");var s=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],o=s.type,l=s.url,c=a.mapsSettings.settings.hotspotsArr[o].hotspotBaseUrl,d=a.mapsSettings.settings.hotspotsArr[o].hotspotFinUrl;r=""!==c?c:void 0===c?r:"",n=""!==d?d:void 0===d?d:"",(l.indexOf("http")>=0||l.indexOf("mailto")>=0)&&(r=n="");var g="http://www.linkedin.com/shareArticle?mini=true&url="+r+l+n;MainFrame.ActionManager.doAction(this,this,"catalogue","openURL","false",[{url:g,winName:t}]),this.endAndClearAction()}}),MainFrame.Action.Share_pinterestRef=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("mapsSourceId"),t=this.getParam("winName"),a=MainFrame.Manager.Scoping.getById(e),i=a.getCurrentContainer().maps,r=i.baseUrlMaps,n=i.finUrlMaps;"undefined"==typeof n&&(n="");var s=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],o=s.type,l=s.url,c=a.mapsSettings.settings.hotspotsArr[o].hotspotBaseUrl,d=a.mapsSettings.settings.hotspotsArr[o].hotspotFinUrl;r=""!==c?c:void 0===c?r:"",n=""!==d?d:void 0===d?d:"",(l.indexOf("http")>=0||l.indexOf("mailto")>=0)&&(r=n="");var g="http://pinterest.com/pin/create/button/?url="+r+l+n;MainFrame.ActionManager.doAction(this,this,"catalogue","openURL","false",[{url:g,winName:t}]),this.endAndClearAction()}}),MainFrame.Action.Share_twitterRef=MainFrame.Abstract.Action.extend({startAction:function(){var e="https://twitter.com/intent/tweet?source=webclient&text=",t="https://api-ssl.bit.ly/v3/shorten",a=this.getParam("mapsSourceId"),i=(this.getParam("winName"),MainFrame.Manager.Scoping.getById(a)),r=i.getCurrentContainer().maps,n=r.baseUrlMaps,s=r.finUrlMaps;"undefined"==typeof s&&(s="");var o=this.initiatorObject.ref?this.initiatorObject.ref:this.initiatorObject.refs[0],l=o.type,c=o.url,d=i.mapsSettings.settings.hotspotsArr[l].hotspotBaseUrl,g=i.mapsSettings.settings.hotspotsArr[l].hotspotFinUrl;n=""!==d?d:void 0===d?n:"",s=""!==g?g:void 0===g?g:"",(c.indexOf("http")>=0||c.indexOf("mailto")>=0)&&(n=s="");var h=n+c+s;MainFrame.Util.request({method:"GET",params:{login:"bogdanmihalcea",apiKey:"R_a313023407eb627e268c73d32e0ba632",longUrl:h,format:"json"},url:t,asynchronous:!1,onSuccess:function(t){t=JSON.parse(t),200==t.status_code?window.open(e+" "+t.data.url,"_blank"):window.open(e+" "+h,"_blank")},onError:function(){window.open(e+" "+h,"_blank")}}),this.endAndClearAction()}}),MainFrame.Action.ShowMaps=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getMaps(e);t.forEach(function(e){e.showMaps()})}this.endAndClearAction()}}),MainFrame.Action.ShowMapsContent=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e&&e.settings.maps.active)if(e.isSinglePage){var t=e.currentPageContainers.page;t.maps&&t.maps.showCustomContent()}else{var a=e.currentPageContainers.left,i=e.currentPageContainers.right;a.maps&&a.maps.showCustomContent(),i.maps&&i.maps.showCustomContent()}this.endAndClearAction()}}),MainFrame.Action.ShowMapsForNormalPage=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getMaps(e);t.forEach(function(e){e.showMapsForNormalPage()})}this.endAndClearAction()
}}),MainFrame.Action.ShowMultilinkPopover=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this,t=this.getTarget(),a=this.getParam("resourceId")||"mapMultilinkResource",i=MainFrame.Manager.Resource.getById(a);if(!t)return MainFrame.Util.showError("ShowMultilinkPopover error! The target is invalid"),void this.endAndClearAction();if(!i)return MainFrame.Util.showError('ShowMultilinkPopover error! The resource with the id "'+a+'" is invalid or does not exist'),void this.endAndClearAction();var r=new MainFrame.Element.Resource({id:a,superObject:t,data:i});r.containerElement.style.visibility="hidden";var n=this.getParam("placeholderId")||"multilinkContainer",s=MainFrame.Manager.Scoping.getById(n);if(!s)return MainFrame.Util.showError('ShowMultilinkPopover error! The placeholder with the id "'+a+'" is invalid or does not exist'),void this.endAndClearAction();var o=(this.getCatalog(),"true"===this.getParam("grouped"));o?(e.buildLinksForRefs(this.initiatorObject.refs,r,s),e.endAndClearAction()):e.getRefs(function(t){e.buildLinksForRefs(t,r,s),e.endAndClearAction()})},getRefs:function(e){var t=this.catalog,a=this.initiatorObject;if("undefined"!=typeof a.passedData){var i=a.passedData;if(i.refIds){var r=i.refIds,n=i.page,s=[],o=MainFrame.Util.zeroFill(n),l=MainFrame.Util.getAppURL()+t.settings.maps.dataSrcMaps+"/"+o+".xml",c=this;MainFrame.Util.request({url:l,xmlResponse:!0,onSuccess:function(t){var a=t.documentElement,i=r.map(function(e){return c.extractRefByRefId(a,e)});e(i)}})}}else{if(t.isSinglePage)var d=t.currentPageContainers.page;else{var n="undefined"==typeof a.page?a.superObject.page:a.page;if(n%2===0)var d=t.currentPageContainers.left;else var d=t.currentPageContainers.right}var r=a.refs||a.superObject.refs,g=d.maps,h=t.settings.maps.settings.zonesConfig;if(h.groupMultiRefsByRefType)var s=this.getRefTypes(g,r);else var s=r.map(function(e){return g.getRefById(e)});e(s)}},getRefTypes:function(e,t){var a=[],i={},r=[];t.forEach(function(t){var a=e.getRefById(t);i[a.type]=!0,r.push(a)});for(var n in i){var s=this.getRefsByType(r,n);a.push(1===s.length?s[0]:{type:"multi_"+n,refs:s})}return a},getRefsByType:function(e,t){return e.filter(function(e){return e.type===t})},buildLinksForRefs:function(e,t,a){var i=this.catalog,r=i.settings.maps.settings.hotspotsArr,n=this.getParam("refTemplateRootName")||"multilinkRef_",s=0,o=0,l=0,c=this;e.forEach(function(e){if("zoom"!==e.type){var t=n+e.id,l=MainFrame.Manager.Resource.getById(t);if(l||(t=t=n+e.type,l=MainFrame.Manager.Resource.getById(t),l||(t=n+"default",l=MainFrame.Manager.Resource.getById(t))),l){var d=new MainFrame.Element.Resource({id:t,superObject:a,data:l}),g=d.getSubObjectWithId(t+"Title");g&&c.setTitle(g,e,r);var h=c.determineTitleHeight(g,d);d.setPositionY(o),o+=h;var u=i.settings.maps.settings.zonesConfig,m=-1!==e.type.indexOf("multi_");if(u.groupMultiRefsByRefType&&m){var p="id:mapMultirefGroupedActions;params:source="+i.id;d.setAction(p),d.refs=e.refs}else{var p="id:"+e.type+"MultilinkRefActions;params:source="+i.id;d.setAction(p),d.ref=e}s++}else MainFrame.Util.showError("Error! You need to have a default template for the multilink references!")}});var d=this.getParam("maxHeight"),g=o+l;"0"!==d&&(d||(d="Desktop"===EnvDetection.deviceType?600:300)),d?g>d?(a.setDimensionY(g),a.setAction("id:applyVerticalEasing"),t.setDimensionY(d)):t.setDimensionY(g):"0"===d&&t.setDimensionY(g),this.placeResource(t),t.resize(),t.containerElement.style.visibility="visible"},setTitle:function(e,t,a){var i=t.infos&&t.infos.lib,r=a[t.type]&&a[t.type].libId;if(i)var n=t.infos.lib;else if(r)var s=a[t.type].libId,n=MainFrame.Manager.Text.getById(s);else{var s=t.type+"MultiLib",o=MainFrame.Manager.Text.getById(s);o||(s=t.type+"Alt",o=MainFrame.Manager.Text.getById(s));var n=o||""}var l=-1!==n.indexOf("#{")&&-1!==n.indexOf("}");if(l&&"ldc"===t.type){var c=MainFrame.Manager.Text.getById("ldcLoadingLibId")||"Chargement...";e.setText(c);var d=MainFrame.EprintShop,g=d.config.settings&&d.config.settings.shopType?d.config.settings.shopType:"eps";if("eps"===g){var h=a[t.type].hotspotBaseUrl+t.url+a[t.type].hotspotFinUrl;this.setEPSDynamicLib(e,n,h)}else this.setLDCDynamicLib(e,n,t)}else e.setText(n)},setEPSDynamicLib:function(e,t,a){var i=MainFrame.Manager.Text.getById("ldcErrorLibId")||"Produit indisponible";try{var r=MainFrame.EprintShop.config;r.product.baseUrl,productFinUrl=r.finUrl||"",overrideMimeType=r.product.overrideMimeType||null;var n=r.settings&&r.settings.fluxType?r.settings.fluxType:"xml",s=!1,o=!1;"xml"===n?s=!0:"json"===n&&(o=!0),MainFrame.Util.request({url:a,xmlResponse:s,jsonResponse:o,overrideMimeType:overrideMimeType,onSuccess:function(a){if(a){var r;if("xml"===n){if(a&&a.documentElement)var r=MainFrame.DataParser.parseXmlFlux(a.documentElement)}else if("json"===n)var r=a;var s=MainFrame.EprintShop.formatProduct(r);if(s){var o=MainFrame.EprintShop.fillTemplateWithProductData(t,s);o=o.replace(/<\\/g,"<"),o=o.replace(/\\\//g,"/"),e.setText(o)}else e.setText(i)}else e.setText(i)},onError:function(){e.setText(i)}})}catch(l){e.setText(i)}},setLDCDynamicLib:function(e,t,a){var i=MainFrame.EprintShop,r=i.config.settings&&i.config.settings.fluxType?i.config.settings.fluxType:"xml";if("csv"===r)var n=i.csvData[a.url];else if("xml"===r)var n=i.xmlData[a.url];else var n=a.infos;var s=i.formatProduct(n);if(s){var o=MainFrame.EprintShop.fillTemplateWithProductData(t,s);o=o.replace(/\\"/g,'"'),e.setText(o)}else{var l=MainFrame.Manager.Text.getById("ldcErrorLibId")||"Produit indisponible";e.setText(l)}},determineTitleHeight:function(e,t){var a=t.getDimensionY(),i=e.containerElement.cloneNode();document.body.appendChild(i),i.innerHTML=e.getText(),i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.style.width=e.getDimensionX()+"px",i.style.height="auto";var r=i.clientHeight+1;if(MainFrame.Util.removeElement(i),1!=r){var n=e.getDimensionY();if(r>e.getDimensionY()){var s=r-n;e.setDimensionY(r),a+=s,t.setDimensionY(a)}}return a}}),MainFrame.Action.SimulatedLdc=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("resourceId"),t=MainFrame.Manager.Scoping.getById(e);if(!e)return MainFrame.Util.showError('LDC loading error! The resource with id: "'+e+'" does not exist!'),void this.endAndClearAction();var a=!1,i=this.getParam("templateId"),r=this.getParam("templateType"),n=this.getParam("refUrl"),s=decodeURIComponent(this.getParam("baseUrl"));if(this.getParam("finUrl"))var o=decodeURIComponent(this.getParam("finUrl"));var l={};l.refId=n,l.baseUrl=s,l.finUrl=o,l.templateType=r,l.templateId=i;var c=a?MainFrame.Manager.Cache.getById(i):null;if(c)MainFrame.EprintShop.showDetailsInResource(c,t,l);else switch(r){case"html":var d=MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/eps/templates/"+i+".html";MainFrame.Util.request({url:d,onSuccess:function(n){n?(a&&MainFrame.Manager.Cache.register(i,n),MainFrame.EprintShop.showDetailsInResource(n,t,l)):MainFrame.Util.showError("LDC loading error! The "+r+' template with id: "'+e+'" cannot be loaded from the path: '+d)}});break;case"xml":default:c=MainFrame.Manager.Resource.getById(i),c||(1===MainFrame.Browser.orientation?(i+="Portrait",c=MainFrame.Manager.Resource.getById(i)):(i+="Landscape",c=MainFrame.Manager.Resource.getById(i))),a&&MainFrame.Manager.Cache.register(i,data),MainFrame.EprintShop.showDetailsInResource(c,t,l)}this.endAndClearAction()}}),MainFrame.Action.StartMapAnimations=MainFrame.Abstract.Action.extend({startAction:function(){return void this.endAndClearAction()}}),MainFrame.Action.StumbleuponRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="stumbleupon",t=this.getShareURL(e),a="http://www.stumbleupon.com/badge/?url="+encodeURIComponent(t);window.open(a,"_blank"),this.endAndClearAction()}}),MainFrame.Action.ToggleMapInfos=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=this.getCatalog(),i=this.getMaps(a),r="false"===this.getParam("hideOtherZoneInfos")?!1:!0,n=i[0].cssClasses.zone+"--visible",s=i[0].cssClasses.zone+"--hidden";if(r){var o=this;i.forEach(function(e){e.zones.forEach(function(a){var i=a.infos&&a.infos.item,r=a.id!==t.id;i&&r&&o.hideInfos(a,e,n,s)})})}var l=t.infos&&t.infos.item;if(l){var c=t.infos.item.containerElement;MainFrame.Util.hasClass(c,n)?this.hideInfos(t,i[0],n,s):this.showInfos(t,i[0],n,s)}this.endAndClearAction()},showInfos:function(e,t,a,i){var r=e.infos.item.containerElement;MainFrame.Util.addClass(r,a),MainFrame.Util.removeClass(r,i)},hideInfos:function(e,t,a,i){var r=e.infos.item.containerElement;MainFrame.Util.removeClass(r,a),MainFrame.Util.addClass(r,i)}}),MainFrame.Action.TwitterRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="https://twitter.com/intent/tweet?source=webclient&text=",t="https://api-ssl.bit.ly/v3/shorten",a="twitter",i=this.getParam("url")||this.getShareURL(a),r=this.getParam("text"),n=this.getParam("textId")||"twitterText";!r&&n&&(r=MainFrame.Manager.Text.getById(n)),r||(r="");var s=MainFrame.Util.replaceSharingKeywords(r)+" ",o=s+" "+i;MainFrame.Util.request({method:"GET",params:{login:"bogdanmihalcea",apiKey:"R_a313023407eb627e268c73d32e0ba632",longUrl:i,format:"json"},url:t,asynchronous:!1,onSuccess:function(t){console.log("response"),t=JSON.parse(t),200==t.status_code?window.open(e+" "+s+t.data.url,"_blank"):window.open(e+" "+o,"_blank")},onError:function(){window.open(e+" "+o,"_blank")}}),this.endAndClearAction()}}),MainFrame.Action.UrlRef=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.initiatorObject,t=this.getParam("refId"),a=this.getParam("zoneId"),i=this.getParam("page");if(console.log(t,a,i),(t||a)&&i){var r=this.getParam("mapsSourceId"),n=MainFrame.Manager.Scoping.getById(r),s=MainFrame.Util.zeroFill(i),o=MainFrame.Util.getAppURL()+n.settings.maps.dataSrcMaps+"/"+s+".xml",l=this;MainFrame.Util.request({url:o,xmlResponse:!0,onSuccess:function(e){var i=e.documentElement;if(t)var r=l.extractRefByRefId(i,t);else if(a)var r=l.extractRefByZoneId(i,a);r&&l.openUrl(r)}})}else e.ref&&this.openUrl(e.ref)},openUrl:function(e){var t=this.getParam("mapsSourceId"),a=MainFrame.Manager.Scoping.getById(t),i=a.settings.maps,r=e.type,n=e.url,s=a.settings.maps.settings,o=s.hotspotsArr[r].hotspotBaseUrl,l=s.hotspotsArr[r].hotspotFinUrl,c=i.baseUrlMaps||"",d=i.finUrlMaps||"";c=""!==o?o:void 0===o?c:"",d=""!==l?l:void 0===l?l:"",(n.indexOf("http")>=0||n.indexOf("mailto")>=0)&&(c=d="");var g=this.getParam("winName"),h=this.getParam("urlTarget"),u=c+n+d;MainFrame.ActionManager.doAction(this,this,"catalogue","openURL","false",[{url:u,winName:g,urlTarget:h}]),this.endAndClearAction()}}),MainFrame.Action.ViadeoRef=MainFrame.Action.ShareRef.extend({startAction:function(){var e="viadeo",t=this.getShareURL(e),a="http://www.viadeo.com/shareit/share/?url="+encodeURIComponent(t);window.open(a,"_blank"),this.endAndClearAction()}}),MainFrame.Action.VideoYTRef=MainFrame.Abstract.Action.extend({startAction:function(){console.log("Ref: VideoYT"),this.endAndClearAction()}}),MainFrame.Action.Xurl1Ref=MainFrame.Action.BaseRef.extend({startAction:function(){this.baseOpenURL(),this.endAndClearAction()}}),MainFrame.Action.Xurl2Ref=MainFrame.Action.BaseRef.extend({startAction:function(){this.baseOpenURL(),this.endAndClearAction()}}),MainFrame.Action.XurlRef=MainFrame.Action.BaseRef.extend({startAction:function(){this.baseOpenURL(),this.endAndClearAction()}}),MainFrame.Action.Yurl1Ref=MainFrame.Action.BaseRef.extend({startAction:function(){this.baseOpenURL(),this.endAndClearAction()}}),MainFrame.Action.Yurl2Ref=MainFrame.Action.BaseRef.extend({startAction:function(){this.baseOpenURL(),this.endAndClearAction()}}),MainFrame.Action.YurlRef=MainFrame.Action.BaseRef.extend({startAction:function(){this.baseOpenURL(),this.endAndClearAction()}}),MainFrame.Action.ZoomRef=MainFrame.Action.BaseRef.extend({startAction:function(){var e=this.getCatalog();if(e.scale>1)return void this.endAndClearAction();e.setCatalogState("zooming_map"),this.addOverlay(e),this.addOverflow(e);var t=this.getParam("mapsSpacing");this.mapsSpacing="undefined"!=typeof t&&null!==t&&""!==t?parseInt(t,10):5,this.catalog=e;var a=this.getMapZone();this.zoneSizes=[],e.zoomMaps||(e.zoomMaps={},e.zoomMaps.normal={},e.zoomMaps.hd={}),this.totalSizesDetermined=0;var i=this.getZoomZones(e,a);if(a.hasMultizoom&&a.layerId){this.totalZonesToZoom=i.length;for(var r=0,n=i.length;n>r;r++)this.applyZoomToZone(i[r])}else this.totalZonesToZoom=1,this.applyZoomToZone(a);this.endAndClearAction()},addOverlay:function(e){var t=this.getParam("overlayColor"),a=this.getParam("overlayOpacity"),i=this.getParam("duration");if(i)var r=parseFloat(i,10);else var r=.3;var n=this.determineOverlayCoordinates(e);e.zoomMapOverlay.style.left=n.x+"px",e.zoomMapOverlay.style.width=n.width+"px",e.zoomMapOverlay.style.height=n.height+"px",this.emptyZoomMapContainer(e),e.zoomMapOverlay.style.backgroundColor=t,e.zoomMapOverlay.style.transitionDuration=r,e.zoomMapContainer.style.display="block",window.requestAnimationFrame(function(){e.zoomMapOverlay.style.opacity=a});var s=new MainFrame.Element.HtmlItem({containerElement:e.zoomMapOverlay});this.overlay=s},addOverflow:function(e){if(e.isSinglePage){var t=e.currentPageContainers.page.maps;t.zonesContainer.style.overflow="hidden"}else{var a=e.currentPageContainers.left,i=e.currentPageContainers.right,r=a.maps;if(r.zonesContainer.style.overflow="hidden",i&&i.maps){var n=i.maps;n.zonesContainer.style.overflow="hidden"}}},determineOverlayCoordinates:function(e){if(1===e.pagesOnScreen){var t=0,a=e.settings.pages,i="single"===a.coverType;i&&(a.centerFirst&&e.shouldCenterPage(e.currentPage)?e.isDoublePage&&1===e.pagesOnScreen&&1===e.currentPage&&(t=e.currentPageSize.width/2):e.isDoublePage&&1===e.pagesOnScreen&&1===e.currentPage&&(t=e.currentPageSize.width));var r=a.totalPages;a.centerLast&&e.shouldCenterPage(e.currentPage)&&e.isDoublePage&&1===e.pagesOnScreen&&e.currentPage===r&&(t=e.currentPageSize.width/2);var n=e.currentPageSize;o=n.width,l=n.height}else var s=e.currentCatalogSize,t=0,o=s.width,l=s.height;return{x:t,y:0,width:o,height:l}},emptyZoomMapContainer:function(e){for(var t=0,a=e.zoomMapContainer.childNodes.length,i=[];a>t;t++){var r=e.zoomMapContainer.childNodes[t];r!==e.zoomMapOverlay&&i.push(r)}i.forEach(function(e){MainFrame.Util.removeElement(e)})},getZoomZones:function(e,t){var a=[];if(e.isSinglePage)var i=e.currentPageContainers.page.maps,a=i.getZonesByLayerId(t.layerId);else{var r=e.currentPageContainers.left,n=e.currentPageContainers.right,s=r.maps;if(a=s.getZonesByLayerId(t.layerId),n&&n.maps){var o=n.maps,l=o.getZonesByLayerId(t.layerId);l.forEach(function(e){a.push(e)})}}return a},shouldUseSizesForZoomScale:function(){var e=this.getMapZone(),t=this.getCatalog(),a=t.settings.pages.sizes,i="true"===this.getParam("useSizes")?!0:!1,r=a&&a.length>0;return i&&r&&e.hasDcp!==!0},getCurrentContainer:function(e){var t=this.catalog;if(t.isSinglePage){var a=t.currentPageContainers;return a.page}var i="single"===t.settings.pages.coverType;if(i)var r=e.page,n=r%2===0,s=n;else var s=t.isLeftPage(e.page);var o=s?t.currentPageContainers.left:t.currentPageContainers.right;return o},getZoneMaps:function(e){var t=this.getCurrentContainer(e);return t.maps},getZonePrices:function(e){var t=this.getCurrentContainer(e);return t.prices},applyZoomToZone:function(e){var t=this,a=this.catalog,i=this.createCanvas(e),r=this.getZoneMaps(e),n=this.getZonePrices(e),s=new Image;s.onload=function(){t.drawImageInCanvas(i.contentElement,this,e);var s=t.getParam("duration"),o=t.determineMargins(e),l=t.determineDCP(e),c=t.determineMaxScaleToFit(e,i.containerElement);e.isScrollMap&&c<e.zoomScale?e.hasMultizoom===!1?t.applyScrollingDcpZoomWithoutRatio(e,i,e.zoomScale,c,s,o,l):t.applyScrollingDcpZoomWithRatio(e,i,e.zoomScale,c,s,o,l):t.applyDcpZoom(e,i,c,s,o,l),setTimeout(function(){var i=t.createHQCanvas(e);a.settings.prices.active&&t.showInnerPrices(e,i,n);var s=a.settings.maps.settings.zonesConfig;s.innerMapsVisibleZoomMap&&t.showInnerMaps(e,i,r),t.showMapIcons(e,i,r),t.showMapInfos(e,i,r),t.addShadow(e,i,r),a.setCatalogState("idle")},MainFrame.Util.secondsToMiliseconds(s))};var o="undefined"!=typeof a.settings.pages.sizes;if(o){var l=e.page,c=a.pages[l][0],d=a.determineOptimumSize(),g=c.sizes[d],h=g.normal;a.settings.pages.useXJpgForZoom&&-1!==a.settings.pages.xJpgPages.indexOf(l)&&(h=g.original),u=-1===h.indexOf("/")?MainFrame.Util.getAppURL()+a.settings.pages.dataSrc+h:MainFrame.Util.getAppURL()+h}else{var l=e.page,c=a.pages[l][0],u=MainFrame.Util.getAppURL()+a.settings.pages.dataSrc+c.hd;a.settings.pages.useXJpgForZoom&&-1!==a.settings.pages.xJpgPages.indexOf(l)&&-1===u.indexOf("x.jpg")&&(u=u.split(".jpg").join("x.jpg"))}if(s.src=u,a.hasPngText){var m=new Image;m.onload=function(){t.drawImageInCanvas(i.contentElement,this,e)};var p=s.src.replace(/hd.jpg/g,"hd.png");m.src=p}},applyScrollingDcpZoomWithRatio:function(e,t,a,i,r,n,s){var o=parseFloat(t.containerElement.style.width),l=parseFloat(t.containerElement.style.height),c=parseFloat(t.containerElement.style.left)+o/2,d=parseFloat(t.containerElement.style.top)+l/2;s&&null!==s.x&&null!==s.y?(t.translatedX=s.x-c,t.translatedY=s.y-d,c+=t.translatedX,d+=t.translatedY):(t.translatedX=0,t.translatedY=0);var g=this.getCatalog(),h=this.getCatalogSize();t.scale=i;var u=parseFloat(t.containerElement.style.left),m=parseFloat(t.containerElement.style.top),p=this.getZoneSize(e,g),f={};if(f.id=e.id,f.left=u,f.top=m,f.width=p.width*t.scale,f.height=p.height*t.scale,n){var v=u-o*(t.scale-1)/2,M=m-l*(t.scale-1)/2,b=0;if(b>v){var F=b-v;t.translatedX+=F}var A=h.width-o*t.scale;if(v>A){var F=v-A;t.translatedX-=F}var P=0;if(P>M){var y=P-M;t.translatedY+=y}var C=h.height-l*t.scale;if(M>C){var y=M-C;t.translatedY-=y}if(e.rotation){var E=l/2*i,S=c+E,w=S-(h.width+h.leftMargin);w>0&&(t.translatedX=-w);var I=c-E-h.leftMargin;0>I&&(t.translatedX=-I)}}this.zoneSizes.push(f),t.containerElement.style.transitionProperty="transform",MainFrame.Util.setTransformDuration(t.containerElement,r,"s"),e.rotation?MainFrame.Util.setPositionAndRotation(t.containerElement,t.translatedX,t.translatedY,i,e.rotation):MainFrame.Util.setPosition(t.containerElement,t.translatedX,t.translatedY,i);var x=a/i,D=o*i,T=l*i,O=D*x,z=T*x,B=(O-D)/2,k=(z-T)/2,U=B/i,R=k/i;MainFrame.Util.setPosition(t.contentElement,U,R,x)},applyScrollingDcpZoomWithoutRatio:function(e,t,a,i,r,n,s){var o=this.determineMaxScaleToFill(e,t.containerElement),a=o.scale<a?o.scale:a,l=o.fills,c=parseFloat(t.containerElement.style.width),d=parseFloat(t.containerElement.style.height),g=parseFloat(t.containerElement.style.left)+c/2,h=parseFloat(t.containerElement.style.top)+d/2;s&&null!==s.x&&null!==s.y?(t.translatedX=s.x-g,t.translatedY=s.y-h,g+=t.translatedX,h+=t.translatedY):(t.translatedX=0,t.translatedY=0);var u=(this.getCatalog(),this.getCatalogSize());t.scale=a;var m=parseFloat(t.containerElement.style.left),p=parseFloat(t.containerElement.style.top),f=m-c*(t.scale-1)/2,v=p-d*(t.scale-1)/2,M=c*a,b=d*a,F=u.width/2,A=u.height/2,g=f+M/2,h=v+b/2;"width"===l?(t.translatedY=A-h,t.translatedX=0-f):(t.translatedX=F-g,t.translatedY=0-v),t.containerElement.style.transitionProperty="transform",MainFrame.Util.setTransformDuration(t.containerElement,r),e.rotation?MainFrame.Util.setPositionAndRotation(t.containerElement,t.translatedX,t.translatedY,a,e.rotation):MainFrame.Util.setPosition(t.containerElement,t.translatedX,t.translatedY,a)},applyDcpZoom:function(e,t,a,i,r,n){var s,o,l=this.getCatalog();s=parseFloat(t.containerElement.style.width),o=parseFloat(t.containerElement.style.height);var c,d;c=parseFloat(t.containerElement.style.left)+s/2,d=parseFloat(t.containerElement.style.top)+o/2,n&&null!==n.x&&null!==n.y?(t.translatedX=n.x-c,t.translatedY=n.y-d,c+=t.translatedX,d+=t.translatedY):(t.translatedX=0,t.translatedY=0);var g=this.getCatalogSize(),h=this.getZoneSize(e,l);t.scale=a;var u=parseFloat(t.containerElement.style.left),m=parseFloat(t.containerElement.style.top),p={};if(p.id=e.id,p.left=u,p.top=m,p.width=h.width*t.scale,p.height=h.height*t.scale,p.canvas=t,r){var f=u-s*(t.scale-1)/2,v=m-o*(t.scale-1)/2,M=0;if(M>f){var b=M-f;t.translatedX+=b}var F=g.width-s*t.scale;if(f>F){var b=f-F;t.translatedX-=b}var A=0;if(A>v){var P=A-v;t.translatedY+=P}var y=g.height-o*t.scale;if(v>y){var P=v-y;t.translatedY-=P}if("double"===l.settings.pages.catalogType&&"true"===this.getParam("centerCoverMaps")){var C=1===l.pagesOnScreen&&1===l.currentPage&&l.settings.pages.centerFirst,E=1===l.pagesOnScreen&&l.isLastPage(l.currentPage)&&l.settings.pages.centerLast;if(C||E){var S=l.currentPageSize.width,w=Math.round(S/2);if(p.width>S){var I=l.currentCatalogSize.width/2,x=f+p.width/2;t.translatedX=I-x}else if(f+p.width>w+S){var b=f+p.width-(w+S);t.translatedX-=b}else w>f&&(t.translatedX+=w-f)}}for(var D=0,T=this.zoneSizes.length;T>D;D++){var O=this.zoneSizes[D];do{var z=this.checkOverlap(p,O),B=z.overlapping;B&&(z.touchingLeft&&(p.left--,t.translatedX--),z.touchingRight&&(p.left++,t.translatedX++),z.touchingTop&&(p.top--,t.translatedY--),z.touchingBottom&&(p.top++,t.translatedY++))}while(B)}}p.zone=e,p.scale=a,p.translatedX=t.translatedX,p.translatedY=t.translatedY,this.zoneSizes.push(p),this.checkZoneSizes()},checkZoneSizes:function(){if(this.totalSizesDetermined++,this.totalSizesDetermined===this.totalZonesToZoom){var e=this.checkZoneSizesDcp();e||this.adjustSizes();for(var t=0,a=this.zoneSizes.length;a>t;t++){var i=this.zoneSizes[t];this.zoomSize(i)}}},checkZoneSizesDcp:function(){for(var e=!0,t=0,a=this.zoneSizes.length;a>t;t++){var i=this.zoneSizes[t];if("undefined"==typeof i.zone.dcpX||"undefined"==typeof i.zone.dcpY)return!1}return e},adjustSizes:function(){var e=this.zoneSizes.length;if(1===e);else if(4>e){var t=500,a=!1;do a=2===e?this.adjustTwoSizes():this.adjustThreeSizes(),a===!1&&this.decreaseSizesScale(),t--;while(!a&&t)}},adjustTwoSizes:function(){var e=this.catalog,t=e.currentCatalogSize,a=t.width,i=this.getZoomsSizeOrizontal(this.zoneSizes),r=t.height,n=this.getZoomsSizeVertical(this.zoneSizes),s={catalogWidth:a,catalogHeight:r,zonesWidth:i,zonesHeight:n};return i.width<=a?(this.placeZones("01",s),!0):n.height<=r?(this.placeZones("0-1",s),!0):!1},adjustThreeSizes:function(){var e=this.catalog,t=e.currentCatalogSize,a=t.width,i=this.getZoomsSizeOrizontal(this.zoneSizes),r=t.height,n=this.getZoomsSizeVertical(this.zoneSizes),s=this.getOptimumZonesSize(this.zoneSizes,a,r),o={catalogWidth:a,catalogHeight:r,zonesWidth:i,zonesHeight:n};return i.width<=a?(this.placeZones("012",o),!0):n.height<=r?(this.placeZones("0-1-2",o),!0):s.width<=a&&s.height<=r?(o.zonesWidth=s.width,o.zonesHeight=s.height,o.sortedSizes=s.sortedSizes,this.placeZones(s.placement,o),!0):!1},placeZones:function(e,t){switch(e){case"01":this.placeZones01(t);break;case"0-1":this.placeZones0_1(t);break;case"012":this.placeZones012(t);break;case"0-1-2":this.placeZones0_1_2(t);break;case"01-2":this.placeZones01_2(t);break;case"0-12":this.placeZones0_12(t);break;case"12-0":this.placeZones12_0(t)}},placeZones01:function(e){var t=this.zoneSizes[0],a=this.zoneSizes[1],i=Math.round((e.catalogWidth-e.zonesWidth.width)/2),r=Math.round((e.catalogHeight-t.height)/2),n=i+t.width+this.mapsSpacing,s=Math.round((e.catalogHeight-a.height)/2);this.adjustDiffForSize(t,i,r),this.adjustDiffForSize(a,n,s)},placeZones0_1:function(e){var t=this.zoneSizes[0],a=this.zoneSizes[1],i=Math.round((e.catalogWidth-t.width)/2),r=Math.round((e.catalogHeight-e.zonesHeight.height)/2),n=Math.round((e.catalogWidth-a.width)/2),s=r+t.height+this.mapsSpacing;this.adjustDiffForSize(t,i,r),this.adjustDiffForSize(a,n,s)},placeZones012:function(e){var t=this.zoneSizes[0],a=this.zoneSizes[1],i=this.zoneSizes[2],r=Math.round((e.catalogWidth-e.zonesWidth.width)/2),n=Math.round((e.catalogHeight-t.height)/2),s=r+t.width+this.mapsSpacing,o=Math.round((e.catalogHeight-a.height)/2),l=s+a.width+this.mapsSpacing,c=Math.round((e.catalogHeight-i.height)/2);this.adjustDiffForSize(t,r,n),this.adjustDiffForSize(a,s,o),this.adjustDiffForSize(i,l,c)},placeZones0_1_2:function(e){var t=this.zoneSizes[0],a=this.zoneSizes[1],i=this.zoneSizes[2],r=Math.round((e.catalogWidth-t.width)/2),n=Math.round((e.catalogHeight-e.zonesHeight.height)/2),s=Math.round((e.catalogWidth-a.width)/2),o=n+t.height+this.mapsSpacing,l=Math.round((e.catalogWidth-i.width)/2),c=o+a.height+this.mapsSpacing;this.adjustDiffForSize(t,r,n),this.adjustDiffForSize(a,s,o),this.adjustDiffForSize(i,l,c)},placeZones01_2:function(e){var t=e.sortedSizes[0],a=e.sortedSizes[1],i=e.sortedSizes[2],r=Math.round((e.catalogWidth-e.zonesWidth)/2),n=Math.round((e.catalogHeight-e.zonesHeight)/2),s=r+t.width+this.mapsSpacing,o=n,l=r+Math.round((t.width+this.mapsSpacing+a.width-i.width)/2),c=n+(t.height>a.height?t.height:a.height)+this.mapsSpacing;this.adjustDiffForSize(t,r,n),this.adjustDiffForSize(a,s,o),this.adjustDiffForSize(i,l,c)},placeZones0_12:function(e){var t=e.sortedSizes[0],a=e.sortedSizes[1],i=e.sortedSizes[2],r=Math.round((e.catalogWidth-e.zonesWidth)/2),n=Math.round((e.catalogHeight-e.zonesHeight)/2),s=r+Math.round((e.zonesWidth-t.width-this.mapsSpacing)/2),o=n,l=r+Math.round((e.zonesWidth-a.width-this.mapsSpacing-i.width-this.mapsSpacing)/2),c=o+t.height+this.mapsSpacing,d=l+a.width+this.mapsSpacing,g=c;this.adjustDiffForSize(t,s,o),this.adjustDiffForSize(a,l,c),this.adjustDiffForSize(i,d,g)},placeZones12_0:function(e){var t=e.sortedSizes[0],a=e.sortedSizes[1],i=e.sortedSizes[2],r=Math.round((e.catalogWidth-e.zonesWidth)/2),n=Math.round((e.catalogHeight-e.zonesHeight)/2),s=r+Math.round((e.zonesWidth-a.width-this.mapsSpacing-i.width-this.mapsSpacing)/2),o=n,l=s+a.width+this.mapsSpacing,c=o,d=r+Math.round((e.zonesWidth-t.width-this.mapsSpacing)/2),g=n+(a.height>i.height?a.height:i.height)+this.mapsSpacing;this.adjustDiffForSize(t,d,g),this.adjustDiffForSize(a,s,o),this.adjustDiffForSize(i,l,c)},adjustDiffForSize:function(e,t,a){var i=parseFloat(e.canvas.containerElement.style.left)+e.translatedX-parseFloat(e.canvas.containerElement.style.width)*(e.canvas.scale-1)/2,r=parseFloat(e.canvas.containerElement.style.top)+e.translatedY-parseFloat(e.canvas.containerElement.style.height)*(e.canvas.scale-1)/2,n=t-i,s=a-r;e.translatedX+=n,e.canvas.translatedX+=n,e.translatedY+=s,e.canvas.translatedY+=s},decreaseSizesScale:function(){for(var e=0,t=this.zoneSizes.length,a=this.getMaxScaleFromSizes(this.zoneSizes);t>e;e++){var i=this.zoneSizes[e];if(i.scale===a){i.scale-=.05,i.canvas.scale-=.05;var r=this.getZoneSize(i.zone,this.catalog);i.width=Math.round(r.width*i.canvas.scale),i.height=Math.round(r.height*i.canvas.scale)}}},getMaxScaleFromSizes:function(){for(var e=0,t=0,a=this.zoneSizes.length;a>t;t++){var i=this.zoneSizes[t];i.scale>e&&(e=i.scale)}return e},getZoomsSizeOrizontal:function(e){for(var t=0,a=0,i=0;i<e.length;i++){var r=e[i];t+=r.width,(i<e.length-1||this.mapsSpacing>10)&&(t+=this.mapsSpacing),a<r.height&&(a=r.height)}return{width:t,height:a}},getZoomsSizeVertical:function(e){for(var t=0,a=0,i=0;i<e.length;i++){var r=e[i];a+=r.height,i<e.length-1&&(a+=this.mapsSpacing),t<r.width&&(t=r.width)}return{width:t,height:a}},getOptimumZonesSize:function(e,t,a){var i={},r="",n=e[e.length-1],s=(n.id,e[0]),o=e[1],l=e[2],c=s.width+this.mapsSpacing+o.width,d=(s.height>o.height?s.height:o.height)+this.mapsSpacing+l.height;l.width+this.mapsSpacing>c&&(c=l.width+this.mapsSpacing);var g=s.width+this.mapsSpacing+l.width,h=(s.height>l.height?s.height:l.height)+this.mapsSpacing+o.height;o.width+this.mapsSpacing>g&&(g=o.width+this.mapsSpacing);var u=o.width+this.mapsSpacing+l.width,m=(o.height>l.height?o.height:l.height)+this.mapsSpacing+s.height;s.width+this.mapsSpacing>u&&(u=s.width+this.mapsSpacing);var p=t/a,f=c/d,v=g/h,M=u/m,b=Math.abs(p-f),F=Math.abs(p-v),A=Math.abs(p-M),P=[b,F,A].sort();if(P[0]===b){var y=[s,o,l];r="01-2",i.width=c,i.height=d}else if(P[0]===F){var y=[s,l,o];r="01-2",i.width=g,i.height=h}else if(P[0]===A){var y=[s,o,l];r="0-12",i.width=u,i.height=m}return i.placement=r,i.sortedSizes=y,i},zoomSize:function(e){var t=e.canvas,a=this.getParam("duration")||300,i=e.scale,r=e.zone;t.containerElement.style.transitionProperty="transform",MainFrame.Util.setTransformDuration(t.containerElement,a,"s"),r.rotation?MainFrame.Util.setPositionAndRotation(t.containerElement,t.translatedX,t.translatedY,i,r.rotation):MainFrame.Util.setPosition(t.containerElement,t.translatedX,t.translatedY,i)},createCanvas:function(e){var t=this.catalog,a=MainFrame.Util.createElement("div","v7__maps__zoom-map-element",t.zoomMapContainer),i=MainFrame.Util.createElement("canvas","v7__elem--content v7--fill v7__maps__zoom-map-element",a),r=new MainFrame.Element.Item({id:"zoom_zone_"+e.id,superObject:t,containerElement:a,contentElement:i});r.containerElement.style.transitionProperty="transform",MainFrame.Util.setTransformDuration(r.containerElement,0);var n=this.getUniqueZoneId(e);t.zoomMaps.normal[n]=r;var s=this.getZoneSize(e,t);i.width=2*s.width,i.height=2*s.height,a.style.width=s.width+"px",a.style.height=s.height+"px",a.style.position="absolute",a.style.overflow="hidden";var o=e.getPositionX(),l=e.getPositionY(),c=t.settings.pages,d="single"===c.coverType;d&&(c.centerFirst&&t.shouldCenterPage(t.currentPage)?t.isDoublePage&&1===t.pagesOnScreen&&1===t.currentPage&&(o+=t.currentPageSize.width/2):t.isDoublePage&&1===t.pagesOnScreen&&1===t.currentPage&&(o+=t.currentPageSize.width));var g=d?e.page%2===1:t.isRightPage(e.page),h=c.totalPages;return c.centerLast&&t.shouldCenterPage(t.currentPage)?t.isDoublePage&&1===t.pagesOnScreen&&t.currentPage===h&&(o+=t.currentPageSize.width/2):t.isDoublePage&&2===t.pagesOnScreen&&g&&(o+=t.currentPageSize.width),a.style.left=o+"px",a.style.top=l+"px",r},createHQCanvas:function(e){var t=this,a=this.catalog,i=this.getUniqueZoneId(e),r=a.zoomMaps.normal[i],n=MainFrame.Util.createElement("div","v7__maps__zoom-map-element",a.zoomMapContainer),s=MainFrame.Util.createElement("div","v7__elem--content v7--fill v7__maps__zoom-map-element",n),o=MainFrame.Util.createElement("div","v7__maps__zoom-map-element",s),l=MainFrame.Util.createElement("canvas","v7__maps__zoom-map-element",o);n.style.position="absolute",s.style.position="absolute",o.style.position="absolute",l.style.position="absolute",l.style.overflow="hidden";var c=new MainFrame.Element.Item({id:"hd_zoom_zone_"+e.id,superObject:a,containerElement:n,contentElement:s});c.canvasElement=l,c.innerContainer=o;var d=new MainFrame.Element.HtmlItem({containerElement:c.canvasElement,superObject:c});c.actionItem=d;var g=a.currentCatalogSize,h=this.getZoneSize(e,a),u=h.width,m=h.height;if(e.isScrollMap){var p=e.zoomScale,f=u*p,v=m*p;o.style.left="0px",o.style.top="0px",l.style.cursor="move"}else{var f=u*r.scale,v=m*r.scale;l.style.cursor="zoom-out"}l.width=f,l.height=v,l.style.left="0px",l.style.top="0px",o.style.width=f+"px",o.style.height=v+"px";var M=e.isScrollMap&&e.hasMultizoom===!1,b=u*r.scale,F=m*r.scale,A=M&&b>g.width?g.width:b,P=M&&F>g.height?g.height:F;n.style.width=A+"px",n.style.height=P+"px";var y=parseFloat(r.containerElement.style.width),C=parseFloat(r.containerElement.style.height),E=parseFloat(r.containerElement.style.left)+r.translatedX-y*(r.scale-1)/2,S=parseFloat(r.containerElement.style.top)+r.translatedY-C*(r.scale-1)/2;n.style.left=E+"px",n.style.top=S+"px";for(var w=E+g.x+a.getPositionX(),I=S+g.y+a.getPositionY(),x="undefined"!=typeof a.superObject,D=a.superObject;x;){var T=D.getPositionX(),O=D.getPositionY();w+=T,I+=O,x="undefined"!=typeof D.superObject,D=D.superObject}c.absoluteLeft=w,c.absoluteTop=I,c.maxX=A,c.maxY=P,c.maxTranslationX=f-A,c.maxTranslationY=v-P,a.zoomMaps.hd[i]=c;var z=new Image;z.onload=function(){if(e.hasHeader){var i=t.createHeaderCanvas(c,e),n=!0;c.header=i,t.drawHeaderImageInCanvas(i,this,e);var s=a.settings.maps.settings.zonesConfig;if(s.innerMapsVisibleZoomMap){var o=t.getZoneMaps(e);t.showInnerMapsHeader(e,i,o)}}else if(e.headers&&e.headers.length){var l=t.createHeaderCanvases(c,e);
l.forEach(function(a){t.drawHeaderImageInCanvas(a,z,e,a.headerData)}),c.headerCanvases=l,n=!1}else n=!1;t.drawImageInCanvas(c.canvasElement,this,e,n),r.containerElement.style.display="none",MainFrame.EventHandler.dispatch("zoomMapReady",[t.paramsObject.sourceEvent.eventData])};var B=this.getCurrentImageSrc(a,e);if(z.src=B,a.hasPngText){var k=new Image;k.onload=function(){t.drawImageInCanvas(c.canvasElement,this,e)};var U=z.src.replace(/hd.jpg/g,"hd.png");k.src=U}return c.containerElement.style.transitionProperty="transform",MainFrame.Util.setTransformDuration(c.containerElement,0,"s"),e.rotation&&(c.translatedX=0,c.translatedY=0,MainFrame.Util.setPositionAndRotation(c.containerElement,c.translatedX,c.translatedY,1,e.rotation)),e.altZoomText&&this.addZoomAlt(e,c.actionItem),e.isScrollMap?e.rotation?c.actionItem.setAction("id:zoomMapRotatedActions;params:rotation="+e.rotation):c.setAction("id:zoomMapActions"):c.actionItem.setAction("id:closeZoomMap"),this.overlay.setAction("id:closeZoomMap"),c},addZoomAlt:function(e,t){var a=e.altZoomText,i=e.altZoomType||"default";if(a&&i){var r=e.id+"_zoomed_"+Math.random();t.addAltId(r,i,a,{})}},createHeaderCanvases:function(e,t){var a=this,i=a.getCatalog();a.getCatalogSize(),scale=t.isScrollMap?t.zoomScale:t.maxScale;var r=[];return t.headers.forEach(function(t){var n=MainFrame.Util.createElement("div","",e.contentElement),s=MainFrame.Util.createElement("canvas","v7__elem--content v7--fill",n),o=new MainFrame.Element.Item({superObject:e,containerElement:n,contentElement:s});o.headerData=t;var l=a.getHeaderSize(t,i),c=l.width*scale,d=l.height*scale;s.width=c,s.height=d,o.setDimensionX(c),o.setDimensionY(d),n.style.left="0px",n.style.top="0px",n.style.width=c+"px",n.style.height=d+"px",n.style.position="absolute",n.style.overflow="hidden",r.push(o)}),r},createHeaderCanvas:function(e,t){var a=this.getCatalog(),i=MainFrame.Util.createElement("div","",e.contentElement),r=MainFrame.Util.createElement("canvas","v7__elem--content v7--fill",i),n=new MainFrame.Element.Item({superObject:e,containerElement:i,contentElement:r}),s=t.isScrollMap?t.zoomScale:t.maxScale,o=this.getCatalogSize(),l=this.getHeaderSize(t,a),c=l.width*s,d=l.height*s;switch(r.width=c,r.height=d,i.style.width=c+"px",i.style.height=d+"px",i.style.position="absolute",i.style.overflow="hidden",t.getDistanceToLeft()+a.borderLeftWidth+o.leftMargin,t.getDistanceToTop()+a.borderTopWidth+o.topMargin,t.headerAnchor){case"TL":case"TR":case"TC":default:i.style.left="0px",i.style.top="0px",e.absoluteTop+=d,e.maxY-=d}return n},drawImageInCanvas:function(e,t,a,i){var r=this.getCatalog(),n=this.isACheval(a),s=a.hasHeader&&i===!0;if(n){var o=this,l=t.src,c=this.getNextPageImageSrc(l),d=new Image;d.onload=function(){o.drawLeftPageImageInCanvas(e,t,a,r,s),o.drawRightPageImageInCanvas(e,d,a,r,s)},d.src=c}else this.drawCurrentPageImageInCanvas(e,t,a,r,s)},drawCurrentPageImageInCanvas:function(e,t,a,i,r){if(r){var n=(parseInt(a.headerX,10),parseInt(a.headerY,10),parseInt(a.headerW,10),parseInt(a.headerH,10)),s=parseInt(a.recX,10),o=parseInt(a.recY,10),l=parseInt(a.recW,10),c=parseInt(a.recH,10);switch(a.anchor){case"TC":case"TR":case"TL":default:var d=s,g=o+n,h=l,u=c-n,m=h,p=u,f=l,v=c,M=100*m/f,b=100*p/v,F=100*n/v,A={};A.x=0,A.y=F*e.height/100,A.width=M*e.width/100,A.height=b*e.height/100}}else var d=parseInt(a.recX,10),g=parseInt(a.recY,10),h=parseInt(a.recW,10),u=parseInt(a.recH,10),A=this.getCanvasStandardDest(e.width,e.height);var P=this.getCanvasSrc(d,g,h,u,i,t),y=e.getContext("2d");this.shouldUseSizesForZoomScale()&&(e.style.left=-P.diff_x+"px",e.style.top=-P.diff_y+"px",Math.abs(P.width-A.width)<=2&&(P.width=A.width,P.height=A.height)),y.drawImage(t,P.x,P.y,P.width,P.height,A.x,A.y,A.width,A.height),a.hasMask&&i.settings.maps.settings.clippingConfig.zoomMapClipping&&this.applyZoneDetourage(a,e,y)},applyZoneDetourage:function(e,t,a){var i=t.width,r=t.height,n=parseInt(e.recW,10),s=parseInt(e.recH,10),o=i/n,l=r/s;a.globalCompositeOperation="destination-in",a.beginPath(),e.hasMask&&e.maskPathEntries.forEach(function(e){var t=e.params.map(function(e,t){var a=t%2===0;return a?e*o:e*l});a[e.type].apply(a,t)}),a.closePath(),a.fill()},drawLeftPageImageInCanvas:function(e,t,a,i,r){var n=e.width,s=e.height;if(r){var o=(parseInt(a.headerX,10),parseInt(a.headerY,10),parseInt(a.headerW,10),parseInt(a.headerH,10)),l=parseInt(a.recX,10),c=parseInt(a.recY,10),d=parseInt(a.recW,10),g=parseInt(a.recH,10);switch(a.anchor){case"TC":case"TR":case"TL":default:var h=l,u=c+o,m=i.settings.pages.normalSize.width-l,p=g-o,f=m,v=p,M=d,b=g,F=100*f/M,A=100*v/b,P=100*o/b,y={};y.x=0,y.y=P*s/100,y.width=F*n/100,y.height=A*s/100}}else var h=parseInt(a.recX,10),u=parseInt(a.recY,10),m=i.settings.pages.normalSize.width-h,p=parseInt(a.recH,10),y=this.getCanvasLeftDest(e,m,a.recW);var C=this.getCanvasSrc(h,u,m,p,i,t),E=e.getContext("2d");E.drawImage(t,C.x,C.y,C.width,C.height,y.x,y.y,y.width,y.height)},drawRightPageImageInCanvas:function(e,t,a,i,r){if(e.width,e.height,r){var n=(parseInt(a.headerX,10),parseInt(a.headerY,10),parseInt(a.headerW,10),parseInt(a.headerH,10));switch(parseInt(a.recX,10),parseInt(a.recY,10),parseInt(a.recW,10),parseInt(a.recH,10),a.anchor){case"TC":case"TR":case"TL":default:var s=0,o=parseInt(a.recY,10)+n,l=parseInt(a.recX,10)+parseInt(a.recW,10)-i.settings.pages.normalSize.width,c=parseInt(a.recH,10)-n,d=l,g=c,h=i.settings.pages.normalSize.width-parseInt(a.recX,10),u=parseInt(a.recW),m=parseInt(a.recH),p=100*d/u,f=100*g/m,v=100*h/u,M=100*n/m,b=v*e.width/100,F=M*e.height/100,A=p*e.width/100,P=f*e.height/100}}else var s=0,o=parseInt(a.recY,10),l=parseInt(a.recX,10)+parseInt(a.recW,10)-i.settings.pages.normalSize.width,c=parseInt(a.recH,10),d=l,h=i.settings.pages.normalSize.width-parseInt(a.recX,10),u=parseInt(a.recW),p=100*d/u,v=100*h/u,b=v*e.width/100,F=0,A=p*e.width/100,P=e.height;var y=this.getCanvasSrc(s,o,l,c,i,t),C=e.getContext("2d");C.drawImage(t,y.x,y.y,y.width,y.height,b,F,A,P)},drawHeaderImageInCanvas:function(e,t,a,i){var r=this.getCatalog(),n=this.isACheval(a);if(a.hasHeader,n){var s=this,o=t.src,l=this.getNextPageImageSrc(o),c=new Image;c.onload=function(){s.drawLeftHeaderImageInCanvas(e.contentElement,t,a,r,i),s.drawRightHeaderImageInCanvas(e.contentElement,c,a,r,i)},c.src=l}else this.drawCurrentHeaderImageInCanvas(e.contentElement,t,a,r,i)},drawCurrentHeaderImageInCanvas:function(e,t,a,i,r){if(r)var n=r.headerX,s=r.headerY,o=r.headerW,l=r.headerH;else var n=parseInt(a.headerX,10),s=parseInt(a.headerY,10),o=parseInt(a.headerW,10),l=parseInt(a.headerH,10);var c=parseInt(a.recX,10),d=parseInt(a.recY,10),g=n+c,h=s+d,u=o,m=l,p=this.getCanvasSrc(g,h,u,m,i,t),f=this.getCanvasStandardDest(e.width,e.height),v=e.getContext("2d");v.drawImage(t,p.x,p.y,p.width,p.height,f.x,f.y,f.width,f.height)},drawLeftHeaderImageInCanvas:function(e,t,a,i,r){if(r)var n=r.headerX,s=r.headerY,o=r.headerW,l=r.headerH;else var n=parseInt(a.headerX,10),s=parseInt(a.headerY,10),o=parseInt(a.headerW,10),l=parseInt(a.headerH,10);var c=parseInt(a.recX,10),d=parseInt(a.recY,10),g=n+c,h=s+d,u=i.settings.pages.normalSize.width-g,m=l,p=this.getCanvasSrc(g,h,u,m,i,t),f=this.getCanvasLeftDest(e,u,o),v=e.getContext("2d");v.drawImage(t,p.x,p.y,p.width,p.height,f.x,f.y,f.width,f.height)},drawRightHeaderImageInCanvas:function(e,t,a,i,r){if(r)var n=r.headerX,s=r.headerY,o=r.headerW,l=r.headerH;else var n=parseInt(a.headerX,10),s=parseInt(a.headerY,10),o=parseInt(a.headerW,10),l=parseInt(a.headerH,10);var c=parseInt(a.recX,10),d=parseInt(a.recY,10),g=0+c,h=s+d,u=n+o-i.settings.pages.normalSize.width,m=l,p=this.getCanvasSrc(g,h,u,m,i,t),f=u,v=i.settings.pages.normalSize.width-n,M=o,b=100*f/M,F=100*v/M,A=F*e.width/100,P=0,y=b*e.width/100,C=e.height,E=e.getContext("2d");E.drawImage(t,p.x,p.y,p.width,p.height,A,P,y,C)},getCanvasSrc:function(e,t,a,i,r,n){var s=100*e/r.settings.pages.normalSize.width,o=100*t/r.settings.pages.normalSize.height,l=100*a/r.settings.pages.normalSize.width,c=100*i/r.settings.pages.normalSize.height,d={};return d.x=s*n.width/100,d.y=o*n.height/100,d.width=l*n.width/100,d.height=c*n.height/100,this.shouldUseSizesForZoomScale()&&(d.diff_x=d.x-Math.floor(d.x),d.diff_y=d.y-Math.floor(d.y),d.x=Math.floor(d.x),d.y=Math.floor(d.y),d.width=Math.floor(d.width),d.height=Math.floor(d.height)),d},getCanvasStandardDest:function(e,t){var a={};return a.x=0,a.y=0,a.width=e,a.height=t,a},getCanvasLeftDest:function(e,t,a){var i=t,r=parseInt(a),n=100*i/r,s={};return s.x=0,s.y=0,s.width=n*e.width/100,s.height=e.height,s},cachedCatalogSize:{},getCatalogSize:function(){var e=this.getCatalog(),t=MainFrame.Browser.width+"|"+MainFrame.Browser.height+"|"+e.currentPage;if(this.cachedCatalogSize[t])var a=this.cachedCatalogSize[t];else{var i=e.currentCatalogSize,r=i.width,n=i.height;catalogPageMarginLeft=i.x,catalogPageMarginTop=i.y;var a={};a.width=r,a.height=n,a.leftMargin=catalogPageMarginLeft,a.topMargin=catalogPageMarginTop}return a},getZoneSize:function(e,t){var a=t.currentPageSize,i=parseInt(e.recW,10),r=parseInt(e.recH,10),n=i/t.settings.pages.normalSize.width,s=r/t.settings.pages.normalSize.height,o=n*a.width,l=s*a.height;return{width:o,height:l}},getHeaderSize:function(e,t){var a=t.currentPageSize,i=parseInt(e.headerW,10),r=parseInt(e.headerH,10),n=i/t.settings.pages.normalSize.width,s=r/t.settings.pages.normalSize.height,o=n*a.width,l=s*a.height;return{width:o,height:l}},scaleValidator:function(e,t,a,i,r){var n=i/t,s=r/a;return e>n&&(e=n),e>s&&(e=s),e},determineMaxScaleToFit:function(e,t){if("undefined"==typeof e.zoomScale){var a=parseFloat(this.getParam("scale"));e.zoomScale=a}else var a=e.zoomScale;var i=this.getCatalog(),r=this.getCatalogSize(),n=parseFloat(t.style.width),s=parseFloat(t.style.height);if(this.shouldUseSizesForZoomScale())for(var o,l=!1,c=i.settings.pages.sizes,d=c.length-1,g=i.currentPageSize;l===!1;){var h=c[d],u=h.width/g.width,m=n*u,p=s*u,f=m<=r.width,v=p<=r.height;f&&v?(l=!0,o=u):d--}else var o=e.rotation?this.scaleValidator(a,s,n,r.width,r.height):this.scaleValidator(a,n,s,r.width,r.height);return o},determineMaxScaleToFill:function(e,t){if("undefined"==typeof e.zoomScale){var a=parseFloat(this.getParam("scale"));e.zoomScale=a}else var a=e.zoomScale;var i,r,n=(this.getCatalog(),this.getCatalogSize()),s=parseFloat(t.style.width),o=parseFloat(t.style.height),l=n.width,c=n.height,d=l/s,g=c/o;return d>g?(i="height",r=d):(i="width",r=g),{scale:r,fills:i}},getCurrentImageSrc:function(e,t){var a="undefined"!=typeof e.settings.pages.sizes;return a?this.getCurrentImageSrcWithSizes(e,t):this.getCurrentImageSrc_deprecated(e,t)},getCurrentImageSrcWithSizes:function(e,t){var a=t.page,i=e.pageReferences[a],r=e.determineMaximumSize(),n=i.sizes[r],s=n.normal;e.settings.pages.useXJpgForZoom&&-1!==e.settings.pages.xJpgPages.indexOf(a)&&(s=n.original);var o=!0;if(-1===s.indexOf("/"))var o=!0;else var o=!1;var l=MainFrame.Util.getAppURL()+(o?e.settings.pages.dataSrc:"")+s;return l},getCurrentImageSrc_deprecated:function(e,t){var a=t.page,i=e.pages[a][0],r=i.hd;e.settings.pages.useXJpgForZoom&&-1!==e.settings.pages.xJpgPages.indexOf(a)&&-1===r.indexOf("x.jpg")&&(r=r.split(".jpg").join("x.jpg"));var n=!0,s=MainFrame.Util.getAppURL()+(n?e.settings.pages.dataSrc:"")+r;return s},getNextPageImageSrc:function(e){var t=this.getCatalog(),a="undefined"!=typeof t.settings.pages.sizes;return a?this.getNextPageImageSrcWithSizes(e):this.getNextPageImageSrc_deprecated(e)},getNextPageImageSrcWithSizes:function(e){var t=this.getCatalog(),a=e.split("/").pop(),i=a.split(".")[0].substr(0,4),r=parseInt(i,10),n=r+1,s=t.pageReferences[n],o=t.determineMaximumSize(),l=s.sizes[o],c=l.normal;t.settings.pages.useXJpgForZoom&&-1!==t.settings.pages.xJpgPages.indexOf(n)&&(c=l.original);var d=!0;if(-1===c.indexOf("/"))var d=!0;else var d=!1;var g=MainFrame.Util.getAppURL()+(d?t.settings.pages.dataSrc:"")+c;return g},getNextPageImageSrc_deprecated:function(e){var t=e.split("/").pop(),a=t.split(".")[0].substr(0,4),i=parseInt(a,10),r=i+1,n=MainFrame.Util.zeroFill(r),s=e.replace(a,n),o=this.getCatalog();return o.settings.pages.useXJpgForZoom&&-1!==o.settings.pages.xJpgPages.indexOf(r)&&-1===s.indexOf("x.jpg")&&(s=s.split(".jpg").join("x.jpg")),s},determineMargins:function(e){var t=(this.getCatalog(),!1);return t=e.hasDcp?!1:!0},determineDCP:function(e){var t={x:null,y:null},a=this.getCatalog();if(e.hasDcp){var i=parseFloat(e.dcpX),r=parseFloat(e.dcpY),n="single"===a.settings.pages.coverType,s=n?e.page%2===1:a.isRightPage(e.page);a.isDoublePage&&s&&(i+=parseFloat(a.settings.pages.normalSize.width));var o=100*i/a.settings.pages.normalSize.width,l=100*r/a.settings.pages.normalSize.height,c=a.currentPageSize;t.x=o*c.width/100,t.y=l*c.height/100}return t},getUniqueZoneId:function(e){return[e.pageOrder,e.recX,e.recY,e.recW,e.recH].join("_")},checkOverlap:function(e,t){var a={};a.touchingTop=!1,a.touchingBottom=!1,a.touchingLeft=!1,a.touchingRight=!1;var i=e.left,r=e.top,n=e.left+e.width,s=e.top+e.height,o=t.left,l=t.top,c=t.left+t.width,d=t.top+t.height,g=Math.max(0,Math.min(n,c)-Math.max(i,o));return y_overlap=Math.max(0,Math.min(s,d)-Math.max(r,l)),a.overlapping=g*y_overlap!==0,a.overlapping&&(g&&(o>i?a.touchingRight=!0:a.touchingLeft=!0),y_overlap&&(l>r?a.touchingTop=!0:a.touchingBottom=!0)),a},showMapIcons:function(e,t,a){var i=this.catalog.settings.maps,r=i.settings.mapIcons;if(r.active){var n=!0;a.drawMapIcons.call(a,e,t.containerElement,n)}},showMapInfos:function(e,t,a){this.catalog.settings.maps.settings.zonesConfig,e.infos&&a.drawZoneInfos.call(a,e,t.containerElement)},showInnerMaps:function(e,t,a){var i=a.getInnerZones(e.id),r=this.getCatalog(),n=this.getUniqueZoneId(e),s=r.zoomMaps.hd[n],o=s.innerContainer;this.drawZones(i,a,o,e)},getZonesInsideHeader:function(e,t){var a=parseInt(t.headerX,10),i=parseInt(t.headerY,10),r=parseInt(t.headerW,10),n=parseInt(t.headerH,10),s=[];return e.forEach(function(e){var t=parseInt(e.recX,10),o=parseInt(e.recY,10);MainFrame.Util.pointInsideRectangle(t,o,a,i,r,n)&&s.push(e)}),s},showInnerMapsHeader:function(e,t,a){var i=a.getInnerZones(e.id);i=this.getZonesInsideHeader(i,e);var r=t.containerElement;this.drawZones(i,a,r,e)},drawZones:function(e,t,a,i){var r=!0,n=this.getCatalog(),s=n.settings.maps.settings.zonesConfig,o=n.settings.maps.settings.hotspotsArr,l=this.getUniqueZoneId(i);hqCanvas=n.zoomMaps.hd[l],canvasWidth=parseFloat(hqCanvas.canvasElement.width),canvasHeight=parseFloat(hqCanvas.canvasElement.height);for(var c=e.length,d=0;c>d;d++){var g=!0,h=e[d],u=t.determineMapRefType(h);if("undefined"!=typeof h.visibleInZoomMap?g=h.visibleInZoomMap:"undefined"!=typeof o[u]&&"undefined"!=typeof o[u].visibleInZoomMap?o[u].visibleInZoomMap===!1&&(g=!1):s.visibleInZoomMap===!1&&(g=!1),g){var m=new MainFrame.Abstract.Element({containerElement:!1});for(var p in h){var f="superObject"!==p&&"aF"!==p,v="interpretors"!==p;f&&v&&(m[p]=h[p])}h.isDrawn=!1,m.insideZoomMap=!0;var M=!0,b=!1,F=!0;t.drawMap(m,a,r,M,b,F),this.resizeZone(m,t,i,canvasWidth,canvasHeight)}}},resizeZone:function(e,t,a,i,r){var n=this.getCatalog(),s=n.settings.maps.settings,o=s.zonesConfig,l=t.getDefaultZoneRef(e);hotspotConfig=s.hotspotsArr[l.type];var c=parseFloat(e.recX,10),d=parseFloat(e.recY,10),g=parseFloat(e.recW,10),h=parseFloat(e.recH,10);hotspotConfig&&null!==hotspotConfig.adjustX?c+=hotspotConfig.adjustX:null!==o.adjustX&&(c+=hotspotConfig.adjustX),hotspotConfig&&null!==hotspotConfig.adjustY?d+=hotspotConfig.adjustY:null!==o.adjustY&&(d+=hotspotConfig.adjustY),c-=parseFloat(a.recX,10),d-=parseFloat(a.recY,10);var u=c/parseFloat(a.recW,10),m=d/parseFloat(a.recH,10),p=g/parseFloat(a.recW,10),f=h/parseFloat(a.recH,10);c=u*i,d=m*r,g=p*i,h=f*r;var v=this.catalog.settings.maps.settings,M=e.ref;M&&"true"==v.zonesConfig.zonesPictos[M.type+"Picto"]&&(g=v.hotspotsArr[M.type].hotspotWidth,h=v.hotspotsArr[M.type].hotspotHeight),e.setPositionX(c),e.setPositionY(d),e.setDimensionX(g),e.setDimensionY(h),e.resize()},showInnerPrices:function(e,t,a){var i=a.getInnerPrices(e),r=this.getCatalog();if(i)for(var n=this.getUniqueZoneId(e),s=r.zoomMaps.hd[n],o=s.innerContainer,l=parseFloat(t.canvasElement.width),c=parseFloat(t.canvasElement.height),d=i.length,g=a.superObject.currentPageSize,h=!0,u=0;d>u;u++){var m=i[u],p=a.drawPrice(m,o,h);this.resizePrice(m,p,a,e,t,l,c,g.height)}},resizePrice:function(e,t,a,i,r,n,s){var o=a.adjustPricePosition({x:parseFloat(t.priceMap.x),y:parseFloat(t.priceMap.y),size:parseFloat(t.priceMap.height)}),l=o.x,c=o.y,d=o.size;l-=parseFloat(i.recX),c-=parseFloat(i.recY);var g=100*l/parseFloat(i.recW),h=100*c/parseFloat(i.recH),u=100*d/parseFloat(i.recH);l=g*n/100,c=h*s/100,d=u*s/100,t.containerElement.style.fontSize=d+"px",t.containerElement.style.lineHeight=d+"px",t.setPositionX(l),t.setPositionY(c),t.containerElement.style.left=l+"px",t.containerElement.style.top=c+"px",t.resize()},addShadow:function(e,t,a){var i="true"===this.getParam("useShadow")?!0:!1,r=this.getZoneShadow(e,a);if(i||r){var n=a.cssClasses["zoom-map-shadow"];MainFrame.Util.addClass(t.containerElement,n)}},getZoneShadow:function(e,t){var a=t.superObject,i=t.getDefaultZoneRef(e),r=a.settings.maps.settings,n=r.zonesConfig,s=r.hotspotsArr[i.type];return"undefined"!=typeof e.zonesUseShadowZoom?e.zonesUseShadowZoom:"undefined"!=typeof s.zonesUseShadowZoom?s.zonesUseShadowZoom:"undefined"!=typeof n.zonesUseShadowZoom?n.zonesUseShadowZoom:!1}}),MainFrame.Action.ZoomInZoomMap=MainFrame.Action.BaseZoomMap.extend({startAction:function(){var e=this.getTarget();if("canvas"===e.containerElement.nodeName.toLowerCase()){var t=e.superObject,a="true"===this.getParam("zoomAssociatedZones")?!0:!1;this.hasAssociatedMaps(t)&&a?this.zoomInAllMaps(t):this.zoomInMap(t)}this.endAndClearAction()},zoomInAllMaps:function(e){var t=e.superObject,a=t.zoomMapContainer;"undefined"==typeof a.scale&&(a.scale=1,a.style.transitionDuration="0.1s",this.cloneOverlay(t));var i=this.getStep();a.scale+=i,this.zonesFitInsideContainer(e,a.scale)===!1&&(a.scale=this.getMaxZonesScale(e)),a.style.transform="scale("+a.scale+")"},zoomInMap:function(e){"undefined"==typeof e.scale&&(e.scale=1,e.containerElement.style.transitionDuration="0.1s");var t=this.getStep();e.scale+=t,this.zoneFitsInsideContainer(e,e.scale)===!1&&(e.scale=this.getMaxZoneScale(e));var a=this.getTranslation(e,e.scale);e.containerElement.style.zIndex="1000",e.containerElement.style.transform="translate("+a.x+"px, "+a.y+"px) scale("+e.scale+")"},cloneOverlay:function(e){var t=e.zoomMapContainer,a=e.zoomMapOverlay,i=a.cloneNode();a.style.transition="opacity 0s",a.style.opacity="0",i.style.left=e.currentCatalogSize.x+"px",i.style.top=e.currentCatalogSize.y+"px",t.parentNode.insertBefore(i,t),e.zoomMapOverlayClone=i}}),MainFrame.Action.ZoomOutZoomMap=MainFrame.Action.BaseZoomMap.extend({startAction:function(){var e=this.getTarget();if("canvas"===e.containerElement.nodeName.toLowerCase()){var t=e.superObject,a="true"===this.getParam("zoomAssociatedZones")?!0:!1;this.hasAssociatedMaps(t)&&a?this.zoomOutAllMaps(t):this.zoomOutMap(t)}this.endAndClearAction()},zoomOutAllMaps:function(e){var t=e.superObject,a=t.zoomMapContainer;t.zoomMapOverlay,"undefined"==typeof a.scale&&(a.scale=1,a.style.transitionDuration="0.1s");var i=this.getStep(),r=this.getMaxZonesScale(e);e.scale===r&&(i=e.scale-i*Math.floor(e.scale/i)),a.scale-i>=1?(a.scale-=i,a.style.transform="scale("+a.scale+")"):a.style.transform=""},zoomOutMap:function(e){"undefined"==typeof e.scale&&(e.scale=1,e.containerElement.style.transitionDuration="0.1s");var t=this.getStep(),a=this.getMaxZoneScale(e);if(e.scale===a&&(t=e.scale-t*Math.floor(e.scale/t)),e.scale-t>=1){e.scale-=t;var i=this.getTranslation(e,e.scale);e.containerElement.style.zIndex="1000",e.containerElement.style.transform="translate("+i.x+"px, "+i.y+"px) scale("+e.scale+")"}else e.containerElement.style.zIndex="",e.containerElement.style.transform=""}}),!function(){var e={parseMapsSettings:function(e){if(this.settings={},this.settings.zonesConfig={},this.settings.hotspotsArr={},this.settings.clippingConfig={},e.childNodes,this.settings.allowedGoToMaps="ldc|audio|video|videoYT|diapo|containerPopup|zoom".split("|"),e.attributes.allowedGoToMaps&&(this.settings.allowedGoToMaps=e.attributes.allowedGoToMaps.split("|")),e.attributes.allowedProdIdMaps&&(this.settings.allowedGoToMaps=e.attributes.allowedProdIdMaps.split("|")),this.settings.prodIdTrigger=e.attributes.prodIdTrigger?e.attributes.prodIdTrigger:"prodIdClick",e.attributes.prodIdTriggerDelay){var t=parseFloat(e.attributes.prodIdTriggerDelay);this.settings.prodIdTriggerDelay=MainFrame.Util.secondsToMiliseconds(t)}else this.settings.prodIdTriggerDelay=1e3;"true"===e.attributes.disableZIndexIncrease&&(this.settings.disableZIndexIncrease=!0),this.settings.mapIcons={};var a=MainFrame.DataParser.getNodesWithNodeName(e,"mapIcons");if(a.length){var i=a[0];MainFrame.DataParser.parseMapIcons.call(this,i)}else this.settings.mapIcons.active=!1;var r=MainFrame.DataParser.getNodesWithNodeName(e,"details");for(index=0,totalDetails=r.length;totalDetails>index;index++){var n=r[index];MainFrame.DataParser.parseDetails(n)}var s=MainFrame.DataParser.getNodesWithNodeName(e,"zones");if(s.length){var o=s[0];MainFrame.DataParser.parseZones.call(this,o)}var l=MainFrame.DataParser.getNodesWithNodeName(e,"clipping");if(l.length){var c=l[0];MainFrame.DataParser.parseClipping.call(this,c)}for(var d=MainFrame.DataParser.getNodesWithNodeName(e,"hotspot"),g=d.length,h=0;g>h;h++){var u=d[h];MainFrame.DataParser.parseHotspot.call(this,u)}},getDisplayModes:function(e,t){return t="undefined"==typeof t?{}:t,e.attributes.displayMode&&(t.desktop=MainFrame.DataParser.getDisplayMode(e.attributes.displayMode)),e.attributes.displayModeTablet&&(t.tablet=MainFrame.DataParser.getDisplayMode(e.attributes.displayModeTablet)),e.attributes.displayModePhone&&(t.phone=MainFrame.DataParser.getDisplayMode(e.attributes.displayModePhone)),t},getDisplayMode:function(e){var t={showMapIcons:!1,showZone:!1,showHotspot:!1};return e&&(-1!==e.indexOf("mapIcons")&&(t.showMapIcons=!0),-1!==e.indexOf("rec")&&(t.showZone=!0),-1!==e.indexOf("hs")&&(t.showHotspot=!0),-1!==e.indexOf("none")&&(t.isDisabled=!0),-1!==e.indexOf("cheval")&&(t.isACheval=!0)),t},parseZones:function(e){var t=this.settings.zonesConfig;t.hasMultizoom="0"===e.attributes.multizoom?!1:!0,t.innerMapsVisibleNormal="false"===e.attributes.innerMapsVisibleNormal?!1:!0,t.innerMapsVisibleZoomCatalog="false"===e.attributes.innerMapsVisibleZoom?!1:!0,t.innerMapsVisibleZoomCatalog="false"===e.attributes.innerMapsVisibleZoomCatalog?!1:!0,t.innerMapsVisibleZoomMap="false"===e.attributes.innerMapsVisibleZoomMap?!1:!0,t.showAssociatedZonesOnHover="false"===e.attributes.showAssociatedZonesOnHover?!1:!0,t.showMapsOnHover="false"===e.attributes.hover?!1:!0,t.alwaysVisible="true"===e.attributes.alwaysVisible||"1"===e.attributes.alwaysVisible?!0:!1,t.placeOnTop="false"===e.attributes.placeOnTop||"0"===e.attributes.placeOnTop?!1:!0,t.resizeHotspots="false"===e.attributes.resizeHotspots?!1:!0,t.visibleInZoomMap="false"===e.attributes.visibleInZoomMap?!1:!0,t.altType=e.attributes.altType||"default",t.zoneAlt="false"===e.attributes.zoneAlt||"0"===e.attributes.zoneAlt?!1:!0,t.adjustX=e.attributes.adjustX?parseFloat(e.attributes.adjustX,10):null,t.adjustY=e.attributes.adjustY?parseFloat(e.attributes.adjustY,10):null,t.showInfosInsideZoomMaps="true"===e.attributes.showInfosInsideZoomMaps?!0:!1,t.infosActions="true"===e.attributes.infosActions?!0:!1,e.attributes["class"]&&(t.cssClass=e.attributes["class"]),t.groupMultiRefsByRefType="true"===e.attributes.groupMultiRefsByRefType||"1"===e.attributes.groupMultiRefsByRefType?!0:!1,MainFrame.DataParser.getGlorifierSettings(e,t);var a={};if(a.desktop={showMapIcons:!0,showZone:!1,showHotspot:!1,isDisabled:!1},a.tablet={showMapIcons:!1,showZone:!1,showHotspot:!0,isDisabled:!1},a.phone={showMapIcons:!1,showZone:!1,showHotspot:!0,isDisabled:!1},t.displayMode=MainFrame.DataParser.getDisplayModes(e,a),t.zonesColor=e.attributes.color,t.zonesOpacity=e.attributes.opacity,t.zonesBorder=e.attributes.border,t.zonesBorderColor=e.attributes.borderColor,t.zonesPictos={},t.zonesUseShadow="true"===e.attributes.useShadow?!0:!1,t.zonesUseShadow&&(t.zonesBorder="0px"),t.zonesUseShadowZoom="true"===e.attributes.useShadowZoom?!0:!1,t.theme=e.attributes.theme,e.attributes.pos){var i=e.attributes.pos,r=MainFrame.Util.processPosition(i);t.pos=[r.x,r.y].join("|")}var n=this.settings.mapIcons;if(n.active){var s=e.attributes.zoomIcons;n.zoomIconsOrder=MainFrame.DataParser.getMapIconsOrder(s)}for(var o in e.attributes){var l=e.attributes[o],c=o.indexOf("Picto")>0;c&&(t.zonesPictos[o]=l)}},parseClipping:function(e){var t=this.settings.clippingConfig;t.zoomMapClipping="false"===e.attributes.zoom||"0"===e.attributes.zoom?!1:!0,t.normalClipping="false"===e.attributes.normal||"0"===e.attributes.normal?!1:!0},getGlorifierSettings:function(e,t){t.glorified="true"===e.attributes.glorifier?!0:!1;var a=e.attributes.glorifierColor;t.glorifierColor=a?MainFrame.Util.processAttribute(a).interpretedString:"#000";var i=e.attributes.glorifierOpacity;t.glorifierOpacity=i?MainFrame.Util.processAttribute(i).interpretedString:"0.7"},parseHotspot:function(e){var t={};t.hotspotType=e.attributes.type,t.hotspotSrc=e.attributes.src,t.hotspotWidth=e.attributes.width,t.hotspotHeight=e.attributes.height,t.hotspotBaseUrl="undefined"!=typeof e.attributes.baseUrl?e.attributes.baseUrl:"",t.hotspotFinUrl="undefined"!=typeof e.attributes.finUrl?e.attributes.finUrl:"",t.hotspotMediaBaseUrl="undefined"!=typeof e.attributes.mediaBaseUrl?e.attributes.mediaBaseUrl:"common/facebook_maps/",t.hotspotMediaFinUrl="undefined"!=typeof e.attributes.mediaFinUrl?e.attributes.mediaFinUrl:".jpg",t.zonesColor="undefined"!=typeof e.attributes.color?e.attributes.color:"",t.zonesOpacity="undefined"!=typeof e.attributes.opacity?e.attributes.opacity:"",t.zonesBorder="undefined"!=typeof e.attributes.border?e.attributes.border:"",t.zonesBorderColor="undefined"!=typeof e.attributes.borderColor?e.attributes.borderColor:"",t.theme=e.attributes.theme,e.attributes.altType&&(t.altType=e.attributes.altType),e.attributes.zoneAlt&&(t.zoneAlt="false"===e.attributes.zoneAlt||"0"===e.attributes.zoneAlt?!1:!0),"undefined"!=typeof e.attributes.useShadow&&(t.zonesUseShadow="true"===e.attributes.useShadow?!0:!1,t.zonesUseShadow&&(t.zonesBorder="0px")),"undefined"!=typeof e.attributes.useShadowZoom&&(t.zonesUseShadowZoom="true"===e.attributes.useShadowZoom?!0:!1),t.libId="undefined"!=typeof e.attributes.libId?e.attributes.libId:"",("false"===e.attributes.placeOnTop||"0"===e.attributes.placeOnTop)&&(t.placeOnTop=!1),"true"===e.attributes.glorifier&&(t.glorified=!0);var a=e.attributes.useMultiPanel;if(("false"===a||"0"===a)&&(t.useMultiPanel=!1),"undefined"!=typeof e.attributes.visibleInZoomMap&&(t.visibleInZoomMap="false"===e.attributes.visibleInZoomMap?!1:!0),t.displayMode=MainFrame.DataParser.getDisplayModes(e),t.visibleOnHover=this.settings.zonesConfig.showMapsOnHover,e.attributes.hover&&"false"===e.attributes.hover&&(t.visibleOnHover=!1),t.alwaysVisible=this.settings.zonesConfig.alwaysVisible,"true"===e.attributes.alwaysVisible||"1"===e.attributes.alwaysVisible?t.alwaysVisible=!0:("false"===e.attributes.alwaysVisible||"0"===e.attributes.alwaysVisible)&&(t.alwaysVisible=!1),e.attributes.pos){var i=e.attributes.pos,r=MainFrame.Util.processPosition(i);t.pos=[r.x,r.y].join("|")}if(t.isEnabled=!0,e.attributes.disabled&&"true"===e.attributes.disabled&&(t.isEnabled=!1),e.attributes.zoomIcons&&"undefined"!==e.attributes.zoomIcons){var n=e.attributes.zoomIcons;t.zoomOrder=MainFrame.DataParser.getMapIconsOrder(n)}if(e.attributes.order&&"undefined"!==e.attributes.order){var s=e.attributes.order;t.order=MainFrame.DataParser.getMapIconsOrder(s)}if(e.attributes.orientation&&"undefined"!==e.attributes.orientation){var o=e.attributes.orientation;t.orientation=o}if(e.attributes.place&&"undefined"!==e.attributes.place){var l=e.attributes.place;t.position=l}if(e.attributes.defaultAction&&"undefined"!==e.attributes.defaultAction){var c=e.attributes.defaultAction;t.defaultZoneRef=c}t.differentProdIdAction="true"===e.attributes.differentProdIdAction?!0:!1,e.attributes["class"]&&(t.cssClass=e.attributes["class"]),t.adjustX=e.attributes.adjustX?parseFloat(e.attributes.adjustX,10):null,t.adjustY=e.attributes.adjustY?parseFloat(e.attributes.adjustY,10):null;var d="false"===e.attributes.mapIcons?!1:!0;t.mapIcons=d,this.settings.hotspotsArr[t.hotspotType]=t},parseMapsPageXml:function(e,t){for(var a=this,i=a.refs||{},r=0,n=e.childNodes.length;n>r;r++)switch(e.childNodes[r].nodeName){case"zone":var s=e.childNodes[r];MainFrame.DataParser.recurseZones.call(a,s,0,t);break;case"ref":var s=e.childNodes[r];MainFrame.DataParser.parseRefs.call(a,i,s,t)}a.refs=i},recurseZones:function(e,t,a,i){var r=this.superObject,n=r.settings.maps.settings,s=n.zonesConfig,o=n.hotspotsArr,l=MainFrame.DataParser.getDisplayModes(e);if("Desktop"===EnvDetection.deviceType){if("undefined"!=typeof l.desktop&&l.desktop.isDisabled===!1)return}else if("Tablet"===EnvDetection.deviceType){if("undefined"!=typeof l.tablet&&l.tablet.isDisabled===!1)return}else if("Phone"===EnvDetection.deviceType&&"undefined"!=typeof l.phone&&l.phone.isDisabled===!1)return;var c={};c.displayMode=l;var d=Date.now();if(c.id=(e.attributes.id||"no-id")+"_"+d+"_"+Math.random(),c.lvl=t,i&&(c.parentId=i),("false"===e.attributes.placeOnTop||"0"===e.attributes.placeOnTop)&&(c.placeOnTop=!1),"true"===e.attributes.glorifier||"1"===e.attributes.glorifier?c.glorified=!0:("false"===e.attributes.glorifier||"0"===e.attributes.glorifier)&&(c.glorified=!1),e.attributes.ratiozoom){var g=parseInt(e.attributes.ratiozoom,10)/100;c.zoomScale=g}if(e.attributes.styleId&&(c.zoneStyleId=e.attributes.styleId),e.attributes.ratioZoom){var g=parseInt(e.attributes.ratioZoom,10)/100;c.zoomScale=g}c.isScrollMap="1"===e.attributes.autoZoomSize?!0:!1,e.attributes.rotation&&(c.rotation=parseInt(e.attributes.rotation,10)),c.hasMultizoom=e.attributes.multizoom?"1"===e.attributes.multizoom?!0:!1:s.hasMultizoom,"undefined"!=typeof e.attributes.visibleInZoomMap&&(c.visibleInZoomMap="false"===e.attributes.visibleInZoomMap?!1:!0),"undefined"!=typeof e.attributes.innerMapsVisibleNormal&&(c.innerMapsVisibleNormal="true"===e.attributes.innerMapsVisibleNormal?!0:!1),e.attributes.altType&&(c.altType=e.attributes.altType),e.attributes.zoneAlt&&(c.zoneAlt="false"===e.attributes.zoneAlt||"0"===e.attributes.zoneAlt?!1:!0),"true"===e.attributes.alwaysVisible||"1"===e.attributes.alwaysVisible?c.alwaysVisible=!0:("false"===e.attributes.alwaysVisible||"0"===e.attributes.alwaysVisible)&&(c.alwaysVisible=!1),e.attributes["class"]&&(c.cssClass=e.attributes["class"]),"undefined"!=typeof e.attributes.useShadowZoom&&(c.zonesUseShadowZoom="true"===e.attributes.useShadowZoom?!0:!1),c.zoneAttributes=e.attributes,MainFrame.DataParser.parseDcp.call(c,e),c.pageOrder=a,c.refs=[],c.mapIconRefs=[],c.headers=[];for(var h=0,u=e.childNodes.length;u>h;h++){var m=e.childNodes[h];switch(m.nodeName){case"rec":var p=m,f=p.value,v=f.split("|");c.recX=v[0],c.recY=v[1],c.recW=v[2],c.recH=v[3],c.positionX=c.recX,c.positionY=c.recY,c.dimensionX=c.recW,c.dimensionY=c.recH,MainFrame.DataParser.parseDcp.call(c,p);break;case"header":var M=m,b=(M.attributes.anchor||"TL",M.attributes.rec),F=b.split("|"),A=M.attributes.type,P={};P.type=A,P.headerX=parseInt(F[0],10),P.headerY=parseInt(F[1],10),P.headerW=parseInt(F[2],10),P.headerH=parseInt(F[3],10),c.headers.push(P),"true"===M.attributes.old_version&&(c.headerX=F[0],c.headerY=F[1],c.headerW=F[2],c.headerH=F[3],c.hasHeader=!0);break;case"ref":var y=m.value,C=this.refs[y];if(o[C.type]&&o[C.type].isEnabled!==!1){var C=this.getRefById(y);n.mapIcons.active&&-1===n.mapIcons.defaultRefs.indexOf(C.type)?c.refs.push(y):c.mapIconRefs.push(y)}else"undefined"==typeof o[C.type]&&MainFrame.Util.warn('The reference type "'+C.type+'" is not defined in mapsConfigFile.xml and will be ignored! Please add <hotspot type="'+C.type+'">');break;case"alt":c.altText=m.value;
break;case"altZoom":c.altZoomText=m.value;break;case"id":c.layerId=m.value;break;case"hs":MainFrame.DataParser.parseHotspotSettings.call(c,m);break;case"content":MainFrame.DataParser.parseZoneContent.call(c,m);break;case"infos":MainFrame.DataParser.parseZoneInfos.call(c,m);break;case"mask":MainFrame.DataParser.parseZoneMask.call(c,m)}}for(this.zones.push(c),t++,h=0;u>h;h++){var m=e.childNodes[h];switch(m.nodeName){case"zone":MainFrame.DataParser.recurseZones.call(this,m,t,a,c.id)}}},parseZoneInfos:function(e){var t={},a=MainFrame.DataParser.getNodeNamed(e,"description"),i=MainFrame.DataParser.getNodeNamed(e,"title");t.description=a?a.value:"",t.title=i?i.value:"",t.theme=e.attributes.theme,t.class=e.attributes["class"];var r=e.attributes.rec;if(r){var n=r.split("|"),s=parseInt(n[0],10),o=parseInt(n[1],10),l=parseInt(n[2],10),c=parseInt(n[3],10);"undefined"==typeof this.recX||"undefined"==typeof this.recW?MainFrame.Util.warn("Zone infos parsing error: please place the <infos> node after the <rec> node"):(t.dimensionX=l,t.dimensionY=c,t.positionX=s-parseInt(this.recX,10),t.positionY=o-parseInt(this.recY,10))}var d=e.attributes.size;if(d){var g=d.split("|");t.dimensionX=parseInt(g[0],10),t.dimensionY=parseInt(g[1],10)}var h=e.attributes.pos;if(h){var u=h.split("|");t.positionX=parseInt(u[0],10),t.positionY=parseInt(u[1],10)}this.infos=t},parseZoneMask:function(e){var t=this;if(e.childNodes.length){t.hasMask=!0;var a=[];e.childNodes.forEach(function(e){var i={};i.type=MainFrame.DataParser.getMaskEntryType(e),i.params=MainFrame.DataParser.getMaskEntryParams(e,i.type,t),a.push(i)}),t.maskPathEntries=a}},getMaskEntryType:function(e){var t=e.attributes.t;switch(t){case"C":return"quadraticCurveTo";case"L":return"lineTo";case"M":return"moveTo"}return""},getMaskEntryParams:function(e,t,a){var i=e.attributes.v,r=i.split("|"),n=[],s=(parseInt(a.recX),parseInt(a.recY),r.map(parseFloat));return"lineTo"===t||"moveTo"===t?(n.push(s[0]),n.push(s[1])):"quadraticCurveTo"===t&&(n.push(s[2]),n.push(s[3]),n.push(s[0]),n.push(s[1])),n},parseHotspotSettings:function(e){var t=e;if(t.attributes.pos){var a=t.attributes.pos;this.hsPos=a}if(t.attributes.size){var i=t.attributes.size;this.hsSize=i}t.attributes.styleId&&(this.hotspotStyleId=t.attributes.styleId);for(var r=0,n=t.childNodes.length;n>r;r++){var s=t.childNodes[r];"src"===s.nodeName&&(this.hotspotSrc=s.textContent||s.text)}},parseZoneContent:function(e){this.hasCustomContent=!0,e.attributes.resourceId?this.resourceId=e.attributes.resourceId:e.attributes.iframeSrc?this.iframeSrc=e.attributes.iframeSrc:this.customContent=e},parseRefs:function(e,t,a){var i={};i.type=t.attributes.type,i.pageOrder=a;for(var r=0,n=t.childNodes.length;n>r;r++){var s=t.childNodes[r];switch(s.nodeName){case"id":i.id=s.value;break;case"url":i.url=s.value;break;case"infos":i.infos=MainFrame.DataParser.parseNodeToObject(s)}}"undefined"==typeof i.id&&(Date.now(),i.id="no_ref_id_"+Math.random()),e[i.id]=i},parseDcp:function(e){if(e.attributes.dcp){this.hasDcp=!0;var t=e.attributes.dcp;dcpArray=t.split("|"),this.dcpX=dcpArray[0],this.dcpY=dcpArray[1]}},parseMapIcons:function(e){MainFrame.DataParser.parseMapIconSettings.call(this,e);for(var t={},a=0,i=e.childNodes.length;i>a;a++){var r=e.childNodes[a];r.attributes&&"details"!==r.nodeName&&(t[r.nodeName]=r)}this.settings.mapIcons.icons=t},parseMapIconSettings:function(e){var t=e.attributes.orientation||"vertical",a=e.attributes.place||"TR",i=e.attributes.order,r=e.attributes.zoomIcons,n="1"===e.attributes.groupMultiIcons||"true"===e.attributes.groupMultiIcons?!0:!1,s=e.attributes.defaultRefs||"zoom|print|mail|facebook|google|pinterest|twitter|linkedin|stumbleupon|digg|delicious",o="true"===e.attributes.mapIconsInZoom?!0:!1,l="1"===e.attributes.groupMultiIconsByRefType||"true"===e.attributes.groupMultiIconsByRefType?!0:!1,c=this.settings.mapIcons;c.active="false"!==e.attributes.active?!0:!1;var d=MainFrame.DataParser.getMapIconsOrder(i);c.order=d;var g=MainFrame.DataParser.getMapIconsOrder(r);c.zoomOrder=g,c.position=a,c.orientation=t,c.groupMultiIcons=n,c.groupMultiIconsByRefType=l,c.defaultRefs=s.split("|"),c.mapIconsInZoom=o;var h=e.attributes.spaceX,u=e.attributes.spaceY,m=e.attributes.offsetX,p=e.attributes.offsetY;c.spaceX=h?parseInt(h):0,c.spaceY=u?parseInt(u):0,c.offsetX=m?parseInt(m):0,c.offsetY=p?parseInt(p):0},getMapIconsOrder:function(e){var t={};if(e)for(var a=e.split("|"),i=0,r=a.length;r>i;i++){var n=a[i];t[n]=i}return t},getZoneRefIds:function(e){for(var t=[],a=e.getElementsByTagName("ref"),i=a.length,r=0;i>r;r++){var n=a[r],s=MainFrame.DataParser.getCDATA(n);t.push(s)}return t}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Maps=MainFrame.Abstract.Element.extend({cssClasses:{shadow:"v7__maps__zone--shadow","zoom-map-shadow":"v7__maps__zone__zoom--shadow",zones:"v7__maps__zones","custom-content":"v7__maps__custom-content","custom-content-iframe":"v7__maps__custom-content__iframe",glorifier:"v7__maps__glorifier",map:"v7__maps__map",zone:"v7__maps__zone","zone-zoom":"v7__maps__zone__zoom",hotspot:"v7__maps__hotspot",infos:"v7__maps__zone__infos","infos-theme":"v7__maps__zone__infos__theme--","infos-title":"v7__maps__zone__infos__title","infos-description":"v7__maps__zone__infos__description","map-icons":"v7__maps__map-icons","map-icons-wrapper":"v7__maps__map-icons__wrapper","map-icons-position":"v7__maps__map-icons__wrapper--","map-custom-content":"v7__maps__map__custom-content"},dimensionX:"100%",dimensionY:"100%",positionX:"0",positionY:"0",initialize:function(e){this.superObject=e.superObject,this.superObject&&this.superObject.addSubObject(this),this.subObjects=[],this.containerElement=e.containerElement,this.createGlorifierCanvas(),this.createCustomContentContainer(),this.createZonesContainer(),this.onCompleteCallback=function(){}},createZonesContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses.zones,this.containerElement);this.zonesContainer=e},createCustomContentContainer:function(){var e=MainFrame.Util.createElement("div",this.cssClasses["custom-content"],this.containerElement);this.customContentContainer=e},createGlorifierCanvas:function(){var e=MainFrame.Util.createElement("canvas",this.cssClasses.glorifier,this.containerElement);this.glorifierCanvas=e},drawMapsForPage:function(e,t){var a=this.superObject;this.empty(),this.containerElement.style.display="",this.zones=[],this.refs=[];var i=a.isValidPageValue(e);i&&("function"==typeof t&&(this.onCompleteCallback=t),this.page=e,this.readData())},readData:function(){var e=this.superObject,t=e.pages[this.page][0];if(e.settings.maps.zips&&!MainFrame.Browser.isFileProtocol){var a=t.filename+".xml";this.requestMapXmlFromArchive(a)}else{var i=MainFrame.Util.getAppURL()+e.settings.maps.dataSrcMaps+"/"+t.filename+".xml";i=MainFrame.Util.localizePath(i),this.requestMapXml(i)}},requestMapXmlFromArchive:function(e){var t=this,a=this.superObject,i=a.settings.maps.zips[e];i?i.getData(new zip.BlobWriter("text/plain"),function(e){var a=new FileReader;a.onload=function(e){var a=e.target.result,i=MainFrame.Util.stringToXML(a),r=MainFrame.DataParser.parseXml(i.documentElement);t.parsePageMap(r)},a.readAsText(e)}):console.error("File "+e+" not found in archive")},requestMapXml:function(e){var t=this;MainFrame.Util.request({url:e,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(e){t.parsePageMap(e)}})},parsePageMap:function(e){MainFrame.DataParser.parseMapsPageXml.call(this,e),this.drawMaps(this.zones),this.dispatchMapsReadyEvents(e)},dispatchMapsReadyEvents:function(e){var t=e.attributes.id,a=this.superObject;if("undefined"==typeof t)var i=a.pageReferences[this.page],t=i.filename;var r="#"+a.id+".maps."+t+".ready",n="#"+a.id+".maps."+t+".swf.ready";MainFrame.EventHandler.dispatch(r),MainFrame.EventHandler.dispatch(n)},drawMaps:function(e){for(var t=this.superObject,a=document.createDocumentFragment(),i=document.createDocumentFragment(),r=0,n=e.length;n>r;r++){var s=e[r],o=new MainFrame.Abstract.Element({superObject:this,containerElement:!1});for(var l in s)o[l]=s[l];if(o.page=this.page,t.scale>1)var c=t.settings.maps.settings.zonesConfig.innerMapsVisibleZoomCatalog;else{var c=t.settings.maps.settings.zonesConfig.innerMapsVisibleNormal;if(0!==o.lvl){var d=this.getRootParent(o);if("undefined"!=typeof d.innerMapsVisibleNormal)var c=d.innerMapsVisibleNormal}}if(o.hasCustomContent)var g=i;else var g=a;this.drawMap(o,g,c)}this.resize(),this.customContentContainer.appendChild(i),this.zonesContainer.appendChild(a),this.onCompleteCallback()},drawMap:function(e,t,a){var i=e.refs.length,r=0===i,n=1===i,s=i>1,o=this.superObject.settings.maps.settings;if(r)var l="zoom";else if(n)var c=e.refs[0],d=this.getRefById(c),l=d.type;else if(s)var l="multi";if("Desktop"!==EnvDetection.deviceType)if(0===e.refs.length)var l="zoom";else if(e.refs.length<2)var c=e.refs[0],d=this.getRefById(c),l=d.type;else var l="multi";var g=o.hotspotsArr[l]||o.hotspotsArr["default"],h=g,u=g;o.zonesConfig.zonesPictos[l+"Picto"],this.createMapContainer(e,t,g,o.zonesConfig),this.handleZoomMap(e,a),e.hotspotStyleId&&(o.hotspotsArr[e.hotspotStyleId]?u=o.hotspotsArr[e.hotspotStyleId]:MainFrame.Util.showError('Maps error! No style found for the style id "'+e.hotspotStyleId+'"')),e.zoneStyleId&&(o.hotspotsArr[e.zoneStyleId]?h=o.hotspotsArr[e.zoneStyleId]:MainFrame.Util.showError('Maps error! No style found for the style id "'+e.zoneStyleId+'"'));var m=!1;if(e.zoneAttributes.mapIcons===!1?m=!0:g.mapIcons===!1&&(m=!0),e.hasCustomContent)e.resourceId?this.drawResourceInMap(e):e.iframeSrc?this.drawIframeContentInMap(e):e.customContent&&this.drawContentInMap(e);else{var p=this.getDisplayMode(o.zonesConfig,g,e);if(p.isACheval){var f=this.superObject;if(1!==f.orientation)return}if(p.showMapIcons||p.showZone){var v=0===e.lvl,M=e.lvl>0;if(p.showMapIcons===!1&&(m=!0),v||M&&a){var b=!1;this.drawZoneInMap(e,g,o.zonesConfig,b,m,h);var F=e;a=!0,this.addMapAction(e,F,a,g,m)}}if(p.showHotspot){this.drawHotspotInMap(e,g,o.zonesConfig,u);var F=e.hotspot;a=!0;var A=!0;this.addMapAction(e,F,a,g,m,A)}}"1"==MainFrame.Util.urlGET("showProdId")&&this.showProdIdText(e),F&&this.triggerGoToMap(e,F,l)},showProdIdText:function(e){var t=MainFrame.Util.zeroFill(e.page,4)+e.zoneAttributes.id,a=MainFrame.Util.createElement("p","",e.containerElement);a.style.position="absolute",a.style.margin="5px 0",a.style.padding=0,a.style.border="1px solid red",a.style.background="#ffffff",a.setAttribute("data-item-id",t),a.setAttribute("data-type","container"),a.innerHTML=t},getDisplayMode:function(e,t,a){var i={};if("Desktop"===EnvDetection.deviceType){if("undefined"!=typeof a.displayMode&&"undefined"!=typeof a.displayMode.desktop)return a.displayMode.desktop;if("undefined"!=typeof t.displayMode&&"undefined"!=typeof t.displayMode.desktop)return t.displayMode.desktop;if("undefined"!=typeof e.displayMode&&"undefined"!=typeof e.displayMode.desktop)return e.displayMode.desktop}if("Tablet"===EnvDetection.deviceType){if("undefined"!=typeof a.displayMode&&"undefined"!=typeof a.displayMode.tablet)return a.displayMode.tablet;if("undefined"!=typeof t.displayMode&&"undefined"!=typeof t.displayMode.tablet)return t.displayMode.tablet;if("undefined"!=typeof e.displayMode&&"undefined"!=typeof e.displayMode.tablet)return e.displayMode.tablet}if("Phone"===EnvDetection.deviceType){if("undefined"!=typeof a.displayMode&&"undefined"!=typeof a.displayMode.phone)return a.displayMode.phone;if("undefined"!=typeof t.displayMode&&"undefined"!=typeof t.displayMode.phone)return t.displayMode.phone;if("undefined"!=typeof e.displayMode&&"undefined"!=typeof e.displayMode.phone)return e.displayMode.phone}return i},getZoneClass:function(e,t,a){return"undefined"!=typeof e.cssClass?e.cssClass:"undefined"!=typeof t.cssClass?t.cssClass:"undefined"!=typeof a.cssClass?a.cssClass:""},drawZoneInMap:function(e,t,a,i,r,n){if(t){e.containerElement.style.display="none";var s=this.superObject.settings.maps.settings,o=s.mapIcons;o.active&&this.drawMapIcons(e,e.containerElement,i,r),this.drawZoneContainer(e,t,a,r,i,n),e.infos&&this.drawZoneInfos(e),e.containerElement.style.display="block"}},drawZoneContainer:function(e,t,a,i,r,n){var s=t.visibleOnHover,o=t.alwaysVisible;if("undefined"!=typeof e.alwaysVisible&&(o=e.alwaysVisible),t.zonesUseShadow===!0)var l=this.cssClasses.shadow;else if("undefined"==typeof t.zonesUseShadow&&a.zonesUseShadow===!0)var l=this.cssClasses.shadow;else var l="";var c=this.cssClasses.zone+" "+this.cssClasses["zone-zoom"]+" "+l,d=MainFrame.Util.createElement("div",c,e.containerElement);d.setAttribute("data-role","map-action-zone"),d.style.height="100%";var g=this.superObject,h=parseInt(e.recX,10),u=parseInt(e.recW,10),m=g.settings.pages.normalSize.width,p=h+u>m,f="portrait"===g.orientation,v=f||"single"===g.settings.catalogType;if(p&&v){var M=h+u-m,b=u-M,F=100*b/u;d.style.width=F+"%"}else d.style.width="100%";if(MainFrame.Browser.hasHover){var A=a.showAssociatedZonesOnHover;if(o){var P="--hovered",y="--normal";this.bindZoneHover(e,A,r,P,y)}else if(s){var P="--visible",y="--hidden";this.bindZoneHover(e,A,r,P,y)}}var C=""!=n.zonesColor?n.zonesColor:a.zonesColor;e.zoneAttributes.color&&(C=e.zoneAttributes.color);var E=""!=n.zonesOpacity?n.zonesOpacity:a.zonesOpacity;e.zoneAttributes.opacity&&(E=e.zoneAttributes.opacity);var S="rgba("+MainFrame.Util.hexToRgb(C)+", "+E+")";d.style.background=S;var w="undefined"!=typeof e.zoneAttributes.border?e.zoneAttributes.border:n.zonesBorder,I="undefined"!=typeof e.zoneAttributes.borderColor?e.zoneAttributes.borderColor:n.zonesBorderColor,w=t.zonesBorder||a.zonesBorder;"undefined"!=typeof e.zoneAttributes.border&&(w=e.zoneAttributes.border);var I=n.zonesBorderColor||a.zonesBorderColor;"undefined"!=typeof e.zoneAttributes.borderColor&&(I=e.zoneAttributes.borderColor),d.style.border=w+" solid "+I;var x=new MainFrame.Element.HtmlItem({containerElement:d,superObject:e});e.zoneItem=x,this.addMapAlt(e,x,i),this.specificZoneDrawing(e)},drawZoneInfos:function(e,t){var a=this.getZoneTheme(e),i=this.cssClasses.infos,r=this.cssClasses["infos-theme"]+a,n=this.cssClasses["infos-title"],s=this.cssClasses["infos-description"],o=[i,r];e.infos.class&&o.push(r+"--"+e.infos.class),"undefined"!=typeof t&&t||(t=e.containerElement);var l=o.join(" "),c=MainFrame.Util.createElement("div",l,t),d="";if(e.infos.title){var g=MainFrame.Util.interpretString(e.infos.title).interpretedString;d+='<p class="'+n+'">'+g+"</p>"}if(e.infos.description){var h=MainFrame.Util.interpretString(e.infos.description).interpretedString;d+='<p class="'+s+'">'+h+"</p>"}c.innerHTML=d;var u=new MainFrame.Element.HtmlItem({containerElement:c,superObject:e.zoneItem});e.infos.item=u;var m=this.superObject.settings.maps.settings,p=m.zonesConfig;if(p.infosActions){var f=this.getDefaultInfosRef(e);this.addZoneInfosAction(e,u,f),this.addZoneInfosAlt(e,u,f)}},addZoneInfosAction:function(e,t,a){if(t.ref=a,t.refs=e.refs,t.page=e.page,"multi"!==a.type)var i="id:"+a.type+"RefActions;params:source="+this.superObject.id;else var i="id:mapMultirefActions";t.setAction(i)},addZoneInfosAlt:function(e,t,a){var i=a.type+"Alt",r=MainFrame.Manager.Text.getById(i),n=r,s=this.getAltTypeForRef(a);if(n){var o=i+"_"+Math.random();t.addAltId(o,s,n,{"##urlValue":a.url,catalogId:this.superObject.id})}t.addHandCursor()},getZoneTheme:function(e){if(e.infos.theme)return e.infos.theme;var t=this.getZoneSetting(e,"theme");return t||"hidden"},bindZoneHover:function(e,t,a,i,r){var n=this.cssClasses.zone+r;e.containerElement.setAttribute("class",this.cssClasses.zone+" "+n);var s=new MainFrame.Maps.Observer,o=e.containerElement;s.target=e.containerElement,s.maps=this,s.zone=e,s.isForZoomMap=a,s.withAssociatedZones=t,s.hoverOnClassSufix=i,s.hoverOffClassSufix=r,MainFrame.Event.bind(o,"mouseover",s),MainFrame.Event.bind(o,"mouseout",s),MainFrame.Event.bind(o,"click",s)},bindHotspotHover:function(e){var t=new MainFrame.Maps.HotspotObserver,a=e.containerElement;t.target=a,MainFrame.Event.bind(a,"mouseover",t),MainFrame.Event.bind(a,"mouseout",t),MainFrame.Event.bind(a,"click",t)},determineMapRefType:function(e){var t=0===e.refs.length,a=1===e.refs.length,i=e.refs.length>1;if(t)return"zoom";if(a){var r=e.refs[0],n=this.getRefById(r);return n.type}return i?"multi":void 0},determineMapIconSettings:function(e){var t=this.determineMapRefType(e),a={},i=this.superObject.settings.maps.settings,r=i.mapIcons,n=i.hotspotsArr[t];return a.groupMulti=r.groupMultiIcons,e.zoneAttributes.groupMultiIcons&&(a.groupMulti="1"===e.zoneAttributes.groupMultiIcons?!0:!1),a.groupMultiByRef=r.groupMultiIconsByRefType,e.zoneAttributes.groupMultiIconsByRefType&&(a.groupMultiByRef="1"===e.zoneAttributes.groupMultiIcons?!0:!1),a.defaultRefs=r.defaultRefs,e.zoneAttributes.defaultAction?a.defaultZoneRef=e.zoneAttributes.defaultAction:n.defaultZoneRef&&(a.defaultZoneRef=n.defaultZoneRef),a.position=r.position,e.zoneAttributes.autopositionPlace?a.position=e.zoneAttributes.autopositionPlace:n.position&&(a.position=n.position),a.orientation=r.orientation,e.zoneAttributes.autopositionOrientation?a.orientation=e.zoneAttributes.autopositionOrientation:n.orientation&&(a.orientation=n.orientation),a.zoomOrder=r.zoomOrder,e.zoneAttributes.zoomIcons?a.zoomOrder=MainFrame.DataParser.getMapIconsOrder(e.zoneAttributes.zoomIcons):n.zoomOrder&&(a.zoomOrder=n.zoomOrder),a.defaultOrder=r.order,e.zoneAttributes.autopositionOrder?a.defaultOrder=MainFrame.DataParser.getMapIconsOrder(e.zoneAttributes.autopositionOrder):n.order&&(a.defaultOrder=n.order),a.offsetX=r.offsetX,e.zoneAttributes.offsetX?a.offsetX=e.zoneAttributes.offsetX:n.offsetX&&(a.offsetX=n.offsetX),a.offsetY=r.offsetY,e.zoneAttributes.offsetY?a.offsetY=e.zoneAttributes.offsetY:n.offsetY&&(a.offsetY=n.offsetY),a.spaceX=r.spaceX,e.zoneAttributes.spaceX?a.spaceX=e.zoneAttributes.spaceX:n.spaceX&&(a.spaceX=n.spaceX),a.spaceY=r.spaceY,e.zoneAttributes.spaceY?a.spaceY=e.zoneAttributes.spaceY:n.spaceY&&(a.spaceY=n.spaceY),a.mapIcons=!0,e.zoneAttributes.mapIcons?a.mapIcons=e.zoneAttributes.mapIcons:n.mapIcons&&(a.mapIcons=e.zoneAttributes.mapIcons),a},determineMapReferences:function(e,t,a){var i=this,r=e.refs.length>1,n=[],s={};if(e.mapIconRefs.forEach(function(e){if(-1===n.indexOf(e)&&(n.push(e),!t.groupMultiByRef)){var a=i.getRefById(e),r=a.type;s[r]=!0}}),r&&t.groupMultiByRef&&s.multi!==!0){e.refs.forEach(function(e){if(-1===n.indexOf(e)){var t=i.getRefById(e),a=t.type;"undefined"==typeof s[a]&&"undefined"==typeof s["multi_"+a]?s[a]=!0:(delete s[a],s["multi_"+a]=!0)}});for(var o in s){var l=(0===o.indexOf("multi_"),-1===n.indexOf(o));l&&n.push(o)}}else r&&t.groupMulti&&s.multi!==!0?n.push("multi"):e.refs.forEach(function(e){if(-1===n.indexOf(e)){n.push(e);var t=i.getRefById(e),a=t.type;s[a]=!0}});t.defaultRefs.forEach(function(e){"undefined"==typeof s[e]&&n.push(e)});var c=a?t.zoomOrder:t.defaultOrder,d=[];n.forEach(function(a){var n=i.getRefById(a),s=n.type;t.groupMultiByRef&&(s=i.getOriginalRefType(s)),s in c?d.push(a):!t.groupMulti&&r&&-1!==e.refs.indexOf(a)&&d.push(a)});var g=d.sort(function(e,a){var r=i.getRefById(e),n=i.getRefById(a),s=r.type,o=n.type;t.groupMultiByRef&&(s=i.getOriginalRefType(s),o=i.getOriginalRefType(o));var l=c[s],d=c[o];return l-d});return g},getOriginalRefType:function(e){return 0===e.indexOf("multi_")&&(e=e.replace("multi_","")),e},drawMapIcons:function(e,t,a,i){var r=this.superObject.settings.maps.settings,n=r.mapIcons,s=this.determineMapIconSettings(e);if(!i||n.mapIconsInZoom){e.mapIconRefs=this.determineMapReferences(e,s,a);var o=MainFrame.Util.createElement("div",this.cssClasses["map-icons"],t);o.setAttribute("data-role","map-icons-container"),a?e.zoomMapIconsContainer=o:e.mapIconsContainer=o;for(var l=this.cssClasses["map-icons-position"]+s.position,c=MainFrame.Util.createElement("div",this.cssClasses["map-icons-wrapper"]+" "+l,o),d=0,g=e.mapIconRefs.length,h=0,u=0;g>d;d++){var m=e.mapIconRefs[d],p=this.getRefById(m),f=p.type,v=n.icons[f];if(s.groupMultiByRef&&"undefined"==typeof n.icons[f])var v=n.icons[this.getOriginalRefType(f)];var M=this.createMapIcon(c,e,v),b=M.getDimensionX(),F=M.getDimensionY();if("vertical"===s.orientation){M.setPositionX(0);var A=u;M.setPositionY(A),h=b,u+=F+s.spaceY}else{M.setPositionY(0);var P=h;M.setPositionX(P),h+=b+s.spaceX,u=F}this.addMapIconAction(M,e,p,a),this.addMapIconAlt(M,e,p),M.resize()}switch(o.style.width=h+"px",o.style.height=u+"px",s.position){case"BL":if("vertical"===s.orientation)var y=-s.offsetY,P=-h+s.offsetX;else var y=-u-s.offsetY,P=s.offsetX;o.style.bottom=y+"px",o.style.left=P+"px";break;case"BR":if("vertical"===s.orientation)var y=-s.offsetY,C=-h-s.offsetX;else var y=-u-s.offsetY,C=s.offsetX;o.style.bottom=y+"px",o.style.right=C+"px";break;case"TL":if("vertical"===s.orientation)var A=s.offsetY,P=-h+s.offsetX;else var A=-u-s.offsetY,P=s.offsetX;o.style.top=A+"px",o.style.left=P+"px";break;case"TR":default:if("vertical"===s.orientation)var A=s.offsetY,C=-h-s.offsetX;else var A=-u-s.offsetY,C=s.offsetX;o.style.top=A+"px",o.style.right=C+"px"}}},createMapIcon:function(e,t,a){var i=document.createElement("div");e.appendChild(i);var r=new MainFrame.Element.Item({containerElement:i,data:a,superObject:t});return r},addMapIconAction:function(e,t,a){var i=this.superObject,r=i.settings.maps.settings.hotspotsArr,n=this.determineMapIconSettings(t),s=r.ldc.useMultiPanel===!1;if(n.groupMultiByRef&&-1!==a.type.indexOf("multi"))var o=this.getMapIconActionForMultiRefGrouped(t,e,a,i,s);else if("multi"===a.type)var o=this.getMapIconActionForMulti(t,e,a,i,s);else var o=this.getMapIconAction(t,e,a,i,n);e.setAction(o)},getMapIconActionForMultiRefGrouped:function(e,t,a,i,r){var n="id:mapMultirefActions";if(t.refs=e.refs,-1!==a.type.indexOf("multi_")){var s=this.getOriginalRefType(a.type),o=this,l=e.refs.filter(function(e){var t=o.getRefById(e);return t.type===s});t.refs=l}if(r){if(-1!==a.type.indexOf("multi_"))var s=this.getOriginalRefType(a.type),c="ldc"===s;else var c=this.detectLDCRef(e.refs);if(c){var n="id:ldcRefActions;params:source="+i.id,d=this.getRefsForRefIds(t.refs);t.refs=d}}return n},getMapIconActionForMulti:function(e,t,a,i,r){var n="id:mapMultirefActions";if(t.refs=e.refs,r){var s=this.detectLDCRef(e.refs);if(s){var n="id:ldcRefActions;params:source="+i.id,o=this.getRefsForRefIds(e.refs);t.refs=o}}return n},getMapIconAction:function(e,t,a,i,r){if(r.groupMultiByRef){var n=this;e.refs.forEach(function(e){var t=n.getRefById(e);t.type===a.type&&(a=t)})}if("zoom"!==a.type)var s="id:"+a.type+"RefActions;params:source="+i.id;else var s="id:zoomRefActions;params:source="+i.id;return t.ref=a,s},detectLDCRef:function(e){for(var t=0,a=e.length;a>t;t++){var i=e[t],r=this.getRefById(i);if("ldc"===r.type)return!0}return!1},getRefsForRefIds:function(e){for(var t=[],a=0,i=e.length;i>a;a++){var r=e[a],n=this.getRefById(r);t.push(n)}return t},getAltTypeForRef:function(e){var t="default",a=this.superObject,i=a.settings.maps.settings,r=i.hotspotsArr,n=i.zonesConfig;return r[e.type]&&r[e.type].altType?t=r[e.type].altType:n.altType&&(t=n.altType),t},addMapIconAlt:function(e,t,a){var i=a.type+"Alt",r=MainFrame.Manager.Text.getById(i);if(!r&&-1!==a.type.indexOf("multi_"))var n=this.getOriginalRefType(a.type),i=n+"Alt",r=MainFrame.Manager.Text.getById(i);var s=r,o=this.getAltTypeForRef(a);if(s){var l=i+"_"+Math.random();e.addAltId(l,o,s,{"##urlValue":a.url,catalogId:this.superObject.id})}e.addHandCursor()},drawContentInMap:function(e){e.containerElement.style.display="block";var t=new MainFrame.Element.Resource({superObject:e});MainFrame.Util.addClass(t.containerElement,this.cssClasses["map-custom-content"]);var a=e.customContent,i=MainFrame.DataParser.getNodesWithNodeName(a,"details");i.forEach(function(e){MainFrame.DataParser.parseDetails(e)}),MainFrame.DataParser.parseChildren.call(t,a),e.content=t},drawResourceInMap:function(e){e.containerElement.style.display="block";var t=MainFrame.Manager.Media.getById(e.resourceId);new MainFrame.Element.Resource({id:e.resourceId,superObject:e,data:t})},drawIframeContentInMap:function(e){e.containerElement.style.display="block",e.containerElement.style.zIndex="1";var t=MainFrame.Util.createElement("iframe",this.cssClasses["custom-content-iframe"],e.containerElement);t.src=e.iframeSrc},drawHotspotInMap:function(e,t,a,i){e.containerElement.style.display="block";var r=e.containerElement,n=!1;if(e.displayMode&&"Desktop"===EnvDetection.deviceType&&e.displayMode.desktop&&e.displayMode.desktop.showHotspot===!0&&e.displayMode.desktop.showZone===!0&&e.displayMode.showMapIcons!==!0){n=!0,r=this.zonesContainer;var s=e.superObject.superObject,o=s.settings.pages.normalSize}var l=this.cssClasses.hotspot+"--hidden",c=MainFrame.Util.createElement("img",this.cssClasses.hotspot+" "+l,r);c.style.position="absolute",n&&(c.style.zIndex="1000");var d=new MainFrame.Element.Item({superObject:e,containerElement:c});d.isHotspot=!0,MainFrame.Browser.hasHover&&this.bindHotspotHover(d);var g=e.zoneAttributes.width||i.hotspotWidth,h=e.zoneAttributes.height||i.hotspotHeight;if(e.hsSize){var u=e.hsSize.split("|");1===u.length&&u.push(u[0]),g=u[0],h=u[1]}if(a.resizeHotspots!==!1){if(n)var m=o.width,p=o.height;else var m=parseFloat(e.recW,10),p=parseFloat(e.recH,10);g=100*g/m+"%",h=100*h/p+"%"}if(e.hsPos)var f=e.hsPos;else if(e.zoneAttributes.pos)var f=e.zoneAttributes.pos;else if(t.pos)var f=t.pos;else var f="50%-w/2|50%-h/2";var v=f.split("|"),M=v[0],b=v[1];if(n){var F=parseFloat(e.recX,10),A=parseFloat(e.recY,10),m=parseFloat(e.recW,10),p=parseFloat(e.recH,10);M="center"===M||"50%-w/2"===M?F+m/2:F+parseFloat(M,10),M=100*parseFloat(M,10)/o.width+"%",b="center"===b||"50%-h/2"===b?A+p/2:A+parseFloat(b,10),b=100*parseFloat(b,10)/o.height+"%"}else-1!==M.indexOf("center")&&(M=M.replace("center","50%-w/2")),-1!==b.indexOf("center")&&(b=b.replace("center","50%-h/2")),M=this.getMapPercentage(M,e.recW),b=this.getMapPercentage(b,e.recH);d.setDimensionX(g),d.setDimensionY(h),d.setPositionX(M),d.setPositionY(b),d.ref=e.ref,d.refs=e.refs,e.hotspot=d;var P=e.hotspotSrc||i.hotspotSrc;e.zoneAttributes.src&&(P=e.zoneAttributes.src),P||(P="");var y=MainFrame.Util.isAbsoluteUrl(P);y||(P=-1===P.indexOf("/")?MainFrame.Util.getAppURL()+MainFrame.Util.getResURL()+P:MainFrame.Util.getAppURL()+MainFrame.Global.initializationVariables.appFolder+"/"+P),e.hotspot.containerElement.src=P,this.addHotspotAlt(e,d)},getMapPercentage:function(e,t){var a=-1===e.indexOf("%"),i=-1===e.indexOf("w"),r=-1===e.indexOf("h");if(a&&i&&r){var n=100*parseFloat(e)/parseFloat(t);return n+"%"}return e},resize:function(e,t){this.resizeZones(e,t)},resizeZones:function(e,t){var a=this.superObject;if(this.subObjects.length){var i=a.currentPageSize,r=i.width,n=i.height,s=a.settings.pages.normalSize.width,o=a.settings.pages.normalSize.height;e===!0&&("undefined"==typeof t&&(t=a.scale),r=Math.round(r*t),n=Math.round(n*t));for(var l=r/s,c=n/o,d=0,g=this.subObjects.length;g>d;d++){var h=this.subObjects[d];this.resizeZone(h,l,c,r)}}},resizeZone:function(e,t,a){var i=this.superObject,r=parseInt(e.recX,10)+parseInt(e.recW)>i.settings.pages.normalSize.width,n=1===i.orientation,s=n||"1"===i.pagingType,o=i.settings.maps.settings,l=o.zonesConfig,c=this.getDefaultZoneRef(e);hotspotConfig=o.hotspotsArr[c.type];var d=parseFloat(e.recX,10),g=parseFloat(e.recY,10),h=parseFloat(e.recW,10),u=parseFloat(e.recH,10);hotspotConfig&&null!==hotspotConfig.adjustX?d+=hotspotConfig.adjustX:null!==l.adjustX&&(d+=hotspotConfig.adjustX),hotspotConfig&&null!==hotspotConfig.adjustY?g+=hotspotConfig.adjustY:null!==l.adjustY&&(g+=hotspotConfig.adjustY);var m=d*t,p=g*a,f=u*a;if(r&&s)var v=i.settings.pages.normalSize.width-d,M=v*t;else var M=h*t;e.setPositionX(m),e.setPositionY(p),e.setDimensionX(M),e.setDimensionY(f),e.infos&&e.infos.item&&this.resizeZoneInfos(e,M,f),e.resize()},resizeZoneInfos:function(e,t,a){if("undefined"!=typeof e.infos.positionX||"undefined"!=typeof e.infos.dimensionX){var i=parseInt(e.recW,10),r=parseInt(e.recH,10),n=t*(e.infos.positionX/i),s=a*(e.infos.positionY/r),o=t*(e.infos.dimensionX/i),l=a*(e.infos.dimensionY/r),c=e.infos.item.containerElement;c.style.left=n+"px",c.style.top=s+"px",c.style.width=o+"px",c.style.height=l+"px",c.style.position="absolute"}},createMapContainer:function(e,t,a,i){var r=this.getZoneClass(e,a,i),n=this.cssClasses.map+" "+r;e.containerElement=MainFrame.Util.createElement("div",n,t),e.containerElement.setAttribute("data-item-id","map_"+e.id),MainFrame.Manager.Scoping.register("map_"+e.id,e),e.superObject=this,e.hasPicto=!1,e.hotspotSrc&&(e.display="block"),e.containerElement.style.display=e.display||"none"},removeMapsFromContainer:function(){for(;this.zonesContainer.lastChild;)this.zonesContainer.removeChild(this.zonesContainer.lastChild);MainFrame.Util.removeElement(this.zonesContainer),delete this.zonesContainer},removeCustomContentFromContainer:function(){for(;this.customContentContainer.lastChild;)this.customContentContainer.removeChild(this.customContentContainer.lastChild);MainFrame.Util.removeElement(this.customContentContainer),delete this.customContentContainer},hide:function(){this.hideMaps(),this.hideCustomContent()},hideMaps:function(){this.zonesContainer&&"none"!==this.zonesContainer.style.display&&(this.zonesContainer.style.display="none")},hideMapsForZoomedPage:function(){this.subObjects.forEach(function(e){var t="undefined"==typeof e.customContent,a=0===e.refs.length&&t;a&&(e.containerElement.style.display="none")})},hideCustomContent:function(){this.customContentContainer&&"none"!==this.customContentContainer.style.display&&(this.customContentContainer.style.display="none")},show:function(){this.showMaps(),this.showCustomContent()},showMaps:function(){this.zonesContainer&&"none"===this.zonesContainer.style.display&&(this.zonesContainer.style.display="")},showMapsForNormalPage:function(){this.subObjects.forEach(function(e){var t="undefined"==typeof e.customContent,a=0===e.refs.length&&t;a&&(e.containerElement.style.display="")})},showCustomContent:function(){this.customContentContainer&&"none"===this.customContentContainer.style.display&&(this.customContentContainer.style.display="")},getRefById:function(e){return"undefined"==typeof e||null===e?{type:"zoom"}:this.refs[e]||{type:e}},getZoneById:function(e){for(var t=0,a=this.zones.length;a>t;t++){var i=this.zones[t];if(i.id===e)return i}return null},getRootParent:function(e){if(e.lvl>0)for(var t=e.lvl;t;){var a=this.getZoneById(e.parentId);e=a,t--}return e},getZonesByLayerId:function(e){var t=[];if(e)for(var a=0,i=this.subObjects.length;i>a;a++){var r=this.subObjects[a];r.layerId==e&&0===r.lvl&&t.push(r)}return t},getRandomizedZoneId:function(e){for(var t=0,a=this.zones.length;a>t;t++){var i=this.zones[t];if(i.zoneAttributes.id===e)return i.id}return null},getInnerZones:function(e){for(var t=[],a=0,i=this.subObjects.length;i>a;a++){var r=this.subObjects[a];r.parentId&&r.parentId===e&&t.push(r)}return t},handleZoomMap:function(e,t){var a=this.superObject.settings.maps.settings;e.lvl>0&&!t&&(e.containerElement.style.display="none"),e.refs[0]&&"zoom"===e.refs[0].type&&(this.superObject.scale>1||e.lvl>0)&&(e.containerElement.style.display="none"),"undefined"==typeof e.hasMultizoom&&(e.hasMultizoom=a.zonesConfig.hasMultizoom)},addMapAction:function(e,t,a,i,r,n){if(t){var s=!e.parentId||e.parentId&&a,o=this.superObject.settings.maps.settings.mapIcons,l=(EnvDetection.deviceType.toLowerCase(),this.getDisplayMode(this.superObject.settings.maps.settings.zonesConfig,i,e)),c=l&&l.showMapIcons===!0,d="Desktop"===EnvDetection.deviceType&&o.active&&c;if(n="undefined"==typeof n?!1:n,s){var g=e.refs.length>1;if(t.zoneItem&&(t=t.zoneItem),d&&!n)var h=this.getMapIconsZoneAction(e,t,r);else if(g)var h=this.getMultiRefZoneAction(e,t);else var h=this.getZoneAction(e,t);-1!==h.indexOf("zoomRefActions")&&e.zoneItem&&(e.zoneItem.containerElement.style.cursor="zoom-in"),t.setAction(h)}}},getDefaultZoneRef:function(e,t){t=t||this.determineMapIconSettings(e);var a,i=t.defaultZoneRef;if("zoom"===i)return{type:"zoom"};var r=this;if(e.refs.forEach(function(e){var t=r.getRefById(e);
t.type===i&&(a=t)}),!a){if(e.refs.length>1)return{type:"multi"};if(1===e.refs.length)return this.getRefById(e.refs[0]);if(0===e.refs.length)return{type:"zoom"};MainFrame.Util.showError('Default ref type "'+i+'" not found for the map with the id: '+e.id),console.log(e)}return a||{type:"zoom"}},getDefaultInfosRef:function(e){return e.refs.length>1?{type:"multi"}:1===e.refs.length?this.getRefById(e.refs[0]):0===e.refs.length?{type:"zoom"}:(MainFrame.Util.showError('Default ref type "'+defaultRefType+'" not found for the map with the id: '+e.id),console.log(e),{type:"zoom"})},getMapIconsZoneAction:function(e,t,a){var i=this.determineMapIconSettings(e),r=this.superObject,n=r.settings.maps.settings.hotspotsArr,s=n.ldc.useMultiPanel===!1;if(a){var o=e.refs.length>1;if(o)var l={type:"multi"};else var c=e.refs[0],l=this.getRefById(c);if("multi"===l.type){var d="id:mapMultirefActions";if(t.refs=e.refs,s){var g=this.detectLDCRef(e.refs);if(g){var d="id:ldcRefActions;params:source="+r.id,h=this.getRefsForRefIds(e.refs);t.refs=h}}}else{if("zoom"!==l.type)var d="id:"+l.type+"RefActions;params:source="+this.superObject.id;else var d="id:closeZoomMap;params:source="+this.superObject.id;t.ref=l}}else if(i.defaultZoneRef){var u=this.getDefaultZoneRef(e,i);if("multi"===u.type){var d="id:mapMultirefActions";if(t.refs=e.refs,s){var g=this.detectLDCRef(e.refs);if(g){var d="id:ldcRefActions;params:source="+r.id,h=this.getRefsForRefIds(e.refs);t.refs=h}}}else{var d="id:"+u.type+"RefActions;params:source="+this.superObject.id;t.ref=u}}else if(e.mapIconRefs&&e.mapIconRefs.length){var m=e.mapIconRefs[0],p=this.refs[m],f=p&&p.type?p.type:m;d="id:"+f+"RefActions;params:source="+this.superObject.id,t.ref=p}else var d="id:zoomRefActions;params:source="+this.superObject.id;return d},getMultiRefZoneAction:function(e,t){var a=this.superObject,i=a.settings.maps.settings.hotspotsArr,r=i.multi,n=i.ldc.useMultiPanel===!1;if("Desktop"!==EnvDetection.deviceType)if(e.refs.length<2){var s=e.refs[0],o=this.getRefById(s);t.ref=o;var l="id:"+o.type+"RefActions;params:source="+this.superObject.id}else if(r.defaultZoneRef){var c=this.getDefaultZoneRef(e,r);if("multi"===c.type){var l="id:mapMultirefActions";if(t.refs=e.refs,n){var d=this.detectLDCRef(e.refs);if(d){var l="id:ldcRefActions;params:source="+a.id,g=this.getRefsForRefIds(e.refs);t.refs=g}}}else{var l="id:"+c.type+"RefActions;params:source="+this.superObject.id;t.ref=c}}else{var l="id:mapMultirefActions";if(n){var d=this.detectLDCRef(e.refs);if(d){var l="id:ldcRefActions;params:source="+a.id,g=this.getRefsForRefIds(e.refs);t.refs=g}}}else{var l="id:mapMultirefActions";if(n){var d=this.detectLDCRef(e.refs);if(d){var l="id:ldcRefActions;params:source="+a.id,g=this.getRefsForRefIds(e.refs);t.refs=g}}}return l},getZoneAction:function(e,t){if(e.refs.length){var a=e.refs[0],i=this.getRefById(a);t.ref=i;var r="id:"+i.type+"RefActions;params:source="+this.superObject.id}else if(e.infos&&"Desktop"!==EnvDetection.deviceType)var r="id:toggleMapInfosActions;params:source="+this.superObject.id;else var r="id:zoomRefActions;params:source="+this.superObject.id;return r},addHotspotAlt:function(e,t){var a=this.getZoneAltRef(e);this.addAlt(e,a,t,e.altText)},addMapAlt:function(e,t,a){var i=this.superObject.settings.maps.settings.mapIcons,r="Desktop"===EnvDetection.deviceType&&i.active;if(r)var n=this.getMapIconsZoneAltRef(e,a);else var n=this.getZoneAltRef(e);this.addAlt(e,n,t,e.altText)},addAlt:function(e,t,a,i){var r=t.type+"Alt",n=MainFrame.Manager.Text.getById(r),s=i||n,o=this.getZoneSetting(e,"altType")||"default",n=this.getZoneSetting(e,"zoneAlt");if(s&&n){var l=r+"_"+Math.random();a.addAltId(l,o,s,{"##urlValue":t.url,catalogId:this.superObject.id})}a.addHandCursor()},getMapIconsZoneAltRef:function(e,t){if(t){if(e.refs){var a=e.refs.length>1;if(a)return{type:"multi"};var i=e.refs[0];return this.getRefById(i)}return{type:"zoom"}}var r=this.determineMapIconSettings(e);if(r.defaultZoneRef){var n=this.getDefaultZoneRef(e,r);return n}if(e.mapIconRefs&&e.mapIconRefs.length){var i=e.mapIconRefs[0];return this.getRefById(i)}return{type:"zoom"}},getZoneAltRef:function(e){var t=e.refs.length>1;if(t)return{type:"multi"};var a=e.refs[0];return this.getRefById(a)},triggerGoToMap:function(e,t,a){if(t){var i=this.superObject;if(i.goToMapId&&e.zoneAttributes.id===i.goToMapId){i.goToMapId=null,delete i.goToMapId;var r=e.refs.length>2,n=i.settings.maps.settings;if(-1!==n.allowedGoToMaps.indexOf(a)||r){var s=n.hotspotsArr[a].differentProdIdAction,o=this,t=t.zoneItem?t.zoneItem:t;setTimeout(function(){s?MainFrame.EventHandler.dispatch(n.prodIdTrigger,[o],t):(MainFrame.EventHandler.dispatch("click",[o],t),MainFrame.EventHandler.dispatch("singleClick",[o],t))},n.prodIdTriggerDelay)}else{MainFrame.Util.warn('ProdId warning: the zone is either a multiref zone or has a ref type not allowd for prodId actions (ref type is "'+a+'"). The zoom action will be triggered automatically.');var o=this,t=t.zoneItem?t.zoneItem:t;t.setAction("id:defaultProdIdActions;params:source="+i.id),setTimeout(function(){MainFrame.EventHandler.dispatch(n.prodIdTrigger,[o],t)},n.prodIdTriggerDelay)}}}},isValidGoToReference:function(e){if(this.superObject.hasCustomPages){var t="undefined"!=typeof e&&("goto"===e.type||"goto1"===e.type);if(t){var a=parseInt(e.url,10);if(-1===this.superObject.pageIndexes.indexOf(a))return!1}}return!0},validateRef:function(e,t){var a=this.superObject.settings.maps.settings,i="undefined"==typeof t;i&&(t={},t.type=e.hasCustomContent?"content":"zoom",t.url=" ");var r=a.hotspotsArr[t.type]&&a.hotspotsArr[t.type].isEnabled===!1;return r&&(t.type="disabled"),e.ref=t,e.ref},getZoneSetting:function(e,t){if("undefined"!=typeof e[t])return e[t];var a=this.getDefaultZoneRef(e),i=this.superObject.settings.maps,r=i.settings.hotspotsArr[a.type];return"undefined"!=typeof r[t]?r[t]:"undefined"!=typeof i.settings.zonesConfig[t]?i.settings.zonesConfig[t]:void 0},removeGlorifierCanvas:function(){this.glorifierCanvas&&MainFrame.Util.removeElement(this.glorifierCanvas)},getGlorifierSettings:function(){var e={},t=this.superObject,a=t.settings.maps.settings,i=a.zonesConfig;return e.color=i.glorifierColor,e.opacity=i.glorifierOpacity,e},clearIframeElements:function(){this.subObjects&&this.subObjects.forEach(function(e){if("undefined"!=typeof e.customContent){var t=e.containerElement.getElementsByTagName("iframe");for(index=0,totalNodes=t.length;totalNodes>index;index++){var a=t[index];a.src="about:blank"}}})}}),MainFrame.Maps.Observer=MainFrame.Class.extend({handleEvent:function(e){"mouseover"===e.type?this.appear(e):("mouseout"===e.type||"click"===e.type)&&this.disappear(e)},appear:function(e){var t=this.target||e.target||e.srcElement,a=this.maps.cssClasses.zone+this.hoverOnClassSufix,i=this.maps.cssClasses.zone+this.hoverOffClassSufix;MainFrame.Util.addClass(t,a),MainFrame.Util.removeClass(t,i);var r=this.maps.superObject;r.settings.maps.settings.disableZIndexIncrease!==!0&&this.increasePageZIndex(),this.increaseInnerZonesIndex(t),this.withAssociatedZones===!0&&this.showAssociatedZones();var n=this.maps.getZoneSetting.call(this.maps,this.zone,"glorified");n&&this.zone.insideZoomMap!==!0&&this.showGlorifier()},disappear:function(e){var t=this.maps.cssClasses.zone+this.hoverOnClassSufix,a=this.maps.cssClasses.zone+this.hoverOffClassSufix,i=this.target||e.target||e.srcElement;MainFrame.Util.addClass(i,a),MainFrame.Util.removeClass(i,t);var r=this.maps.superObject;r.settings.maps.settings.disableZIndexIncrease!==!0&&this.decreasePageZIndex(),this.decreaseInnerZonesIndex(i),this.withAssociatedZones===!0&&this.hideAssociatedZones();var n=this.maps.getZoneSetting.call(this.maps,this.zone,"glorified");n&&this.zone.insideZoomMap!==!0&&this.hideGlorifier()},increasePageZIndex:function(){var e=this.maps,t=e.superObject;if(t.isDoublePage){if(t.isLeftPage(e.page))var a=t.currentPageContainers.left;else var a=t.currentPageContainers.right;a.container.style.zIndex=10}},increaseInnerZonesIndex:function(e){var t=this.zone,a=this.maps,i=a.getZoneSetting.call(a,t,"placeOnTop"),r=i?900:0;e.style.zIndex=r;for(var n=a.getInnerZones.call(a,t.id),s=0,o=n.length;o>s;s++){var t=n[s],l=t.lvl||1;t.containerElement.style.zIndex=r+l}},decreasePageZIndex:function(){var e=this.maps,t=e.superObject;if(t.isDoublePage)if(t.isLeftPage(e.page)){var a=t.currentPageContainers.left;a.container.style.zIndex=6}else{var a=t.currentPageContainers.right;a.container.style.zIndex=4}},decreaseInnerZonesIndex:function(e){var t=this.zone,a=this.maps;e.style.zIndex="";for(var i=a.getInnerZones.call(a,t.id),r=0,n=i.length;n>r;r++){var t=i[r];t.containerElement.style.zIndex=""}},getAssociatedZones:function(){var e=[],t=this.zone,a=this.maps,i=a.getZonesByLayerId(t.layerId);i.length>1&&i.forEach(function(a){a!==t&&e.push(a)});var r=a.superObject,n=a.page;if(r.isDoublePage&&1!==n){if(n%2===0)var s=r.currentPageContainers.right;else var s=r.currentPageContainers.left;var o=s.maps;if(o){var i=o.getZonesByLayerId(t.layerId);i.length>0&&i.forEach(function(a){a!==t&&e.push(a)})}}return e},showAssociatedZones:function(){var e=(this.zone,this.isForZoomMap?this.zoomMapIconsContainer:this.mapIconsContainer);e&&(e.style.display="");var t=this.maps.cssClasses.zone+this.hoverOnClassSufix,a=this.maps.cssClasses.zone+this.hoverOffClassSufix,i=this.maps.superObject,r=i.currentPageSize.width,n=this.getAssociatedZones();n.forEach(function(e){var n=e.getPositionX(),s=e.getDimensionX(),o=n+s>r;if(o&&i.isDoublePage){var l=i.currentPageContainers.left;l.container.style.zIndex="11"}var c=e.isForZoomMap?e.zoomMapIconsContainer:e.mapIconsContainer;c&&(c.style.display="none"),MainFrame.Util.addClass(e.containerElement,t),MainFrame.Util.removeClass(e.containerElement,a)})},hideAssociatedZones:function(){var e=(this.zone,this.maps.cssClasses.zone+this.hoverOnClassSufix),t=this.maps.cssClasses.zone+this.hoverOffClassSufix,a=this.maps.superObject,i=a.currentPageSize.width,r=this.getAssociatedZones();r.forEach(function(r){var n=r.getPositionX(),s=r.getDimensionX(),o=n+s>i;if(o&&a.isDoublePage){var l=a.currentPageContainers.left;l.container.style.zIndex="6"}MainFrame.Util.addClass(r.containerElement,t),MainFrame.Util.removeClass(r.containerElement,e);var c=r.isForZoomMap?r.zoomMapIconsContainer:r.mapIconsContainer;c&&(c.style.display="")})},showGlorifier:function(){var e=this.maps,t=this.zone,a=this.getAssociatedZones(),i=e.superObject;if(i.isSinglePage)this.showGlorifierCanvas(e,t,a);else{var r=e.page%2===1,n=i.currentPage!==i.settings.pages.totalPages;if(r){var s=i.currentPageContainers.left;this.showGlorifierCanvas(s.maps)}else if(n){var o=i.currentPageContainers.right;this.showGlorifierCanvas(o.maps)}this.showGlorifierCanvas(e,t,a)}},showGlorifierCanvas:function(e,t,a){var i=this,r=e.glorifierCanvas,n=r.getContext("2d"),s=e.superObject,o=e.zonesContainer.clientWidth,l=e.zonesContainer.clientHeight,c=e.getGlorifierSettings.call(e);if(s.isDoublePage)var d=s.currentPageContainers.left,g=d.maps.glorifierCanvas,h=g.getContext("2d"),u=s.currentPageContainers.right,m=u.maps.glorifierCanvas,p=m.getContext("2d");r.width=o,r.height=l,n.fillStyle=c.color,n.fillRect(0,0,r.width,r.height),t&&this.clearZoneInGlorifier(t,n,s),a&&a.forEach(function(e){var t=n;s.isDoublePage&&(s.isLeftPage(e.page)?t=h:s.isRightPage(e.page)&&(t=p)),i.clearZoneInGlorifier(e,t,s)}),r.style.display="block",r.style.opacity=c.opacity},hideGlorifier:function(){var e=this.maps,t=e.superObject;if(t.isSinglePage)this.hideGlorifierCanvas(e);else{var a=e.page%2===1;if(a){var i=t.currentPageContainers.left;this.hideGlorifierCanvas(i.maps)}else{var r=t.currentPageContainers.right;this.hideGlorifierCanvas(r.maps)}this.hideGlorifierCanvas(e)}},hideGlorifierCanvas:function(e){canvas=e.glorifierCanvas,canvas.style.opacity="0"},clearZoneInGlorifier:function(e,t,a){e.hasMask&&a.settings.maps.settings.clippingConfig.normalClipping?this.clearZoneInGlorifier_detourage(e,t,a):this.clearZoneInGlorifier_rec(e,t,a)},clearZoneInGlorifier_rec:function(e,t,a){var i=e.getPositionX(),r=e.getPositionY(),n=e.getDimensionX(),s=e.getDimensionY();t.clearRect(i,r,n,s);var o=a.currentPageSize.width,l=i+n>o;if(l&&a.isDoublePage){var c=a.currentPageContainers.right,d=c.maps,g=d.glorifierCanvas,h=g.getContext("2d"),u=0,m=r,p=i+n-o,f=s;h.clearRect(u,m,p,f)}},clearZoneInGlorifier_detourage:function(e,t,a){var i=a.currentPageSize,r=i.width,n=i.height,s=a.settings.pages.normalSize.width,o=a.settings.pages.normalSize.height,l=r/s,c=n/o;t.globalCompositeOperation="destination-out",t.beginPath();var d=parseInt(e.recX,10),g=parseInt(e.recY,10);e.maskPathEntries.forEach(function(e){var a=e.params.map(function(e,t){var a=t%2===0;return a?(e+=d,e*l):(e+=g,e*c)});t[e.type].apply(t,a)}),t.closePath(),t.fill();var h=parseInt(e.recW,10),u=d+h>s;if(u&&a.isDoublePage){var m=a.currentPageContainers.right,p=m.maps,f=p.glorifierCanvas,v=f.getContext("2d");v.globalCompositeOperation="destination-out",v.beginPath();var M=d-s,b=g;e.maskPathEntries.forEach(function(e){var t=e.params.map(function(e,t){var a=t%2===0;return a?(e+=M,e*l):(e+=b,e*c)});v[e.type].apply(v,t)}),v.closePath(),v.fill()}}}),MainFrame.Maps.HotspotObserver=MainFrame.Class.extend({handleEvent:function(e){"mouseover"===e.type?this.appear(e):("mouseout"===e.type||"click"===e.type)&&this.disappear(e)},appear:function(e){var t=MainFrame.Maps.prototype,a=t.cssClasses.hotspot+"--visible",i=this.target||e.target||e.srcElement;i.setAttribute("class",t.cssClasses.hotspot+" "+a)},disappear:function(e){var t=MainFrame.Maps.prototype,a=t.cssClasses.hotspot+"--hidden",i=this.target||e.target||e.srcElement;i.setAttribute("class",t.cssClasses.hotspot+" "+a)}});var proto=MainFrame.Maps.prototype;proto.specificZoneDrawing=function(){},MainFrame.Action.CloseMedia=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Util.getMainFrame(),t=e.mediaReference;t&&(e.removeSubObject(t),delete e.mediaReference),this.endAndClearAction()}}),MainFrame.Action.DragPageMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getTarget();t.scrollerContainer.translatedX||(t.scrollerContainer.translatedX=0),t.scrollerContainer.translatedX+=e.distanceX,MainFrame.Util.setTransformDuration(t.scrollerContainer,0),MainFrame.Util.setPosition(t.scrollerContainer,t.scrollerContainer.translatedX,0),t.isChangingPages=!0,this.endAndClearAction()}}),MainFrame.Action.GoToPageMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=MainFrame.Util.setDefault(this.getParam("duration"),0),a=this.getParam("page");switch(a){case"initiatorsGoToPage":a=this.initiatorObject.goToPage;break;case"lastPage":a=e.totalPages;break;default:a=parseInt(a,10)}t=parseFloat(t);var i=!1;if(a!==e.currentPage){e.setCurrentPage(a),e.currentPage===e.superObject.sources.length-1&&(i=!0);var r=e.scrollerContainer,n=parseInt(e.getDimensionX(),10);r.translatedX=-n*e.currentPage,MainFrame.Util.setTransformDuration(r,t),MainFrame.Util.setPosition(r,r.translatedX,0);var s=e.getPrevIndex(e.currentIndex),o=e.getNextIndex(e.currentIndex);e.moveContainer(s,e.currentPage-1),e.moveContainer(e.currentIndex,e.currentPage),e.moveContainer(o,e.currentPage+1),e.resize();var l=this;setTimeout(function(){e.isChangingPages=!1,MainFrame.EventHandler.dispatch("mediaContainerScrollerPageChanged",[l]),i&&MainFrame.EventHandler.dispatch("mediaContainerScrollerLastPageReached",[l]),l.endAndClearAction()},t)}else this.endAndClearAction()}}),MainFrame.Action.NextPageMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=e.getTarget(),a=t.scrollerContainer,i=parseInt(e.getParam("duration"),10),r=1,n=!1,s=!1;if(i=MainFrame.Util.setDefault(i,300),t.currentPage<t.superObject.sources.length-1){var o=t.getPrevIndex(t.currentIndex);t.currentIndex=t.getNextIndex(t.currentIndex),t.setCurrentPage(t.currentPage+r),t.currentPage===t.superObject.sources.length-1&&(s=!0);var l=parseInt(t.getDimensionX(),10);a.translatedX=-l*t.currentPage,MainFrame.Util.setTransformDuration(a,i),MainFrame.Util.setPosition(a,a.translatedX,0),t.moveContainer(o,t.currentPage+1);var n=!0}else MainFrame.ActionManager.doAction(t,t,t.id,"repositionAfterDragMediaDiaporama","false",[t]);setTimeout(function(){t.isChangingPages=!1,n&&MainFrame.EventHandler.dispatch("mediaContainerScrollerPageChanged",[e]),s&&MainFrame.EventHandler.dispatch("mediaContainerScrollerLastPageReached",[e]),e.endAndClearAction()},i)}}),MainFrame.Action.PreviousPageMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=e.getTarget(),a=t.scrollerContainer,i=parseInt(e.getParam("duration"),10),r=1,n=!1,s=!1;if(i=MainFrame.Util.setDefault(i,300),t.currentPage>0){var o=t.getNextIndex(t.currentIndex);t.currentIndex=t.getPrevIndex(t.currentIndex),t.setCurrentPage(t.currentPage-r),0===t.currentPage&&(s=!0);var l=parseInt(t.getDimensionX(),10);a.translatedX=-l*t.currentPage,MainFrame.Util.setTransformDuration(a,i),MainFrame.Util.setPosition(a,a.translatedX,0),t.moveContainer(o,t.currentPage-1);var n=!0}else MainFrame.ActionManager.doAction(t,t,t.id,"repositionAfterDragMediaDiaporama","false",[t]);setTimeout(function(){t.isChangingPages=!1,n&&MainFrame.EventHandler.dispatch("mediaContainerScrollerPageChanged",[e]),s&&MainFrame.EventHandler.dispatch("mediaContainerScrollerFirstPageReached",[e]),e.endAndClearAction()},i)}}),MainFrame.Action.RepositionAfterDragMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=e.getTarget(),a=parseInt(e.getParam("duration"),10),i=-1*t.getDimensionX()*t.currentPage;a=MainFrame.Util.setDefault(a,300),a=isNaN(a)?300:a,t.scrollerContainer.translatedX=i,MainFrame.Util.setTransformDuration(t.scrollerContainer,a),MainFrame.Util.setPosition(t.scrollerContainer,i,0),setTimeout(function(){t.isChangingPages=!1,MainFrame.EventHandler.dispatch("mediaContainerScrollerPageRepositioned",[e]),e.endAndClearAction()},a)}}),MainFrame.Action.SetMediaPageNumbering=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("pageSource")),t=this.getTarget();if(e&&t){var a=e.currentPage+1;t.setText(a+"")}this.endAndClearAction()}}),MainFrame.Action.StartAutoplayMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=e.autoplay,a=e.autoplay.active!==!0;t&&a&&e.startAutoplay()}this.endAndClearAction()}}),MainFrame.Action.StopAutoplayMediaDiaporama=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=e.autoplay&&e.autoplay.active;t&&e.stopAutoplay()}this.endAndClearAction()}}),MainFrame.Action.ToggleDisplayOnPageChange=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("pageSource"),t=MainFrame.Manager.Scoping.getById(e),a=this.getParam("hideOnPage");if(t){switch(a){case"first":a=0;break;case"last":a=t.totalPages-1;break;default:a=parseInt(a,10)}var i=this.getTarget();i.containerElement.style.display=t.currentPage===a?"none":""}else MainFrame.Util.showError("Invalid page source! No module found with the id :"+e);this.endAndClearAction()}}),MainFrame.Action.UpdateTextFromCaption=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("source"),t=MainFrame.Manager.Scoping.getById(e);if(t){var a=this.getParam("captionProp"),i=t.currentPage,r=t.superObject.sources[i];if(r){var n=r.caption;n[a]=n[a]?n[a]:"";var s=this.getTarget();s.setText(n[a])}}else MainFrame.Util.showError("Invalid caption source! No module found with the id :"+e);this.endAndClearAction()}}),MainFrame.Interpretor.DragEndNormalMediaContainer=MainFrame.Interpretor.Drag.extend({onTouchMove:function(e){var t=this;t.dragStarted&&(t.isDragged=!0,t.currentEvent=e.changedTouches?e.changedTouches[0]:e,t.currentX=t.currentEvent.pageX,t.currentY=t.currentEvent.pageY,t.totalDistanceX=t.currentX-t.initialX,t.totalDistanceY=t.currentY-t.initialY)},onTouchEnd:function(){this.dragStarted&&(this.dragStarted=!1,this.dragDuration=(new Date).getTime()-this.dragStartedTime,this.isDragged&&(this.totalDistanceX>20||this.dragDuration>50)&&Math.abs(this.totalDistanceX)<Math.abs(this.initiator.getDimensionX())/2&&"normal"===this.target.state&&MainFrame.EventHandler.dispatch("dragEndNormalMediaContainer",[this],this.target),this.isDragged=!1)}}),MainFrame.Interpretor.PressOnParent=MainFrame.Interpretor.Press.extend({onTouchEnd:function(e){var t=this;if(!t.hasMoved){var a=e.srcElement||e.target,i=a===t.initiator.contentElement,r=!1;if(t.initiator.containers){var n=t.initiator.containers[t.initiator.currentIndex];r=a===n.contentElement}(i||r)&&MainFrame.EventHandler.dispatch("pressOnParent",[t],t.initiator)}t.hasMoved=!1}}),MainFrame.Manager.Media=new MainFrame.Abstract.Manager({id:"media"}),!function(){var e={parseMedia:function(e){var t=MainFrame.DataParser.getChildrenWithNodeName(e,"system");if(t.length){var a=t[0];MainFrame.DataParser.parseSystem(a)}var i=MainFrame.DataParser.getChildrenWithNodeName(e,"mainframe");if(i.length){var r=i[0];MainFrame.DataParser.parseElement.call(this,r)}},parseMediaContainer:function(e){if(e.attributes&&e.attributes.templateId){var t=e.attributes.templateId,a=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,t,a)}MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getAction.call(this,e);var i=MainFrame.Util.processAttribute(e.attributes.padding).interpretedString;i&&(this.padding=MainFrame.DataParser.getTopRightBottomLeftValues(i));var r=MainFrame.Util.processAttribute(e.attributes.autoresize).interpretedString;r&&(this.autoresize="true"===r?!0:!1),MainFrame.DataParser.parseChildren.call(this,e)},parseMediaDiaporama:function(e){if(e.attributes&&e.attributes.templateId){var t=e.attributes.templateId,a=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,t,a)}MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getType.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getAction.call(this,e);var i=MainFrame.Util.processAttribute(e.attributes.mediaDiaporamaId||MainFrame.Util.processAttribute(e.attributes.mediaId).interpretedString).interpretedString;i&&MainFrame.DataParser.parseMediaDiaporamaSettings.call(this,i),MainFrame.DataParser.parseChildren.call(this,e)},parseMediaDiaporamaSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);this.settings={};var a=MainFrame.Util.processAttribute(t.attributes.data).interpretedString;a&&(this.settings.dataSrc=a),t.attributes.currentItem&&(this.currentItem=t.attributes.currentItem);var i=MainFrame.DataParser.getChildrenWithNodeName(t,"settings");if(i.length)for(var r=i[0],n=MainFrame.DataParser.getChildrenWithNodeName(r,"prop"),s=0,o=n.length;o>s;s++){var l=n[s],c=l.attributes.id,d=l.value;this.settings[c]=d}var g=MainFrame.DataParser.getChildrenWithNodeName(t,"sources");g.length?MainFrame.DataParser.parseMediaSources.call(this,g[0]):this.sources=[]},parseMediaSources:function(e){this.settings||(this.settings={}),MainFrame.DataParser.getBorders.call(this.settings,e),e.attributes.id&&(this.sourcesId=e.attributes.id,console.log(this.sourcesId));var t=[];if(e.attributes.source){var a=MainFrame.Util.getForSource(e.attributes.source);""!==a&&a.forEach(function(e){var a={};a.type="image",a.src="undefined"==typeof e.value?e:e.value,t.push(a)})}else for(var i=MainFrame.DataParser.getChildrenWithNodeName(e,"source"),r=0,n=i.length;n>r;r++){var a={};sourceNode=i[r];var s=MainFrame.DataParser.getChildrenWithNodeName(sourceNode,"src")[0];if(a.type=s.attributes.type,s.value?a.src=s.value:s.childNodes.length&&(a.sources={},s.childNodes.forEach(function(e){a.sources[e.nodeName]=e.value})),"video"===a.type){var o=s.attributes.availableFormats;if(o){var l=o.split("|");a.availableFormats=l}else a.availableFormats=["mp4"]}if("audio"===a.type){var o=s.attributes.availableFormats;if(o){var l=o.split("|");a.availableFormats=l}else a.availableFormats=["mp3"]}if("xml"===a.type)for(var c=0,d=s.childNodes.length;d>c;c++){var g=s.childNodes[c];"resource"===g.nodeName&&(a.xmlContent=s.childNodes[c])}var h=MainFrame.DataParser.getChildrenWithNodeName(sourceNode,"caption");a.caption=h.length?MainFrame.DataParser.parseSourceCaption(h[0]):{},t.push(a)}this.sources=t},parseMediaVideo:function(e){if(e.attributes&&e.attributes.templateId){var t=e.attributes.templateId,a=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,t,a)}MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getType.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getAction.call(this,e);var i=MainFrame.Util.processAttribute(e.attributes.mediaVideoId||MainFrame.Util.processAttribute(e.attributes.mediaId).interpretedString).interpretedString;i&&MainFrame.DataParser.parseMediaVideoSettings.call(this,i),MainFrame.DataParser.parseChildren.call(this,e)},parseMediaVideoSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);this.settings={};var a=MainFrame.Util.processAttribute(t.attributes.data).interpretedString;a&&(this.settings.dataSrc=a);var i=MainFrame.DataParser.getChildrenWithNodeName(t,"settings");if(i.length)for(var r=i[0],n=MainFrame.DataParser.getChildrenWithNodeName(r,"prop"),s=0,o=n.length;o>s;s++){var l=n[s],c=l.attributes.id,d=l.value;this.settings[c]=d}var g=MainFrame.DataParser.getChildrenWithNodeName(t,"sources");g.length&&MainFrame.DataParser.parseMediaSources.call(this,g[0])},parseMediaAudio:function(e){if(e.attributes&&e.attributes.templateId){var t=e.attributes.templateId,a=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,t,a)}MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getType.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getAction.call(this,e);var i=MainFrame.Util.processAttribute(e.attributes.mediaAudioId||MainFrame.Util.processAttribute(e.attributes.mediaId).interpretedString).interpretedString;i&&MainFrame.DataParser.parseMediaAudioSettings.call(this,i),MainFrame.DataParser.parseChildren.call(this,e)},parseMediaAudioSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);this.settings={};var a=MainFrame.Util.processAttribute(t.attributes.data).interpretedString;a&&(this.settings.dataSrc=a);var e=MainFrame.DataParser.getChildrenWithNodeName(t,"settings");if(e.length)for(var i=e[0],r=MainFrame.DataParser.getChildrenWithNodeName(i,"prop"),n=0,s=r.length;s>n;n++){var o=r[n],l=o.attributes.id,c=o.value;this.settings[l]=c}var d=MainFrame.DataParser.getChildrenWithNodeName(t,"sources");d.length&&MainFrame.DataParser.parseMediaSources.call(this,d[0])},parseSourceCaption:function(e){for(var t={},a=0,i=e.childNodes.length;i>a;a++){var r=e.childNodes[a],n=r.nodeName,s=r.value;t[n]=s}return t},parseMediaDiaporamaThumbs:function(e){if(e.attributes&&e.attributes.templateId){var t=e.attributes.templateId,a=MainFrame.DataParser.getTemplateParams(e);e=MainFrame.DataParser.applyTemplate(e,t,a)}MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getType.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getSkin.call(this,e),MainFrame.DataParser.getAction.call(this,e),MainFrame.DataParser.getSpacing.call(this,e),MainFrame.DataParser.getSourceModule.call(this,e),MainFrame.DataParser.getLoadingTemplateId.call(this,e);var i=e.attributes.sliderId;i&&(this.sliderId=i),this.layoutType=e.attributes.layout||"horizontal",this.thumbSufix=e.attributes.thumbSufix||"_s",this.thumbFolder=e.attributes.thumbFolder||"s/",MainFrame.DataParser.getMediaThumb.call(this,e)},getMediaThumb:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"mediaThumb");this.thumbTemplate=t}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Element.MediaAudio=MainFrame.Abstract.Element.extend({mediaType:"audio",readData:function(e){MainFrame.DataParser.parseMediaAudio.call(this,e),this.initAudio()},initAudio:function(){}}),MainFrame.Element.MediaContainer=MainFrame.Abstract.Element.extend({currentPage:0,currentIndex:1,canScaleUp:!1,readData:function(e){MainFrame.DataParser.parseMediaContainer.call(this,e),this.isInitialized||this.initMediaContainer()},initMediaContainer:function(){switch(this.superObject.mediaType){case"diaporama":this.initMediaContainerDiaporama();break;case"video":this.initMediaContainerDiaporama();break;case"audio":this.initMediaContainerDiaporama()}this.isInitialized=!0},resize:function(){switch(this.isInitialized||this.initMediaContainer(),this._resize(),this.superObject.mediaType){case"diaporama":this.mediaContainerScrollerResize();break;case"video":this.mediaContainerScrollerResize();break;case"audio":this.mediaContainerScrollerResize()}},initMediaContainerDiaporama:function(){this.totalPages=this.superObject.sources.length,this.currentIndex=1,this.initCurrentPage(),this.state="normal",this.superObject.settings.dataSrc||(this.superObject.settings.dataSrc=MainFrame.Util.getResURL()),this.buildScrollerContainer(),this.updateContentForContainer(1,this.currentPage),this.updateContentForContainer(0,this.currentPage-1),this.updateContentForContainer(2,this.currentPage+1);var e=this;setTimeout(function(){MainFrame.EventHandler.dispatch("mediaContainerScrollerPageChanged",[e]),e.initAutoplay()},100),this.scale=1,this.hasBorders&&(this.containerElement.style.borderTop=this.borderTopWidth*this.scale+"px "+this.borderTopStyle+" "+this.borderTopColor,this.containerElement.style.borderRight=this.borderRightWidth*this.scale+"px "+this.borderRightStyle+" "+this.borderRightColor,this.containerElement.style.borderBottom=this.borderBottomWidth*this.scale+"px "+this.borderBottomStyle+" "+this.borderBottomColor,this.containerElement.style.borderLeft=this.borderLeftWidth*this.scale+"px "+this.borderLeftStyle+" "+this.borderLeftColor)},initAutoplay:function(){var e=this.superObject.settings,t="true"===e.autoPlay||"1"===e.autoPlay,a=e.autoPlayInterval||"3",i=parseFloat(a,10),r=MainFrame.Util.secondsToMiliseconds(i);this.autoplay={},this.autoplay.intervalDuration=r,t&&this.startAutoplay()},startAutoplay:function(){var e=this,t=e.autoplay;t.event="autoplayMediaNext",t.active=!0,t.interval=setInterval(function(){e.doAutoplay()},t.intervalDuration),MainFrame.EventHandler.dispatch("autoplayMediaStart")},doAutoplay:function(){var e=this.autoplay;if(e.active){var t=this.superObject,a=t.settings;loop="false"===a.autoPlayLoop||"0"===a.autoPlayLoop?!1:!0,reverse="true"===a.autoPlayReverse||"1"===a.autoPlayReverse?!0:!1;var i=this.currentPage,r=t.sources.length-1;if(lastPageReached=i===r)if(loop){if(!reverse)return void MainFrame.EventHandler.dispatch("autoplayMediaReset");e.event="autoplayMediaPrevious"}else clearInterval(e.Interval),e.active=!1,MainFrame.EventHandler.dispatch("autoplayMediaStop");else 1>i&&"autoplayMediaPrevious"===e.event&&(e.event="autoplayMediaNext");MainFrame.EventHandler.dispatch(e.event)}},stopAutoplay:function(){var e=this.autoplay;clearInterval(e.interval),e.active=!1,MainFrame.EventHandler.dispatch("autoplayMediaStop")},unload:function(){this.stopAutoplay(),this._unload()},updateContentForContainer:function(e,t){var a=this.superObject.sources.length;t>=0&&a>t?this.buildContentInSubContainer(this.containers[e],t):this.clearSubContainer(this.containers[e])},initCurrentPage:function(){var e=MainFrame.Util.getItem("mediaContainer_"+this.id+"_"+this.superObject.sourcesId+"_currentPage");if(e&&(this.currentPage=parseInt(e,10)),"undefined"!=typeof this.superObject.currentItem){var t=parseInt(this.superObject.currentItem)-1,a=this.superObject.sources.length-1;t>=0&&a>=t&&(this.currentPage=t)}this.currentPage||(this.currentPage=0)},setCurrentPage:function(e){this.currentPage=e,"undefined"!=typeof this.superObject.sourcesId&&MainFrame.Util.saveItem("mediaContainer_"+this.id+"_"+this.superObject.sourcesId+"_currentPage",this.currentPage)
},buildScrollerContainer:function(){this.scrollerContainer=document.createElement("div"),this.scrollerContainer.setAttribute("class","v7__elem--scroller"),this.contentElement.insertBefore(this.scrollerContainer,this.contentElement.firstChild),this.scrollerContainer.style.width="100%",this.scrollerContainer.style.height="100%",this.scrollerContainer.translatedX=-this.currentPage*parseInt(this.getDimensionX(),10),MainFrame.Util.setTransformDuration(this.scrollerContainer,0),MainFrame.Util.setPosition(this.scrollerContainer,this.scrollerContainer.translatedX,0),this.divs=[],this.containers=[];var e,t,a;e=this.currentPage-1,t=this.currentPage,a=this.currentPage+1,this.buildSubContainer(0,e),this.buildSubContainer(1,t),this.buildSubContainer(2,a)},buildSubContainer:function(e,t){var a=MainFrame.Util.createElement("div","",this.scrollerContainer);a.setAttribute("data-index",t),a.style.left=100*t+"%",this.divs[e]=a;var i="scroller_"+this.id+"_container"+e,r=MainFrame.Util.createElement("div","v7__elem--container",this.divs[e]);contentElement=MainFrame.Util.createElement("div","v7__elem--content",r),contentElement.style.width="100%",contentElement.style.height="100%";var n=new MainFrame.Element.Item({id:i,superObject:this,containerElement:r,contentElement:contentElement});n.positionX="0",n.positionY="0",n.dimensionX="100%",n.dimensionY="100%",this.containers[e]=n},buildContentInSubContainer:function(e,t){var a=this.superObject.sources[t];switch(a.type){case"image":this.buildImageInSubContainer(e,t);break;case"video":this.buildVideoInSubContainer(e,t);break;case"audio":this.buildAudioInSubContainer(e,t);break;case"xml":this.buildXmlInSubContainer(e,t);break;case"html":this.buildHtmlInSubContainer(e,t)}},buildImageInSubContainer:function(e,t){var a=this;if(this.clearSubContainer(e),e.containerElement.style.visibility="visible",!e.img){e.img=MainFrame.Util.createElement("img","",e.contentElement),e.contentElement.style.textAlign="center",this.scale=1;var i=this.superObject.settings;i.hasBorders&&(e.img.style.borderTop=i.borderTopWidth*this.scale+"px "+i.borderTopStyle+" "+i.borderTopColor,e.img.style.borderRight=i.borderRightWidth*this.scale+"px "+i.borderRightStyle+" "+i.borderRightColor,e.img.style.borderBottom=i.borderBottomWidth*this.scale+"px "+i.borderBottomStyle+" "+i.borderBottomColor,e.img.style.borderLeft=i.borderLeftWidth*this.scale+"px "+i.borderLeftStyle+" "+i.borderLeftColor)}var r=a.superObject.sources[t],n=this.getSource(r),s=new Image;s.onload=function(){e.imageLoaded=!0;var t=e.getDimensionX()/e.getDimensionY(),i=this.width/this.height;e.img.src=this.src,e.img.naturalImageWidth=this.width,e.img.naturalImageHeight=this.height,a.resizeMediaContainerImageWithRatios(e,t,i)},e.imageLoaded=!1,e.page=t;var o=MainFrame.Util.isAbsoluteUrl(n);s.src=o?n:MainFrame.Util.getAppURL()+a.superObject.settings.dataSrc+n},buildVideoInSubContainer:function(e,t){var a=this,i=a.superObject.sources[t];this.clearSubContainer(e),e.containerElement.style.visibility="visible",e.videoIframe||(e.videoIframe=MainFrame.Util.createElement("iframe","",e.contentElement),e.videoIframe.style.width="90%",e.videoIframe.style.height="90%",e.videoIframe.style.margin="5%",e.videoIframe.style.border="none");var r="";r+='<script>function closeIframe() { var clickedElement = window.event.target || window.event.srcElement; if (clickedElement.nodeName.toLowerCase() === "div") { window.top.MainFrame.EventHandler.dispatch("iframeDivPressed"); } };</script>',r+='<div onclick="closeIframe();" style="width: 100%; height: 100%;"><video autoplay autobuffer controls preload="metadata" style="margin: auto; position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px; width: 100%; height: 100%; max-width: 100%; max-height: 100%;">';for(var n,s,o=this.getSource(i),l=MainFrame.Util.isAbsoluteUrl(o),c=0,d=i.availableFormats.length;d>c;c++){var g=i.availableFormats[c];switch(g){case"mp4":n=l?o:MainFrame.Util.getAppURL()+this.superObject.settings.dataSrc+o+"."+g;break;case"webm":s=l?o:MainFrame.Util.getAppURL()+this.superObject.settings.dataSrc+o+"."+g}}if(s&&(r+='<source src="'+s+'" type=\'video/webm; codecs="vp8, vorbis"\' />',videoDownloadSource=s),n&&(r+='<source src="'+n+'"  type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\' />',videoDownloadSource=n),videoDownloadSource){var h=MainFrame.Manager.Text.getById("videoNotSupported");h&&(-1!==h.indexOf("#src#")&&(h=h.replace("#src#",videoDownloadSource)),r+=h)}r+="</video></div>",e.videoIframe.contentDocument.write(r)},buildAudioInSubContainer:function(e,t){var a=this,i=a.superObject.sources[t];if(this.clearSubContainer(e),e.containerElement.style.visibility="visible",!e.audio){e.audio=MainFrame.Util.createElement("audio","",e.contentElement),e.contentElement.style.textAlign="center",e.audio.setAttribute("autoplay","true"),e.audio.setAttribute("controls","true"),e.audio.setAttribute("preload","metadata"),e.audio.setAttribute("style","margin: auto; position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px;"),this.scale=1;var r=this.superObject.settings;r.hasBorders&&(e.audio.style.borderTop=r.borderTopWidth*this.scale+"px "+r.borderTopStyle+" "+r.borderTopColor,e.audio.style.borderRight=r.borderRightWidth*this.scale+"px "+r.borderRightStyle+" "+r.borderRightColor,e.audio.style.borderBottom=r.borderBottomWidth*this.scale+"px "+r.borderBottomStyle+" "+r.borderBottomColor,e.audio.style.borderLeft=r.borderLeftWidth*this.scale+"px "+r.borderLeftStyle+" "+r.borderLeftColor)}for(var n,s=0,o=i.availableFormats.length;o>s;s++){var l=i.availableFormats[s];switch(l){case"mp3":n=MainFrame.Util.getAppURL()+this.superObject.settings.dataSrc+i.src+"."+l}}var c="";n&&e.audio.setAttribute("src",n);var d=MainFrame.Manager.Text.getById("audioNotSupported");d&&(-1!==d.indexOf("#src#")&&(d=d.replace("#src#",audioDownloadSource)),c+=d),e.audio.innerHTML=c,MainFrame.Event.bind(e.audio,"loadedmetadata",function(){e.audioLoaded=!0}),EnvDetection.isAndroid&&(e.audio.isPlaying=!1,MainFrame.Event.bind(e.audio,MainFrame.Event.start,function(){e.audio.isPlaying?(e.audio.pause(),e.audio.isPlaying=!1):(e.audio.play(),e.audio.isPlaying=!0)})),e.audioLoaded=!1},buildXmlInSubContainer:function(e,t){var a=this;this.clearSubContainer(e),e.containerElement.style.visibility="visible";var i=a.superObject.sources[t];new MainFrame.Element.Resource({superObject:e,data:i.xmlContent})},buildHtmlInSubContainer:function(e,t){var a=this;this.clearSubContainer(e),e.containerElement.style.visibility="visible";var i=a.superObject.sources[t];e.hasHtml=!0,e.contentElement.innerHTML=i.src},clearSubContainer:function(e){e.containerElement.style.visibility="hidden",e.img&&(e.img.src=MainFrame.Util.emptyImageUrl,MainFrame.Util.removeElement(e.img),delete e.img),e.video&&(MainFrame.Util.removeElement(e.video),delete e.video),e.audio&&(MainFrame.Util.removeElement(e.audio),delete e.audio),e.resource&&(MainFrame.Util.removeElement(e.resource.containerElement),delete e.resource),e.hasHtml&&(MainFrame.Util.emptyElement(e.contentElement),e.hasHtml=!1),this.autoresize},getNextIndex:function(e){return 2===e?0:e+1},getPrevIndex:function(e){return e?e-1:2},moveContainer:function(e,t){this.divs[e].style.left=100*t+"%",this.divs[e].setAttribute("data-index",t),this.updateContentForContainer(e,t),this.autoresize&&this.repositionMediaContainerElementsRelativeToImage()},mediaContainerScrollerResize:function(){var e=this.getPrevIndex(this.currentIndex),t=this.getNextIndex(this.currentIndex);this.scrollerContainer.translatedX=-this.currentPage*parseInt(this.getDimensionX(),10),MainFrame.Util.setTransformDuration(this.scrollerContainer,0),MainFrame.Util.setPosition(this.scrollerContainer,this.scrollerContainer.translatedX,0),this.resizeContentInContainer(this.currentPage,this.containers[this.currentIndex]);var a=this.superObject.sources.length;this.currentPage+1<a&&this.resizeContentInContainer(this.currentPage+1,this.containers[t]),this.currentPage-1>0&&this.resizeContentInContainer(this.currentPage-1,this.containers[e])},resizeContentInContainer:function(e,t){var a=this.superObject.sources[e];if(a)switch(a.type){case"image":this.resizeImageInSubContainer(t);break;case"video":this.resizeVideoInSubContainer(t);break;case"audio":this.resizeAudioInSubContainer(t);break;case"xml":this.resizeXmlInSubContainer(t);case"html":this.resizeHtmlInSubContainer(t)}},resizeImageInSubContainer:function(e){if(e.imageLoaded){this.autoresize;var t=e.getDimensionX()/e.getDimensionY(),a=e.img.clientWidth/e.img.clientHeight;this.resizeMediaContainerImageWithRatios(e,t,a)}},resizeMediaContainerImageWithRatios:function(e,t,a){var i=this.superObject.settings,r=0,n=0;i.hasBorders&&(r=i.borderTopWidth+i.borderBottomWidth,n=i.borderLeftWidth+i.borderRightWidth);var s=e.img.naturalImageWidth,o=e.img.naturalImageHeight;if(t>a)if(this.canScaleUp){var l=e.getDimensionY();l-=r,e.img.style.height=l+"px";var c=l*a;e.img.style.width=c+"px",e.img.style.marginTop="0px"}else if(o>e.getDimensionY()){var d=e.getDimensionY()-r;e.img.style.height=d+"px";var g=d*a;e.img.style.width=g+"px",e.img.style.marginTop="0px"}else{var h=e.getDimensionY(),u=o,m=(h-r-u)/2;e.img.style.marginTop=m+"px"}else if(this.canScaleUp){var c=e.getDimensionX();c-=n,e.img.style.width=c+"px";var l=c/a;if(e.img.style.height=l+"px",!e.autoresize){var h=e.getDimensionY(),u=e.getDimensionX()/a,m=(h-u)/2;e.img.style.marginTop=m+"px"}}else if(s>e.getDimensionX()){var g=e.getDimensionX()-n;e.img.style.width=g+"px";var d=g/a;e.img.style.height=d+"px";var h=e.getDimensionY(),m=(h-r-d)/2;e.img.style.marginTop=m+"px"}else{var h=e.getDimensionY(),u=o;e.img.style.width=s+"px",e.img.style.height=o+"px";var m=(h-r-u)/2;e.img.style.marginTop=m+"px"}this.autoresize&&this.repositionMediaContainerElementsRelativeToImage()},resizeVideoInSubContainer:function(){},resizeMediaContainerVideoWithRatios:function(){},resizeAudioInSubContainer:function(){},resizeXmlInSubContainer:function(e){e.resource&&e.resource.resize()},resizeHtmlInSubContainer:function(){},resizeMediaContainerAudioWithRatios:function(){},repositionMediaContainerElementsRelativeToImage:function(){for(var e=this.containers[this.currentIndex],t=0,a=this.subObjects.length;a>t;t++){var i=this.subObjects[t];if(!this.isContainer(i)){i.originalPositionX||(i.originalPositionX=i.positionX),i.originalPositionY||(i.originalPositionY=i.positionY),i.originalDimensionX||(i.originalDimensionX=i.dimensionX),i.originalDimensionY||(i.originalDimensionY=i.dimensionY);var r=e.img.clientWidth,n=e.img.clientHeight,s=(e.getDimensionX()-r)/2,o=(e.getDimensionY()-n)/2,l=s+this.parseStringExpression(i.originalPositionX,r),c=o+this.parseStringExpression(i.originalPositionY,n),d=this.parseStringExpression(i.originalDimensionX,r),g=this.parseStringExpression(i.originalDimensionY,n);i.setPositionY(c),i.setPositionX(l),i.setDimensionX(d),i.setDimensionY(g),i.resize()}}},isContainer:function(e){for(var t=0;3>t;t++)if(e===this.containers[t])return!0;return!1},getSource:function(e){if(e.src)return e.src;if(e.sources){var t=EnvDetection.deviceType.toLowerCase(),a=e.sources[t];return a||("desktop"===t?a=e.sources.tablet:"tablet"===t&&(a=e.sources.desktop)),a}return""}}),MainFrame.Element.MediaDiaporama=MainFrame.Abstract.Element.extend({mediaType:"diaporama",readData:function(e){MainFrame.DataParser.parseMediaDiaporama.call(this,e),this.initDiaporama()},initDiaporama:function(){this.state="normal",this.totalPages=this.sources.length,this.settings.dataSrc||(this.settings.dataSrc=MainFrame.Util.getResURL())}}),MainFrame.Element.MediaDiaporamaThumbs=MainFrame.Abstract.Module.extend({readData:function(e){MainFrame.DataParser.parseMediaDiaporamaThumbs.call(this,e);var t=this;this.setLoadingScreen(),setTimeout(function(){t.initDiaporamaThumbs()},200)},initDiaporamaThumbs:function(){for(var e,t,a=this.sourceModule,i=a.sources.length,r=0,n=0,s=0;i>s;s++){var o=new MainFrame.Element.Item({superObject:this,data:this.thumbTemplate}),l=o.getSubObjectWithRole("image");if(l){var c=a.sources[s],d=this.getSource(c);l.setSource(d)}e=e||o.getDimensionX(),t=t||o.getDimensionY(),"horizontal"===this.layoutType?(o.setPositionX(r),r+=e):(o.setPositionY(n),n+=t),o.setAction("id:mediaThumbGoToPage;params:page="+s),o.addHandCursor()}"horizontal"===this.layoutType?this.setDimensionX(r):this.setDimensionY(n),this.resize(),this.removeLoadingScreen()},getSource:function(e){var t="";if(e.src)t=e.src;else if(e.sources){var a=EnvDetection.deviceType.toLowerCase();t=e.sources[a],t||("desktop"===a?t=e.sources.tablet:"tablet"===a&&(t=e.sources.desktop))}var i=MainFrame.Util.isAbsoluteUrl(t);if(!i){var r=t.split("."),n=r.pop(),s=r.pop();s+=this.thumbSufix,r.push(s),r.push(n),t=r.join("."),t=MainFrame.Util.getAppURL()+this.sourceModule.settings.dataSrc+this.thumbFolder+t}return t}}),MainFrame.Element.MediaVideo=MainFrame.Abstract.Element.extend({mediaType:"video",readData:function(e){MainFrame.DataParser.parseMediaVideo.call(this,e),this.initVideo()},initVideo:function(){}}),MainFrame.Element.Media=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseMedia.call(this,e)}}),!function(){MainFrame.DataParser.elements.mediaAudio=MainFrame.Element.MediaAudio,MainFrame.DataParser.elements.mediaContainer=MainFrame.Element.MediaContainer,MainFrame.DataParser.elements.mediaDiaporama=MainFrame.Element.MediaDiaporama,MainFrame.DataParser.elements.mediaVideo=MainFrame.Element.MediaVideo,MainFrame.DataParser.elements.mediaDiaporamaThumbs=MainFrame.Element.MediaDiaporamaThumbs}(),!function(){var e={parseNotes:function(e){MainFrame.DataParser.basicParse.call(this,e),MainFrame.DataParser.getLoadingTemplateId.call(this,e),e.attributes.annotationId&&MainFrame.DataParser.parseNotesSettings.call(this,e.attributes.annotationId)},parseNotesSettings:function(e){var t=MainFrame.Manager.Settings.getById(e);MainFrame.DataParser.getType.call(this,t),t.attributes.templateId&&(this.templateId=t.attributes.templateId),t.attributes.catalogId&&(this.catalogId=t.attributes.catalogId),this.groupNotesByPage="true"===t.attributes.groupNotesByPage?!0:!1,this.allowEmptyNotes=t.attributes.allowEmptyNotes?"true"===t.attributes.allowEmptyNotes:!1}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Abstract.Note=MainFrame.Element.Resource.extend({resize:function(){if(this.note){var e=MainFrame.Manager.Scoping.getById(this.note.catalogId),t=e.settings.pages.normalSize.width,a=e.settings.pages.normalSize.height,i=100*this.note.x/t,r=100*this.note.y/a,n=e.currentPageSize,s=n.width,o=n.height,l=i*s/100,c=r*o/100,d="single"===e.settings.pages.coverType;if(d){var g=this.note.page%2===1;(e.isSinglePage||1===e.pagesOnScreen)&&(g=!1),g&&(l+=s)}else{var h=this.note.page;e.isRightPage(h)===!0&&(l+=s)}if(this.note.sideIconMode){var u=this.getSubObjectWithRole("icon"),m=this.getDimensionX(),p=u.getDimensionX(),f=e.currentCatalogSize,v=f.width,M=50,b=50;l=v-m+p,c=M+b*this.note.noteIndex,1===e.pagesOnScreen&&(l-=v/2)}this.setPositionX(l),this.setPositionY(c),(this.translatedX||this.translatedY)&&(this.translatedX=0,this.translatedY=0,MainFrame.Util.setTransformDuration(this.containerElement,0),MainFrame.Util.setPosition(this.containerElement,this.translatedX,this.translatedY))}this._resize()},_resize:function(){var e=this.getDimensionX(),t=this.getDimensionY();if(this.containerElement.style.width=e+"px",this.containerElement.style.height=t+"px",this.containerElement.style.top=this.getPositionY()+"px",this.containerElement.style.left=this.getPositionX()+"px",this.contentElement&&(this.contentElement.style.width=e+"px",this.contentElement.style.height=t+"px"),this.subObjects)for(var a=0,i=this.subObjects.length;i>a;a++)this.subObjects[a].resize();this.skinObject&&this.skinObject.resize()}}),MainFrame.Action.BringNoteToFront=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.noteId;if("undefined"==typeof t)return MainFrame.Util.showError("Action.BringNoteToFront error! The target object does not have a noteId property!"),void this.endAndClearAction();var a=this.getParam("catalogId"),i=MainFrame.Manager.Scoping.getById(a),r=this.getParam("method"),n=function(e){if("zIndex"===r)e.containerElement.style.zIndex="",e.noteId==t&&(e.containerElement.style.zIndex="1");else if(e.noteId==t){for(var a,i=0,n=e.containerElement.parentNode.childNodes.length;n>i;i++){var s=e.containerElement.parentNode.childNodes[i];s===e.containerElement&&(a=i)}n-1>a&&e.containerElement.parentNode.appendChild(e.containerElement)}};if(i.isSinglePage){var s=i.currentPageContainers.page;s.notes.forEach(n)}else{var o=i.currentPageContainers.left;o.notes.forEach(n);var l=i.currentPageContainers.right;l.notes.forEach(n)}this.endAndClearAction()}}),MainFrame.Action.DragNote=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getParam("dragTarget")||"self",a=this.getTarget();switch(t){case"self":var i=a;break;case"parent":var i=a.superObject;break;default:var i=MainFrame.Manager.Scoping.getById(t)}if(i){var r=this.getParam("catalogId")||"catalog",n=MainFrame.Manager.Scoping.getById(r);if(n){var s=i.getDimensionX(),o=i.getDimensionY(),l=i.note.page,c=this.getNoteLimits(n,s,o,l),d=parseInt(i.getPositionX())+e.distanceX+"",g=parseInt(i.getPositionY())+e.distanceY+"",h=d>=c.left&&d<=c.right,u=g>=c.top&&g<=c.bottom;h&&u&&(i.translatedX||(i.translatedX=0),i.translatedY||(i.translatedY=0),MainFrame.Util.setPosition(i.containerElement,i.translatedX,i.translatedY),i.translatedX+=e.distanceX,i.translatedY+=e.distanceY,i.positionX=d,i.positionY=g)}}this.endAndClearAction()},getNoteLimits:function(e,t,a){var i=e.currentCatalogSize,r=i.width,n=i.height,s=e.currentPageSize.width;e.isDoublePage&&1===e.pagesOnScreen&&(r=s);var o={};return o.left=0,o.right=r-t,o.top=0,o.bottom=n-a,o}}),MainFrame.Action.DrawNote=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("templateId"),a=this.getParam("positionIncrementX")||50,i=this.getParam("positionIncrementY")||50,r=a?parseInt(a,10):50,n=i?parseInt(i,10):50,s=e.currentPage,o=(e.pageReferences[s],this.getParam("maxNotesOnDoublePage"));if(o)var l=parseInt(o,10);var c="true"===this.getParam("oneNoteOnDoublePage");if(c&&this.isNoteAlreadyOnDoublePage(e))return void this.endAndClearAction();var d=MainFrame.Manager.Resource.getById(t),g="true"===d.attributes.hasIcon;if(e.isSinglePage)var h=e.currentPageContainers.page;else{var u=e.currentPage;if(1===u||g)var h=e.currentPageContainers.right;else var h=e.currentPageContainers.left}if(h.notes)for(var m=0,p=h.notes.length;p>m;m++){var f=h.notes[m],v=f.noteId;if(g){var M=f.getSubObjectWithRole("note");M&&M.hide()}var b=!MainFrame.Manager.Notes.getById(v);if(b)return MainFrame.EventHandler.dispatch("customError",[{errorMessageId:"emptyNoteOnScreenError"}]),void this.endAndClearAction()}else h.notes=[];if(l){var F=this.getTotalNotesOnDoublePage(e);if(F>=l)return MainFrame.EventHandler.dispatch("maxNotesOnDoublePageError"),void this.endAndClearAction()}var A=MainFrame.Util.createElement("div","v7__elem__note",e.notesContainer),v="note_"+Date.now();A.style.zIndex="1";var g="true"===d.attributes.hasIcon,f=new MainFrame.Abstract.Note({id:t+"_"+v,superObject:e,containerElement:A,data:d});if(f.noteId=v,f.sideIconMode=g,h.notes){var p=h.notes.length;if(g){var P=f.getSubObjectWithRole("icon"),y=f.getDimensionX(),C=P.getDimensionX(),E=e.currentCatalogSize,S=(E.x,E.y),w=E.width,I=this.getParam("paddingY"),x=I?parseInt(I,10):50,D=w-y+C,T=S+x+n*p;1===e.pagesOnScreen&&(D-=w/2)}else var O=f.getPositionX()+r*p,z=f.getPositionY()+n*p,D=O,T=z;f.setPositionX(D),f.setPositionY(T)}if(h.notes.push(f),f.resize(),c){var B=!0;MainFrame.Util.saveNoteText(f,e,"",B)}var k=f.getSubObjectWithId("closeNoteBtn");k.setAction("id:removeNote;params:noteId="+f.noteId);var U=f.getSubObjectWithId("noteText"),R=MainFrame.Util.getMainFrame();MainFrame.Event.bind(U.containerElement,"focus",function(){R.blockResize=!0}),MainFrame.Event.bind(U.containerElement,"blur",function(){R.blockResize=!1}),U.containerElement.focus(),MainFrame.Manager.Scoping.register(t+"_"+f.noteId,f),MainFrame.Util.saveNoteData(f,e,""),this.endAndClearAction()},isNoteAlreadyOnDoublePage:function(e){if(e.isSinglePage){var t=e.currentPage,a="single"===e.settings.pages.coverType;if(a&&1===t&&(t=0),t%2===0){var i=e.currentPageContainers.page;r=e.nextPageContainers.page}else{var i=e.previousPageContainers.page;r=e.currentPageContainers.page}}else var i=e.currentPageContainers.left,r=e.currentPageContainers.right;return i.notes&&i.notes.length>0?!0:r.notes&&r.notes.length>0?!0:!1},getTotalNotesOnDoublePage:function(e){var t=0;if(e.isDoublePage){var a=e.currentPageContainers.left,i=e.currentPageContainers.right;t+=a.notes.length,t+=i.notes.length}return t}}),MainFrame.Action.DrawNotesInContainers=MainFrame.Abstract.Action.extend({startAction:function(){if(MainFrame.Manager.Notes.list)for(var e=this.getParam("containers"),t=e.split("/"),a=this.getTarget(),i=0,r=t.length;r>i;i++){var n=t[i];switch(n){case"next":var s=a.getNextContainer(),o=a.getNextPage();break;case"previous":var s=a.getPreviousContainer(),o=a.getPreviousPage();break;case"current":default:var s=a.getCurrentContainer(),o=a.currentPage}if(a.isValidPageValue(o)){this.clearNotes(s),this.drawNotesForPageInCatalog(o,a,s);var l="2"===a.pagingType&&2===a.orientation;l&&this.drawNotesForPageInCatalog(o+1,a,s)}}this.endAndClearAction()},clearNotes:function(e){if(e.notes)for(var t=e.notes.length,a=0;t>a;a++){var i=e.notes[a];e.removeSubObject(i)}e.notes=[]},drawNotesForPageInCatalog:function(e,t,a){var i=MainFrame.Manager.Notes.getNotesForPage(e),r=t.getPageSize(),n=t.normalSize,s=e%2===1;(1===t.orientation||"1"===t.pagingType)&&(s=!1);for(var o=i.length,l=0;o>l;l++){var c=i[l];""!==c.text&&this.drawNote(c,a,r.pageWidth,r.pageHeight,n.width,n.height,s)}},drawNote:function(e,t){var a=this.getParam("templateId"),i=MainFrame.Util.createElement("div","v7__elem--container",t.centeredDiv),r=MainFrame.Manager.Resource.getById(a),n=new MainFrame.Abstract.Note({superObject:t,containerElement:i,data:r});n.setDimensionX(e.width),n.setDimensionY(e.height),n.note=e;var s=n.getSubObjectWithId("noteText");s.setText(e.text),n.noteId=e.noteId;var o=n.getSubObjectWithId("closeNoteBtn");o.setAction("id:removeNote;params:noteId="+e.noteId),MainFrame.Manager.Scoping.register(a+"_"+e.noteId,n),n.resize();var l=MainFrame.Util.getMainFrame();MainFrame.Event.bind(s.containerElement,"focus",function(){l.blockResize=!0}),MainFrame.Event.bind(s.containerElement,"blur",function(){l.blockResize=!1}),t.notes.push(n)}}),MainFrame.Action.HideNotes=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&(e.notesContainer.style.display="none"),this.endAndClearAction()}}),MainFrame.Action.HideNotesInContainers=MainFrame.Abstract.Action.extend({startAction:function(){if(MainFrame.Manager.Notes.list)for(var e=this.getParam("containers"),t=e.split("/"),a=this.getTarget(),i=0,r=t.length;r>i;i++){var n=t[i];switch(n){case"next":var s=a.getNextContainer();break;case"previous":var s=a.getPreviousContainer();break;case"current":default:var s=a.getCurrentContainer()}this.hideNotesForContainer(s)}this.endAndClearAction()},hideNotesForContainer:function(e){if(e.notes)for(var t=e.notes.length,a=0;t>a;a++){var i=e.notes[a];i.containerElement.style.display="none"}}}),MainFrame.Action.RemoveNote=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("noteId"),t=this.getParam("deleteOrHide")&&"hide"===this.getParam("deleteOrHide")?!0:!1;e&&(t||MainFrame.Manager.Notes.unregisterById(e));var a=this.getTarget();if(a)if(a.isSinglePage){var i=a.currentPageContainers.page;this.removeNoteFromContainer(i,e)}else{var r=a.currentPage,n="single"===a.settings.pages.coverType;n&&1===r&&(r=0);var s=a.currentPageContainers.left,o=a.currentPageContainers.right;this.removeNoteFromContainer(s,e),this.removeNoteFromContainer(o,e)}this.endAndClearAction()},removeNoteFromContainer:function(e,t){if(e.notes){for(var a=!1,i=e.notes.length,r=0;i>r;r++){var n=e.notes[r];n&&n.noteId==t&&(e.notes.splice(r,1),n.superObject.removeSubObject(n),n.sideIconMode&&(a=!0))}this.repositionNotes(e,i)}},repositionNotes:function(e){e.notes&&(this.getTarget(),e.notes.forEach(function(e,t){e.note.noteIndex=t,e.resize()}))}}),MainFrame.Action.RemoveVerticalListNote=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("noteId");e?MainFrame.Manager.Notes.unregisterById(e):MainFrame.Manager.Notes.unregister();var t=this.getParam("notesId");if(t){var a=MainFrame.Manager.Scoping.getById(t);if(!a)return MainFrame.Util.showError("Action.RemoveVerticalListNote error! No notes module found for the id: "+t),void this.endAndClearAction();a.refresh()}this.endAndClearAction()}}),MainFrame.Action.ResizeNote=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=parseInt(this.getParam("minSizeX"),10)||150,i=parseInt(this.getParam("minSizeY"),10)||100,r=parseInt(this.getParam("maxSizeX"),10)||500,n=parseInt(this.getParam("maxSizeY"),10)||400,s=150,o=100,l=1e3,c=1e3;s>a&&(a=s),o>i&&(i=o),r>l&&(r=l),n>c&&(n=c);var d=this.paramsObject.sourceEvent,g=t.getDimensionX(),h=t.getDimensionY(),u=g+d.distanceX,m=h+d.distanceY;u>a&&r>u&&t.setDimensionX(u),m>i&&n>m&&t.setDimensionY(m),t.resize(),this.endAndClearAction()}}),MainFrame.Action.SaveNotePosition=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=!0;do{if("undefined"!=typeof t.noteId){var i=t;a=!1}t=t.superObject}while(t.superObject&&a);if(i){var r=i.getSubObjectWithId("noteText"),n=this.getParam("catalogId"),s=MainFrame.Manager.Scoping.getById(n),o=(i.noteId,r.getText());MainFrame.Util.saveNoteData(i,s,o)}else MainFrame.Util.showError("SaveNoteText error! No valid note found");this.endAndClearAction()}}),MainFrame.Action.SaveNoteText=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=!0;do{if("undefined"!=typeof t.noteId){var i=t;a=!1}t=t.superObject}while(t.superObject&&a);if(i){var r=this.getParam("catalogId"),n=MainFrame.Manager.Scoping.getById(r),s=e.superObject.noteId,o=e.getText(),l="true"===this.getParam("allowEmptyText");if(o){MainFrame.Util.saveNoteText(i,n,o,l);var c="note:"+s+":textChanged";if(MainFrame.Publisher.publish(c,{text:o,id:s}),n.isSinglePage)[n.currentPageContainers.page.notes];else var d=[n.currentPageContainers.left.notes,n.currentPageContainers.right.notes];d.forEach(function(e){e.forEach(function(e){var t=e.getSubObjectWithId("noteText");t&&e.noteId===s&&t.setText(o)})})}else l||MainFrame.Manager.Notes.unregisterById(s)}else MainFrame.Util.showError("SaveNoteText error! No valid note found");this.endAndClearAction()}}),MainFrame.Action.SendNoteToBack=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=!0;if("undefined"!=typeof e.noteId)var i=e;else do{if("undefined"!=typeof t.noteId){var i=t;a=!1}t=t.superObject}while(t.superObject&&a);return"undefined"==typeof i?(MainFrame.Util.showError("Action.SendNoteToBack error! The target object does not have a noteId property!"),void this.endAndClearAction()):(i.containerElement.style.zIndex="",void this.endAndClearAction())}}),MainFrame.Action.ShowMainNote=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=t.getSubObjectWithRole("note"),i=t.superObject;this.hideOtherNotes(i,t),a&&a.show(),this.endAndClearAction()},hideOtherNotes:function(e,t){if(e.isSinglePage){var a=e.currentPageContainers.page;this.hideNotesInContainer(a,t)}else{var i=e.currentPageContainers.right;this.hideNotesInContainer(i,t);var r=e.currentPageContainers.left;this.hideNotesInContainer(r,t)}},hideNotesInContainer:function(e,t){e.notes&&e.notes.forEach(function(e){if(e!==t){var a=e.getSubObjectWithRole("note");a&&a.hide()}})}}),MainFrame.Action.ShowNotes=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&(e.notesContainer.style.display=""),this.endAndClearAction()}}),MainFrame.Action.ShowNotesInContainers=MainFrame.Abstract.Action.extend({startAction:function(){if(MainFrame.Manager.Notes.list)for(var e=this.getParam("containers"),t=e.split("/"),a=this.getTarget(),i=0,r=t.length;r>i;i++){var n=t[i];switch(n){case"next":var s=a.getNextContainer();break;case"previous":var s=a.getPreviousContainer();break;case"current":default:var s=a.getCurrentContainer()}this.showNotesForContainer(s)}this.endAndClearAction()},showNotesForContainer:function(e){if(e.notes)for(var t=e.notes.length,a=0;t>a;a++){var i=e.notes[a];i.containerElement.style.display="block"}}}),MainFrame.Manager.Notes=new MainFrame.Abstract.Manager({id:"notes",hasLocalStorage:!0,hasEventPublishing:!0,customInitList:function(){var e=0;if(this.hasLocalStorage){var t=this.localStorageKey+"_index";e=MainFrame.Util.getItem(t,!1)}this.notesIndex=e&&!isNaN(e)?e:0}}),MainFrame.Manager.Notes.saveList=function(){if(this.hasLocalStorage){MainFrame.Util.saveItem(this.localStorageKey,this.list,!0);var e=this.localStorageKey+"_index";MainFrame.Util.saveItem(e,this.notesIndex,!1)}if(this.hasEventPublishing){var t=this.eventKey+"change";MainFrame.Publisher.publish(t)}},MainFrame.Manager.Notes.getNotesForPage=function(e){var t=[];if(this.list)for(var a in this.list){var i=this.list[a];i.page===e&&t.push(i)}return t},MainFrame.Manager.Notes.orderByPage=function(){var e={},t=[];if(this.list)for(var a in this.list){var i=this.list[a];e[i.page]||(e[i.page]=[],t.push(parseInt(i.page))),e[i.page].push(i)}for(var t=t.sort(function(e,t){return e-t}),r=[],n=0,s=t.length;s>n;n++){var a=t[n];r=r.concat(e[a])}return r},MainFrame.Manager.Notes.groupByPage=function(){var e=[],t=[];for(var a in this.list){var i=this.list[a],r=i.page;-1===t.indexOf(r)&&t.push(r)}return t.sort(),t.forEach(function(t){var a={};a.page=t,a.notes=MainFrame.Manager.Notes.getNotesForPage(t),e.push(a)}),e},MainFrame.Manager.Notes.register=function(e,t){"undefined"!=typeof t&&null!==t?(this.list[e]=t,this.saveList()):MainFrame.Util.showError("Therere is no value to be stored in the manager for the id "+e)},MainFrame.Element.Notes=MainFrame.Abstract.Element.extend({readData:function(e){if(MainFrame.DataParser.parseNotes.call(this,e),this.setLoadingScreen(),this.getTemplate()){var t=this;setTimeout(function(){t.buildNotesList()},200)}},setLoadingScreen:function(){if(this.loadingTemplateId){var e=MainFrame.Manager.Resource.getById(this.loadingTemplateId);if(e){var t=new MainFrame.Element.Resource({superObject:this,data:e});this.loadingTemplate=t}else MainFrame.Util.showError("Notes list error! No loading template found for the id: "+this.loadingTemplateId)}},getTemplate:function(){if(!this.templateId)return MainFrame.Util.showError("Notes list error! The template id was not set!"),!1;var e=MainFrame.Manager.Resource.getById(this.templateId);return e?(this.template=e,!0):(MainFrame.Util.showError('Notes list error! No resource found for the id: "'+this.templateId+'"'),!1)},buildNotesList:function(){var e="manager.notes:change";switch(MainFrame.Publisher.subscribe(e,this,this.onContentUpdated),this.type){case"horizontalList":this.buildHorizontalList();break;case"verticalList":default:this.buildVerticalList()}this.resize()},onContentUpdated:function(){this.refresh()},refresh:function(){switch(this.type){case"horizontalList":this.refreshHorizontalList();break;case"verticalList":default:this.refreshVerticalList()}this.resize()},buildVerticalList:function(){var e=this,t=0,a=0,i=0;for(var r in MainFrame.Manager.Notes.list)i++;if(0===i&&(MainFrame.EventHandler.dispatch("notesNotFound"),a=1),this.groupNotesByPage===!0){var n=MainFrame.Manager.Notes.groupByPage();n.forEach(function(t){var i=new MainFrame.Element.Resource({superObject:e,data:e.template});e.addNoteGroupDataToTemplate(t,i);var r=i.getDimensionY();i.setPositionY(a),a+=r})}else{var s=MainFrame.Manager.Notes.orderByPage();for(var o in s){var l=s[o];if(""!==l.text||this.allowEmptyNotes){var c=new MainFrame.Element.Resource({superObject:this,data:this.template});
this.addNoteDataToTemplate(l,c);var d=c.getDimensionY();c.setPositionY(d*t),c.resize(),t++,a+=d}}}this.loadingTemplate&&this.removeSubObject(this.loadingTemplate),"Desktop"===EnvDetection.deviceType&&(a+=this.superObject.getPositionY(),this.superObject.contentElement.style.overflowY="auto"),this.setDimensionY(a)},buildHorizontalList:function(){var e=this,t=0,a=0,i=0;for(var r in MainFrame.Manager.Notes.list)i++;if(0===i&&(MainFrame.EventHandler.dispatch("notesNotFound"),a=1),this.groupNotesByPage===!0){var n=MainFrame.Manager.Notes.groupByPage();n.forEach(function(t){var i=new MainFrame.Element.Resource({superObject:e,data:e.template});e.addNoteGroupDataToTemplate(t,i);var r=i.getDimensionX();i.setPositionX(a),a+=r})}else{var s=MainFrame.Manager.Notes.orderByPage();for(var o in s){var l=s[o];if(""!==l.text||this.allowEmptyNotes){var c=new MainFrame.Element.Resource({superObject:this,data:this.template});this.addNoteDataToTemplate(l,c);var d=c.getDimensionX();c.setPositionX(d*t),c.resize(),t++,a+=d}}}this.loadingTemplate&&this.removeSubObject(this.loadingTemplate),"Desktop"===EnvDetection.deviceType&&(a+=this.superObject.getPositionX(),this.superObject.contentElement.style.overflowY="auto"),this.setDimensionX(a)},addNoteGroupDataToTemplate:function(e,t){var a,i=this,r=MainFrame.Manager.Scoping.getById(i.catalogId),n=t.getSubObjectWithId("innerNotesList"),s=n.getSubObjectWithId("innerNotesItem"),o=s.data,l=0,c=n.getDimensionY();e.notes.forEach(function(e,c){if(i.addNoteDataToTemplate(e,t),0===c)var d=s;else var d=new MainFrame.Element.Item({superObject:n,data:o});t.noteId=e.noteId;var g=d.getSubObjectWithId("noteListPage"),h=d.getSubObjectWithId("noteListText"),u=d.getSubObjectWithId("noteListDelBtn");if(h.setText(e.text),g){var m=g.getText();if(-1!==m.indexOf("##page")){if("2"===r.API_VERSION)var p=r.pageReferences[e.page],f=p.number;else var f=r.pageNumbers[e.page];m=m.replace("##page",f),g.setText(m)}}u.setAction("id:deleteNote;params:noteId="+e.noteId),d.noteId=e.noteId,h.setAction("id:noteTextActions"),a=a||d.getDimensionY(),d.setPositionY(a*c),l+=a;var v="note:"+e.noteId+":textChanged";MainFrame.Publisher.subscribe(v,d,i.onNoteChange)});var d=t.getSubObjectWithId("notePagePreview");d&&d.setPageNumber(e.page);var g=t.getSubObjectWithId("notePageText");if(g){var h=g.getText();if(-1!==h.indexOf("##page")){var r=MainFrame.Manager.Scoping.getById(this.catalogId);if("2"===r.API_VERSION)var u=r.pageReferences[note.page],m=u.number;else var m=r.pageNumbers[note.page];h=h.replace("##page",m),g.setText(h)}}if(n.setDimensionY(l),l>c){var p=l-c,f=t.getDimensionY(),v=f+p;t.setDimensionY(v)}},onNoteChange:function(e,t){var a=MainFrame.Manager.Scoping.getById("catalog");a.containers.forEach(function(e){e.notes&&e.notes.forEach(function(e){if(e.noteId==t.id){var a=e.getSubObjectWithId("noteText");a.setText(t.text)}})})},addNoteDataToTemplate:function(e,t){var a=t.getSubObjectWithId("noteListText"),i=t.getSubObjectWithId("noteListPage"),r=t.getSubObjectWithId("noteListDelBtn"),n=t.getSubObjectWithId("notePagePreview"),s=t.getSubObjectWithRole("action-target");a&&a.setText(e.text),t.noteId=e.noteId;var o="id:goToNote;params:page="+e.page;if(n.setAction(o),s&&s.setAction(o),i){var l=i.getText();if(-1!==l.indexOf("##page")){var c=MainFrame.Manager.Scoping.getById(this.catalogId);if("2"===c.API_VERSION)var d=c.pageReferences[e.page],g=d.number;else var g=c.pageNumbers[e.page];l=l.replace("##page",g),i.setText(l)}}if(n){n.setPageNumber(e.page);var d=c.pageReferences[e.page],g=d.number;n.altTextPage=g}r&&r.setAction("id:deleteNote;params:noteId="+e.noteId)},refreshVerticalList:function(){this.empty(),this.buildVerticalList()},refreshHorizontalList:function(){this.empty(),this.buildHorizontalList()}}),!function(){var e={getNotePositionAndPage:function(e,t){var a={},i=e.getPositionX(),r=e.getPositionY(),n=t.currentPageSize,s=t.settings.pages.normalSize,o=t.pagesOnScreen,l=100*i/(n.width*o),c=100*r/n.height,d=l*s.width*o/100,g=c*s.height/100,h=t.currentPage,u=d>s.width;return u&&(h+=1,d-=s.width),a.page=h||1,a.x=Math.floor(d),a.y=Math.floor(g),a},saveNoteData:function(e,t,a){var i={};i.catalogId=t.id,i.noteId=e.noteId,i.text=a;var r=MainFrame.Util.getNotePositionAndPage(e,t);i.page=r.page,i.x=r.x,i.y=r.y,i.width=e.getDimensionX(),i.height=e.getDimensionY(),i.sideIconMode=e.sideIconMode,MainFrame.Manager.Notes.register(i.noteId,i),e.note=i,e.containerElement.style.zIndex=""},saveNoteText:function(e,t,a,i){"undefined"==typeof i&&(i=!1);var r=e.noteId,n=MainFrame.Manager.Notes.getById(r),s=""!==a;n&&(s||i)?(n.text=a,MainFrame.Manager.Notes.register(r,n)):MainFrame.Util.saveNoteData(e,t,a)}};MainFrame.Util.extend(MainFrame.Util,e)}(),!function(){MainFrame.DataParser.elements.annotation=MainFrame.Element.Notes}(),!function(){var e={parseProgressBar:function(e){MainFrame.DataParser.basicParse.call(this,e),this.progressAnimationDuration=e.attributes.progressAnimationDuration||"0.6";var t=e.attributes.fillColor||"#FF0000";this.fillColor=MainFrame.Util.processAttribute(t).interpretedString}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.UpdateProgress=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("percentage");e&&e.updateProgress&&e.updateProgress(t),this.endAndClearAction()}}),MainFrame.Action.UpdateProgressFromCatalog=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("catalogId"),a=MainFrame.Manager.Scoping.getById(t);if(e&&a){var i=a.currentPage,r="2"===a.API_VERSION?a.settings.pages.totalPages:a.totalPages,n=2===a.orientation,s="2"===a.API_VERSION?"2"===a.pagingType:a.isDoublePage,o=n&&s&&i+1==r,l=o?100:100*i/r;e.updateProgress(l)}this.endAndClearAction()}}),MainFrame.Element.ProgressBar=MainFrame.Abstract.Element.extend({percentage:0,initialize:function(e){this._initialize(e),this.createProgressIndicator(),this.updateProgress(this.percentage)},readData:function(e){MainFrame.DataParser.parseProgressBar.call(this,e)},createProgressIndicator:function(){var e=MainFrame.Util.createElement("div","",this.contentElement);e.style.backgroundColor=this.fillColor,e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.height="100%",e.style[MainFrame.Browser.vendorPrefix+"TransitionProperty"]="width",e.style[MainFrame.Browser.vendorPrefix+"TransitionDuration"]=this.progressAnimationDuration+"s",this.progressIndicator=e},updateProgress:function(e){this.progressIndicator.style.width=e+"%"}}),!function(){MainFrame.DataParser.elements.progressBar=MainFrame.Element.ProgressBar}(),!function(){var e={parseSearch:function(e){if("true"===e.attributes.active&&"false"!==e.attributes.preload){var t=this.id;MainFrame.DataParser.loadSearchData.call(this,t,e)}else MainFrame.Search.active=!1},loadSearchData:function(e,t,a){if(MainFrame.Search[e]=MainFrame.Search[e]||{},MainFrame.Search[e].highlight="false"===t.attributes.highlight?!1:!0,MainFrame.Search.loadingStarted=!0,MainFrame.Search[e].itemsLoaded=0,MainFrame.Search[e].itemsToLoad=2,a)var i=function(){MainFrame.Search[e].itemsLoaded++,MainFrame.Search.keywordsLoaded=!0,MainFrame.Search[e].itemsLoaded===MainFrame.Search[e].itemsToLoad&&a()};else var i=function(){MainFrame.Search[e].itemsLoaded++,MainFrame.Search.keywordsLoaded=!0};if(MainFrame.Search.textXmlLoaded||(MainFrame.Search.textXmlLoaded=!0,MainFrame.DataParser.getSearchTextXML.call(this,t,i)),!MainFrame.Search.loadingKeywords){MainFrame.Search.loadingKeywords=!0;var r=t.attributes.keywordsPath||MainFrame.Util.getResURL();r=MainFrame.Util.localizePath(r);var n=MainFrame.Util.createElement("script","",document.head);n.onload=i;var s=t.attributes.keywordsName||"Keywords.js",o=MainFrame.Util.getAppURL()+r+s;o=MainFrame.Util.processUrlForCaching(o),n.src=o}},getSearchTextXML:function(e,t){e.attributes.searchTextXMLZipUrl&&MainFrame.Browser.hasBlobSupport&&"undefined"!=typeof zip&&!MainFrame.Browser.isFileProtocol?MainFrame.DataParser.parseSearchTextXMLZipUrl.call(this,e,t):e.attributes.searchTextXMLUrl?MainFrame.DataParser.parseSearchTextXMLUrl.call(this,e,t):MainFrame.Search.textXmlDisabled=!0},parseSearchTextXMLUrl:function(e,t){var a=MainFrame.Util.getAppURL()+e.attributes.searchTextXMLUrl;if(a){var i=this;MainFrame.Util.request({url:a,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(e){MainFrame.DataParser.parseSearchTextXML.call(i,e,i.id),t&&t()}})}},parseSearchTextXMLZipUrl:function(e,t){var a=e.attributes.searchTextXMLZipUrl;if(a){var i=new zip.fs.FS;zip.useWebWorkers=!1;var r=MainFrame.Util.getAppURL()+a;r=MainFrame.Util.localizePath(r);var n=this;i.importHttpContent(r,!1,function(){var e=i.root.children[0];e.getData(new zip.BlobWriter("text/plain"),function(e){var a=new FileReader;a.onload=function(e){var a=e.target.result,i=MainFrame.Util.stringToXML(a),r=i.documentElement;MainFrame.DataParser.parseSearchTextXML.call(n,r,n.id),t&&t()},a.readAsText(e)})},function(){console.log("search text unzip error!")})}},parseSearchTextXML:function(e,t){for(var a={},i=MainFrame.DataParser.getNodesWithNodeName(e,"page"),r=0,n=i.length;n>r;r++){var s=i[r],o=s.attributes.nr,l=s.value;l=MainFrame.Util.removeDiacritics(l),a[o]=l}MainFrame.Search[t]=MainFrame.Search[t]||{};var c=MainFrame.Search[t];c.pageText=a}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.ClearHighlightedKeyword=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(MainFrame.Search[e.id].highlight===!1)return void this.endAndClearAction();if(MainFrame.Search[e.id].highlightedKeyword&&(MainFrame.Search[e.id].highlightedKeyword=null,delete MainFrame.Search[e.id].highlightedKeyword),e.isSinglePage){var t=e.currentPageContainers.page,a=e.nextPageContainers.page,i=e.previousPageContainers.page;e.clearHighlightedTextInContainer(t),e.clearHighlightedTextInContainer(a),e.clearHighlightedTextInContainer(i)}else{var r=e.currentPageContainers.left,n=e.currentPageContainers.right,s=e.nextPageContainers.left,o=e.nextPageContainers.right,l=e.previousPageContainers.left,c=e.previousPageContainers.right;e.clearHighlightedTextInContainer(r),e.clearHighlightedTextInContainer(n),e.clearHighlightedTextInContainer(s),e.clearHighlightedTextInContainer(o),e.clearHighlightedTextInContainer(l),e.clearHighlightedTextInContainer(c)}this.endAndClearAction()}}),MainFrame.Action.GenerateSearchSuggestionFields=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("templateId"),a=MainFrame.Manager.Resource.getById(t);if(e.empty(),a){for(var i,r,n=document.createDocumentFragment(),s=0;10>s;s++){var o=MainFrame.Util.createElement("div","",n);i=new MainFrame.Element.Resource({superObject:e,data:a,containerElement:o}),r=r||i.getDimensionY();var l=s*r;i.setPositionY(l),i.setAction("id:searchSuggestion"),i.hide()}e.contentElement.appendChild(n)}var c=e.getDimensionY(),d=10*r;d-c-e.originalHeight,e.setDimensionY(d),e.resize(),this.endAndClearAction()}}),MainFrame.Action.GenerateSearchSuggestions=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("inputId")),t=this.getParam("minimumLength")||3,a=this.getParam("maximumWords")||3,i=e.getText(),r=i.length;if(this.clearOutputContent(),r>=t){var n=MainFrame.Util.cleanString(i);n=MainFrame.Util.customCleanString(n);var s=-1!==n.indexOf(" ");if(s){var o=n.split(" "),l=" "===n[r-1],c=o.length;if(l&&c--,(a>c||!l)&&MainFrame.Search.textXmlDisabled!==!0){var d={},g="(.*?)[^a-zA-Z0-9-]";if(l){var h=MainFrame.Util.getPagesWithKeywords(o),u=n+"\\s"+g;MainFrame.Util.findSuggestions.call(this,h,u,d),u=n+g,MainFrame.Util.findSuggestions.call(this,h,u,d)}else{var h=MainFrame.Util.getPagesWithKeywords(o.slice(0,-1)),u=n+g;MainFrame.Util.findSuggestions.call(this,h,u,d)}var m=this.sortResultsByRelevance(d);this.showSuggestionsInOutput(m)}}else this.findSuggestionsForSingleKeyword(n)}this.endAndClearAction()},findSuggestionsForSingleKeyword:function(e){e=e.replace(/\\/g,"");var t=MainFrame.SearchTrie.searchWordsBeginningWith(e),a=this.buildResultsFromSuggestions(t);this.showSuggestionsInOutput(a)},clearOutputContent:function(){var e=MainFrame.Manager.Scoping.getById(this.getParam("outputId"));if(e.subObjects&&e.subObjects.length)for(var t=0;10>t;t++){var a=e.subObjects[t];a.hide()}},sortResultsByRelevance:function(e){var t=[];for(var a in e)t.push({keyword:a,occurrences:e[a].length});return MainFrame.Util.sortAndReturnFirstTen(t)},buildResultsFromSuggestions:function(e){for(var t=[],a=0,i=e.length;i>a;a++){var r=e[a],n=MainFrame.Keywords[r],s={};s.keyword=r,s.occurrences=n.length,t.push(s)}return MainFrame.Util.sortAndReturnFirstTen(t)},showSuggestionsInOutput:function(e){for(var t=MainFrame.Manager.Scoping.getById(this.getParam("outputId")),a=this.getParam("templateId"),i=0,r=e.length;r>i;i++){var n=e[i],s=n.keyword,o=t.subObjects[i],l=o.getSubObjectWithRole("search-result")||o.getSubObjectWithId(a+"Text");l?(l.setText(s),o.show()):MainFrame.Util.showError("GenerateSearchSuggestions error! No suggestionTxt element found!")}for(;10>i;i++){var o=t.subObjects[i];o.hide()}}}),MainFrame.Action.GetTextAndSearch=MainFrame.Abstract.Action.extend({startAction:function(){var e=this,t=this.getParam("source")||"catalog",a=(MainFrame.Search[t],MainFrame.Util.getActiveElement());a.blur();var i=this.getParam("outputId"),r=MainFrame.Manager.Scoping.getById(i);r.empty();var n=this.getParam("inputId"),s=MainFrame.Manager.Scoping.getById(n),o=s.getText(),l=MainFrame.Util.cleanString(o);l=MainFrame.Util.customCleanString(l),l.trim();var c=l.split(" "),d=MainFrame.Util.getPagesWithAllKeywords(c);if(MainFrame.Search.textXmlDisabled===!0)if(MainFrame.Keywords[l]){var g=MainFrame.Keywords[l],h=[];g.forEach(function(e){h.push({keyword:l,page:e})});var u=!1;e.displayResults(h,l,u)}else this.setLoadingScreen(),setTimeout(function(){e.displayAlternatives([])},100);else if(d.length){var m=this.findPagesWithExactMatch(d,l);m.length?(this.setLoadingScreen(),setTimeout(function(){var t=new RegExp(l,"igm"),a=e.sortPagesByResultOccurrences(m,t),i=!1;e.displayResults(a,l,i)},100)):(this.setLoadingScreen(),setTimeout(function(){var t=c.join("|"),a=new RegExp(t,"igm"),i=e.sortPagesByResultOccurrences(d,a),r=!0;e.displayResults(i,l,r)},100))}else{var p=MainFrame.Util.getPagesWithKeywords(c);p.length?(this.setLoadingScreen(),setTimeout(function(){var t=c.join("|"),a=new RegExp(t,"igm"),i=e.sortPagesByResultOccurrences(p,a),r=e.generateAlternativeSearches(c),n=e.searchAlternativeExpressions(r),s=!0;e.displayResultsAndAlternatives(i,n,l,s)},100)):(this.setLoadingScreen(),setTimeout(function(){var t=e.generateAlternativeSearches(c),a=e.searchAlternativeExpressions(t);e.displayAlternatives(a)},100))}var f=MainFrame.Util.getMainFrame();f.hasTracking&&MainFrame.Tracker.sendTrackedEvent("810","press",this.initiatorObject,[o]),this.endAndClearAction()},findPagesWithExactMatch:function(e,t){var a=[],i={},r=t;MainFrame.Util.findSuggestions.call(this,e,r,i);for(var n in i)a=a.concat(i[n]);return a},sortPagesByResultOccurrences:function(e,t){for(var a=this.getParam("source")||"catalog",i=MainFrame.Search[a],r=[],n=0,s=e.length;s>n;n++){var o=e[n],l=i.pageText[o],c=l.match(t),d=c?c.length:0;r.push({page:o,occurrences:d});var g=0===d;if(g){var h=(t+"").split("/"),u=h[1];MainFrame.Util.warn('The keyword "'+u+"\" was not found in the page's text. If this isn't a dynamically inserted keyword make sure Keywords.js and text.xml are correct")}}return r.sort(function(e,t){return t.occurrences-e.occurrences}),r},generateAlternativeSearches:function(e){for(var t=[],a=0,i=e.length;i>a;a++){var r=e[a];if(MainFrame.Keywords[r])t.push([r]);else{var n=MainFrame.SearchTrie.searchSimilarWords(r,1);n&&t.push(n)}}var s=MainFrame.Util.cartesian.apply(this,t);return s.map(function(e){return e.join(" ")})},searchAlternativeExpressions:function(e){for(var t={},a=0,i=e.length;i>a;a++){var r=e[a];t[r]=0}var n=this.getParam("source")||"catalog",s=MainFrame.Search[n];for(var o in s.pageText)for(var l=s.pageText[o],a=0,i=e.length;i>a;a++){var r=e[a],c=new RegExp(r,"igm"),d=l.match(c);d&&(t[r]+=d.length)}var g=this.sortResultsByRelevance(t);return g},sortResultsByRelevance:function(e){var t=[];for(var a in e)e[a]&&t.push({keyword:a,occurrences:e[a]});return MainFrame.Util.sortAndReturnFirstTen(t)},displayResults:function(e,t,a){var i=this.getParam("outputId"),r=MainFrame.Manager.Scoping.getById(i),n=this.getParam("source"),s=(MainFrame.Manager.Scoping.getById(n),parseInt(this.getParam("maxChars"),10),this.getParam("highlightColor"),this.getParam("excerptDelimiter"),document.createDocumentFragment());this.addResultsElements(e,t,r,s,0,a),r.superObject.loadingScreen.hide(),Ps.update(r.superObject.contentElement)},displayResultsAndAlternatives:function(e,t,a,i){var r=this.getParam("outputId"),n=MainFrame.Manager.Scoping.getById(r),s=document.createDocumentFragment(),o=0,l=!0;if(l&&t.length){var c=MainFrame.Manager.Resource.getById("searchAlternatives"),d=MainFrame.Util.createElement("div","",s),g=new MainFrame.Element.Resource({superObject:n,data:c,containerElement:d});o=g.getDimensionY();var h=g.getSubObjectWithRole("search-result")||g.getSubObjectWithId("searchAlternativesText"),u=MainFrame.Manager.Text.getById("searchResultWithAlternatives");u=u.replace("##search",'"<span style="font-style: italic;">'+a+'</span>"');var m=[],p=0,f=t.length;for(f=3>=f?f:3;f>p;p++){var v=t[p],M='<span id="suggestions_'+p+'" style="font-weight: bold;">'+v.keyword+"</span>";m.push(M)}var b=this.joinSuggestionsText(m);for(u=u.replace("##suggestions",b),h.setText(u),p=0;f>p;p++){var v=t[p],F=s.getElementById("suggestions_"+p),A=new MainFrame.Element.Item({superObject:h,containerElement:F});A.setAction("id:searchSuggestion;params:suggestion="+v.keyword)}}this.addResultsElements(e,a,n,s,o,i),n.superObject.loadingScreen.hide()},addResultsElements:function(e,t,a,i,r,n){var s,o=this.getParam("source"),l=MainFrame.Manager.Scoping.getById(o),c=MainFrame.Search[o],d=parseInt(this.getParam("maxChars"),10),g=this.getParam("highlightColor"),h=this.getParam("excerptDelimiter"),u=this.getParam("layout")||"vertical",m=this.getParam("maxResults")?parseInt(this.getParam("maxResults"),10):0,p=MainFrame.Manager.Resource.getById("searchResult");if("grid"===u)var f=!0,v=0,M=0;var b=0,F=e.length,A=!1;for(m&&F-b>m&&(F=m,A=!0);F>b;b++){var P=e[b],y=P.page,C=MainFrame.Util.createElement("div","",i),E=new MainFrame.Element.Resource({superObject:a,data:p,containerElement:C});if(s=s||E.getDimensionY(),"vertical"===u){var S=b*s+r;E.setPositionY(S),E.containerElement.style.top=S+"px"}else if("grid"===u){if(f){var w=a.getDimensionX(),I=E.getDimensionX(),x=E.getDimensionY();itemsPerRow=Math.floor(w/I);var D=itemsPerRow*I,T=w-D,O=Math.floor(T/2);f=!1}var z=O+v*I,S=M*x;v++,v===itemsPerRow&&(v=0,M++),E.setPositionX(z),E.setPositionY(S),E.containerElement.style.left=z+"px",E.containerElement.style.top=S+"px"}this.setPageThumb(E,l,y),this.setPageNumber(E,l,y);var B=E.getSubObjectWithRole("search-excerpt")||E.getSubObjectWithId("searchResultExcerpt");if(B){if(MainFrame.Search.textXmlDisabled===!0)var k="";else var k=c.pageText[y];var U=this.setPageExcerptFromData({searchString:t,excerptElement:B,text:k,highlightColor:g,maxChars:d,delimiter:h,searchForKeywords:n,columnIndex:v,rowIndex:M});this.setKeyword(E,U)}E.setAction("id:searchResultGoToPage;params:page="+y+",keyword="+U)}if("grid"===u&&(a.layout="grid"),a.contentElement.appendChild(i),"vertical"===u)var R=b*s+r;else if("grid"===u)var R=s*(M+1);if(A){var Y=this.getParam("moreResultsTemplate")||"searchMoreResultsButton";moreResultsData=MainFrame.Manager.Resource.getById(Y),moreResults=new MainFrame.Element.Resource({id:Y,data:moreResultsData,superObject:a});var _=moreResults.getSubObjectWithRole("action-target");_&&(_._passedParams={results:e,searchString:t,searchForKeywords:n,catalogId:o,maxChars:d,highlightColor:g,excerptDelimiter:h,maxResults:m,layout:u,startingHeight:r},_.setAction("id:loadMoreSearchResults;params:startFrom="+F));var L=moreResults.getSubObjectWithRole("label");if(L){var N=L.getText();N=N.replace("##results",e.length-F),L.setText(N)}var j=moreResults.getDimensionY();moreResults.setPositionY(R),moreResults.containerElement.style.top=R+"px",R+=j}a.setDimensionY(R),a.containerElement.style.height=R+"px","Desktop"===EnvDetection.deviceType&&(a.superObject.contentElement.style.overflowY="auto"),a.superObject.hasSlider&&setTimeout(function(){Ps.update(a.superObject.contentElement)},500)},displayAlternatives:function(e){var t=this.getParam("outputId"),a=MainFrame.Manager.Scoping.getById(t),i=this;setTimeout(function(){i.showSuggestions(a,e)},100)},showSuggestions:function(e,t){var a=document.createDocumentFragment(),i=MainFrame.Manager.Resource.getById("searchNoResult"),r=MainFrame.Util.createElement("div","",a),n=new MainFrame.Element.Resource({id:"searchNoResult",superObject:e,data:i,containerElement:r}),s=t.length?"searchNoResultWithSuggestions":"searchNoResult",o=n.getSubObjectWithRole("search-result")||n.getSubObjectWithId("searchNoResultMessage"),l=MainFrame.Manager.Text.getById(s);o.setText(l);var c=n.getDimensionY(),d=c;if(t.length){var g="searchSuggestion",h=MainFrame.Manager.Resource.getById(g);if(h)for(var u,m,p=0,f=t.length;f>p;p++){var r=MainFrame.Util.createElement("div","",a);u=new MainFrame.Element.Resource({superObject:e,data:h,containerElement:r}),m=m||u.getDimensionY(),d+=m;var v=p*m+c;u.setPositionY(v);var M=u.getSubObjectWithRole("search-result")||u.getSubObjectWithId(g+"Text"),b=t[p];M.setText(b.keyword),u.setAction("id:searchSuggestion;params:suggestion="+b.keyword)}}e.contentElement.appendChild(a),e.setDimensionY(d),e.resize(),"Desktop"===EnvDetection.deviceType&&(e.superObject.contentElement.style.overflowY="auto"),e.superObject.loadingScreen.hide()},setLoadingScreen:function(){var e=this.getParam("outputId"),t=MainFrame.Manager.Scoping.getById(e);if("undefined"==typeof t.superObject.loadingScreen){var a=MainFrame.Manager.Resource.getById("searchLoadingScreen"),i=new MainFrame.Element.Resource({superObject:t.superObject,data:a});i.containerElement.style.zIndex="999",t.superObject.containerElement.appendChild(i.containerElement),t.superObject.loadingScreen=i}else t.superObject.loadingScreen.show()},setPageThumb:function(e,t,a){var i=e.getSubObjectWithRole("search-page-preview")||e.getSubObjectWithId("searchResultPage");if(i){var r="undefined"!=typeof i.setPageNumber;if(r)i.setPageNumber(a);else{var n=MainFrame.Util.createElement("img","v7--centered-image",i.contentElement);if("2"===t.API_VERSION){var s=t.pageReferences[a],o=s.small;i.altTextPage=s.number}else var o=t.commonDataSrc+MainFrame.Util.zeroFill(a)+"v.jpg";n.src=MainFrame.Util.getAppURL()+o}}},setPageNumber:function(e,t,a){var i=e.getSubObjectWithRole("search-page")||e.getSubObjectWithId("searchResultPageNumber");if("2"===t.API_VERSION)var r=t.pageReferences[a],n=r.number;else var s=t.getContainerForCustomPage(a),n=t.pageNumbers[s]+"";i.setText(n)},setKeyword:function(e,t){var a=e.getSubObjectWithRole("search-keyword");a&&a.setText(t)},setPageExcerptFromData:function(e){var t=e.text,a=t.toLowerCase(),i=e.delimiter||"[...]",r=2*i.length,n=e.maxChars||50,s=e.highlightColor||"#FF0000",o=e.excerptElement,l=e.searchString,c=e.searchForKeywords;l=l.replace("\\","");var d=a.indexOf(l);if(-1!==d&&(c=!1),c){for(var g="[...]",h=!1,u=l.split(" "),m=0,p=u.length;p>m;m++){var f=u[m],v=' <span style="color: '+s+'; font-weight: bold;">'+f+"</span> ",d=a.indexOf(f);if(-1!==d){h=!0;var M=t.substr(d-15,15),b=t.substr(d+15,15),F=M.trim().split(" "),A=F.length,P=F[A-1],y=b.split(" "),C=y[0];g+=P+v+C,g+="[...]"}}h||(g+=v+"[...]")}else{var P,C,E=(parseInt(n,10)-l.length-r)/2;P=t.substr(d-E,E),C=t.substr(d+l.length,E);var g=P+' <span style="color: '+s+'; font-weight: bold;">'+l+"</span> "+C;g=i+g+i}return o.setText(g),f||l||""},joinSuggestionsText:function(e){if(1===e.length)return e[0];var t=e.pop(),a=MainFrame.Manager.Text.getById("or")||", ";return e.join(", ")+" "+a+" "+t}}),MainFrame.Action.HighlightKeyword=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(MainFrame.Search.active===!1||MainFrame.Search[e.id].highlight===!1)return void this.endAndClearAction();var t=this.getParam("page");t="initiatorsGoToPage"===t?this.initiatorObject.goToPage:"lastPage"===t?e.settings.pages.totalPages:null==t||"undefined"==typeof t||""===t?e.currentPage:parseInt(t,10);var a=this.getParam("keyword"),e=this.getTarget(),i="false"===this.getParam("persistent")?!1:!0;if(a)this.highlightedKeyword=a,i&&(MainFrame.Search[e.id].highlightedKeyword=a);else if(i){if(!MainFrame.Search[e.id].highlightedKeyword)return void this.endAndClearAction();this.highlightedKeyword=MainFrame.Search[e.id].highlightedKeyword}if(e.isSinglePage)this.highlight(t);else{var t=parseInt(t),r=t%2===0;if(r)var n=t,s=t+1;else var n=t-1,s=t;n>0&&this.highlight(n),s<=e.settings.pages.totalPages&&this.highlight(s)}},highlight:function(e){var t=this,a=MainFrame.Util.zeroFill(e),i=MainFrame.Util.getAppURL()+"common/data/"+a+".tetml";MainFrame.Util.request(MainFrame.Browser.isFileProtocol?{url:i,onSuccess:function(a){a?t.initHighlighting.call(t,a,e):(MainFrame.Util.showError('Highlight error! "'+i+'" is not valid'),t.endAndClearAction())}}:{url:i,xmlResponse:!1,onSuccess:function(a){if(a){var r=new DOMParser,n=r.parseFromString(a,"text/xml"),s=n.documentElement,a=MainFrame.DataParser.parseXml(s);t.initHighlighting.call(t,a,e)}else MainFrame.Util.showError('Highlight error! "'+i+'" is not valid'),t.endAndClearAction()}})},initHighlighting:function(e,t){for(var a=this.extractWords(e),i=(this.getTarget(),this.highlightedKeyword),r=i.split(" "),n=0,s=r.length;s>n;n++){var o=r[n];if(a[o])for(var l=0,c=a[o].length;c>l;l++){var d=a[o][l];this.highlightKeyword(d,t)}}this.endAndClearAction()},extractWords:function(e){for(var t=this.getPageSize(e),a={},i=MainFrame.DataParser.getNodesWithNodeName(e,"Word"),r=0,n=i.length;n>r;r++){var s=i[r],o=MainFrame.DataParser.getNodesWithNodeName(s,"Text")[0],l=MainFrame.DataParser.getNodesWithNodeName(s,"Box")[0],c={},d=o.value;cleanText=MainFrame.Util.cleanString(d),wordBoxSize=this.getWordBoxSize(l,t),c.x=wordBoxSize.x,c.y=wordBoxSize.y,c.width=wordBoxSize.width,c.height=wordBoxSize.height,"undefined"==typeof a[cleanText]&&(a[cleanText]=[]),this.wordNotDuplicate(a[cleanText],c)&&a[cleanText].push(c)}return a},wordNotDuplicate:function(e,t){for(var a=!0,i=0,r=e.length;r>i;i++){var n=e[i];if(Math.round(100*n.x)/100===Math.round(100*t.x)/100&&Math.round(100*n.y)/100===Math.round(100*t.y)/100&&Math.round(100*n.width)/100===Math.round(100*t.width)/100&&Math.round(100*n.height)/100===Math.round(100*t.height)/100)return!1}return a},getPageSize:function(e){var t={},a=e.attributes.trimbox,i=a.split("|"),r=parseFloat(i[0],10),n=parseFloat(i[1],10),s=parseFloat(i[2],10),o=parseFloat(i[3],10),l=e.attributes.cropbox,c=l.split("|"),d=parseFloat(c[0],10),g=parseFloat(c[1],10);return t.width=s-r,t.height=o-n,t.xCorrection=r-d,t.yCorrection=n-g,t},getWordBoxSize:function(e,t){var a=this.getParam("heightPadding");a=a?parseInt(a,10):2;var i={},r=parseFloat(e.attributes.llx,10),n=parseFloat(e.attributes.lly,10),s=parseFloat(e.attributes.urx,10),o=parseFloat(e.attributes.ury,10),l=r,c=o,d=s,g=n,h=r>s&&n>o,u=r>s&&o>n;h?(l=s,d=r):u&&(c=n,g=o);var m=l-t.xCorrection,p=c-t.yCorrection,f=d-m-t.xCorrection,v=g-p-t.yCorrection;v+=a;var M=100/t.width,b=100/t.height,F=m*M,A=p*b,P=f*M,y=v*b;return i.x=F,i.y=A,i.width=P,i.height=y,i},highlightKeyword:function(e,t){var a=this.getCatalogContainer(t),i=this.getParam("animated"),r="v7__keyword-highlight";"true"===i&&(r+=" v7-anim-effect-pulse");var n=MainFrame.Util.createElement("div",r,a),s=e.x,o=e.y,l=e.width,c=e.height;if(e.width<0||e.height<0){var d=this.getParam("keyword");MainFrame.Util.warn('The keyword "'+d+'" was highlighted but seems to have negative sizes so it will not be visible.')}n.style.left=s+"%",n.style.top=o+"%",n.style.width=l+"%",n.style.height=c+"%";var g=this.getParam("color"),h=this.getParam("opacity");g&&(n.style.backgroundColor=g),h&&(n.style.opacity=h)},getCatalogContainer:function(e){var t=this.getTarget();if(t.isSinglePage)return t.currentPageContainers.page.highlight;var a="single"===t.settings.pages.coverType,i=a?e%2===0:t.isLeftPage(e);return i?t.currentPageContainers.left.highlight:t.currentPageContainers.right.highlight}}),MainFrame.Action.LoadSearch=MainFrame.Abstract.Action.extend({startAction:function(){if(MainFrame.Search.loadingStarted)this.endAndClearAction();else{var e=this.getParam("source"),t=MainFrame.Manager.Scoping.getById(e),a=t.settingsId,i=MainFrame.Manager.Settings.getById(a),r=MainFrame.DataParser.getNodeNamed(i,"search");MainFrame.DataParser.loadSearchData.call(t,e,r,this.searchLoadedCallback.bind(this))}},searchLoadedCallback:function(){this.endAndClearAction()}}),MainFrame.Action.LoadMoreSearchResults=MainFrame.Action.GetTextAndSearch.extend({startAction:function(){var e=this.initiatorObject,t=this.getTarget();passedParams=e._passedParams,t.superObject.loadingScreen.show();var a=passedParams.results,i=passedParams.searchString,r=passedParams.searchForKeywords,n=this;setTimeout(function(){n.addResultsElements(a,i,t,r),t.superObject.loadingScreen.hide(),n.endAndClearAction()},200)},addResultsElements:function(e,t,a,i){var r=document.createDocumentFragment(),n=this.initiatorObject,s=n._passedParams,o=s.catalogId,l=MainFrame.Manager.Scoping.getById(o),c=MainFrame.Search[o],d=s.maxChars,g=s.highlightColor,h=s.excerptDelimiter,u=s.layout,m=s.maxResults,p=s.startingHeight,f=this.getParam("startFrom")?parseInt(this.getParam("startFrom"),10):0;this.removeExistingMoreButton(a);var v=MainFrame.Manager.Resource.getById("searchResult");if("grid"===u)var M=a.subObjects[0],b=a.getDimensionX(),F=M.getDimensionX(),A=M.getDimensionY(),P=Math.floor(b/F),y=P*F,C=b-y,E=Math.floor(C/2),S=a.subObjects.length,w=Math.floor(S/P),I=S-w*P;else if("vertical"===u)var M=a.subObjects[0],A=M.getDimensionY();var x=f,D=e.length,T=!1;for(m&&D-x>m&&(D=x+m,T=!0);D>x;x++){var O=e[x],z=O.page,B=MainFrame.Util.createElement("div","",r),M=new MainFrame.Element.Resource({superObject:a,data:v,containerElement:B}),k=A;if("vertical"===u){var U=x*k+p;M.setPositionY(U),M.containerElement.style.top=U+"px"}else if("grid"===u){var R=E+I*F,U=w*A;I++,I===P&&(I=0,w++),M.setPositionX(R),M.setPositionY(U),M.containerElement.style.left=R+"px",M.containerElement.style.top=U+"px"}this.setPageThumb(M,l,z),this.setPageNumber(M,l,z);var Y=M.getSubObjectWithRole("search-excerpt")||M.getSubObjectWithId("searchResultExcerpt");if(Y){if(MainFrame.Search.textXmlDisabled===!0)var _="";else var _=c.pageText[z];var L=this.setPageExcerptFromData({searchString:t,excerptElement:Y,text:_,highlightColor:g,maxChars:d,delimiter:h,searchForKeywords:i,startingHeight:p});this.setKeyword(M,L)}M.setAction("id:searchResultGoToPage;params:page="+z+",keyword="+L)}if("grid"===u&&(a.layout="grid"),a.contentElement.appendChild(r),"vertical"===u)var N=x*k+p;else if("grid"===u)var N=k*(w+1);if(T){var j=this.getParam("moreResultsTemplate")||"searchMoreResultsButton",X=MainFrame.Manager.Resource.getById(j),H=new MainFrame.Element.Resource({id:j,data:X,superObject:a}),Q=H.getSubObjectWithRole("action-target");Q&&(Q._passedParams={results:e,searchString:t,searchForKeywords:i,catalogId:o,maxChars:d,highlightColor:g,excerptDelimiter:h,maxResults:m,layout:u,startingHeight:p},Q.setAction("id:loadMoreSearchResults;params:startFrom="+D));var W=H.getSubObjectWithRole("label");if(W){var Z=W.getText();Z=Z.replace("##results",e.length-D),W.setText(Z)}var V=H.getDimensionY();H.setPositionY(N),H.containerElement.style.top=N+"px",N+=V}a.setDimensionY(N),a.containerElement.style.height=N+"px",a.superObject.hasSlider&&setTimeout(function(){Ps.update(a.superObject.contentElement)},500)},removeExistingMoreButton:function(e){var t=this.getParam("moreResultsTemplate")||"searchMoreResultsButton",a=MainFrame.Manager.Scoping.getById(t);a&&e.removeSubObject(a)
}}),MainFrame.Action.RemoveOverflow=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e.contentElement.style.overflowY="",e.contentElement.style.overflowX="",this.endAndClearAction()}}),MainFrame.Action.SetSearchSuggestion=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("suggestion");if(!e){var t=this.getParam("templateId"),a=this.initiatorObject,i=a.getSubObjectWithRole("search-result")||a.getSubObjectWithId(t+"Text");e=i.getText()}var r=this.getTarget();r.setText(e),this.endAndClearAction()}}),!function(){var e={cleanString:function(e){if(e){var t=e.toLowerCase();t=MainFrame.Util.removeDiacritics(t);var a=/(\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\[|\]|\{)/g;return t=t.replace(a,function(e){return"\\"+e})}return""},customCleanString:function(e){return e},getPagesWithKeywords:function(e){for(var t=[],a=0,i=e.length;i>a;a++){var r=e[a],n=MainFrame.Keywords[r];n&&t.push(n)}return t.length?MainFrame.Util.arrayMultiIntersection.apply(this,t):[]},getPagesWithAllKeywords:function(e){for(var t=[],a=0,i=e.length;i>a;a++){var r=e[a];r=r.replace(/\\/g,"");var n=MainFrame.Keywords[r];if(!n)return[];t.push(n)}return MainFrame.Util.arrayMultiIntersection.apply(this,t)},findSuggestions:function(e,t,a){for(var i=this.getParam("source")||"catalog",r=MainFrame.Search[i],n=0,s=e.length;s>n;n++){var o=e[n],l=r.pageText[o],c=new RegExp(t,"igm"),d=l.match(c);MainFrame.Util.insertMatchesInResults(d,o,a)}},insertMatchesInResults:function(e,t,a){if(e)for(var i=0,r=e.length;r>i;i++){var n=e[i];n=n.toLowerCase().trim(),a[n]||(a[n]=[]),-1===a[n].indexOf(t)&&a[n].push(t)}},sortAndReturnFirstTen:function(e){return e.sort(function(e,t){return t.occurrences-e.occurrences}),e.splice(0,10)}};MainFrame.Util.extend(MainFrame.Util,e)}(),MainFrame.SearchTrie=new MainFrame.Abstract.Trie,MainFrame.SearchTrie.init=function(e){this.mainTrie=new MainFrame.Abstract.Trie.Node;for(var t in e)this.insertWord(this.mainTrie,t);this.isInitialized=!0},MainFrame.Action.BaseShare=MainFrame.Abstract.Action.extend({startAction:function(){this.endAndClearAction()},getShareURL:function(e){var t=MainFrame.Util.getMainFrame();return t.sharingSettings&&t.sharingSettings.types[e]?t.sharingSettings.types[e]:this.getDefaultURL()},getDefaultURL:function(){if("undefined"!=typeof V7){var e=V7.getBaseUrl(),t=V7.getIndex();return e+t}return window.location.href}}),MainFrame.Action.SendMail=MainFrame.Abstract.Action.extend({startAction:function(){var e="mailto:";if(this.getParam("to")&&(e+=this.getParam("to")),e+="?",this.getParam("cc")&&(e+="cc="+this.getParam("cc")+"&"),this.getParam("subject")){var t=this.getParam("subject"),a=MainFrame.Manager.Text.getById(t);e+="subject="+a+"&"}if(this.getParam("body")){var i=this.getParam("body"),r=MainFrame.Manager.Text.getById(i);r=MainFrame.Util.replaceSharingKeywords(r,"mail"),e+="body="+r+"&"}var n=document.createElement("a");n.href=e,n.target="_blank";var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),n.dispatchEvent(s),this.endAndClearAction()}}),MainFrame.Action.SendMailFromForm=MainFrame.Abstract.Action.extend({startAction:function(){this.prefix=this.getParam("formPrefix")||"stf";var e=this.getFormContainer();if(e&&e.subObjects){var t=this.extractInputItemsFromTarget(e);if(!this.validateInputItems(t))return void this.endAndClearAction();var a=this.getMailParams(t),i=this.getParam("url"),r=this.getParam("mailSentTrigger")||"mailSentFromForm",n=this.getParam("mailNotSentTrigger")||"mailNotSentFromForm";MainFrame.Util.request({method:"POST",formDataParams:a,url:i,onSuccess:function(e){MainFrame.EventHandler.dispatch(-1!==e.indexOf("sendResult=true")?r:n)},onError:function(){MainFrame.EventHandler.dispatch(n)}})}else MainFrame.Util.showError("SendMailFromForm error! Invalid target");this.endAndClearAction()},getFormContainer:function(){var e=this.getParam("containerId");if(e)return MainFrame.Manager.Scoping.getById(e);var t=this.getTarget();return t?t:null},extractInputItemsFromTarget:function(e){for(var t=[],a=0,i=e.subObjects.length;i>a;a++){var r=e.subObjects[a],n="input"===r.txtType,s=r.data&&"select"===r.data.nodeName,o="textarea"===r.txtType,l=(n||o)&&0===r.id.indexOf(this.prefix);if(l){var c=this.getInputDataFromItem(r);t.push(c)}else if(s){var d=this.getSelectDataFromItem(r);t.push(d)}if(r.subObjects){var g=this.extractInputItemsFromTarget(r);g.forEach(function(e){t.push(e)})}}return t},getInputDataFromItem:function(e){var t={},a=e.id,i=this.getFieldNameFromId(a);t.fieldName=i;var r=e.role||"";-1!==r.indexOf("required")&&(t.required=!0),e.isRequired&&(t.required=!0),-1!==r.indexOf("email")&&(t.isEmail=!0),e.emailValidation&&(t.isEmail=!0),-1!==r.indexOf("numeric")&&(t.isNumeric=!0);var n=e.getText();return t.value=n,t.item=e,t},getSelectDataFromItem:function(e){var t={},a=e.id,i=this.getFieldNameFromId(a);t.fieldName=i;var r=e.role||"";-1!==r.indexOf("required")&&(t.required=!0),e.isRequired&&(t.required=!0);var n=e.getValue();return t.value=n,t.item=e,t},extractCheckboxItemsFromTarget:function(e){for(var t=[],a=0,i=e.subObjects.length;i>a;a++){var r=e.subObjects[a],n="undefined"!=typeof r.isChecked&&0===r.id.indexOf(this.prefix);if(n){var s=this.getCheckboxDataFromItem(r);t.push(s)}else if(r.subObjects){var o=this.extractCheckboxItemsFromTarget(r);o.forEach(function(e){t.push(e)})}}return t},getCheckboxDataFromItem:function(e){var t={},a=e.id,i=this.getFieldNameFromId(a);t.fieldName=i;var r=e.isChecked();return t.checked=r,t},getFieldNameFromId:function(e){return-1!==e.indexOf(this.prefix+"_")?e.replace(this.prefix+"_",""):e.replace("stfInput","").toLowerCase()},validateInputItems:function(e){for(var t=this.getParam("formErrorEvent")||"sendMailFormError",a="true"===this.getParam("disableErrorTriggers")?!0:!1,i="false"===this.getParam("changeBorders")?!1:!0,r=this.getParam("borderColor")||"#ff0000",n=this.getParam("defaultBorderColor")||"",s="true"===this.getParam("changeBackground")?!0:!1,o=this.getParam("backgroundColor")||"#ffdfd6",l=this.getParam("defaultBackgroundColor")||"",c="true"===this.getParam("changeLabel")?!0:!1,d=this.getParam("labelColor")||"#ffdfd6",g=this.getParam("defaultLabelColor")||"#000",h=0,u=e.length;u>h;h++){var m=e[h];if(i&&(m.item.containerElement.style.borderColor=n),s&&(m.item.containerElement.style.backgroundColor=l),c){var p=m.item.id,f="label_"+p,v=MainFrame.Manager.Scoping.getById(f);v&&(v.containerElement.style.color=g)}var M=!m.value&&m.required,b=m.isEmail&&!MainFrame.Util.isValidEmailAddress(m.value),F=m.isNumeric&&!MainFrame.Util.isNumeric(m.value);if(M||b||F){var A=M?"empty":"invalid";return a||MainFrame.EventHandler.dispatch(t,[{errorMessageId:t+"_"+A+"_"+m.fieldName}]),i&&(m.item.containerElement.style.borderColor=r),s&&(m.item.containerElement.style.backgroundColor=o),c&&v&&(v.containerElement.style.color=d),!1}}return!0},getMailParams:function(e){var t=this.getXmlOutput(e),a=MainFrame.Util.getDefaultLanguage(),i={};i.xmloutput=t,i.lang=a;for(var r=0,n=e.length;n>r;r++){var s=e[r];i[s.fieldName]=s.value}return i},getXmlOutput:function(e){var t=MainFrame.Util.getBaseUrl();if("undefined"!=typeof V7&&V7.getUrlRequest)var a=V7.getUrlRequest();else var a=t;var i=MainFrame.Util.getMainFrame(),r=t;if(this.getParam("finurl"))r=this.getParam("finurl");else if(i.sharingSettings&&i.sharingSettings.types.mail){var n=i.sharingSettings.types.mail;-1===n.indexOf("http")?r+=n:r=n}else if(i.sharingSettings&&i.sharingSettings.types["default"]){var s=i.sharingSettings.types["default"];-1===s.indexOf("http")?r+=s:r=s}else r+="undefined"!=typeof V7&&V7.getIndex?V7.getIndex():"index.html";var o=this.getParam("oldVersion");"true"===o&&(a=a.replace("/html5/","/"),r=r.replace("/html5/","/"));var l='<?xml version="1.0" encoding="utf-8"?>';l+="<sendtofriend>",l+="<urlrequest><![CDATA["+a+"]]></urlrequest>",l+="<finurl><![CDATA["+r+"]]></finurl>";var c=this.getParam("lang");l+="<lang><![CDATA["+c+"]]></lang>";var d="false"===this.getParam("sendPage")?!1:!0;if(d){var g=this.getPageValue();l+="<page><![CDATA["+g+"]]></page>"}for(var h=0,u=e.length;u>h;h++){var m=e[h];l+="<"+m.fieldName+"><![CDATA["+m.value+"]]></"+m.fieldName+">"}return l+=this.getCheckboxBasedContent(),l+="</sendtofriend>"},getCheckboxBasedContent:function(){var e="",t=this.getFormContainer(),a=this.extractCheckboxItemsFromTarget(t);if(a.length)for(var i=this.getParam("catalogId")||"catalog",r=MainFrame.Manager.Scoping.getById(i),n="undefined"!=typeof MainFrame.Manager.Bookmarks?MainFrame.Manager.Bookmarks.list:{},s="undefined"!=typeof MainFrame.Manager.Notes?MainFrame.Manager.Notes.list:{},o=0,l=a.length;l>o;o++){var c=a[o];if(c.checked)switch(c.fieldName){case"pagemarks":e+="<pagemarks>";var d=[];for(var g in n)d.push(g);e+=d.join(","),e+="</pagemarks>";break;case"annotations":var h=r.settings.pages.offset;e+="<annotations>",e+="<offset>"+h+"</offset>";for(var u in s){var m=s[u],p=m.page,f=r.pageReferences[p],v=f.number;e+='<page id="'+p+'" displayPage="'+v+'">',e+="<annotation><![CDATA["+m.text+"]]></annotation>",e+="</page>"}e+="</annotations>";break;default:e+="<"+c.fieldName+">"+c.checked+"</"+c.fieldName+">"}}return e},getPageValue:function(){var e=this.getParam("catalogId")||"catalog",t=MainFrame.Manager.Scoping.getById(e);if(t){var a=t.currentPage,i=t.getHashPageString(a);return i}}}),MainFrame.Action.ShareFacebook=MainFrame.Action.BaseShare.extend({startAction:function(){var e="http://www.facebook.com/sharer.php?u=",t=this.getParam("url");if(t){if("facebookPage"===t){if(this.getParam("baseUrl"))var a=this.getParam("baseUrl");else if("undefined"!=typeof V7&&V7.getBaseUrl)var a=V7.getBaseUrl();else var a="";var i=this.getParam("facebookFilesPath");(null===i||"undefined"==typeof i)&&(i="common/data/");var r=this.getPageValue();t=a+i+r+".html"}else"location"===t&&(t=location.href);e+=t}else e+=this.getShareURL("facebook");window.open(e,"_blank"),this.endAndClearAction()},getPageValue:function(){var e=this.getParam("catalogId")||"catalog",t=MainFrame.Manager.Scoping.getById(e);if(t){var a=t.currentPage,i=t.getHashPageString(a);return i}}}),MainFrame.Action.ShareFacebookFeed=MainFrame.Abstract.Action.extend({startAction:function(){var e="https://www.facebook.com/dialog/feed?";params=["app_id","link","picture","name","caption","description","redirect_uri"];for(var t=0,a=params.length;a>t;t++)if(this.getParam(params[t])){var i=this.getParam(params[t]);switch(params[t]){case"name":case"caption":case"description":i=MainFrame.Manager.Text.getById(i)}e+=params[t]+"="+i+"&"}window.open(e,"_blank"),this.endAndClearAction()}}),MainFrame.Action.ShareGooglePlus=MainFrame.Action.BaseShare.extend({startAction:function(){var e="https://plus.google.com/share?url=";e+=this.getParam("url")?this.getParam("url"):this.getShareURL("google"),window.open(e,"_blank"),this.endAndClearAction()}}),MainFrame.Action.ShareLinkedIn=MainFrame.Action.BaseShare.extend({startAction:function(){for(var e="http://www.linkedin.com/shareArticle?mini=true&",t=["url","title","summary","source"],a=0,i=t.length;i>a;a++){var r=t[a],n=this.getParam(r);if(n){switch(r){case"url":"current"===n?n=window.location.href:n||(n=this.getShareURL("linkedin")),n=encodeURIComponent(n);break;case"title":case"summary":case"source":n=MainFrame.Manager.Text.getById(n),n&&(n=MainFrame.Util.replaceSharingKeywords(n))}n&&(e+=r+"="+n+"&")}}window.open(e,"_blank"),this.endAndClearAction()}}),MainFrame.Action.SharePinterest=MainFrame.Action.BaseShare.extend({startAction:function(){var e="http://pinterest.com/pin/create/button/?",t=["url","media","description"],a=[],i=this.getParam("catalogId")||"catalog",r=MainFrame.Manager.Scoping.getById(i),n=this;t.forEach(function(e){var t=n.getParam(e);switch(e){case"url":t||(t=n.getShareURL("pinterest")),t=encodeURIComponent(t);break;case"description":t=t||"pinterestDescription",t=MainFrame.Manager.Text.getById(t),t&&(t=MainFrame.Util.replaceSharingKeywords(t),t=encodeURIComponent(t));break;case"media":var i=MainFrame.Util.getBaseUrl();if(t)if("currentPage"===t){var s=r.currentPage;0===s&&(s=1),t=i+MainFrame.Global.initializationVariables.appFolder+"/data/"+MainFrame.Util.zeroFill(s)+".jpg"}else{var o=-1===t.indexOf("http://");o&&(t=i+t)}else t=i+r.commonUrl+"0001v.jpg"}if(t){var l=e+"="+t;a.push(l)}}),e+=a.join("&"),window.open(e,"_blank"),this.endAndClearAction()}}),MainFrame.Action.ShareTwitter=MainFrame.Action.BaseShare.extend({startAction:function(){var e="https://twitter.com/intent/tweet?source=webclient&text=",t="https://api-ssl.bit.ly/v3/shorten",a="false"===this.getParam("addLinkToCatalog")?!1:!0,i=window.location.href,r=this.getParam("text");if(r){var n=MainFrame.Manager.Text.getById(r);n&&(n=MainFrame.Util.replaceSharingKeywords(n),e+=n)}var s=this.getParam("textId");if(s){var n=MainFrame.Manager.Text.getById(s);n&&(n=MainFrame.Util.replaceSharingKeywords(n),e+=n)}var o=this.getParam("url");i=o?o:this.getShareURL("twitter"),a===!1&&(i=""),MainFrame.Util.request({method:"GET",params:{login:"bogdanmihalcea",apiKey:"R_a313023407eb627e268c73d32e0ba632",longUrl:i,format:"json"},url:t,asynchronous:!1,onSuccess:function(t){t=JSON.parse(t),200==t.status_code?window.open(e+" "+t.data.url,"_blank"):window.open(e+" "+i,"_blank")},onError:function(){window.open(e+" "+i,"_blank")}}),this.endAndClearAction()}}),MainFrame.Action.ShareViadeo=MainFrame.Action.BaseShare.extend({startAction:function(){var e="http://www.viadeo.com/shareit/share/?";params=["url","media","description"];for(var t=0,a=params.length;a>t;t++)if(this.getParam(params[t])){var i=this.getParam(params[t]);switch(params[t]){case"url":i||(i=this.getShareURL("viadeo")),i=encodeURIComponent(i);break;case"description":i=MainFrame.Manager.Text.getById(i),i&&(i=MainFrame.Util.replaceSharingKeywords(i))}e+=params[t]+"="+i+"&"}window.open(e,"_blank"),this.endAndClearAction()}}),!function(){var e={replaceSharingKeywords:function(e,t){if(-1!==e.indexOf("##location"))if("mail"===t){var a=window.location.href+"#ref=mail";e=e.replace("##location",a)}else e=e.replace("##location",window.location.href);return e}};MainFrame.Util.extend(MainFrame.Util,e)}(),!function(){var e={parseSlider:function(e){if(e.attributes.target){this.targetModule=MainFrame.Manager.Scoping.getById(e.attributes.target);var t=this.targetModule;this.currentPage=t.currentPage,this.totalPages=t.settings.pages.totalPages}e.attributes.trigger&&(this.changeTrigger=e.attributes.trigger),e.attributes.action&&(this.actionString=e.attributes.action),MainFrame.DataParser.basicParse.call(this,e)},parseSliderIndicator:function(e){e.attributes.id&&(this.superObject.indicatorId=e.attributes.id),MainFrame.DataParser.basicParse.call(this,e)}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.DragEndSlider=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e.superObject.synchronizePages(),this.endAndClearAction()}}),MainFrame.Action.DragEndSliderAndHidePageIndicator=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e.superObject.synchronizePages();var t=MainFrame.Util.getMainFrame();t.pageIndicator&&t.pageIndicator.setVisible(!1),MainFrame.EventHandler.dispatch("dragEndSlider",[e.superObject]),this.endAndClearAction()}}),MainFrame.Action.DragSlider=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getTarget(),a=parseInt(t.getPositionX(),10)+e.distanceX+"";t.positionX=a,t.containerElement.style.left=a+"px",t.adjustPage(),this.endAndClearAction()}}),MainFrame.Action.DragSliderAndShowPageIndicator=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getTarget(),a=parseInt(t.getPositionX(),10)+e.distanceX+"",i=t.superObject,r=t.getDimensionX(),n=i.getPositionX(),s=i.getDimensionX();n>a&&(a=n),a>s-r&&(a=s-r),t.setPositionX(a),t.containerElement.style.left=a+"px",t.adjustPage();var o=MainFrame.Util.getMainFrame();if(o.pageIndicator){var l=o.pageIndicator,c=5,d=t.getDistanceToTop(),g=t.getDistanceToLeft(),h=g-l.getDimensionX()/2+t.getDimensionX()/2,u=d-l.getDimensionY()-c;0>h&&(h=0),h+l.getDimensionX()>MainFrame.Browser.width&&(h=MainFrame.Browser.width-l.getDimensionX()),l.setPositionX(h),l.setPositionY(u),l.resize()}this.endAndClearAction()}}),MainFrame.Action.MoveSliderToPagePosition=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=e.superObject,a=t.targetModule,i=a.currentPage;if(e.isDragged)this.endAndClearAction();else{t.currentPage=i;var r=t.calculatePageForPosition(),n=i!==r,s="landscape"===a.orientation&&"double"==a.settings.pages.catalogType,o="portrait"===a.orientation||"single"==a.settings.pages.catalogType,l=r%2===1?r-1===i:!1;if(n&&(s&&!l||o)){var c=t.calculatePositionForPage(i);e.setPositionX(c),e.containerElement.style.left=c+"px"}this.endAndClearAction()}}}),MainFrame.Action.MoveSliderToPosition=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("sourceEvent"),t=this.getTarget();t.positionX=e.eventData.pageX+"",t.adjustPage(),t.superObject.synchronizePages(),t.positionX=e.eventData.pageX+"",t.containerElement.style.left=e.eventData.pageX+"px",this.endAndClearAction()}}),MainFrame.Action.ShowSliderPageIndicator=MainFrame.Abstract.Action.extend({startAction:function(){var e,t=MainFrame.Util.getMainFrame();if(t.pageIndicator)e=t.pageIndicator;else{var a=MainFrame.Manager.Resource.getById(this.getParam("resourceId"));e=new MainFrame.Element.Resource({superObject:t,data:a}),t.pageIndicator=e}e.setVisible(!0),this.endAndClearAction()}}),MainFrame.Action.UpdateSliderPagePreview=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget(),t=this.getParam("pageSource"),a=MainFrame.Manager.Scoping.getById(t);a&&e.setPageNumber(a.currentPage),this.endAndClearAction()}}),MainFrame.Element.Slider=MainFrame.Abstract.Element.extend({currentPage:0,totalPages:1,segment:0,changeTrigger:null,readData:function(e){MainFrame.DataParser.parseSlider.call(this,e),this.setAction.call(this,"id:moveSliderToPosition;params:target="+this.indicatorId),MainFrame.EventHandler.dispatch("sliderReady",[this])},calculateSegment:function(){if(this.indicator){var e=this.getDimensionX()-this.indicator.getDimensionX();this.segment=e/this.totalPages}},calculatePageForPosition:function(e){e||(e=this.indicator.getPositionX());var t=Math.round(e/this.segment);return t>0?t:1},calculatePositionForPage:function(e){e||(e=this.currentPage);var t=this.targetModule;if(1===e)e=0;else if(t.isLastPage(e)&&this.indicator)return this.getDimensionX()-this.indicator.getDimensionX();return this.segment*e},changeCurrentPage:function(e){var t=this.targetModule;"double"===t.settings.pages.catalogType&&"landscape"===t.orientation&&(e=e%2===0?e:e-1,0===e&&(e=1)),this.currentPage!==e&&(this.currentPage=e,MainFrame.EventHandler.dispatch("pageChangedSlider",[this]))},synchronizePages:function(){this.goToPage=this.currentPage,this.indicator.goToPage=this.currentPage}}),MainFrame.Element.SliderIndicator=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseSliderIndicator.call(this,e),this.placeIndicator(),this.setAction.call(this,"id:sliderActions"),this.skinElement&&(this.skinElement.style.position="static"),this.superObject.indicator=this},placeIndicator:function(){this.superObject.calculateSegment(),this.positionX=this.superObject.calculatePositionForPage()+""},adjustPage:function(){var e=this.superObject.calculatePageForPosition();e>this.superObject.totalPages&&(e=this.superObject.totalPages-1),this.superObject.currentPage!==e&&this.superObject.changeCurrentPage(e)},resize:function(){this._resize(),this.placeIndicator()}}),!function(){MainFrame.DataParser.elements.slider=MainFrame.Element.Slider,MainFrame.DataParser.elements.sliderIndicator=MainFrame.Element.SliderIndicator}(),!function(){var e={parseSummary:function(e){var t=this;if(MainFrame.DataParser.getId.call(t,e),MainFrame.DataParser.getSize.call(t,e),MainFrame.DataParser.getPos.call(t,e),MainFrame.DataParser.getType.call(t,e),MainFrame.DataParser.getSkinId.call(t,e),MainFrame.DataParser.getSourceModule.call(t,e),MainFrame.DataParser.getLoadingTemplateId.call(this,e),MainFrame.DataParser.parseChildren.call(t,e),this.autoLoad=!0,e.attributes.autoLoad&&(this.autoLoad="false"==e.attributes.autoLoad||"0"==e.attributes.autoLoad?!1:!0),e.attributes.xmlUrl){var a=MainFrame.Util.getAppURL()+e.attributes.xmlUrl;a=MainFrame.Util.localizePath(a),this.summaryPath=a}1==this.autoLoad&&MainFrame.DataParser.loadSummaryXML.call(t)},loadSummaryXML:function(){var e=this;this.summaryPath&&MainFrame.Util.request({url:this.summaryPath,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(t){MainFrame.DataParser.parseSummaryXML.call(e,t)}})},parseSummaryXML:function(e){var t=this,a=[];this.defaultParams=MainFrame.DataParser.getDefaultSummaryParams(e),MainFrame.DataParser.registerInManager(MainFrame.Manager.Template,"templates","template","id",e),e.childNodes.forEach(function(e){if("chapter"===e.nodeName){var i=MainFrame.DataParser.parseSummaryChapter.call(t,e);a.push(i)}}),this.chapters=a,this.buildSummary()},getDefaultSummaryParams:function(e){var t={};return e.attributes.bgColorOn&&(t["#bgColorOn"]=e.attributes.bgColorOn),e.attributes.bgColorOff&&(t["#bgColorOff"]=e.attributes.bgColorOff),e.attributes.borderColor&&(t["#borderColor"]=e.attributes.borderColor),e.attributes.textColor&&(t["#textColor"]=e.attributes.textColor),e.attributes.textColorOn&&(t["#textColorOn"]=e.attributes.textColorOn),t},parseSummaryChapter:function(e,t,a){var i=this;"undefined"==typeof t&&(t=0);var r={};r.chapters=[],r.level=t,r.parentChapter="undefined"==typeof a?null:a,r.templateId=e.attributes.templateId?e.attributes.templateId:this.id+"Chapter"+r.level,MainFrame.DataParser.setChapterTemplateParams.call(i,r,e);var n=t+1;return e.childNodes.forEach(function(e){switch(e.nodeName){case"url":r.url=e.value,r.urlTarget=e.attributes.target;break;case"action":r.customAction=e.value;break;case"chapter":if(e.childNodes.length){var t=MainFrame.DataParser.parseSummaryChapter.call(i,e,n,r);r.chapters.push(t)}break;case"page":case"title":default:r[e.nodeName]=e.value}}),r.chapters.forEach(function(e){for(var t in r)-1==="chapters,url,urlTarget,page,title".indexOf(t)&&"undefined"==typeof e[t]&&(e[t]=r[t])}),r},setChapterTemplateParams:function(e,t){e.templateParams=MainFrame.DataParser.getTemplateParams(t),e.defaultParams=MainFrame.DataParser.getDefaultSummaryParams(t);for(var a in this.defaultParams)e.templateParams[a]=this.defaultParams[a];if(e.parentChapter)for(var i=e.parentChapter;i;){if(i.defaultParams){for(var a in i.defaultParams)e.templateParams[a]=i.defaultParams[a];i=null;break}i=i.parentChapter}for(var a in e.defaultParams)e.templateParams[a]=e.defaultParams[a]}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.HideSummarySubChapters=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=e.getSubObjectWithRole("subchapters-wrapper");if(t){var a=this.getParam("duration"),i=this.getParam("animation");MainFrame.ActionManager.doAction(t,t,t.id,"hide","false",[{duration:a,animation:i}])}}this.endAndClearAction()}}),MainFrame.Action.ShowSummarySubChapters=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=e.getSubObjectWithRole("subchapters-wrapper");if(t){var a=this.getParam("duration"),i=this.getParam("animation");MainFrame.ActionManager.doAction(t,t,t.id,"show","false",[{duration:a,animation:i}])}}this.endAndClearAction()}}),MainFrame.Action.ToggleSummarySubChapters=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getParam("summaryId")||"summary",t=MainFrame.Manager.Scoping.getById(e);if(t){var a=this.getTarget(),i=a.superObject;i.isOpen?t.closeAccordionChapter(i):t.openAccordionChapter(i);var r=t.superObject;r.hasSlider&&Ps.update(r.contentElement)}else MainFrame.Util.showError("OpenSummarySubChaptersAction error! The summary with the id: "+e+" does not exist");this.endAndClearAction()}}),MainFrame.Action.LoadSummary=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();MainFrame.DataParser.loadSummaryXML.call(e),this.endAndClearAction()}}),MainFrame.Element.Summary=MainFrame.Abstract.Module.extend({chapters:null,readData:function(e){this.setLoadingScreen(),this.chapters=[],MainFrame.DataParser.parseSummary.call(this,e),this.setAction("id:summaryActions")},buildSummary:function(){var e=this;switch(this.type){case"list":setTimeout(function(){e.buildListSummary()},100);break;case"accordion":setTimeout(function(){e.buildAccordionSummary()},100);break;case"multilevel":setTimeout(function(){e.buildMultiLevelSummary()},100);break;default:setTimeout(function(){e.buildListSummary()},100)}},buildListSummary:function(){this.totalChaptersHeight=0;var e=this.sourceModule,t=this;this.chapters.forEach(function(a){var i=e.getPageForPageNumber(a.page)||"undefined"==typeof a.page;i&&t.addListChapter(a)});var a=this.getDimensionY(),i=this.totalChaptersHeight,r=i-a;this.limitY=r>0?r:0,this.setDimensionY(i),this.resize(),this.removeLoadingScreen()},getChapterTemplateData:function(e){var t=(e.level,e.templateId),a=e.templateParams,i=MainFrame.Manager.Template.getById(t);if(!i)for(var r=e.parentChapter;null===i&&null!==r;)t=r.templateId,i=MainFrame.Manager.Template.getById(t),r=r.parentChapter;if(i){var n={nodeName:"item",attributes:{},childNodes:[]};n=MainFrame.DataParser.applyTemplate(n,t,a),i={nodeName:"resource",attributes:{},childNodes:[n]}}else i=MainFrame.Manager.Resource.getById(t);return i},addListChapter:function(e){var t=this.getChapterTemplateData(e);if(!t)return void MainFrame.Util.showError("No chapter template found with the id: "+e.templateId);t=MainFrame.Util.fillTemplateWithData(t,e);var a=new MainFrame.Element.Resource({superObject:this,data:t});if(this.setChapterInfo(a,e),a.setPositionY(this.totalChaptersHeight),this.totalChaptersHeight+=a.getDimensionY(),e.chapters.length)for(var i=0,r=e.chapters.length;r>i;i++){var n=e.chapters[i];this.addListChapter(n)}},setChapterInfo:function(e,t){if(this.setChapterThumb(e,t),this.setChapterTitle(e,t),this.setChapterPageNumber(e,t),this.setChapterAction(e,t),t.chapters.length){var a=e.getSubObjectsWithRole("visible-if-subchapters");a.forEach(function(e){e.show()})}},setChapterThumb:function(e,t){var a=e.getSubObjectWithRole("page-thumb")||e.getSubObjectWithId("summaryChapterImage");if(a){var i=this.sourceModule.getContainerForCurrentPagingType(t.page);this.sourceModule.buildGraphicsInSubContainer(a,i,"diapo",!1)}},setChapterTitle:function(e,t){var a=e.getSubObjectWithRole("title")||e.getSubObjectWithId("summaryChapterTitle");if(a){var i=a.containerElement.cloneNode();document.body.appendChild(i),i.innerHTML=t.title,i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.style.width=a.getDimensionX()+"px",i.style.height="auto";var r=i.clientHeight+1;if(MainFrame.Util.removeElement(i),1!=r){var n=a.getDimensionY();if(r>a.getDimensionY()+1){var s=r-n;a.setDimensionY(r);var o=e.getSubObjectWithRole("action-target")||e.getSubObjectWithId("summaryChapterActionZone");if(o){var l=o.getDimensionY();l+=s,o.setDimensionY(l)}var c=e.getSubObjectWithRole("subchapters-wrapper")||e.getSubObjectWithId("summaryChapterSubChaptersWrapper");if(c){var d=c.getPositionY();d+=s,c.setPositionY(d)}var g=e.getDimensionY();e.setDimensionY(g+s)}}a.setText(t.title)}},setChapterPageNumber:function(e,t){var a=e.getSubObjectWithRole("page")||e.getSubObjectWithId("summaryChapterPage");if(a){var i=t.page,r=a.getText();-1!==r.indexOf("##page")?(r=r.replace("##page",i),a.setText(r)):a.setText(i)}},setChapterAction:function(e,t){var a=e.getSubObjectWithRole("action-target")||e.getSubObjectWithId("summaryChapterActionZone"),i=a||e;if("undefined"!=typeof t.page)if("accordion"===this.type&&t.chapters.length)i.setAction("id:summaryChapterOpenSubChapters");else{var r=this.sourceModule;if("2"===r.API_VERSION)var n=r.getPageForPageNumber(t.page);else{var n=r.getContainerForCustomPage(t.page);n=r.getPageForPageNumber(n)}i.setAction("id:summaryChapterGoToPage;params:page="+n)}else if(t.url){var s=t.urlTarget?",urlTarget="+t.urlTarget:"";i.setAction("id:openURL;params:url="+t.url+s)}else t.customAction?i.setAction(t.customAction):t.chapters.length&&i.setAction("id:summaryChapterOpenSubChapters;params:summaryId="+this.id)},buildAccordionSummary:function(){var e=this.sourceModule;this.totalChaptersHeight=0,this.contentElement.style.overflow="hidden";for(var t=0,a=this.chapters.length;a>t;t++){var i=this.chapters[t];if("2"===e.API_VERSION)var r=e.getPageForPageNumber(i.page)||"undefined"==typeof i.page;else var r=-1!==e.pageNumbers.indexOf(i.page)||"undefined"==typeof i.page;r&&this.addAccordionChapter(this,i)}var n=this.getDimensionY(),s=this.totalChaptersHeight,o=s-n;this.limitY=o>0?o:0,this.setDimensionY(s),this.resize(),this.removeLoadingScreen()},addAccordionChapter:function(e,t){var a=this.getChapterTemplateData(t);if(!a)return void MainFrame.Util.showError("No chapter template found with the id: "+t.templateId);a=MainFrame.Util.fillTemplateWithData(a,t);var i=new MainFrame.Element.Resource({superObject:e,data:a});if(e.subChapters||(e.subChapters=[]),e.subChapters.push(i),i.chapterData=t,this.setChapterInfo(i,t),i.containerElement.style.position="relative",i.setPositionY("0"),"undefined"==typeof e.totalChaptersHeight&&(e.totalChaptersHeight=0),e.totalChaptersHeight+=i.getDimensionY(),t.chapters.length){var r=i.getSubObjectWithRole("subchapters-wrapper")||i.getSubObjectWithId("summaryChapterSubChaptersWrapper");if(r){var n=this,s=t.chapters;s.forEach(function(e){n.addAccordionChapter(r,e)}),r.setDimensionY(r.totalChaptersHeight)}}},removeAccordionChapter:function(e,t){var a=t.getDimensionY();e.totalChaptersHeight-=a,e.removeSubObject(t)},openAccordionChapter:function(e){this.toggleAccordionChapter(e,"show"),e.setState("select")},closeAccordionChapter:function(e){this.toggleAccordionChapter(e,"hide"),e.setState("deselect")},toggleAccordionChapter:function(e,t){var a=e.getSubObjectWithRole("subchapters-wrapper")||e.getSubObjectWithId("summaryChapterSubChaptersWrapper");if(a){if("show"===t){e.isOpen=!0,a.show();var i=1}else{e.isOpen=!1,a.hide();var i=-1}var r=i*a.getDimensionY(),n=e.getDimensionY(),s=n+r;e.setDimensionY(s),e.containerElement.style.height=s+"px";for(var o=e.superObject,l=o.superObject;l.isOpen;){var c=o.getDimensionY(),d=c+r;o.setDimensionY(d),o.containerElement.style.height=d+"px";var g=l.getDimensionY(),h=g+r;l.setDimensionY(h),l.containerElement.style.height=h+"px",o=l.superObject,l=o.superObject}var u=this.getDimensionY(),s=u+r;this.setDimensionY(s),this.containerElement.style.height=s+"px"}e.resize()},buildMultiLevelSummary:function(){this.setDimensionY(0),this.removeOverflows();for(var e=this.sourceModule,t=0,a=this.chapters.length;a>t;t++){var i=this.chapters[t],r=e.getPageForPageNumber(i.page)||"undefined"==typeof i.page;if(r){this.addMultiLevelChapter(i,this);var n=this.subObjects[t];this.repositionSubchaptersOutsideOfScreen(n,this)}}var s=this.getDimensionY(),o=this.totalChaptersHeight,l=o-s;this.limitY=l>0?l:0,this.resize(),this.removeLoadingScreen()},removeOverflows:function(){for(var e=this;e&&"mainframe"!==e.id;)e.containerElement.style.overflow="visible",e.contentElement.style.overflow="visible",e=e.superObject},addMultiLevelChapter:function(e,t){var a=this.getChapterTemplateData(e);if(!a)return void MainFrame.Util.showError("No chapter template found with the id: "+e.templateId);a=MainFrame.Util.fillTemplateWithData(a,e);var i=new MainFrame.Element.Resource({superObject:t,data:a});this.setChapterInfo(i,e),i.setAction("id:summaryChapterHover"),i.containerElement.style.overflow="visible",i.contentElement.style.overflow="visible";var r=t.getDimensionY();if(i.setPositionY(r),e.chapters.length){var n=i.getSubObjectWithRole("subchapters-wrapper");if(n){n.containerElement.style.overflow="visible",n.contentElement.style.overflow="visible";var s=i.getDimensionX();n.setPositionX(s),n.setPositionY(0);
for(var o=0,l=e.chapters.length;l>o;o++){var c=e.chapters[o];this.addMultiLevelChapter(c,n)}}else MainFrame.Util.showError("The summary chapter template lacks a subchapters wrapper element")}r+=i.getDimensionY(),t.setDimensionY(r)},repositionSubchaptersOutsideOfScreen:function(e){var t=e.getSubObjectWithRole("subchapters-wrapper");if(t&&t.subObjects&&t.subObjects.length){var a=t.getDimensionY(),i=MainFrame.Browser.height,r=e,n=a;do n+=r.getPositionY(),r=r.superObject;while(r!==this);if(n>i){var s=e.getDimensionY();newPositionY=-(a-s),t.setPositionY(newPositionY)}for(var o=0,l=t.subObjects.length;l>o;o++){var c=t.subObjects[o];this.repositionSubchaptersOutsideOfScreen(c)}}}}),!function(){MainFrame.DataParser.elements.summary=MainFrame.Element.Summary}(),MainFrame.Action.Track=MainFrame.Abstract.Action.extend({startAction:function(){var e=MainFrame.Util.getMainFrame();if(e.hasTracking){var t=this.getParam("action"),a=this.getParam("trigger"),i=this.initiatorObject,r=[],n=this.getTarget(),s=this.getParam("params");if(s&&s.indexOf("url#")>0)r.push(s.split("url#").join(""));else if(s){var o=this.getParam("params").split("/");o.forEach(function(e){var t=n[e];if("currentPage"===e){var a=n.currentPage,i=n.pageReferences[a],s=i.number;t=s}r.push(t)})}if("undefined"!=typeof t&&"#trackingId"!==t)try{MainFrame.Tracker.sendTrackedEvent(t,a,i,r)}catch(l){MainFrame.Util.showError("There was an error while attempting to track the action with the id "+t),console.log(l)}}this.endAndClearAction()}}),!function(){var e={parseTrackingSettings:function(e){var t=MainFrame.DataParser.getChildrenWithNodeName(e,"tracker");t.forEach(function(e){MainFrame.DataParser.parseTracker(e)})},parseTracker:function(e){var t="false"!==e.attributes.active;if(t){var a=e.attributes.type,i=MainFrame.DataParser.parseTrackerVars(e),r=MainFrame.DataParser.parseTrackerCodes(e),n=e.attributes.version;MainFrame.Tracker?MainFrame.Tracker.init({type:a,vars:i,codes:r,version:n}):MainFrame.Util.showError("The Tracker could not be initialized! Check if the tracker.js file is included correctly or disable the <tracking> node")}},parseTrackerVars:function(e){var t={},a=MainFrame.DataParser.getNodeNamed(e,"vars");return a&&a.childNodes.forEach(function(e){var a=e.attributes.name,i=e.value;t[a]=i}),t},parseTrackerCodes:function(e){var t=[],a=MainFrame.DataParser.getNodeNamed(e,"codes");return a&&"default"!==a.value&&(t=a.value.split(" ")),t}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Action.CloseZoomScrollshopItem=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("duration");if(t)var a=parseFloat(t,10);else var a=.3;e.zoomOverlay&&this.removeOverlay(e,a),e.zoomZoneContainer&&this.removeZoomZone(e,a)}else this.endAndClearAction()},removeOverlay:function(e,t){var a=e.zoomOverlay;window.requestAnimationFrame(function(){a.containerElement.style.opacity="0"});var i=MainFrame.Util.secondsToMiliseconds(t);setTimeout(function(){a.unload(),delete e.zoomOverlay},i)},removeZoomZone:function(e,t){var a=e.zoomZoneContainer;MainFrame.Util.setTransformDuration(a,t,"s"),window.requestAnimationFrame(function(){MainFrame.Util.setPosition(a,a.zoomInTranslatedX,a.zoomInTranslatedY,{x:a.zoomInScaleX,y:a.zoomInScaleY})});var i=this,r=MainFrame.Util.secondsToMiliseconds(t);setTimeout(function(){a.parentNode.removeChild(a),delete e.zoomZoneContainer,i.endAndClearAction()},r)}}),MainFrame.Action.DestroyScrollshop=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&e.masonry&&(e.masonry.destroy(),delete e.masonry),this.endAndClearAction()}}),MainFrame.Action.FilterScrollshop=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){console.log(e);var t=this.initiatorObject,a=this.getParam("tagCloudId")||"tagCloud",i=MainFrame.Manager.Scoping.getById(a);if(i)for(var r=0,n=i.subObjects.length;n>r;r++){var s=i.subObjects[r];s.setState(s.id===t.id?"select":"deselect")}var o=this.getParam("tagIds");e.filterItemsByTagIds(o),setTimeout(function(){Ps&&Ps.update&&Ps.update(e.containerElement)},500)}this.endAndClearAction()}}),MainFrame.Action.InitScrollshop=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();e&&e.initScrollshop(),this.endAndClearAction()}}),MainFrame.Action.ZoomScrollshopItem=MainFrame.Abstract.Action.extend({startAction:function(){var e=this.getTarget();if(e){var t=this.getParam("duration");if(t)var a=parseFloat(t,10);else var a=.3;this.duration=a,this.addOverlay(e,this.preloadZoneImages.bind(this))}this.endAndClearAction()},preloadZoneImages:function(){var e=this.getTarget();scrollshopItem=this.initiatorObject.superObject;var t=this.determineAvailableWidth(e),a=this.determineAvailableHeight(e),i=scrollshopItem.zoneData.mapWidth,r=scrollshopItem.zoneData.mapHeight,n=scrollshopItem.zoneData,s=this.determineMaxZoneScale(t,a,i,r);if(this.selectedSize){var o=this,l=e.sourceModule,c=l.settings.pages.normalSize,d=n.mapX+n.mapWidth>c.width,g=new Image,h=this.getPageImagePathForPage(l,n.page);g.onload=function(){if(d){var t=new Image,a=this.getPageImagePathForPage(l,n.page+1);t.onload=function(){o.drawZone(e,scrollshopItem,s)},t.src=a}else o.drawZone(e,scrollshopItem,s)},g.src=h}else this.drawZone(e,scrollshopItem,s)},addOverlay:function(e,t){var a=MainFrame.Util.createElement("div","v7__overlay",e.superObject.contentElement),i=this.getParam("overlayColor")||"#000",r=this.getParam("overlayOpacity")||"0.5",n=this.duration;a.style.opacity="0",a.style.backgroundColor=i;var s=new MainFrame.Element.HtmlItem({containerElement:a});e.zoomOverlay=s,TweenMax.to(a,n,{opacity:r,onComplete:function(){t()}})},drawZone:function(e,t,a){var i=t.zoneData.mapWidth,r=t.zoneData.mapHeight,n=this.drawZoneContainer(e,i,r,a);this.placeZone(n,e,t,a);var s=this.drawZoneImage(e,t.zoneData,a,n);this.zoneImage=s,this.addExtraContent(e,t.zoneData,n);var o=i*a.x,l=r*a.y;this.initInnerPrices(e,t.zoneData,o,l),this.initInnerMaps(e,t.zoneData,o,l),e.zoomZoneContainer=n,e.zoomOverlay.setAction("id:closeZoomScrollshop"),this.scaleZone(n)},determineAvailableWidth:function(e){var t=e.getDimensionX(),a=e.props.paddingLeft+e.props.paddingRight;return t-=a,e.props.rightContentWidth&&(t-=e.props.rightContentWidth),t},determineAvailableHeight:function(e){var t=e.getDimensionY(),a=e.props.paddingTop+e.props.paddingBottom;return t-=a,e.props.bottomContentHeight&&(t-=e.props.bottomContentHeight),t},determineMaxZoneScale:function(e,t,a,i){var r=e/t,n=a/i,s=this.getMinScaleIncrement();if(n>=r)var o="width";else var o="height";var l=this.getTarget(),c=l.sourceModule,d=c.settings.pages.normalSize,g=c.settings.pages.sizes||[],h=g.length-1,u=g[h],m=this.initiatorObject.superObject,p=m.zoneData.zoneWidth,f=m.zoneData.zoneHeight,v=p/a,M=f/i;if("width"===o)var b=e/a;else var b=t/i;for(var F=h>=0;F;){var A="width"===o?d.width*b>u.width:d.height*b>u.height;if(A){var P=u.width/d.width,y=u.height/d.height;return(v>P||M>y)&&(P=v+s,y=M+s),this.selectedSize=u,{x:P,y:y}}h--,u=g[h]}return this.selectedSize=u,{x:b,y:b}},getMinScaleIncrement:function(){var e=this.getParam("minScale");if(e){var t=parseFloat(e,10);return t>1?t-1:.2}return.2},drawZoneContainer:function(e,t,a,i){var r=MainFrame.Util.createElement("div","v7__elem__scrollshop__item__content",e.superObject.contentElement);r.style.position="absolute",r.style.display="none";var n=this.determineWidthAfterScale(e,t,i.x),s=this.determineHeightAfterScale(e,a,i.y);availableWidth=e.getDimensionX(),availableHeight=e.getDimensionY();var o=Math.floor((availableWidth-n)/2),l=Math.floor((availableHeight-s)/2);return r.style.left=o+"px",r.style.top=l+"px",r.style.width=n+"px",r.style.height=s+"px",r},determineWidthAfterScale:function(e,t,a){var i=t*a,r=e.props.paddingLeft+e.props.paddingRight;return i+=r,e.props.rightContentWidth&&(i+=e.props.rightContentWidth),i},determineHeightAfterScale:function(e,t,a){var i=t*a,r=e.props.paddingTop+e.props.paddingBottom;return i+=r,e.props.bottomContentHeight&&(i+=e.props.bottomContentHeight),i},drawZoneImage:function(e,t,a,i){var r=e.sourceModule,n=r.settings.pages.normalSize,s=t.mapWidth*a.x,o=t.mapHeight*a.y,l=document.createElement("div");l.setAttribute("class","v7__elem__scrollshop__item__image-wrapper"),l.style.position="absolute",l.style.width=s+"px",l.style.height=o+"px",l.style.left=e.props.paddingLeft+"px",l.style.top=e.props.paddingTop+"px";var c=document.createElement("div");if(c.setAttribute("class","v7__elem__scrollshop__item__image-container"),c.style.width="100%",c.style.height="100%",t.imageSource)c.style.backgroundImage="url("+t.imageSource+")",c.style.backgroundPosition="0",c.style.backgroundSize="100%";else{var d=t.mapX+t.mapWidth>n.width,g=this.getPageImagePathForPage(r,t.page);if(d){var h=this.getPageImagePathForPage(r,t.page+1);c.style.backgroundImage="url("+g+"), url("+h+")"}else c.style.backgroundImage="url("+g+")";var u=100*t.mapX/n.width,m=100*t.mapY/n.height,p=100*t.mapWidth/n.width,f=100*t.mapHeight/n.height,v=100*s/p,M=100*o/f,b=u*v/100,F=m*M/100;d?(c.style.backgroundPosition="-"+b+"px -"+F+"px, "+(v-b)+"px -"+F+"px",c.style.backgroundSize=v+"px "+M+"px, "+v+"px "+M+"px"):(c.style.backgroundPosition="-"+b+"px -"+F+"px",c.style.backgroundSize=v+"px "+M+"px")}l.appendChild(c),i.appendChild(l);var A=new MainFrame.Element.HtmlItem({containerElement:c}),P=this.getParam("itemAction")||"closeZoomScrollshop";A.setAction("id:"+P+";params:page="+t.page);var y=this.getParam("itemAltId");return y&&A.addAltId(y,"default"),l},getPageImagePathForPage:function(e,t){var a=e.pageReferences[t];if(e.settings.pages.useXJpgForZoom&&-1!==e.settings.pages.xJpgPages.indexOf(t))if(this.selectedSize)var i=a.sizes[this.selectedSize.width],r=i.original;else var r=a.hdx;else if(this.selectedSize)var i=a.sizes[this.selectedSize.width],r=i.normal;else var r=a.hd;return-1===r.indexOf("/")&&(r=e.settings.pages.dataSrc+r),MainFrame.Util.getAppURL()+r},addExtraContent:function(e,t,a){var i=(e.sourceModule,new MainFrame.Element.ScrollshopItem({containerElement:a})),r=e.props.paddingLeft+e.props.paddingRight;if(verticalPadding=e.props.paddingTop+e.props.paddingBottom,e.props.bottomContentData&&(t.refId||t.refs||e.props.defaultRefType)){var n=document.createElement("div");Math.ceil(zoneHeight),n.setAttribute("class","v7__elem__scrollshop__item__bottom-content"),n.style.height=e.props.bottomContentHeight+"px",n.style.position="absolute";var s=document.createElement("div");n.appendChild(s);var o=e.props.bottomContentData,l=new MainFrame.Element.Resource({id:e.id+"_bottomContent",containerElement:s,superObject:i,data:o});a.appendChild(n);var c=l.getSubObjectWithRole("goto-action-target"),d=l.getSubObjectWithRole("ref-action-target");if("goto-action-target"===l.role&&(c=l),"ref-action-target"===l.role&&(d=l),c){var g="id:scrollshopItemGoToAction;params:page="+t.page;c.setAction(g)}if(d){for(var h in t.refs)var u=t.refs[h];if(t.refIds&&t.refIds.length>1){var m="id:mapMultirefActions";d.refs=t.refIds,d.passedData={page:t.page,refIds:t.refIds}}else if(u){var m="id:"+u.type+"RefActions;params:source="+e.sourceModuleId;d.ref=u,d.refs=t.refs}else if(t.refType)var m="id:"+t.refType+"RefActions;params:source="+e.sourceModuleId+",zoneId="+t.id+",page="+t.page+",scrollshopMultiZone=true";else if(t.refId)var m="id:ldcRefActions;params:source="+e.sourceModuleId+",refId="+t.refId+",page="+t.page;else if(e.props.defaultRefType)var m="id:"+e.props.defaultRefType+"RefActions;params:source="+e.sourceModuleId+",zoneId="+t.id+",page="+t.page+",scrollshopMultiZone=true";m&&d.setAction(m)}}else if(e.props.rightContentData&&(t.refId||t.refs||e.props.defaultRefType)){var p=document.createElement("div");Math.ceil(zoneWidth)+r,p.setAttribute("class","v7__elem__scrollshop__item__right-content"),p.style.width=e.props.rightContentWidth+"px",p.style.right="0px",p.style.position="absolute";var s=document.createElement("div");p.appendChild(s);var f=e.props.rightContentData,v=new MainFrame.Element.Resource({id:e.id+"_bottomContent",containerElement:s,superObject:i,data:f});a.appendChild(p);var c=v.getSubObjectWithRole("goto-action-target"),d=v.getSubObjectWithRole("ref-action-target");if("goto-action-target"===v.role&&(c=v),"ref-action-target"===v.role&&(d=v),c){var g="id:scrollshopItemGoToAction;params:page="+t.page;c.setAction(g)}if(d){for(var h in t.refs)var u=t.refs[h];if(t.refIds&&t.refIds.length>1){var m="id:mapMultirefActions";d.refs=t.refIds,d.passedData={page:t.page,refIds:t.refIds}}else if(u){var m="id:"+u.type+"RefActions;params:source="+e.sourceModuleId;d.ref=u,d.refs=t.refs}else if(t.refType)var m="id:"+t.refType+"RefActions;params:source="+e.sourceModuleId+",zoneId="+t.id+",page="+t.page+",scrollshopMultiZone=true";else if(t.refId)var m="id:ldcRefActions;params:source="+e.sourceModuleId+",refId="+t.refId+",page="+t.page;else if(e.props.defaultRefType)var m="id:"+e.props.defaultRefType+"RefActions;params:source="+e.sourceModuleId+",zoneId="+t.id+",page="+t.page+",scrollshopMultiZone=true";m&&d.setAction(m)}}},placeZone:function(e,t,a,i){var r=this.determineOriginalPositionOnScreen(t,a),n=this.determineOriginalScaleOnScreen(a),s=t.getDimensionX()/2,o=t.getDimensionY()/2,l=n/i.x,c=n/i.y;e.translatedX=-(s-r.centerX),e.translatedY=-(o-r.centerY),e.zoomInTranslatedX=e.translatedX,e.zoomInTranslatedY=e.translatedY,e.zoomInScaleX=l,e.zoomInScaleY=c,MainFrame.Util.setTransformDuration(e,this.duration,"s"),MainFrame.Util.setPosition(e,e.translatedX,e.translatedY,{x:l,y:c})},determineOriginalPositionOnScreen:function(e,t){var a=t.containerElement,i=t.zoneData.renderData.x,r=t.zoneData.renderData.y,n=parseFloat(a.style.width,10),s=parseFloat(a.style.height,10),o=(e.props.containerHeight,e.containerElement.scrollTop);if(e.scrollshopPages){var l=e.scrollshopPages.getPositionX(),c=e.scrollshopPages.getDimensionX();0==l&&(i+=c)}var d=i,g=r-o,h=d+n/2,u=g+s/2;return{x:d,y:g,centerX:h,centerY:u}},determineOriginalScaleOnScreen:function(e){var t=e.zoneData.zoneWidth,a=e.zoneData.mapWidth,i=t/a;return i},scaleZone:function(e){e.style.display="",window.requestAnimationFrame(function(){e.translatedX=0,e.translatedY=0,MainFrame.Util.setPosition(e,e.translatedX,e.translatedY,1)})},initInnerMaps:function(e,t,a,i){var r=e.sourceModule;if(r.settings.maps.active){var n=document.createElement("div"),s=new MainFrame.Maps({superObject:r,containerElement:n}),o=this,l=function(){o.drawInnerMaps(s,t,a,i,r)};s.drawMapsForPage(t.page,l)}},drawInnerMaps:function(e,t,a,i,r){for(var n=e.getRandomizedZoneId(t.id),s=e.getInnerZones(n),o=this.zoneImage,l=0,c=s.length;c>l;l++){var d=s[l],g=new MainFrame.Abstract.Element({containerElement:!1});for(var h in d){var u="superObject"!==h&&"aF"!==h,m="interpretors"!==h;u&&m&&(g[h]=d[h])}d.isDrawn=!1,g.insideZoomMap=!0;var p=!0,f=!1,v=!0,M=!0;e.drawMap(g,o,v,p,f,M),this.resizeZone(g,e,t,a,i,r)}e.resize()},initInnerPrices:function(e,t,a,i){var r=e.sourceModule;r.settings.prices.active&&e.initInnerPrices(e,t,a,i,this.zoneImage)},resizeZone:function(e,t,a,i,r,n){var s=parseFloat(e.recX),o=parseFloat(e.recY),l=parseFloat(e.recW),c=parseFloat(e.recH);s-=parseFloat(a.mapX),o-=parseFloat(a.mapY);var d=100*s/parseFloat(a.mapWidth),g=100*o/parseFloat(a.mapHeight),h=100*l/parseFloat(a.mapWidth),u=100*c/parseFloat(a.mapHeight);s=d*i/100,o=g*r/100,l=h*i/100,c=u*r/100;var m=n.settings.maps.settings,p=e.ref;p&&"true"===m.zonesConfig.zonesPictos[p.type+"Picto"]&&(l=m.hotspotsArr[p.type].hotspotWidth,c=m.hotspotsArr[p.type].hotspotHeight),e.setPositionX(s),e.setPositionY(o),e.setDimensionX(l),e.setDimensionY(c),e.resize()}}),!function(){var e={parseScrollshop:function(e){var t=this;MainFrame.DataParser.getSize.call(t,e),MainFrame.DataParser.getPos.call(t,e),MainFrame.DataParser.getSkinId.call(t,e),MainFrame.DataParser.getSourceModule.call(t,e);var a=e.attributes.itemWidth;this.props.itemWidth=parseInt(a,10);var i=e.attributes.startingItems;this.props.startingItems=parseInt(i,10)||50;var r=e.attributes.itemsPerLoad;this.props.itemsPerLoad=parseInt(r,10)||50;var n=e.attributes.itemsToPrepend;this.props.itemsToPrepend=parseInt(n,10)||20;var s=e.attributes.tagsLibraryId||"tags";this.tagsLibraryId=s;var o=e.attributes.dataUrl;this.dataUrl=o;var l=e.attributes.sliderId;this.sliderId=l;var c=e.attributes.spacingX||"5";if(c){var d=parseInt(c,10);this.props.spacingLeft=d,this.props.spacingRight=d}var g=e.attributes.spacingY||"5";if(g){var h=parseInt(g,10);this.props.spacingTop=h,this.props.spacingBottom=h}var u=e.attributes.paddingX||"0";if(u){var m=parseInt(u,10);this.props.paddingLeft=m,this.props.paddingRight=m}var p=e.attributes.paddingY||"5";if(p){var f=parseInt(p,10);this.props.paddingTop=f,this.props.paddingBottom=f}var v=e.attributes.defaultRefType;v&&(this.props.defaultRefType=v);var M=e.attributes.itemAltId;M&&(this.props.itemAltId=M);var b=e.attributes.startingTags;b&&(this.props.startingTags=b);var F=e.attributes.scrollToCurrentPage;this.props.scrollToCurrentPage="false"===F?!1:!0,this.props.useHdSource="true"===e.attributes.useHdSource?!0:!1,this.props.roundCorners="false"===e.attributes.roundCorners?!1:!0,MainFrame.DataParser.getRefTypes.call(t,e),MainFrame.DataParser.parseScrollshopBottomContent.call(t,e),MainFrame.DataParser.parseScrollshopRightContent.call(t,e),MainFrame.DataParser.getScrollshopPages.call(t,e)},parseScrollshopBottomContent:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"scrollshopBottomContent");t?(this.props.bottomContentHeight=parseInt(t.attributes.height),this.props.bottomContentData=t):this.props.bottomContentHeight=0},parseScrollshopRightContent:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"scrollshopRightContent");t?(this.props.rightContentWidth=parseInt(t.attributes.width),this.props.rightContentData=t):this.props.rightContentWidth=0},parseScrollshopFilterGroup:function(e){MainFrame.DataParser.getSize.call(this,e),MainFrame.DataParser.getPos.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getSourceModule.call(this,e),MainFrame.DataParser.getLayout.call(this,e),MainFrame.DataParser.getSpacing.call(this,e),MainFrame.DataParser.parseScrollshopTags.call(this,e);var t=e.attributes.tagsLibraryId||"tags";this.tagsLibraryId=t,this.highlightedUrlTags="false"===e.attributes.highlightedUrlTags?!1:!0},parseScrollshopTags:function(e){var t=MainFrame.DataParser.getNodeNamed(e,"scrollshopTag");t&&(this.tagTemplateData=t);var a=MainFrame.DataParser.getNodeNamed(e,"scrollshopAllTags");a&&(this.allTagsTemplateData=a)},getRefTypes:function(e){var t=[];if(e.attributes.refTypes)var a=e.attributes.refTypes,t=a.split("|");this.props.refTypes=t},getScrollshopPages:function(e){this.props.scrollshopPages={};var t=MainFrame.DataParser.getNodeNamed(e,"scrollshopPages");t?(this.props.scrollshopPages.active=!0,this.props.scrollshopPages.position=t.attributes.position||"left",this.props.scrollshopPages.width=t.attributes.width?parseInt(t.attributes.width,10):200,this.props.scrollshopPages.data=t):this.props.scrollshopPages.active=!1},parseScrollshopPages:function(e){this.id||MainFrame.DataParser.getId.call(this,e),this.states||(this.states={},this.states.def={}),MainFrame.DataParser.getAlpha.call(this,e),MainFrame.DataParser.getSkinId.call(this,e),MainFrame.DataParser.getSkin.call(this,e),MainFrame.DataParser.getAction.call(this,e),MainFrame.DataParser.getVisible.call(this,e),MainFrame.DataParser.getVisibleOffline.call(this,e),MainFrame.DataParser.getResponsiveConditions.call(this,e),MainFrame.DataParser.getClass.call(this,e),MainFrame.DataParser.getOverflow.call(this,e),MainFrame.DataParser.getStyles.call(this,e);var t=MainFrame.DataParser.getNodeNamed(e,"scrollshopPage");t&&(this.scrollshopPageData=t)}};MainFrame.Util.extend(MainFrame.DataParser,e)}(),MainFrame.Element.ScrollshopFilterGroup=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseScrollshopFilterGroup.call(this,e),this.buildScrollshopFilterGroup(),this.highlightedUrlTags&&this.highlightURLTags()},buildScrollshopFilterGroup:function(){var e=MainFrame.Manager.Library.list[this.tagsLibraryId],t=e.data;this.addAllTagsItem();for(var a in t){var i=t[a];i.name=a,this.addTagItem(i)}},addAllTagsItem:function(){var e=this.allTagsTemplateData,t=this.id+"_allTagsItem",a=new MainFrame.Element.Item({id:t,superObject:this,data:e}),i=a.getSubObjectWithRole("tag-name");if(i){var r=MainFrame.Manager.Text.getById("allTagsLabel")||"Show all";i.setText(r)}var n="id:filterScrollshop";a.setAction(n)},addTagItem:function(e){var t=this.tagTemplateData,a=this.id+"_tag_"+e.id,i=new MainFrame.Element.Item({id:a,superObject:this,data:t}),r=i.getSubObjectWithRole("tag-name");r&&r.setText(e.name);var n=r.getDimensionX(),s=r.estimatedTextSizeWithText(e.name,r.fontSize).width;if(s>n){var o=s-n,l=i.getDimensionX(),c=l+o;i.setDimensionX(c)}var d="id:filterScrollshop;params:tagNames="+e.name+",tagIds="+e.id;i.setAction(d),i.tag=e},highlightURLTags:function(){var e=MainFrame.Util.urlGET("tags");if(e)for(var t=e.split("|"),a=0,i=this.subObjects.length;i>a;a++)for(var r=this.subObjects[a],n=0,s=t.length;s>n;n++){var o=t[n];r.tag&&r.tag.name===o&&r.setState("select")}else{var l=this.subObjects[0];l.setState("select")}},gridResize:function(){if(this.subObjects&&this.subObjects.length){var e=this.getDimensionX(),t=this.subObjects.length,a=this.subObjects[0],i=a.getDimensionY(),r={};r[0]={},r[0].columnIndexList=[],r[0].totalWidth=0,r[0].margin=0;for(var n=0,s=[],o=0,l=0;t>n;n++){var c=this.subObjects[n],d=c.getDimensionX();s.push(d);var g=r[l],h=this.spacing.x*o;if(g.totalWidth+d+h<e){g.columnIndexList.push(n),g.totalWidth+=d;var u=this.spacing.x*(g.columnIndexList.length-1);g.margin=(e-g.totalWidth-u)/2,o++}else{var u=this.spacing.x*(g.columnIndexList.length-1);g.margin=(e-g.totalWidth-u)/2,l++,o=0,r[l]={},r[l].columnIndexList=[n],r[l].totalWidth=d,n===t-1&&(r[l].margin=(e-r[l].totalWidth)/2)}}for(var n=0,o=0,l=0,m=0,p=0;t>n;n++){var c=this.subObjects[n],d=s[n],g=r[l];-1===g.columnIndexList.indexOf(n)&&(m=0,o=0,l++,p+=i+this.spacing.y,g=r[l]),0===m&&(m+=g.margin);var f=m,v=p;c.setPositionX(f),c.setPositionY(v),m+=d+this.spacing.x,o++}this.setDimensionY(p)}}}),MainFrame.Element.ScrollshopPages=MainFrame.Abstract.Element.extend({readData:function(e){MainFrame.DataParser.parseScrollshopPages.call(this,e)},buildScrollshopPages:function(){for(var e,t=this.superObject,a=t.sourceModule,i=1,r=a.settings.pages.totalPages,n=0;r>i;i++){var s=this.scrollshopPageData,o=new MainFrame.Element.Item({id:this.id+"_page_"+i,superObject:this,data:s});e||(e=o.getDimensionY());var l=o.getSubObjectWithRole("page-image"),c=a.pageReferences[i],d=MainFrame.Util.createElement("img","v7--centered-image",l.containerElement);d.src=MainFrame.Util.getAppURL()+c.small;var g=o.getSubObjectWithRole("label");if(g){var h=g.getText();h=h.replace("##page",c.number),g.setText(h)}var u=t.determineFirstPageIndex(i),m=t.props.allZones[u],p=m.renderData.y;n>p&&(p=n),o.setPositionY(p),o.containerElement.style.top=p+"px",n=p+e,l.setAction("id:scrollshopPageImageAction;params:page="+i)}}}),MainFrame.Element.Scrollshop=MainFrame.Abstract.Module.extend({items:[],readData:function(e){this.initProperties(),MainFrame.DataParser.parseScrollshop.call(this,e),this.buildScrollshopContainers(),this.extractTags(),this.extractZones()},initProperties:function(){var e={};e.tagFilter=!0,this.props=e},buildScrollshopContainers:function(){this.createLoadingScreen(),this.containerElement.setAttribute("class","v7__elem__scrollshop"),this.props.scrollshopPages.active&&this.createScrollshopPagesContainer(),this.createContentContainer()},createLoadingScreen:function(){var e=MainFrame.Util.createElement("div","v7--loading v7__elem__scrollshop--loading",this.containerElement.parentNode);e.style.display="none",this.loadingContainer=e},showLoadingContainer:function(){this.loadingContainer.style.display="block"},hideLoadingContainer:function(){this.loadingContainer.style.display="none"},createScrollshopPagesContainer:function(){var e=this.props.scrollshopPages,t=new MainFrame.Element.ScrollshopPages({superObject:this,data:e.data});t.setPositionX("left"===e.position?"0":"100%-w"),t.setDimensionX(e.width),this.scrollshopPages=t},createContentContainer:function(){var e=document.createElement("div");e.style.margin="0 auto",this.props.scrollshopPages.active&&(e.style.left="left"===this.props.scrollshopPages.position?this.props.scrollshopPages.width+"px":"0px",e.style.position="absolute"),this.containerElement.appendChild(e),this.contentElement=e},extractTags:function(){var e=MainFrame.Util.urlGET("tags"),t=this.props.startingTags;if(e){e=decodeURIComponent(e);var a=e.split("|"),i=this.getIdsForTags(a)}else if("undefined"!=typeof t)if("none"===t)var i=["none"];else var a=this.props.startingTags.split("|"),i=this.getIdsForTags(a);else var i=[];this.props.mapTags=i},getIdsForTags:function(e){for(var t=[],a=MainFrame.Manager.Library.list[this.tagsLibraryId],i=a.data,r=0,n=e.length;n>r;r++){var s=e[r],o=i[s];o&&t.push(o.id)}return t},extractZones:function(){var e=this,t=MainFrame.Util.getAppURL()+e.dataUrl;MainFrame.Util.request({url:t,xmlResponse:!0,parsedXmlResponse:!0,onSuccess:function(t){e.getZones(t)}})},getZones:function(e){for(var t=[],a=[],i=0,r=MainFrame.DataParser.getNodesWithNodeName(e,"zone"),n=r.length;n>i;i++){var s=r[i],o={};o.id=s.attributes.id,o.page=s.attributes.page;var l=s.attributes.pos||"0|0",c=l.split("|");zoneX=parseInt(c[0],10),zoneY=parseInt(c[1],10),zoneSize=s.attributes.size,sizeParts=zoneSize.split("|"),zoneWidth=parseInt(sizeParts[0],10),zoneHeight=parseInt(sizeParts[1],10),zoneRatio=zoneWidth/zoneHeight,imageSource=s.attributes.src,o.columns=s.attributes.forceWidth?parseInt(s.attributes.forceWidth,10):1,o.ratio=zoneRatio,o.mapX=zoneX,o.mapY=zoneY,o.mapWidth=zoneWidth,o.mapHeight=zoneHeight,o.imageSource=imageSource,o.renderData={};var d=s.attributes.tags||"",g=d.split("|");o.mapTags=g;var h=MainFrame.DataParser.getNodesWithNodeName(s,"ref");if(h.length){for(var u={},m=0,p=h.length;p>m;m++){var f=h[m];MainFrame.DataParser.parseRefs(u,f)}o.refs=u}var v=s.attributes.refIds;if(v){var M=v.split("|"),b=M[0];o.refId=b,o.refIds=M}var F=s.attributes.refId;F&&(o.refId=F);var A=s.attributes.refType;A&&(o.refType=A);var P=s.attributes.color;P&&(o.color=P),this.props.refTypes.length?A&&-1!==this.props.refTypes.indexOf(A)&&(t.push(o),a.push(o)):(t.push(o),a.push(o))}this.props.zones=t,this.props.allZones=a},initScrollshop:function(){if(this.showLoadingContainer(),this.determineZonesPosition(),this.updateContentHeight(),this.initSlider(),this.bindScrollEvent(),this.props.tagFilter){var e=0!==this.props.mapTags.length;e&&this.filterZonesByTags(this.props.mapTags)}if(this.props.scrollToCurrentPage)var t=this.sourceModule,a=t.currentPage;else a=1;this.scrollToPage(a),this.currentPage=a,this.loadZonesForPage(a),this.props.scrollshopPages.active&&this.scrollshopPages.buildScrollshopPages(),this.hideLoadingContainer()},determineZonesPosition:function(){this.determineMaxColumns();for(var e=this.props.zones,t=0,a=[],i=this.props.maxColumns;i>t;t++)a[t]=0;var r={},n=this.props.itemWidth,s=this.props.spacingLeft+this.props.spacingRight,o=this.props.spacingTop+this.props.spacingBottom,l=this.props.paddingLeft+this.props.paddingRight,c=this.props.paddingTop+this.props.paddingBottom,d=this.props.rightContentWidth,g=this.props.bottomContentHeight,h=n-(s+l+d),u=o+c+g,m=i*n,p=this.getDimensionX();this.props.scrollshopPages.active&&(p-=this.props.scrollshopPages.width);var f=Math.round((p-m)/2),v=this;e.forEach(function(e){if(e.columns<=i)var t=e.columns;else var t=i;if(1===t){var o=Math.ceil(h/e.ratio),c=v.getLowestHeightIndex(a),g=a[c];a[c]+=o+u}else for(var m=n*t-(s+l+d),o=Math.ceil(m/e.ratio),c=v.getHeightIndexForMultipleColumns(a,t),g=a[c],p=o+u;t>0;)"undefined"!=typeof a[c+t-1]&&(a[c+t-1]+=p),t--;var M=f+c*n,b=g;e.renderData.x=M,e.renderData.y=b;var F=e.page;"undefined"==typeof r[F]&&(r[F]=b)}),this.props.pageHeights=r,this.props.columnHeights=a},determineMaxColumns:function(){var e=this.getDimensionX();this.props.scrollshopPages.active&&(e-=this.props.scrollshopPages.width);var t=Math.floor(e/this.props.itemWidth);this.props.maxColumns=t},getLowestHeightIndex:function(e){for(var t,a=e.length-1,i=0;a>=0;a--){var r=e[a];("undefined"==typeof t||t>=r)&&(i=a,t=r)}return i},getHeightIndexForMultipleColumns:function(e,t){for(var a=0,i=e.length,r=[];i>a;a++){var n=i-a>=t;if(n){var s=e.slice(a,a+t),o=Math.max.apply(null,s);r.push({height:o,index:a})}}var l,c=r.length,d=0;for(a=c-1;a>=0;a--){var g=r[a];("undefined"==typeof l||g.height<=l)&&(l=g.height,d=g.index)}return d},updateContentHeight:function(){var e=this.determineMaxColumnHeight(this.props.columnHeights);this.contentElement.style.height=e+"px",this.props.scrollshopPages.active&&(this.scrollshopPages.setDimensionY(e),this.scrollshopPages.containerElement.style.height=e+"px"),this.props.containerHeight=e},determineMaxColumnHeight:function(e){for(var t=0,a=e.length,i=0;a>t;t++){var r=e[t];r>i&&(i=r)}return i},initSlider:function(){if(this.sliderId){var e="undefined"!=typeof Ps;if(e){var t=MainFrame.Manager.Slider.getById(this.sliderId),a=MainFrame.DataParser.getSliderConfig(t);Ps.initialize(this.containerElement,a),this.hasSlider=!0}}},bindScrollEvent:function(){var e=this,t=e.getDimensionY(),a=e.containerElement,i=(this.props.containerHeight,a.scrollTop),r="";MainFrame.Event.bind(e.containerElement,"scroll",function(){var n=a.scrollTop;parseInt(e.contentElement.style.height),i>n?r="back":n>i&&(r="forward"),i=n,"back"===r&&n<=e.props.firstZoneHeight?e.prependItems():"forward"===r&&n>=e.props.lastZoneHeight-t&&e.appendItems()})},scrollToPage:function(e){for(var t=0,a=this.props.zones,i=a.length;i>t;t++){var r=a[t];if(r.page==e){var n=r.renderData.y;break}}n&&(this.containerElement.scrollTop=n)},loadZonesForPage:function(e){var t=document.createDocumentFragment(),a=this.props.zones,i=this.determineFirstPageIndex(e),r=i-this.props.itemsToPrepend,n=i+this.props.startingItems,s=a.length;0>r&&(r=0),n>s-1&&(n=s-1);var o=a[r];this.props.firstZoneHeight=o.renderData.y,this.props.firstZoneIndex=r;var l=a[n];this.props.lastZoneHeight=l.renderData.y,this.props.lastZoneIndex=n;for(var c=r;n>=c;c++){var d=a[c];"undefined"==typeof d.item?this.createScrollshopItem(t,d):(d.item.containerElement.style.left=d.renderData.x+"px",d.item.containerElement.style.top=d.renderData.y+"px")}this.contentElement.appendChild(t)},determineFirstPageIndex:function(e){for(var t=this.props.zones,a=0,i=this.props.zones.length;i>a;a++){var r=t[a];if(r.page>=e)return a}return a},createScrollshopItem:function(e,t){var a=this.sourceModule;if("2"===a.API_VERSION)var i=a.settings.pages.normalSize;else var i=a.normalSize;var r=document.createElement("div"),n=t.columns>this.props.maxColumns?this.props.maxColumns:t.columns,s=this.props.itemWidth*n,o=this.props.spacingLeft+this.props.spacingRight,l=this.props.paddingLeft+this.props.paddingRight,c=s-o-l-this.props.rightContentWidth,d=c/t.ratio,g=this.props.spacingTop+this.props.spacingBottom,h=this.props.paddingTop+this.props.paddingBottom,u=d+g+h+this.props.bottomContentHeight;r.setAttribute("class","v7__elem__scrollshop__item"),r.style.width=s+"px",r.style.height=u+"px";var m=document.createElement("div"),p="v7__elem__scrollshop__item__content";this.props.roundCorners&&(p+=" v7__elem__scrollshop--round-corners"),m.setAttribute("class",p),m.style.left=this.props.spacingLeft+"px",m.style.top=this.props.spacingTop+"px",t.color&&(m.style.backgroundColor=t.color);var f=c+l+this.props.rightContentWidth;m.style.width=f+"px";var v=u-g;m.style.height=v+"px";var M=document.createElement("div"),b="v7__elem__scrollshop__item__image-wrapper";this.props.roundCorners&&(b+=" v7__elem__scrollshop--round-corners"),M.setAttribute("class",b),M.style.width=c+"px",M.style.height=d+"px",M.style.left=this.props.paddingLeft+"px",M.style.top=this.props.paddingTop+"px";var F=document.createElement("div");if(F.setAttribute("class","v7__elem__scrollshop__item__image-container"),F.style.width="100%",F.style.height="100%",t.zoneWidth=c,t.zoneHeight=d,t.imageSource)F.style.backgroundImage="url("+t.imageSource+")",F.style.backgroundPosition="0",F.style.backgroundSize="100%";
else{var A=t.mapX+t.mapWidth>i.width,P=this.getPageImagePathForPage(a,t.page);if(A){var y=parseInt(t.page,10)+1,C=this.getPageImagePathForPage(a,y);F.style.backgroundImage="url("+P+"), url("+C+")"}else F.style.backgroundImage="url("+P+")";var E=100*t.mapX/i.width,S=100*t.mapY/i.height,w=100*t.mapWidth/i.width,I=100*t.mapHeight/i.height,x=100*c/w,D=100*d/I,T=E*x/100,O=S*D/100;A?(F.style.backgroundPosition="-"+T+"px -"+O+"px, "+(x-T)+"px -"+O+"px",F.style.backgroundSize=x+"px "+D+"px, "+x+"px "+D+"px"):(F.style.backgroundPosition="-"+T+"px -"+O+"px",F.style.backgroundSize=x+"px "+D+"px")}var z=new MainFrame.Element.ScrollshopItem({superObject:this,containerElement:r});if(z.zoneData=t,t.item=z,M.appendChild(F),m.appendChild(M),this.props.bottomContentData&&(t.refId||t.refs||this.props.defaultRefType)){var B=document.createElement("div");Math.ceil(d),B.setAttribute("class","v7__elem__scrollshop__item__bottom-content"),B.style.height=this.props.bottomContentHeight+"px";var k=document.createElement("div");B.appendChild(k);var U=this.props.bottomContentData,R=new MainFrame.Element.Resource({id:this.id+"_bottomContent",containerElement:k,superObject:z,data:U});m.appendChild(B)}else if(this.props.rightContentData&&(t.refId||t.refs||this.props.defaultRefType)){var B=document.createElement("div"),Y=Math.ceil(c)+l;B.setAttribute("class","v7__elem__scrollshop__item__right-content"),B.style.width=this.props.rightContentWidth+"px",B.style.left=Y+"px";var k=document.createElement("div");B.appendChild(k);var U=this.props.rightContentData,R=new MainFrame.Element.Resource({id:this.id+"_rightContent",containerElement:k,superObject:z,data:U})}if(B){m.appendChild(B);var _=R.getSubObjectWithRole("goto-action-target"),L=R.getSubObjectWithRole("ref-action-target");if("goto-action-target"===R.role&&(_=R),"ref-action-target"===R.role&&(L=R),_){var N="id:scrollshopItemGoToAction;params:page="+t.page;_.setAction(N)}if(L){for(var j in t.refs)var X=t.refs[j];if(t.refIds&&t.refIds.length>1){var H="id:mapMultirefActions";L.refs=t.refIds,L.passedData={page:t.page,refIds:t.refIds}}else if(X){var H="id:"+X.type+"RefActions;params:source="+this.sourceModuleId;L.ref=X,L.refs=t.refs}else if(t.refType)var H="id:"+t.refType+"RefActions;params:source="+this.sourceModuleId+",zoneId="+t.id+",page="+t.page+",scrollshopMultiZone=true";else if(t.refId)var H="id:ldcRefActions;params:source="+this.sourceModuleId+",refId="+t.refId+",page="+t.page;else if(this.props.defaultRefType)var H="id:"+this.props.defaultRefType+"RefActions;params:source="+this.sourceModuleId+",zoneId="+t.id+",page="+t.page+",scrollshopMultiZone=true";H&&L.setAction(H)}}var Q=new MainFrame.Element.HtmlItem({superObject:z,containerElement:M}),W="id:scrollshopItemAction;params:page="+t.page,Z=!1;Q.setAction(W,Z);var V=this.props.itemAltId;V&&Q.addAltId(V,"default"),r.style.left=t.renderData.x+"px",r.style.top=t.renderData.y+"px",t.renderData.rendered=!0,this.initInnerPrices(this,t,c,d,M),r.appendChild(m),e.appendChild(r)},initInnerPrices:function(e,t,a,i,r){var n=e.sourceModule;if(n.settings.prices.active){var s=document.createElement("div"),o=new MainFrame.Prices({superObject:n,containerElement:s}),l=this,c=function(){l.drawInnerPrices(o,t,a,i,n,r)};o.drawPricesForPage(t.page,c)}},drawInnerPrices:function(e,t,a,i,r,n){var s=this.getInnerPrices(e,t),o=n;if(s)for(var l=s.length,c=e.superObject.currentPageSize,d=!0,g=0;l>g;g++){var h=s[g],u=e.drawPrice(h,o,d);this.resizePrice(h,u,e,t,a,i,c.height)}},getInnerPrices:function(e,t){for(var a=[],i=0,r=e.priceMaps.length;r>i;i++){var n=e.priceMaps[i];MainFrame.Util.pointInsideRectangle(n.x,n.y,t.mapX,t.mapY,t.mapWidth,t.mapHeight)&&a.push(n)}return a},resizePrice:function(e,t,a,i,r,n){var s=a.adjustPricePosition({x:parseFloat(t.priceMap.x),y:parseFloat(t.priceMap.y),size:parseFloat(t.priceMap.height)}),o=s.x,l=s.y,c=s.size;o-=parseFloat(i.mapX),l-=parseFloat(i.mapY);var d=100*o/parseFloat(i.mapWidth),g=100*l/parseFloat(i.mapHeight),h=100*c/parseFloat(i.mapHeight);o=d*r/100,l=g*n/100,c=h*n/100,t.containerElement.style.fontSize=c+"px",t.containerElement.style.lineHeight=c+"px",t.setPositionX(o),t.setPositionY(l),t.containerElement.style.left=o+"px",t.containerElement.style.top=l+"px",t.resize()},getPageImagePathForPage:function(e,t){var a=e.pageReferences[t];if(e.settings.pages.useXJpgForZoom&&-1!==e.settings.pages.xJpgPages.indexOf(t))if(e.optimumSize&&!this.props.useHdSource)var i=a.sizes[e.optimumSize],r=i.original;else var r=a.hdx;else if(e.optimumSize&&!this.props.useHdSource)var i=a.sizes[e.optimumSize],r=i.normal;else var r=a.hd;return-1===r.indexOf("/")&&(r=e.settings.pages.dataSrc+r),MainFrame.Util.getAppURL()+r},prependItems:function(){var e=this.props.firstZoneIndex;if(0!==e){this.showLoadingContainer();var t=document.createDocumentFragment(),a=e-this.props.itemsPerLoad;0>a&&(a=0);for(var i=e-1,r=this.props.zones;i>=a;i--){var n=r[i];"undefined"==typeof n.item?this.createScrollshopItem(t,n):(n.item.containerElement.style.left=n.renderData.x+"px",n.item.containerElement.style.top=n.renderData.y+"px")}var s=r[a];this.props.firstZoneIndex=a,this.props.firstZoneHeight=s.renderData.y,this.contentElement.appendChild(t),this.hideLoadingContainer()}},appendItems:function(){var e=this.props.zones,t=e.length,a=this.props.lastZoneIndex;if(a!==t){this.showLoadingContainer();var i=document.createDocumentFragment(),r=a+this.props.itemsPerLoad;r>t-1&&(r=t-1);for(var n=a;r>=n;n++){var s=e[n];"undefined"==typeof s.item?this.createScrollshopItem(i,s):(s.item.containerElement.style.left=s.renderData.x+"px",s.item.containerElement.style.top=s.renderData.y+"px"),s.item.containerElement.style.display=""}var o=e[r];this.props.lastZoneIndex=r,this.props.lastZoneHeight=o.renderData.y,this.contentElement.appendChild(i),this.hideLoadingContainer()}},filterItemsByTagIds:function(e){if(this.showLoadingContainer(),this.hideExistingZones(),this.contentElement.style.height="10px",this.containerElement.scrollTop="0px",e){var t=e.split("|");this.filterZonesByTags(t);var a="#"+this.id+".filteredByTag"}else{this.props.zones=this.props.allZones;for(var i=this.props.zones,r=0,n=i.length;n>r;r++)i[r];var a="#"+this.id+".showingAllTags"}this.props.firstZoneIndex=0,this.props.lastZoneIndex=0,this.repositionItems(),this.appendItems(),MainFrame.EventHandler.dispatch(a,[this])},hideExistingZones:function(){for(var e=this.props.zones,t=0,a=e.length;a>t;t++){var i=e[t];"undefined"!=typeof i.item&&(i.item.containerElement.style.display="none")}},filterZonesByTags:function(e){for(var t=this.props.allZones,a=0,i=e.length,r=t.length,n=[];r>a;a++){for(var s=t[a],o=!1,l=0;i>l;l++)if(s.mapTags.indexOf(e[l])>-1){o=!0;break}o&&n.push(s)}0===n.length&&(MainFrame.EventHandler.dispatch("#"+this.id+".noFilteredResults",[this]),MainFrame.EventHandler.dispatch("scrollshopNoFilteredResults",[this])),this.props.zones=n},resize:function(){this._resize(),this.resizeContentElement(),this.repositionItems()},resizeContentElement:function(){if(this.props.scrollshopPages.active){var e=this.getDimensionX(),t=this.props.scrollshopPages.width,a=e-t;this.contentElement.style.width=a+"px"}},repositionItems:function(){this.determineZonesPosition(),this.updateContentHeight(),Ps.update(this.contentElement);var e=this.props.zones;e.forEach(function(e){var t=e.renderData,a=e.item;t.rendered&&(a.containerElement.style.left=t.x+"px",a.containerElement.style.top=t.y+"px")})}}),MainFrame.Element.ScrollshopItem=MainFrame.Abstract.Element.extend({_initialize:function(e){e=e||{},e.data&&(this.data=e.data),this._properties={},this._properties.def={},this._properties.original={},e.superObject&&this.addSuperObject(e.superObject),this.id=e.id||MainFrame.Util.generateItemId.call(this),MainFrame.Manager.Scoping.register(this.id,this),this.containerElement=e.containerElement,this.containerElement.setAttribute("data-type","container"),this.resize()},resize:function(){}}),!function(){MainFrame.DataParser.elements.scrollshop=MainFrame.Element.Scrollshop,MainFrame.DataParser.elements.scrollshopFilterGroup=MainFrame.Element.ScrollshopFilterGroup,MainFrame.DataParser.elements.scrollshopPages=MainFrame.Element.ScrollshopPages}();